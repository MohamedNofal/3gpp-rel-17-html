<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>38214-h90</title>
  <style>
    html {
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 12px;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      html {
        background-color: white;
      }
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    svg {
      height: auto;
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, Consolas, 'Lucida Console', monospace;
      font-size: 85%;
      margin: 0;
      hyphens: manual;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      border: none;
      border-top: 1px solid #1a1a1a;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
  </style>
  <script
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js"
  type="text/javascript"></script>
</head>
<body>
<nav id="TOC" role="doc-toc">
<ul>
<li><a href="#contents" id="toc-contents"><br />
Contents</a></li>
<li><a href="#foreword" id="toc-foreword"><br />
Foreword</a></li>
<li><a href="#scope" id="toc-scope"><br />
1 Scope</a></li>
<li><a href="#references" id="toc-references">2 References</a></li>
<li><a href="#definitions-symbols-and-abbreviations"
id="toc-definitions-symbols-and-abbreviations">3 Definitions, symbols
and abbreviations</a>
<ul>
<li><a href="#definitions" id="toc-definitions">3.1 Definitions</a></li>
<li><a href="#symbols" id="toc-symbols">3.2 Symbols</a></li>
<li><a href="#abbreviations" id="toc-abbreviations">3.3
Abbreviations</a></li>
</ul></li>
<li><a href="#power-control" id="toc-power-control">4 Power control </a>
<ul>
<li><a href="#power-allocation-for-downlink"
id="toc-power-allocation-for-downlink">4.1 Power allocation for downlink
</a></li>
</ul></li>
<li><a href="#physical-downlink-shared-channel-related-procedures"
id="toc-physical-downlink-shared-channel-related-procedures">5 Physical
downlink shared channel related procedures</a>
<ul>
<li><a
href="#ue-procedure-for-receiving-the-physical-downlink-shared-channel"
id="toc-ue-procedure-for-receiving-the-physical-downlink-shared-channel">5.1
UE procedure for receiving the physical downlink shared channel</a>
<ul>
<li><a href="#transmission-schemes" id="toc-transmission-schemes">5.1.1
Transmission schemes</a>
<ul>
<li><a href="#transmission-scheme-1"
id="toc-transmission-scheme-1">5.1.1.1 Transmission scheme 1</a></li>
</ul></li>
<li><a href="#resource-allocation" id="toc-resource-allocation">5.1.2
Resource allocation</a>
<ul>
<li><a href="#resource-allocation-in-time-domain"
id="toc-resource-allocation-in-time-domain">5.1.2.1 Resource allocation
in time domain</a>
<ul>
<li><a
href="#determination-of-the-resource-allocation-table-to-be-used-for-pdsch"
id="toc-determination-of-the-resource-allocation-table-to-be-used-for-pdsch">5.1.2.1.1
Determination of the resource allocation table to be used for
PDSCH</a></li>
</ul></li>
<li><a href="#resource-allocation-in-frequency-domain"
id="toc-resource-allocation-in-frequency-domain">5.1.2.2 Resource
allocation in frequency domain</a>
<ul>
<li><a href="#downlink-resource-allocation-type-0"
id="toc-downlink-resource-allocation-type-0">5.1.2.2.1 Downlink resource
allocation type 0</a></li>
<li><a href="#downlink-resource-allocation-type-1"
id="toc-downlink-resource-allocation-type-1">5.1.2.2.2 Downlink resource
allocation type 1</a></li>
<li><a
href="#downlink-resource-allocation-type-1-for-multicastbroadcast"
id="toc-downlink-resource-allocation-type-1-for-multicastbroadcast">5.1.2.2.3
Downlink resource allocation type 1 for multicast/broadcast</a></li>
</ul></li>
<li><a href="#physical-resource-block-prb-bundling"
id="toc-physical-resource-block-prb-bundling">5.1.2.3 Physical resource
block (PRB) bundling</a></li>
</ul></li>
<li><a
href="#modulation-order-target-code-rate-redundancy-version-and-transport-block-size-determination"
id="toc-modulation-order-target-code-rate-redundancy-version-and-transport-block-size-determination">5.1.3
Modulation order, target code rate, redundancy version and transport
block size determination</a>
<ul>
<li><a href="#modulation-order-and-target-code-rate-determination"
id="toc-modulation-order-and-target-code-rate-determination">5.1.3.1
Modulation order and target code rate determination</a></li>
<li><a href="#transport-block-size-determination"
id="toc-transport-block-size-determination">5.1.3.2 Transport block size
determination</a></li>
</ul></li>
<li><a href="#pdsch-resource-mapping"
id="toc-pdsch-resource-mapping">5.1.4 PDSCH resource mapping</a>
<ul>
<li><a href="#pdsch-resource-mapping-with-rb-symbol-level-granularity"
id="toc-pdsch-resource-mapping-with-rb-symbol-level-granularity">5.1.4.1
PDSCH resource mapping with RB symbol level granularity</a></li>
<li><a href="#pdsch-resource-mapping-with-re-level-granularity"
id="toc-pdsch-resource-mapping-with-re-level-granularity">5.1.4.2 PDSCH
resource mapping with RE level granularity</a></li>
</ul></li>
<li><a href="#antenna-ports-quasi-co-location"
id="toc-antenna-ports-quasi-co-location">5.1.5 Antenna ports quasi
co-location</a></li>
<li><a href="#ue-procedure-for-receiving-reference-signals"
id="toc-ue-procedure-for-receiving-reference-signals">5.1.6 UE procedure
for receiving reference signals</a>
<ul>
<li><a href="#csi-rs-reception-procedure"
id="toc-csi-rs-reception-procedure">5.1.6.1 CSI-RS reception
procedure</a>
<ul>
<li><a href="#csi-rs-for-tracking"
id="toc-csi-rs-for-tracking">5.1.6.1.1 CSI-RS for tracking</a></li>
<li><a href="#aperiodic-csi-rs-for-tracking-for-fast-scell-activation"
id="toc-aperiodic-csi-rs-for-tracking-for-fast-scell-activation">5.1.6.1.1.1
Aperiodic CSI-RS for tracking for fast SCell activation</a></li>
<li><a href="#csi-rs-for-l1-rsrp-and-l1-sinr-computation"
id="toc-csi-rs-for-l1-rsrp-and-l1-sinr-computation">5.1.6.1.2 CSI-RS for
L1-RSRP and L1-SINR computation</a></li>
<li><a href="#csi-rs-for-mobility"
id="toc-csi-rs-for-mobility">5.1.6.1.3 CSI-RS for mobility</a></li>
</ul></li>
<li><a href="#dm-rs-reception-procedure"
id="toc-dm-rs-reception-procedure">5.1.6.2 DM-RS reception
procedure</a></li>
<li><a href="#pt-rs-reception-procedure"
id="toc-pt-rs-reception-procedure">5.1.6.3 PT-RS reception
procedure</a></li>
<li><a href="#srs-reception-procedure-for-cli"
id="toc-srs-reception-procedure-for-cli">5.1.6.4 SRS reception procedure
for CLI</a></li>
<li><a href="#prs-reception-procedure"
id="toc-prs-reception-procedure">5.1.6.5 PRS reception
procedure</a></li>
</ul></li>
<li><a href="#code-block-group-based-pdsch-transmission"
id="toc-code-block-group-based-pdsch-transmission">5.1.7 Code block
group based PDSCH transmission</a>
<ul>
<li><a
href="#ue-procedure-for-grouping-of-code-blocks-to-code-block-groups"
id="toc-ue-procedure-for-grouping-of-code-blocks-to-code-block-groups">5.1.7.1
UE procedure for grouping of code blocks to code block groups</a></li>
<li><a
href="#ue-procedure-for-receiving-code-block-group-based-transmissions"
id="toc-ue-procedure-for-receiving-code-block-group-based-transmissions">5.1.7.2
UE procedure for receiving code block group based transmissions</a></li>
</ul></li>
</ul></li>
<li><a href="#ue-procedure-for-reporting-channel-state-information-csi"
id="toc-ue-procedure-for-reporting-channel-state-information-csi">5.2 UE
procedure for reporting channel state information (CSI)</a>
<ul>
<li><a href="#channel-state-information-framework"
id="toc-channel-state-information-framework">5.2.1 Channel state
information framework</a>
<ul>
<li><a href="#reporting-settings" id="toc-reporting-settings">5.2.1.1
Reporting settings</a></li>
<li><a href="#resource-settings" id="toc-resource-settings">5.2.1.2
Resource settings</a></li>
<li><a href="#void" id="toc-void">5.2.1.3 (void)</a></li>
<li><a href="#reporting-configurations"
id="toc-reporting-configurations">5.2.1.4 Reporting configurations</a>
<ul>
<li><a href="#resource-setting-configuration"
id="toc-resource-setting-configuration">5.2.1.4.1 Resource Setting
configuration</a></li>
<li><a href="#report-quantity-configurations"
id="toc-report-quantity-configurations">5.2.1.4.2 Report Quantity
Configurations</a></li>
<li><a href="#l1-rsrp-reporting" id="toc-l1-rsrp-reporting">5.2.1.4.3
L1-RSRP Reporting</a></li>
<li><a href="#l1-sinr-reporting" id="toc-l1-sinr-reporting">5.2.1.4.4
L1-SINR Reporting</a></li>
</ul></li>
<li><a href="#triggeringactivation-of-csi-reports-and-csi-rs"
id="toc-triggeringactivation-of-csi-reports-and-csi-rs">5.2.1.5
Triggering/activation of CSI Reports and CSI-RS</a>
<ul>
<li><a
href="#aperiodic-csi-reportingaperiodic-csi-rs-when-the-triggering-pdcch-and-the-csi-rs-have-the-same-numerology"
id="toc-aperiodic-csi-reportingaperiodic-csi-rs-when-the-triggering-pdcch-and-the-csi-rs-have-the-same-numerology">5.2.1.5.1
Aperiodic CSI Reporting/Aperiodic CSI-RS when the triggering PDCCH and
the CSI-RS have the same numerology</a></li>
<li><a
href="#a-aperiodic-csi-reportingaperiodic-csi-rs-when-the-triggering-pdcch-and-the-csi-rs-have-different-numerologies"
id="toc-a-aperiodic-csi-reportingaperiodic-csi-rs-when-the-triggering-pdcch-and-the-csi-rs-have-different-numerologies">5.2.1.5.1a
Aperiodic CSI Reporting/Aperiodic CSI-RS when the triggering PDCCH and
the CSI-RS have different numerologies</a></li>
<li><a href="#semi-persistent-csisemi-persistent-csi-rs"
id="toc-semi-persistent-csisemi-persistent-csi-rs">5.2.1.5.2
Semi-persistent CSI/Semi-persistent CSI-RS</a></li>
<li><a href="#aperiodic-csi-rs-for-tracking-for-fast-scell-activation-1"
id="toc-aperiodic-csi-rs-for-tracking-for-fast-scell-activation-1">5.2.1.5.3
Aperiodic CSI-RS for tracking for fast SCell activation</a></li>
</ul></li>
<li><a href="#csi-processing-criteria"
id="toc-csi-processing-criteria">5.2.1.6 CSI processing
criteria</a></li>
</ul></li>
<li><a href="#channel-state-information"
id="toc-channel-state-information">5.2.2 Channel state information</a>
<ul>
<li><a href="#channel-quality-indicator-cqi"
id="toc-channel-quality-indicator-cqi">5.2.2.1 Channel quality indicator
(CQI) </a>
<ul>
<li><a href="#void-1" id="toc-void-1">5.2.2.1.1 (void)</a></li>
</ul></li>
<li><a href="#precoding-matrix-indicator-pmi"
id="toc-precoding-matrix-indicator-pmi">5.2.2.2 Precoding matrix
indicator (PMI) </a>
<ul>
<li><a href="#type-i-single-panel-codebook"
id="toc-type-i-single-panel-codebook">5.2.2.2.1 Type I Single-Panel
Codebook</a></li>
<li><a href="#type-i-multi-panel-codebook"
id="toc-type-i-multi-panel-codebook">5.2.2.2.2 Type I Multi-Panel
Codebook</a></li>
<li><a href="#type-ii-codebook" id="toc-type-ii-codebook">5.2.2.2.3 Type
II Codebook</a></li>
<li><a href="#type-ii-port-selection-codebook"
id="toc-type-ii-port-selection-codebook">5.2.2.2.4 Type II Port
Selection Codebook</a></li>
<li><a href="#enhanced-type-ii-codebook"
id="toc-enhanced-type-ii-codebook">5.2.2.2.5 Enhanced Type II
Codebook</a></li>
<li><a href="#enhanced-type-ii-port-selection-codebook"
id="toc-enhanced-type-ii-port-selection-codebook">5.2.2.2.6 Enhanced
Type II Port Selection Codebook</a></li>
<li><a href="#further-enhanced-type-ii-port-selection-codebook"
id="toc-further-enhanced-type-ii-port-selection-codebook">5.2.2.2.7
Further enhanced Type II port selection codebook</a></li>
</ul></li>
<li><a href="#reference-signal-csi-rs"
id="toc-reference-signal-csi-rs">5.2.2.3 Reference signal (CSI-RS) </a>
<ul>
<li><a href="#nzp-csi-rs" id="toc-nzp-csi-rs">5.2.2.3.1 NZP
CSI-RS</a></li>
</ul></li>
<li><a href="#channel-state-information-interference-measurement-csi-im"
id="toc-channel-state-information-interference-measurement-csi-im">5.2.2.4
Channel State Information – Interference Measurement (CSI-IM) </a></li>
<li><a href="#csi-reference-resource-definition"
id="toc-csi-reference-resource-definition">5.2.2.5 CSI reference
resource definition</a></li>
</ul></li>
<li><a href="#csi-reporting-using-pusch"
id="toc-csi-reporting-using-pusch">5.2.3 CSI reporting using
PUSCH</a></li>
<li><a href="#csi-reporting-using-pucch"
id="toc-csi-reporting-using-pucch">5.2.4 CSI reporting using
PUCCH</a></li>
<li><a href="#priority-rules-for-csi-reports"
id="toc-priority-rules-for-csi-reports">5.2.5 Priority rules for CSI
reports</a></li>
</ul></li>
<li><a href="#ue-pdsch-processing-procedure-time"
id="toc-ue-pdsch-processing-procedure-time">5.3 UE PDSCH processing
procedure time</a>
<ul>
<li><a
href="#application-delay-of-the-minimum-scheduling-offset-restriction"
id="toc-application-delay-of-the-minimum-scheduling-offset-restriction">5.3.1
Application delay of the minimum scheduling offset restriction</a></li>
</ul></li>
<li><a href="#ue-csi-computation-time"
id="toc-ue-csi-computation-time">5.4 UE CSI computation time</a></li>
<li><a
href="#ue-pdsch-reception-preparation-time-with-cross-carrier-scheduling-with-different-subcarrier-spacings-for-pdcch-and-pdsch"
id="toc-ue-pdsch-reception-preparation-time-with-cross-carrier-scheduling-with-different-subcarrier-spacings-for-pdcch-and-pdsch">5.5
UE PDSCH reception preparation time with cross carrier scheduling with
different subcarrier spacings for PDCCH and PDSCH</a></li>
</ul></li>
<li><a href="#physical-uplink-shared-channel-related-procedure"
id="toc-physical-uplink-shared-channel-related-procedure">6 Physical
uplink shared channel related procedure</a>
<ul>
<li><a
href="#ue-procedure-for-transmitting-the-physical-uplink-shared-channel"
id="toc-ue-procedure-for-transmitting-the-physical-uplink-shared-channel">6.1
UE procedure for transmitting the physical uplink shared channel</a>
<ul>
<li><a href="#transmission-schemes-1"
id="toc-transmission-schemes-1">6.1.1 Transmission schemes</a>
<ul>
<li><a href="#codebook-based-ul-transmission"
id="toc-codebook-based-ul-transmission">6.1.1.1 Codebook based UL
transmission</a></li>
<li><a href="#non-codebook-based-ul-transmission"
id="toc-non-codebook-based-ul-transmission">6.1.1.2 Non-Codebook based
UL transmission</a></li>
</ul></li>
<li><a href="#resource-allocation-1"
id="toc-resource-allocation-1">6.1.2 Resource allocation </a>
<ul>
<li><a href="#resource-allocation-in-time-domain-1"
id="toc-resource-allocation-in-time-domain-1">6.1.2.1 Resource
allocation in time domain</a>
<ul>
<li><a
href="#determination-of-the-resource-allocation-table-to-be-used-for-pusch"
id="toc-determination-of-the-resource-allocation-table-to-be-used-for-pusch">6.1.2.1.1
Determination of the resource allocation table to be used for
PUSCH</a></li>
</ul></li>
<li><a href="#resource-allocation-in-frequency-domain-1"
id="toc-resource-allocation-in-frequency-domain-1">6.1.2.2 Resource
allocation in frequency domain</a>
<ul>
<li><a href="#uplink-resource-allocation-type-0"
id="toc-uplink-resource-allocation-type-0">6.1.2.2.1 Uplink resource
allocation type 0</a></li>
<li><a href="#uplink-resource-allocation-type-1"
id="toc-uplink-resource-allocation-type-1">6.1.2.2.2 Uplink resource
allocation type 1</a></li>
<li><a href="#uplink-resource-allocation-type-2"
id="toc-uplink-resource-allocation-type-2">6.1.2.2.3 Uplink resource
allocation type 2</a></li>
</ul></li>
<li><a
href="#resource-allocation-for-uplink-transmission-with-configured-grant"
id="toc-resource-allocation-for-uplink-transmission-with-configured-grant">6.1.2.3
Resource allocation for uplink transmission with configured grant</a>
<ul>
<li><a
href="#transport-block-repetition-for-uplink-transmissions-of-pusch-repetition-type-a-with-a-configured-grant"
id="toc-transport-block-repetition-for-uplink-transmissions-of-pusch-repetition-type-a-with-a-configured-grant">6.1.2.3.1
Transport Block repetition for uplink transmissions of PUSCH repetition
Type A with a configured grant</a></li>
<li><a
href="#transport-block-repetition-for-uplink-transmissions-of-pusch-repetition-type-b-with-a-configured-grant"
id="toc-transport-block-repetition-for-uplink-transmissions-of-pusch-repetition-type-b-with-a-configured-grant">6.1.2.3.2
Transport Block repetition for uplink transmissions of PUSCH repetition
Type B with a configured grant</a></li>
<li><a
href="#transport-block-repetition-for-uplink-transmissions-of-tb-processing-over-multiple-slots-with-a-configured-grant"
id="toc-transport-block-repetition-for-uplink-transmissions-of-tb-processing-over-multiple-slots-with-a-configured-grant">6.1.2.3.3
Transport Block repetition for uplink transmissions of TB processing
over multiple slots with a configured grant</a></li>
</ul></li>
</ul></li>
<li><a href="#ue-procedure-for-applying-transform-precoding-on-pusch"
id="toc-ue-procedure-for-applying-transform-precoding-on-pusch">6.1.3 UE
procedure for applying transform precoding on PUSCH</a></li>
<li><a
href="#modulation-order-redundancy-version-and-transport-block-size-determination"
id="toc-modulation-order-redundancy-version-and-transport-block-size-determination">6.1.4
Modulation order, redundancy version and transport block size
determination</a>
<ul>
<li><a href="#modulation-order-and-target-code-rate-determination-1"
id="toc-modulation-order-and-target-code-rate-determination-1">6.1.4.1
Modulation order and target code rate determination</a></li>
<li><a href="#transport-block-size-determination-1"
id="toc-transport-block-size-determination-1">6.1.4.2 Transport block
size determination</a></li>
</ul></li>
<li><a href="#code-block-group-based-pusch-transmission"
id="toc-code-block-group-based-pusch-transmission">6.1.5 Code block
group based PUSCH transmission</a>
<ul>
<li><a
href="#ue-procedure-for-grouping-of-code-blocks-to-code-block-groups-1"
id="toc-ue-procedure-for-grouping-of-code-blocks-to-code-block-groups-1">6.1.5.1
UE procedure for grouping of code blocks to code block groups</a></li>
<li><a
href="#ue-procedure-for-transmitting-code-block-group-based-transmissions"
id="toc-ue-procedure-for-transmitting-code-block-group-based-transmissions">6.1.5.2
UE procedure for transmitting code block group based
transmissions</a></li>
</ul></li>
<li><a href="#uplink-switching" id="toc-uplink-switching">6.1.6 Uplink
switching</a>
<ul>
<li><a href="#uplink-switching-for-en-dc"
id="toc-uplink-switching-for-en-dc">6.1.6.1 Uplink switching for
EN-DC</a></li>
<li><a href="#uplink-switching-for-carrier-aggregation"
id="toc-uplink-switching-for-carrier-aggregation">6.1.6.2 Uplink
switching for carrier aggregation</a>
<ul>
<li><a href="#void-2" id="toc-void-2">6.1.6.2.1 void</a></li>
</ul></li>
<li><a href="#uplink-switching-for-supplementary-uplink"
id="toc-uplink-switching-for-supplementary-uplink">6.1.6.3 Uplink
switching for supplementary uplink</a></li>
</ul></li>
<li><a
href="#ue-procedure-for-determining-time-domain-windows-for-bundling-dm-rs"
id="toc-ue-procedure-for-determining-time-domain-windows-for-bundling-dm-rs">6.1.7
UE procedure for determining time domain windows for bundling
DM-RS</a></li>
</ul></li>
<li><a href="#ue-reference-signal-rs-procedure"
id="toc-ue-reference-signal-rs-procedure">6.2 UE reference signal (RS)
procedure</a>
<ul>
<li><a href="#ue-sounding-procedure"
id="toc-ue-sounding-procedure">6.2.1 UE sounding procedure</a>
<ul>
<li><a href="#ue-srs-frequency-hopping-procedure"
id="toc-ue-srs-frequency-hopping-procedure">6.2.1.1 UE SRS frequency
hopping procedure</a></li>
<li><a href="#ue-sounding-procedure-for-dl-csi-acquisition"
id="toc-ue-sounding-procedure-for-dl-csi-acquisition">6.2.1.2 UE
sounding procedure for DL CSI acquisition</a></li>
<li><a href="#ue-sounding-procedure-between-component-carriers"
id="toc-ue-sounding-procedure-between-component-carriers">6.2.1.3 UE
sounding procedure between component carriers</a></li>
<li><a href="#ue-sounding-procedure-for-positioning-purposes"
id="toc-ue-sounding-procedure-for-positioning-purposes">6.2.1.4 UE
sounding procedure for positioning purposes</a></li>
</ul></li>
<li><a href="#ue-dm-rs-transmission-procedure"
id="toc-ue-dm-rs-transmission-procedure">6.2.2 UE DM-RS transmission
procedure</a></li>
<li><a href="#ue-pt-rs-transmission-procedure"
id="toc-ue-pt-rs-transmission-procedure">6.2.3 UE PT-RS transmission
procedure</a>
<ul>
<li><a
href="#ue-pt-rs-transmission-procedure-when-transform-precoding-is-not-enabled"
id="toc-ue-pt-rs-transmission-procedure-when-transform-precoding-is-not-enabled">6.2.3.1
UE PT-RS transmission procedure when transform precoding is not
enabled</a></li>
<li><a
href="#ue-pt-rs-transmission-procedure-when-transform-precoding-is-enabled"
id="toc-ue-pt-rs-transmission-procedure-when-transform-precoding-is-enabled">6.2.3.2
UE PT-RS transmission procedure when transform precoding is
enabled</a></li>
</ul></li>
</ul></li>
<li><a href="#ue-pusch-frequency-hopping-procedure"
id="toc-ue-pusch-frequency-hopping-procedure">6.3 UE PUSCH frequency
hopping procedure</a>
<ul>
<li><a
href="#frequency-hopping-for-pusch-repetition-type-a-and-for-tb-processing-over-multiple-slots"
id="toc-frequency-hopping-for-pusch-repetition-type-a-and-for-tb-processing-over-multiple-slots">6.3.1
Frequency hopping for PUSCH repetition Type A and for TB processing over
multiple slots</a></li>
<li><a href="#frequency-hopping-for-pusch-repetition-type-b"
id="toc-frequency-hopping-for-pusch-repetition-type-b">6.3.2 Frequency
hopping for PUSCH repetition Type B</a></li>
</ul></li>
<li><a href="#ue-pusch-preparation-procedure-time"
id="toc-ue-pusch-preparation-procedure-time">6.4 UE PUSCH preparation
procedure time</a></li>
</ul></li>
<li><a
href="#ue-procedures-for-transmitting-and-receiving-on-a-carrier-with-intra-cell-guard-bands"
id="toc-ue-procedures-for-transmitting-and-receiving-on-a-carrier-with-intra-cell-guard-bands">7
UE procedures for transmitting and receiving on a carrier with
intra-cell guard bands</a></li>
<li><a href="#physical-sidelink-shared-channel-related-procedures"
id="toc-physical-sidelink-shared-channel-related-procedures">8 Physical
sidelink shared channel related procedures</a>
<ul>
<li><a
href="#ue-procedure-for-transmitting-the-physical-sidelink-shared-channel"
id="toc-ue-procedure-for-transmitting-the-physical-sidelink-shared-channel">8.1
UE procedure for transmitting the physical sidelink shared channel</a>
<ul>
<li><a href="#transmission-schemes-2"
id="toc-transmission-schemes-2">8.1.1 Transmission schemes</a></li>
<li><a href="#resource-allocation-2"
id="toc-resource-allocation-2">8.1.2 Resource allocation</a>
<ul>
<li><a href="#resource-allocation-in-time-domain-2"
id="toc-resource-allocation-in-time-domain-2">8.1.2.1 Resource
allocation in time domain</a></li>
<li><a href="#resource-allocation-in-frequency-domain-2"
id="toc-resource-allocation-in-frequency-domain-2">8.1.2.2 Resource
allocation in frequency domain</a></li>
</ul></li>
<li><a
href="#modulation-order-target-code-rate-redundancy-version-and-transport-block-size-determination-1"
id="toc-modulation-order-target-code-rate-redundancy-version-and-transport-block-size-determination-1">8.1.3
Modulation order, target code rate, redundancy version and transport
block size determination</a>
<ul>
<li><a href="#modulation-order-and-target-code-rate-determination-2"
id="toc-modulation-order-and-target-code-rate-determination-2">8.1.3.1
Modulation order and target code rate determination</a></li>
<li><a href="#transport-block-size-determination-2"
id="toc-transport-block-size-determination-2">8.1.3.2 Transport block
size determination</a></li>
</ul></li>
<li><a
href="#ue-procedure-for-determining-the-subset-of-resources-to-be-reported-to-higher-layers-in-pssch-resource-selection-in-sidelink-resource-allocation-mode-2"
id="toc-ue-procedure-for-determining-the-subset-of-resources-to-be-reported-to-higher-layers-in-pssch-resource-selection-in-sidelink-resource-allocation-mode-2">8.1.4
UE procedure for determining the subset of resources to be reported to
higher layers in PSSCH resource selection in sidelink resource
allocation mode 2</a></li>
<li><a
href="#a-ue-procedure-for-determining-a-set-of-preferred-or-non-preferred-resources-for-another-ues-transmission"
id="toc-a-ue-procedure-for-determining-a-set-of-preferred-or-non-preferred-resources-for-another-ues-transmission">8.1.4A
UE procedure for determining a set of preferred or non-preferred
resources for another UE's transmission</a></li>
<li><a href="#b-void" id="toc-b-void">8.1.4B Void </a></li>
<li><a
href="#c-ue-procedure-for-using-a-received-non-preferred-resource-set"
id="toc-c-ue-procedure-for-using-a-received-non-preferred-resource-set">8.1.4C
UE procedure for using a received non-preferred resource set </a></li>
<li><a
href="#ue-procedure-for-determining-slots-and-resource-blocks-for-pssch-transmission-associated-with-an-sci-format-1-a"
id="toc-ue-procedure-for-determining-slots-and-resource-blocks-for-pssch-transmission-associated-with-an-sci-format-1-a">8.1.5
UE procedure for determining slots and resource blocks for PSSCH
transmission associated with an SCI format 1-A</a></li>
<li><a
href="#a-ue-procedure-for-determining-slots-and-resource-blocks-indicated-by-a-preferred-or-non-preferred-resource-set"
id="toc-a-ue-procedure-for-determining-slots-and-resource-blocks-indicated-by-a-preferred-or-non-preferred-resource-set">8.1.5A
UE procedure for determining slots and resource blocks indicated by a
preferred or non-preferred resource set</a></li>
<li><a
href="#sidelink-congestion-control-in-sidelink-resource-allocation-mode-2"
id="toc-sidelink-congestion-control-in-sidelink-resource-allocation-mode-2">8.1.6
Sidelink congestion control in sidelink resource allocation mode
2</a></li>
<li><a
href="#ue-procedure-for-determining-the-number-of-logical-slots-for-a-reservation-period"
id="toc-ue-procedure-for-determining-the-number-of-logical-slots-for-a-reservation-period">8.1.7
UE procedure for determining the number of logical slots for a
reservation period </a></li>
</ul></li>
<li><a href="#ue-procedure-for-transmitting-sidelink-reference-signals"
id="toc-ue-procedure-for-transmitting-sidelink-reference-signals">8.2 UE
procedure for transmitting sidelink reference signals</a>
<ul>
<li><a href="#csi-rs-transmission-procedure"
id="toc-csi-rs-transmission-procedure">8.2.1 CSI-RS transmission
procedure</a></li>
<li><a href="#pssch-dm-rs-transmission-procedure"
id="toc-pssch-dm-rs-transmission-procedure">8.2.2 PSSCH DM-RS
transmission procedure</a></li>
<li><a href="#pt-rs-transmission-procedure"
id="toc-pt-rs-transmission-procedure">8.2.3 PT-RS transmission
procedure</a></li>
</ul></li>
<li><a
href="#ue-procedure-for-receiving-the-physical-sidelink-shared-channel"
id="toc-ue-procedure-for-receiving-the-physical-sidelink-shared-channel">8.3
UE procedure for receiving the physical sidelink shared channel</a></li>
<li><a href="#ue-procedure-for-receiving-reference-signals-1"
id="toc-ue-procedure-for-receiving-reference-signals-1">8.4 UE procedure
for receiving reference signals</a>
<ul>
<li><a href="#csi-rs-reception-procedure-1"
id="toc-csi-rs-reception-procedure-1">8.4.1 CSI-RS reception
procedure</a></li>
<li><a href="#dm-rs-reception-procedure-for-rsrp-computation"
id="toc-dm-rs-reception-procedure-for-rsrp-computation">8.4.2 DM-RS
reception procedure for RSRP computation</a></li>
<li><a href="#pt-rs-reception-procedure-1"
id="toc-pt-rs-reception-procedure-1">8.4.3 PT-RS reception
procedure</a></li>
</ul></li>
<li><a
href="#ue-procedure-for-reporting-channel-state-information-csi-1"
id="toc-ue-procedure-for-reporting-channel-state-information-csi-1">8.5
UE procedure for reporting channel state information (CSI)</a>
<ul>
<li><a href="#channel-state-information-framework-1"
id="toc-channel-state-information-framework-1">8.5.1 Channel state
information framework</a>
<ul>
<li><a href="#reporting-configurations-1"
id="toc-reporting-configurations-1">8.5.1.1 Reporting
configurations</a></li>
<li><a href="#triggering-of-sidelink-csi-reports"
id="toc-triggering-of-sidelink-csi-reports">8.5.1.2 Triggering of
sidelink CSI reports</a></li>
</ul></li>
<li><a href="#channel-state-information-1"
id="toc-channel-state-information-1">8.5.2 Channel state information</a>
<ul>
<li><a href="#csi-reporting-quantities"
id="toc-csi-reporting-quantities">8.5.2.1 CSI reporting quantities</a>
<ul>
<li><a href="#channel-quality-indicator-cqi-1"
id="toc-channel-quality-indicator-cqi-1">8.5.2.1.1 Channel quality
indicator (CQI)</a></li>
</ul></li>
<li><a href="#reference-signal-csi-rs-1"
id="toc-reference-signal-csi-rs-1">8.5.2.2 Reference signal
(CSI-RS)</a></li>
<li><a href="#csi-reference-resource-definition-1"
id="toc-csi-reference-resource-definition-1">8.5.2.3 CSI reference
resource definition</a></li>
</ul></li>
<li><a href="#csi-reporting" id="toc-csi-reporting">8.5.3 CSI
reporting</a></li>
</ul></li>
<li><a href="#ue-pssch-preparation-procedure-time"
id="toc-ue-pssch-preparation-procedure-time">8.6 UE PSSCH preparation
procedure time</a></li>
</ul></li>
<li><a
href="#ue-procedures-for-transmitting-and-receiving-for-rtt-based-propagation-delay-compensation"
id="toc-ue-procedures-for-transmitting-and-receiving-for-rtt-based-propagation-delay-compensation">9
UE procedures for transmitting and receiving for RTT-based propagation
delay compensation</a>
<ul>
<li><a
href="#prs-reception-procedure-for-rtt-based-propagation-delay-compensation"
id="toc-prs-reception-procedure-for-rtt-based-propagation-delay-compensation">9.1
PRS reception procedure for RTT-based propagation delay
compensation</a></li>
</ul></li>
</ul>
</nav>
<p>3GPP TS 38.214 V17.9.0 (2024-03)</p>
<p>Technical Specification</p>
<p>3rd Generation Partnership Project;</p>
<p>Technical Specification Group Radio Access Network;</p>
<p>NR;</p>
<p>Physical layer procedures for data</p>
<p>(Release 17)</p>
<p><img src="media/image1.jpeg" style="width:1.32431in;height:0.91667in"
alt="5G-logo_175px" /> <img src="media/image2.png"
style="width:1.77778in;height:1.03681in" alt="3GPP-logo_web" /></p>
<p>The present document has been developed within the 3rd Generation
Partnership Project (3GPP <sup>TM</sup>) and may be further elaborated
for the purposes of 3GPP..<br />
The present document has not been subject to any approval process by the
3GPP Organizational Partners and shall not be implemented.<br />
This Specification is provided for future development work within 3GPP
only. The Organizational Partners accept no liability for any use of
this Specification.<br />
Specifications and Reports for implementation of the 3GPP <sup>TM</sup>
system should be obtained via the 3GPP Organizational Partners'
Publications Offices.</p>
<blockquote>
<p>Keywords</p>
<p>3GPP, New Radio, Layer 1</p>
<p><em><strong>3GPP</strong></em></p>
<p>Postal address</p>
<p>3GPP support office address</p>
<p>650 Route des Lucioles - Sophia Antipolis</p>
<p>Valbonne - FRANCE</p>
<p>Tel.: +33 4 92 94 42 00 Fax: +33 4 93 65 47 16</p>
<p>Internet</p>
<p>http://www.3gpp.org</p>
</blockquote>
<p><em><strong>Copyright Notification</strong></em></p>
<p>No part may be reproduced except as authorized by written
permission.<br />
The copyright and the foregoing restriction extend to reproduction in
all media.</p>
<p>© 2024, 3GPP Organizational Partners (ARIB, ATIS, CCSA, ETSI, TSDSI,
TTA, TTC).</p>
<p>All rights reserved.</p>
<p>UMTS™ is a Trade Mark of ETSI registered for the benefit of its
members</p>
<p>3GPP™ is a Trade Mark of ETSI registered for the benefit of its
Members and of the 3GPP Organizational Partners<br />
LTE™ is a Trade Mark of ETSI registered for the benefit of its Members
and of the 3GPP Organizational Partners</p>
<p>GSM® and the GSM logo are registered and owned by the GSM
Association</p>
<h1 class="TT" id="contents"><br />
Contents</h1>
<p>Foreword <a href="#foreword">6</a></p>
<p>1 Scope <a href="#scope">7</a></p>
<p>2 References <a href="#references">7</a></p>
<p>3 Definitions, symbols and abbreviations <a
href="#definitions-symbols-and-abbreviations">8</a></p>
<p>3.1 Definitions <a href="#definitions">8</a></p>
<p>3.2 Symbols <a href="#symbols">8</a></p>
<p>3.3 Abbreviations <a href="#abbreviations">8</a></p>
<p>4 Power control <a href="#power-control">9</a></p>
<p>4.1 Power allocation for downlink <a
href="#power-allocation-for-downlink">9</a></p>
<p>5 Physical downlink shared channel related procedures <a
href="#physical-downlink-shared-channel-related-procedures">10</a></p>
<p>5.1 UE procedure for receiving the physical downlink shared channel
<a
href="#ue-procedure-for-receiving-the-physical-downlink-shared-channel">10</a></p>
<p>5.1.1 Transmission schemes <a href="#transmission-schemes">14</a></p>
<p>5.1.1.1 Transmission scheme 1 <a
href="#transmission-scheme-1">14</a></p>
<p>5.1.2 Resource allocation <a href="#resource-allocation">15</a></p>
<p>5.1.2.1 Resource allocation in time domain <a
href="#resource-allocation-in-time-domain">15</a></p>
<p>5.1.2.1.1 Determination of the resource allocation table to be used
for PDSCH <a
href="#determination-of-the-resource-allocation-table-to-be-used-for-pdsch">19</a></p>
<p>5.1.2.2 Resource allocation in frequency domain <a
href="#resource-allocation-in-frequency-domain">23</a></p>
<p>5.1.2.2.1 Downlink resource allocation type 0 <a
href="#downlink-resource-allocation-type-0">24</a></p>
<p>5.1.2.2.2 Downlink resource allocation type 1 <a
href="#downlink-resource-allocation-type-1">24</a></p>
<p>5.1.2.2.3 Downlink resource allocation type 1 for multicast/broadcast
<a
href="#downlink-resource-allocation-type-1-for-multicastbroadcast">26</a></p>
<p>5.1.2.3 Physical resource block (PRB) bundling <a
href="#physical-resource-block-prb-bundling">26</a></p>
<p>5.1.3 Modulation order, target code rate, redundancy version and
transport block size determination <a
href="#modulation-order-target-code-rate-redundancy-version-and-transport-block-size-determination">28</a></p>
<p>5.1.3.1 Modulation order and target code rate determination <a
href="#modulation-order-and-target-code-rate-determination">30</a></p>
<p>5.1.3.2 Transport block size determination <a
href="#transport-block-size-determination">36</a></p>
<p>5.1.4 PDSCH resource mapping <a
href="#pdsch-resource-mapping">39</a></p>
<p>5.1.4.1 PDSCH resource mapping with RB symbol level granularity <a
href="#pdsch-resource-mapping-with-rb-symbol-level-granularity">40</a></p>
<p>5.1.4.2 PDSCH resource mapping with RE level granularity <a
href="#pdsch-resource-mapping-with-re-level-granularity">41</a></p>
<p>5.1.5 Antenna ports quasi co-location <a
href="#antenna-ports-quasi-co-location">43</a></p>
<p>5.1.6 UE procedure for receiving reference signals <a
href="#ue-procedure-for-receiving-reference-signals">50</a></p>
<p>5.1.6.1 CSI-RS reception procedure <a
href="#csi-rs-reception-procedure">50</a></p>
<p>5.1.6.1.1 CSI-RS for tracking <a
href="#csi-rs-for-tracking">51</a></p>
<p>5.1.6.1.1.1 Aperiodic CSI-RS for tracking for fast SCell activation
<a
href="#aperiodic-csi-rs-for-tracking-for-fast-scell-activation">53</a></p>
<p>5.1.6.1.2 CSI-RS for L1-RSRP and L1-SINR computation <a
href="#csi-rs-for-l1-rsrp-and-l1-sinr-computation">54</a></p>
<p>5.1.6.1.3 CSI-RS for mobility <a
href="#csi-rs-for-mobility">54</a></p>
<p>5.1.6.2 DM-RS reception procedure <a
href="#dm-rs-reception-procedure">55</a></p>
<p>5.1.6.3 PT-RS reception procedure <a
href="#pt-rs-reception-procedure">57</a></p>
<p>5.1.6.4 SRS reception procedure for CLI <a
href="#srs-reception-procedure-for-cli">59</a></p>
<p>5.1.6.5 PRS reception procedure <a
href="#prs-reception-procedure">59</a></p>
<p>5.1.7 Code block group based PDSCH transmission <a
href="#code-block-group-based-pdsch-transmission">66</a></p>
<p>5.1.7.1 UE procedure for grouping of code blocks to code block groups
<a
href="#ue-procedure-for-grouping-of-code-blocks-to-code-block-groups">66</a></p>
<p>5.1.7.2 UE procedure for receiving code block group based
transmissions <a
href="#ue-procedure-for-receiving-code-block-group-based-transmissions">66</a></p>
<p>5.2 UE procedure for reporting channel state information (CSI) <a
href="#ue-procedure-for-reporting-channel-state-information-csi">67</a></p>
<p>5.2.1 Channel state information framework <a
href="#channel-state-information-framework">67</a></p>
<p>5.2.1.1 Reporting settings <a href="#reporting-settings">67</a></p>
<p>5.2.1.2 Resource settings <a href="#resource-settings">68</a></p>
<p>5.2.1.3 (void) <a href="#void">69</a></p>
<p>5.2.1.4 Reporting configurations <a
href="#reporting-configurations">69</a></p>
<p>5.2.1.4.1 Resource Setting configuration <a
href="#resource-setting-configuration">71</a></p>
<p>5.2.1.4.2 Report Quantity Configurations <a
href="#report-quantity-configurations">72</a></p>
<p>5.2.1.4.3 L1-RSRP Reporting <a href="#l1-rsrp-reporting">77</a></p>
<p>5.2.1.4.4 L1-SINR Reporting <a href="#l1-sinr-reporting">77</a></p>
<p>5.2.1.5 Triggering/activation of CSI Reports and CSI-RS <a
href="#triggeringactivation-of-csi-reports-and-csi-rs">78</a></p>
<p>5.2.1.5.1 Aperiodic CSI Reporting/Aperiodic CSI-RS when the
triggering PDCCH and the CSI-RS have the same numerology <a
href="#aperiodic-csi-reportingaperiodic-csi-rs-when-the-triggering-pdcch-and-the-csi-rs-have-the-same-numerology">78</a></p>
<p>5.2.1.5.1a Aperiodic CSI Reporting/Aperiodic CSI-RS when the
triggering PDCCH and the CSI-RS have different numerologies <a
href="#a-aperiodic-csi-reportingaperiodic-csi-rs-when-the-triggering-pdcch-and-the-csi-rs-have-different-numerologies">82</a></p>
<p>5.2.1.5.2 Semi-persistent CSI/Semi-persistent CSI-RS <a
href="#semi-persistent-csisemi-persistent-csi-rs">84</a></p>
<p>5.2.1.5.3 Aperiodic CSI-RS for tracking for fast SCell activation <a
href="#aperiodic-csi-rs-for-tracking-for-fast-scell-activation-1">86</a></p>
<p>5.2.1.6 CSI processing criteria <a
href="#csi-processing-criteria">86</a></p>
<p>5.2.2 Channel state information <a
href="#channel-state-information">87</a></p>
<p>5.2.2.1 Channel quality indicator (CQI) <a
href="#channel-quality-indicator-cqi">87</a></p>
<p>5.2.2.1.1 (void) <a href="#void-1">90</a></p>
<p>5.2.2.2 Precoding matrix indicator (PMI) <a
href="#precoding-matrix-indicator-pmi">90</a></p>
<p>5.2.2.2.1 Type I Single-Panel Codebook <a
href="#type-i-single-panel-codebook">90</a></p>
<p>5.2.2.2.2 Type I Multi-Panel Codebook <a
href="#type-i-multi-panel-codebook">96</a></p>
<p>5.2.2.2.3 Type II Codebook <a href="#type-ii-codebook">100</a></p>
<p>5.2.2.2.4 Type II Port Selection Codebook <a
href="#type-ii-port-selection-codebook">107</a></p>
<p>5.2.2.2.5 Enhanced Type II Codebook <a
href="#enhanced-type-ii-codebook">109</a></p>
<p>5.2.2.2.6 Enhanced Type II Port Selection Codebook <a
href="#enhanced-type-ii-port-selection-codebook">116</a></p>
<p>5.2.2.2.7 Further enhanced Type II port selection codebook <a
href="#further-enhanced-type-ii-port-selection-codebook">118</a></p>
<p>5.2.2.3 Reference signal (CSI-RS) <a
href="#reference-signal-csi-rs">122</a></p>
<p>5.2.2.3.1 NZP CSI-RS <a href="#nzp-csi-rs">122</a></p>
<p>5.2.2.4 Channel State Information – Interference Measurement (CSI-IM)
<a
href="#channel-state-information-interference-measurement-csi-im">123</a></p>
<p>5.2.2.5 CSI reference resource definition <a
href="#csi-reference-resource-definition">124</a></p>
<p>5.2.3 CSI reporting using PUSCH <a
href="#csi-reporting-using-pusch">127</a></p>
<p>5.2.4 CSI reporting using PUCCH <a
href="#csi-reporting-using-pucch">131</a></p>
<p>5.2.5 Priority rules for CSI reports <a
href="#priority-rules-for-csi-reports">132</a></p>
<p>5.3 UE PDSCH processing procedure time <a
href="#ue-pdsch-processing-procedure-time">132</a></p>
<p>5.3.1 Application delay of the minimum scheduling offset restriction
<a
href="#application-delay-of-the-minimum-scheduling-offset-restriction">134</a></p>
<p>5.4 UE CSI computation time <a
href="#ue-csi-computation-time">135</a></p>
<p>5.5 UE PDSCH reception preparation time with cross carrier scheduling
with different subcarrier spacings for PDCCH and PDSCH <a
href="#ue-pdsch-reception-preparation-time-with-cross-carrier-scheduling-with-different-subcarrier-spacings-for-pdcch-and-pdsch">137</a></p>
<p>6 Physical uplink shared channel related procedure <a
href="#physical-uplink-shared-channel-related-procedure">137</a></p>
<p>6.1 UE procedure for transmitting the physical uplink shared channel
<a
href="#ue-procedure-for-transmitting-the-physical-uplink-shared-channel">137</a></p>
<p>6.1.1 Transmission schemes <a
href="#transmission-schemes-1">139</a></p>
<p>6.1.1.1 Codebook based UL transmission <a
href="#codebook-based-ul-transmission">140</a></p>
<p>6.1.1.2 Non-Codebook based UL transmission <a
href="#non-codebook-based-ul-transmission">141</a></p>
<p>6.1.2 Resource allocation <a
href="#resource-allocation-1">143</a></p>
<p>6.1.2.1 Resource allocation in time domain <a
href="#resource-allocation-in-time-domain-1">143</a></p>
<p>6.1.2.1.1 Determination of the resource allocation table to be used
for PUSCH <a
href="#determination-of-the-resource-allocation-table-to-be-used-for-pusch">153</a></p>
<p>6.1.2.2 Resource allocation in frequency domain <a
href="#resource-allocation-in-frequency-domain-1">156</a></p>
<p>6.1.2.2.1 Uplink resource allocation type 0 <a
href="#uplink-resource-allocation-type-0">156</a></p>
<p>6.1.2.2.2 Uplink resource allocation type 1 <a
href="#uplink-resource-allocation-type-1">157</a></p>
<p>6.1.2.2.3 Uplink resource allocation type 2 <a
href="#uplink-resource-allocation-type-2">158</a></p>
<p>6.1.2.3 Resource allocation for uplink transmission with configured
grant <a
href="#resource-allocation-for-uplink-transmission-with-configured-grant">159</a></p>
<p>6.1.2.3.1 Transport Block repetition for uplink transmissions of
PUSCH repetition Type A with a configured grant <a
href="#transport-block-repetition-for-uplink-transmissions-of-pusch-repetition-type-a-with-a-configured-grant">161</a></p>
<p>6.1.2.3.2 Transport Block repetition for uplink transmissions of
PUSCH repetition Type B with a configured grant <a
href="#transport-block-repetition-for-uplink-transmissions-of-pusch-repetition-type-b-with-a-configured-grant">163</a></p>
<p>6.1.2.3.3 Transport Block repetition for uplink transmissions of TB
processing over multiple slots with a configured grant <a
href="#transport-block-repetition-for-uplink-transmissions-of-tb-processing-over-multiple-slots-with-a-configured-grant">164</a></p>
<p>6.1.3 UE procedure for applying transform precoding on PUSCH <a
href="#ue-procedure-for-applying-transform-precoding-on-pusch">165</a></p>
<p>6.1.4 Modulation order, redundancy version and transport block size
determination <a
href="#modulation-order-redundancy-version-and-transport-block-size-determination">165</a></p>
<p>6.1.4.1 Modulation order and target code rate determination <a
href="#modulation-order-and-target-code-rate-determination-1">166</a></p>
<p>6.1.4.2 Transport block size determination <a
href="#transport-block-size-determination-1">172</a></p>
<p>6.1.5 Code block group based PUSCH transmission <a
href="#code-block-group-based-pusch-transmission">173</a></p>
<p>6.1.5.1 UE procedure for grouping of code blocks to code block groups
<a
href="#ue-procedure-for-grouping-of-code-blocks-to-code-block-groups-1">173</a></p>
<p>6.1.5.2 UE procedure for transmitting code block group based
transmissions <a
href="#ue-procedure-for-transmitting-code-block-group-based-transmissions">174</a></p>
<p>6.1.6 Uplink switching <a href="#uplink-switching">174</a></p>
<p>6.1.6.1 Uplink switching for EN-DC <a
href="#uplink-switching-for-en-dc">174</a></p>
<p>6.1.6.2 Uplink switching for carrier aggregation <a
href="#uplink-switching-for-carrier-aggregation">175</a></p>
<p>6.1.6.2.1 void <a href="#void-2">176</a></p>
<p>6.1.6.3 Uplink switching for supplementary uplink <a
href="#uplink-switching-for-supplementary-uplink">176</a></p>
<p>6.1.7 UE procedure for determining time domain windows for bundling
DM-RS <a
href="#ue-procedure-for-determining-time-domain-windows-for-bundling-dm-rs">176</a></p>
<p>6.2 UE reference signal (RS) procedure <a
href="#ue-reference-signal-rs-procedure">179</a></p>
<p>6.2.1 UE sounding procedure <a
href="#ue-sounding-procedure">179</a></p>
<p>6.2.1.1 UE SRS frequency hopping procedure <a
href="#ue-srs-frequency-hopping-procedure">186</a></p>
<p>6.2.1.2 UE sounding procedure for DL CSI acquisition <a
href="#ue-sounding-procedure-for-dl-csi-acquisition">187</a></p>
<p>6.2.1.3 UE sounding procedure between component carriers <a
href="#ue-sounding-procedure-between-component-carriers">192</a></p>
<p>6.2.1.4 UE sounding procedure for positioning purposes <a
href="#ue-sounding-procedure-for-positioning-purposes">194</a></p>
<p>6.2.2 UE DM-RS transmission procedure <a
href="#ue-dm-rs-transmission-procedure">195</a></p>
<p>6.2.3 UE PT-RS transmission procedure <a
href="#ue-pt-rs-transmission-procedure">197</a></p>
<p>6.2.3.1 UE PT-RS transmission procedure when transform precoding is
not enabled <a
href="#ue-pt-rs-transmission-procedure-when-transform-precoding-is-not-enabled">197</a></p>
<p>6.2.3.2 UE PT-RS transmission procedure when transform precoding is
enabled <a
href="#ue-pt-rs-transmission-procedure-when-transform-precoding-is-enabled">199</a></p>
<p>6.3 UE PUSCH frequency hopping procedure <a
href="#ue-pusch-frequency-hopping-procedure">200</a></p>
<p>6.3.1 Frequency hopping for PUSCH repetition Type A and for TB
processing over multiple slots <a
href="#frequency-hopping-for-pusch-repetition-type-a-and-for-tb-processing-over-multiple-slots">200</a></p>
<p>6.3.2 Frequency hopping for PUSCH repetition Type B <a
href="#frequency-hopping-for-pusch-repetition-type-b">202</a></p>
<p>6.4 UE PUSCH preparation procedure time <a
href="#ue-pusch-preparation-procedure-time">202</a></p>
<p>7 UE procedures for transmitting and receiving on a carrier with
intra-cell guard bands <a
href="#ue-procedures-for-transmitting-and-receiving-on-a-carrier-with-intra-cell-guard-bands">204</a></p>
<p>8 Physical sidelink shared channel related procedures <a
href="#physical-sidelink-shared-channel-related-procedures">204</a></p>
<p>8.1 UE procedure for transmitting the physical sidelink shared
channel <a
href="#ue-procedure-for-transmitting-the-physical-sidelink-shared-channel">205</a></p>
<p>8.1.1 Transmission schemes <a
href="#transmission-schemes-2">207</a></p>
<p>8.1.2 Resource allocation <a
href="#resource-allocation-2">207</a></p>
<p>8.1.2.1 Resource allocation in time domain <a
href="#resource-allocation-in-time-domain-2">207</a></p>
<p>8.1.2.2 Resource allocation in frequency domain <a
href="#resource-allocation-in-frequency-domain-2">208</a></p>
<p>8.1.3 Modulation order, target code rate, redundancy version and
transport block size determination <a
href="#modulation-order-target-code-rate-redundancy-version-and-transport-block-size-determination-1">208</a></p>
<p>8.1.3.1 Modulation order and target code rate determination <a
href="#modulation-order-and-target-code-rate-determination-2">208</a></p>
<p>8.1.3.2 Transport block size determination <a
href="#transport-block-size-determination-2">209</a></p>
<p>8.1.4 UE procedure for determining the subset of resources to be
reported to higher layers in PSSCH resource selection in sidelink
resource allocation mode 2 <a
href="#ue-procedure-for-determining-the-subset-of-resources-to-be-reported-to-higher-layers-in-pssch-resource-selection-in-sidelink-resource-allocation-mode-2">209</a></p>
<p>8.1.4A UE procedure for determining a set of preferred or
non-preferred resources for another UE's transmission <a
href="#a-ue-procedure-for-determining-a-set-of-preferred-or-non-preferred-resources-for-another-ues-transmission">215</a></p>
<p>8.1.4B Void <a href="#b-void">216</a></p>
<p>8.1.4C UE procedure for using a received non-preferred resource set
<a
href="#c-ue-procedure-for-using-a-received-non-preferred-resource-set">216</a></p>
<p>8.1.5 UE procedure for determining slots and resource blocks for
PSSCH transmission associated with an SCI format 1-A <a
href="#ue-procedure-for-determining-slots-and-resource-blocks-for-pssch-transmission-associated-with-an-sci-format-1-a">216</a></p>
<p>8.1.5A UE procedure for determining slots and resource blocks
indicated by a preferred or non-preferred resource set <a
href="#a-ue-procedure-for-determining-slots-and-resource-blocks-indicated-by-a-preferred-or-non-preferred-resource-set">217</a></p>
<p>8.1.6 Sidelink congestion control in sidelink resource allocation
mode 2 <a
href="#sidelink-congestion-control-in-sidelink-resource-allocation-mode-2">218</a></p>
<p>8.1.7 UE procedure for determining the number of logical slots for a
reservation period <a
href="#ue-procedure-for-determining-the-number-of-logical-slots-for-a-reservation-period">218</a></p>
<p>8.2 UE procedure for transmitting sidelink reference signals <a
href="#ue-procedure-for-transmitting-sidelink-reference-signals">218</a></p>
<p>8.2.1 CSI-RS transmission procedure <a
href="#csi-rs-transmission-procedure">218</a></p>
<p>8.2.2 PSSCH DM-RS transmission procedure <a
href="#pssch-dm-rs-transmission-procedure">219</a></p>
<p>8.2.3 PT-RS transmission procedure <a
href="#pt-rs-transmission-procedure">219</a></p>
<p>8.3 UE procedure for receiving the physical sidelink shared channel
<a
href="#ue-procedure-for-receiving-the-physical-sidelink-shared-channel">219</a></p>
<p>8.4 UE procedure for receiving reference signals <a
href="#ue-procedure-for-receiving-reference-signals-1">219</a></p>
<p>8.4.1 CSI-RS reception procedure <a
href="#csi-rs-reception-procedure-1">219</a></p>
<p>8.4.2 DM-RS reception procedure for RSRP computation <a
href="#dm-rs-reception-procedure-for-rsrp-computation">220</a></p>
<p>8.4.3 PT-RS reception procedure <a
href="#pt-rs-reception-procedure-1">220</a></p>
<p>8.5 UE procedure for reporting channel state information (CSI) <a
href="#ue-procedure-for-reporting-channel-state-information-csi-1">220</a></p>
<p>8.5.1 Channel state information framework <a
href="#channel-state-information-framework-1">220</a></p>
<p>8.5.1.1 Reporting configurations <a
href="#reporting-configurations-1">220</a></p>
<p>8.5.1.2 Triggering of sidelink CSI reports <a
href="#triggering-of-sidelink-csi-reports">220</a></p>
<p>8.5.2 Channel state information <a
href="#channel-state-information-1">221</a></p>
<p>8.5.2.1 CSI reporting quantities <a
href="#csi-reporting-quantities">221</a></p>
<p>8.5.2.1.1 Channel quality indicator (CQI) <a
href="#channel-quality-indicator-cqi-1">221</a></p>
<p>8.5.2.2 Reference signal (CSI-RS) <a
href="#reference-signal-csi-rs-1">221</a></p>
<p>8.5.2.3 CSI reference resource definition <a
href="#csi-reference-resource-definition-1">221</a></p>
<p>8.5.3 CSI reporting <a href="#csi-reporting">222</a></p>
<p>8.6 UE PSSCH preparation procedure time <a
href="#ue-pssch-preparation-procedure-time">222</a></p>
<p>9 UE procedures for transmitting and receiving for RTT-based
propagation delay compensation <a
href="#ue-procedures-for-transmitting-and-receiving-for-rtt-based-propagation-delay-compensation">223</a></p>
<p>9.1 PRS reception procedure for RTT-based propagation delay
compensation <a
href="#prs-reception-procedure-for-rtt-based-propagation-delay-compensation">223</a></p>
<p>Annex &lt;A&gt; (informative): Change history <a
href="#annex-a-informative-change-history">225</a></p>
<h1 id="foreword"><br />
Foreword</h1>
<p>This Technical Specification has been produced by the 3rd Generation
Partnership Project (3GPP).</p>
<p>The contents of the present document are subject to continuing work
within the TSG and may change following formal TSG approval. Should the
TSG modify the contents of the present document, it will be re-released
by the TSG with an identifying change of release date and an increase in
version number as follows:</p>
<p>Version x.y.z</p>
<p>where:</p>
<p>x the first digit:</p>
<p>1 presented to TSG for information;</p>
<p>2 presented to TSG for approval;</p>
<p>3 or greater indicates TSG approved document under change
control.</p>
<p>y the second digit is incremented for all changes of substance, i.e.
technical enhancements, corrections, updates, etc.</p>
<p>z the third digit is incremented when editorial only changes have
been incorporated in the document.</p>
<h1 id="scope"><br />
1 Scope</h1>
<p>The present document specifies and establishes the characteristics of
the physicals layer procedures of data channels for 5G-NR.</p>
<h1 id="references">2 References</h1>
<p>The following documents contain provisions which, through reference
in this text, constitute provisions of the present document.</p>
<p>[1] 3GPP TR 21.905: "Vocabulary for 3GPP Specifications"</p>
<p>[2] 3GPP TS 38.201: " NR; Physical Layer – General Description"</p>
<p>[3] 3GPP TS 38.202: "NR; Services provided by the physical layer"</p>
<p>[4] 3GPP TS 38.211: "NR; Physical channels and modulation"</p>
<p>[5] 3GPP TS 38.212: "NR; Multiplexing and channel coding"</p>
<p>[6] 3GPP TS 38.213: "NR; Physical layer procedures for control"</p>
<p>[7] 3GPP TS 38.215: "NR; Physical layer measurements"</p>
<p>[8] 3GPP TS 38.101: "NR; User Equipment (UE) radio transmission and
reception"</p>
<p>[9] 3GPP TS 38.104: "NR; Base Station (BS) radio transmission and
reception"</p>
<p>[10] 3GPP TS 38.321: "NR; Medium Access Control (MAC) protocol
specification"</p>
<p>[11] 3GPP TS 38.133: "NR; Requirements for support of radio resource
management"</p>
<p>[12] 3GPP TS 38.331: "NR; Radio Resource Control (RRC); Protocol
specification"</p>
<p>[13] 3GPP TS 38.306: "NR; User Equipment (UE) radio access
capabilities"</p>
<p>[14] 3GPP TS 38.423: "NG-RAN; Xn Application Protocol (XnAP)"</p>
<p>[15] 3GPP TS 36.211: "Evolved Universal Terrestrial Radio Access
(E-UTRA); Physical channels and modulation"</p>
<p>[16] 3GPP TS 37.213: "Physical layer procedures for shared spectrum
channel access"</p>
<p>[17] 3GPP TS 37.355: "LTE Positioning Protocol (LPP)"</p>
<p>[18] 3GPP TS 38.822: "NR; User Equipment (UE) feature list"</p>
<h1 id="definitions-symbols-and-abbreviations">3 Definitions, symbols
and abbreviations</h1>
<h2 id="definitions">3.1 Definitions</h2>
<p>For the purposes of the present document, the terms and definitions
given in TR 21.905 [1] and the following apply. A term defined in the
present document takes precedence over the definition of the same term,
if any, in TR 21.905 [1].</p>
<h2 id="symbols">3.2 Symbols</h2>
<p>For the purposes of the present document, the following symbols
apply:</p>
<h2 id="abbreviations">3.3 Abbreviations</h2>
<p>For the purposes of the present document, the abbreviations given in
TR 21.905 [1] and the following apply. An abbreviation defined in the
present document takes precedence over the definition of the same
abbreviation, if any, in TR 21.905 [1].</p>
<p>BWP Bandwidth part</p>
<p>CBG Code block group</p>
<p>CLI Cross Link Interference</p>
<p>CP Cyclic prefix</p>
<p>CQI Channel quality indicator</p>
<p>CPU CSI processing unit</p>
<p>CRB Common resource block</p>
<p>CRC Cyclic redundancy check</p>
<p>CRI CSI-RS Resource Indicator</p>
<p>CSI Channel state information</p>
<p>CSI-RS Channel state information reference signal</p>
<p>CSI-RSRP CSI reference signal received power</p>
<p>CSI-RSRQ CSI reference signal received quality</p>
<p>CSI-SINR CSI signal-to-noise and interference ratio</p>
<p>CW Codeword</p>
<p>DCI Downlink control information</p>
<p>DL Downlink</p>
<p>DM-RS Demodulation reference signals</p>
<p>DRX Discontinuous Reception</p>
<p>EPRE Energy per resource element</p>
<p>IAB-MT Integrated Access and Backhaul – Mobile Terminal</p>
<p>L1-RSRP Layer 1 reference signal received power</p>
<p>LI Layer Indicator</p>
<p>MCS Modulation and coding scheme</p>
<p>PDCCH Physical downlink control channel</p>
<p>PDSCH Physical downlink shared channel</p>
<p>PSS Primary Synchronisation signal</p>
<p>PUCCH Physical uplink control channel</p>
<p>QCL Quasi co-location</p>
<p>PMI Precoding Matrix Indicator</p>
<p>PRB Physical resource block</p>
<p>PRG Precoding resource block group</p>
<p>PRS Positioning reference signal</p>
<p>PT-RS Phase-tracking reference signal</p>
<p>RB Resource block</p>
<p>RBG Resource block group</p>
<p>RI Rank Indicator</p>
<p>RIV Resource indicator value</p>
<p>RS Reference signal</p>
<p>SCI Sidelink control information</p>
<p>SLIV Start and length indicator value</p>
<p>SR Scheduling Request</p>
<p>SRS Sounding reference signal</p>
<p>SS Synchronisation signal</p>
<p>SSS Secondary Synchronisation signal</p>
<p>SS-RSRP SS reference signal received power</p>
<p>SS-RSRQ SS reference signal received quality</p>
<p>SS-SINR SS signal-to-noise and interference ratio</p>
<p>TB Transport Block</p>
<p>TCI Transmission Configuration Indicator</p>
<p>TDM Time division multiplexing</p>
<p>UE User equipment</p>
<p>UL Uplink</p>
<h1 id="power-control">4 Power control </h1>
<p>Throughout this specification, unless otherwise noted, statements
using the term "UE" in clauses 4, 5, or 6 are equally applicable to the
IAB-MT part of an IAB node.</p>
<h2 id="power-allocation-for-downlink">4.1 Power allocation for downlink
</h2>
<p>The gNB determines the downlink transmit EPRE.</p>
<p>For the purpose of SS-RSRP, SS-RSRQ and SS-SINR measurements, the UE
may assume downlink EPRE is constant across the bandwidth. For the
purpose of SS-RSRP, SS-RSRQ and SS-SINR measurements, the UE may assume
downlink EPRE is constant over SSS carried in different SS/PBCH blocks.
For the purpose of SS-RSRP, SS-RSRQ and SS-SINR measurements, the UE may
assume that the ratio of SSS EPRE to PBCH DM-RS EPRE is 0 dB.</p>
<p>For the purpose of CSI-RSRP, CSI-RSRQ and CSI-SINR measurements, the
UE may assume downlink EPRE of a port of CSI-RS resource configuration
is constant across the configured downlink bandwidth and constant across
all configured OFDM symbols.</p>
<p>The downlink SS/PBCH SSS EPRE can be derived from the SS/PBCH
downlink transmit power given by the parameter
<em>ss-PBCH-BlockPower</em> provided by higher layers. The downlink SSS
transmit power is defined as the linear average over the power
contributions (in [W]) of all resource elements that carry the SSS
within the operating system bandwidth.</p>
<p>The downlink CSI-RS EPRE can be derived from the SS/PBCH block
downlink transmit power given by the parameter
<em>ss-PBCH-BlockPower</em> and CSI-RS power offset given by the
parameter <em>powerControlOffsetSS</em> provided by higher layers if the
SS/PBCH block is associated with serving cell PCI, or derived from
<em>ss-PBCH-BlockPower-r17</em> in <em>SSB-MTC-AdditionalPCI-r17</em>
and <em>powerControlOffsetSS</em> provided by higher layers if the
SS/PBCH block is associated with additional PCI different from serving
cell PCI, where the CSI-RS is QCLed with the SS/PBCH block. The downlink
reference-signal transmit power is defined as the linear average over
the power contributions (in [W]) of the resource elements that carry the
configured CSI-RS within the operating system bandwidth.</p>
<p>For downlink DM-RS associated with PDSCH, the UE may assume the ratio
of PDSCH EPRE to DM-RS EPRE (<img src="media/image3.svg" /> [dB]) is
given by Table 4.1-1 according to the number of DM-RS CDM groups without
data as described in Clause 5.1.6.2. The DM-RS scaling factor <img
src="media/image4.svg" /> specified in Clause 7.4.1.1.2 of [4, TS
38.211] is given by <img src="media/image5.svg" />.</p>
<p>Table 4.1-1: The ratio of PDSCH EPRE to DM-RS EPRE</p>
<table>
<colgroup>
<col style="width: 29%" />
<col style="width: 37%" />
<col style="width: 32%" />
</colgroup>
<thead>
<tr>
<th>Number of DM-RS CDM groups without data</th>
<th>DM-RS configuration type 1</th>
<th>DM-RS configuration type 2</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>0 dB</td>
<td>0 dB</td>
</tr>
<tr>
<td>2</td>
<td>-3 dB</td>
<td>-3 dB</td>
</tr>
<tr>
<td>3</td>
<td>-</td>
<td>-4.77 dB</td>
</tr>
</tbody>
</table>
<p>When the UE is scheduled with one or two PT-RS ports associated with
the PDSCH,</p>
<p>- if the UE is configured with the higher layer parameter
<em>epre-Ratio</em>, the ratio of PT-RS EPRE to PDSCH EPRE per layer per
RE for each PT-RS port (<img src="media/image6.svg" />) is given by
Table 4.1-2 according to the <em>epre-Ratio</em>, the PT-RS scaling
factor <img src="media/image7.svg" />specified in clause 7.4.1.2.2 of
[4, TS 38.211] is given by<img src="media/image8.svg" />.</p>
<p>- otherwise, the UE shall assume <em>epre-Ratio</em> is set to state
'0' in Table 4.1-2 if not configured.</p>
<p>Table 4.1-2: PT-RS EPRE to PDSCH EPRE per layer per RE (<img
src="media/image9.svg" />)</p>
<table>
<colgroup>
<col style="width: 15%" />
<col style="width: 15%" />
<col style="width: 13%" />
<col style="width: 13%" />
<col style="width: 13%" />
<col style="width: 13%" />
<col style="width: 13%" />
</colgroup>
<thead>
<tr>
<th rowspan="2"><em>epre-Ratio</em></th>
<th colspan="6">The number of PDSCH layers with DM-RS associated to the
PT-RS port</th>
</tr>
<tr>
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
<th>5</th>
<th>6</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>0</td>
<td>3</td>
<td>4.77</td>
<td>6</td>
<td>7</td>
<td>7.78</td>
</tr>
<tr>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>2</td>
<td colspan="6">reserved</td>
</tr>
<tr>
<td>3</td>
<td colspan="6">reserved</td>
</tr>
</tbody>
</table>
<p>For link recovery, as described in clause 6 of [6, TS 38.213] the
ratio of the PDCCH EPRE to NZP CSI-RS EPRE is assumed as 0 dB.</p>
<h1 id="physical-downlink-shared-channel-related-procedures">5 Physical
downlink shared channel related procedures</h1>
<h2
id="ue-procedure-for-receiving-the-physical-downlink-shared-channel">5.1
UE procedure for receiving the physical downlink shared channel</h2>
<p>For downlink, a maximum of 16 HARQ processes per cell are supported
by the UE, or subject to UE capability, a maximum of 32 HARQ processes
per cell as defined in [13, TS 38.306]. The number of processes the UE
may assume will at most be used for the downlink is configured to the UE
for each cell separately by higher layer parameter
<em>nrofHARQ-ProcessesForPDSCH</em> or
<em>nrofHARQ-ProcessesForPDSCH-v1700</em>, and when no configuration is
provided the UE may assume a default number of 8 processes.</p>
<p>A UE shall upon detection of a PDCCH with a configured DCI format
1_0, 1_1, 4_0, 4_1, 4_2 or 1_2 decode the corresponding PDSCHs as
indicated by that DCI. When the UE is scheduled with multiple PDSCHs by
a DCI, HARQ process ID indicated by this DCI applies to the first PDSCH
not overlapping with a UL symbol indicated by
<em>tdd-UL-DL-ConfigurationCommon</em> or
<em>tdd-UL-DL-ConfigurationDedicated</em> if provided, HARQ process ID
is then incremented by 1 for each subsequent PDSCH(s) in the scheduled
order, with modulo operation of <em>nrofHARQ-ProcessesForPDSCH</em>
applied if <em>nrofHARQ-ProcessesForPDSCH</em> is provided, or with
modulo operation of <em>nrofHARQ-ProcessesForPDSCH-v1700</em> applied if
or <em>nrofHARQ-ProcessesForPDSCH-v1700</em> is provided, or with modulo
operation of 8 applied, otherwise. HARQ process ID is not incremented
for PDSCH(s) not received if at least one of the symbols indicated by
the indexed row of the used resource allocation table in the slot
overlaps with a UL symbol indicated by
<em>tdd-UL-DL-ConfigurationCommon</em> or
<em>tdd-UL-DL-ConfigurationDedicated</em> if provided. When a UE is
configured by the higher layer parameter <em>repetitionScheme</em> set
to 'tdmSchemeA', the PDSCH includes two PDSCH transmission occasions.
For each PDSCH, if either PDSCH occasion overlaps with a UL symbol
indicated by <em>tdd-UL-DL-ConfigurationCommon</em> or
<em>tdd-UL-DL-ConfigurationDedicated</em> if provided, the PDSCH is not
received and HARQ process ID is not increment for the PDSCH. For any
HARQ process ID(s) in a given scheduled cell, the UE is not expected to
receive a PDSCH that overlaps in time with another PDSCH if the UE is
not capable of receiving FDMed unicast and multicast PDSCH per slot per
carrier. When HARQ feedback for the HARQ process ID is not disabled, or
for the HARQ process associated with the first SPS PDSCH when
<em>HARQ-feedbackEnablingforSPSactive</em> is provided and enabled, the
UE is not expected to receive another PDSCH for a given HARQ process
until after the end of the expected transmission of HARQ-ACK for that
HARQ process, where the timing is given by Clause 9.2.3 of [6, TS
38.213]. For HARQ-ACK subject to HARQ-ACK deferral described in Clause
9.2.5.4 of [6 TS 38.213], the expected transmission of HARQ-ACK
corresponds to the expected transmission HARQ-ACK in a first slot. When
HARQ feedback for the HARQ process ID is disabled, the UE is not
expected to receive another PDCCH carrying a DCI scheduling a PDSCH or
set of slot-aggregated PDSCH scheduled for the given HARQ process or to
receive another PDSCH without corresponding PDCCH for the given HARQ
process that starts until T<sub>proc,1</sub> after the end of the
reception of the last PDSCH or slot-aggregated PDSCH for that HARQ
process. Except for the case when a UE is configured by higher layer
parameter <em>PDCCH-Config</em> that contains two different values of
<em>coresetPoolIndex</em> in <em>ControlResourceSet</em> and PDCCHs that
schedule two PDSCHs are associated to different
<em>ControlResourceSets</em> having different values of
<em>coresetPoolIndex,</em> in a given scheduled cell, the UE is not
expected to receive a first PDSCH and a second PDSCH, starting later
than the first PDSCH, with its corresponding HARQ-ACK assigned to be
transmitted on a resource ending before the start of a different
resource for the HARQ-ACK assigned to be transmitted for the first
PDSCH, where the two resources are in different slots for the associated
HARQ-ACK transmissions, each slot is composed of <img
src="media/image10.svg" />symbols [4] or a number of symbols indicated
by <em>subslotLengthForPUCCH</em> if provided, and the HARQ-ACK for the
two PDSCHs are associated with the HARQ-ACK codebook of the same
priority. Except for the case when a UE is configured by higher layer
parameter <em>PDCCH-Config</em> that contains two different values of
<em>coresetPoolIndex</em> in <em>ControlResourceSet</em> and PDCCHs that
schedule two PDSCHs are associated to different
<em>ControlResourceSets</em> having different values of
<em>coresetPoolIndex,</em> in a given scheduled cell, the UE is not
expected to receive a first PDSCH, and a second PDSCH, starting later
than the first PDSCH, with its corresponding HARQ-ACK assigned to be
transmitted on a resource ending before the start of a different
resource for the HARQ-ACK assigned to be transmitted for the first PDSCH
if the HARQ-ACK for the two PDSCHs are associated with HARQ-ACK
codebooks of different priorities. For any two HARQ process IDs in a
given scheduled cell, if the UE is scheduled to start receiving a first
PDSCH starting in symbol <em>j</em> by a PDCCH ending in symbol
<em>i</em> on a scheduling cell, the UE is not expected to be scheduled
to receive a PDSCH starting earlier than the end of the first PDSCH with
a PDCCH that ends later than symbol <em>i</em> of a scheduling cell,.
When the PDCCH reception includes two PDCCH candidates from two
respective search space sets, as described in clause 10.1 of [6, TS
38.213], the PDCCH ending in symbol <em>i</em> is determined based on
the PDCCH candidate that ends later in time. In a given scheduled cell,
for any PDSCH corresponding to SI-RNTI, the UE is not expected to decode
a re-transmission of an earlier PDSCH with a starting symbol less than
<em>N</em> symbols after the last symbol of that PDSCH, where the value
of <em>N</em> depends on the PDSCH subcarrier spacing configuration
<em>μ,</em> with <em>N</em>=13 for <em>μ</em>=0, <em>N</em>=13 for
<em>μ</em>=1, <em>N</em>=20 for <em>μ</em>=2, <em>N</em>=24 for
<em>μ</em>=3, <em>N</em>=96 for <em>μ</em>=5, and <em>N</em>=192 for
<em>μ</em>=6.</p>
<p>When receiving PDSCH scheduled with SI-RNTI, P-RNTI, G-RNTI for
broadcast or MCCH-RNTI, the UE may assume that the DM-RS port of PDSCH
is quasi co-located with the associated SS/PBCH block with respect to
Doppler shift, Doppler spread, average delay, delay spread, spatial RX
parameters when applicable.</p>
<p>When receiving PDSCH scheduled with RA-RNTI, or MSGB-RNTI, the UE may
assume that the DM-RS port of PDSCH is quasi co-located with the SS/PBCH
block or the CSI-RS resource the UE used for RACH association as
applicable, and transmission with respect to Doppler shift, Doppler
spread, average delay, delay spread, spatial RX parameters when
applicable. When receiving a PDSCH scheduled with RA-RNTI in response to
a random access procedure triggered by a PDCCH order which triggers
contention-free random access procedure for the SpCell [10, TS 38.321],
the UE may assume that the DM-RS port of the received PDCCH order and
the DM-RS ports of the corresponding PDSCH scheduled with RA-RNTI are
quasi co-located with the same SS/PBCH block or CSI-RS with respect to
Doppler shift, Doppler spread, average delay, delay spread, spatial RX
parameters when applicable.</p>
<p>When receiving PDSCH in response to a PUSCH transmission scheduled by
a RAR UL grant or corresponding PUSCH retransmission, or when receiving
PDSCH in response to a PUSCH for Type-2 random access procedure, or a
PUSCH scheduled by a fallbackRAR UL grant or corresponding PUSCH
retransmission, the UE may assume that the DM-RS port of PDSCH is quasi
co-located with the SS/PBCH block the UE selected for RACH association
and transmission with respect to Doppler shift, Doppler spread, average
delay, delay spread, spatial RX parameters when applicable.</p>
<p>If the UE is not configured for PUSCH/PUCCH transmission for at least
one serving cell configured with slot formats comprised of DL and UL
symbols, and if the UE is not capable of simultaneous reception and
transmission on serving cell <em>c<sub>1</sub></em> and serving cell
<em>c<sub>2</sub></em>, the UE is not expected to receive PDSCH on
serving cell <em>c<sub>1</sub></em> if the PDSCH overlaps in time with
SRS transmission (including any interruption due to uplink or downlink
RF retuning time [10]) on serving cell <em>c<sub>2</sub></em> not
configured for PUSCH/PUCCH transmission.</p>
<p>The UE is not expected to decode a PDSCH in a serving cell scheduled
by a PDCCH with C-RNTI, CS-RNTI, MCS-C-RNTI, G-RNTI, G-CS-RNTI or
MCCH-RNTI and one or multiple PDSCH(s) required to be received according
to this Clause in the same serving cell without a corresponding PDCCH
transmission if the PDSCHs partially or fully overlap in time except if
the PDCCH scheduling the PDSCH ends at least 14<span
class="math inline">\(\bullet 2^{max(0,\mu - 3)}\)</span> symbols before
the earliest starting symbol of the PDSCH(s) without the corresponding
PDCCH transmission, where<em> μ</em> and the symbol duration are based
on the smallest numerology between the scheduling PDCCH and the PDSCH,
in which case the UE shall decode the PDSCH scheduled by the PDCCH. When
the PDCCH reception incudes two PDCCH candidates from two respectvie
search space sets, as described in clause 10 of [6, TS 38.213], for the
purpose of determining the PDCCH with C-RNTI, CS-RNTI or MCS-C-RNTI
scheduling the PDSCH ends at least 14<span class="math inline">\(\bullet
2^{max(0,\mu - 3)}\)</span> symbols before the earliest starting symbol
of the PDSCH(s) without the corresponding PDCCH transmission, the PDCCH
candidate that ends later in time is used.</p>
<p>The UE is not expected to decode a PDSCH scheduled with C-RNTI,
MCS-C-RNTI, G-RNTI for multicast or broadcast, MCCH-RNTI, G-CS-RNTI or
CS-RNTI if another PDSCH in the same cell scheduled with RA-RNTI or
MSGB-RNTI partially or fully overlap in time.</p>
<p>The UE in RRC_IDLE and RRC_INACTIVE modes shall be able to decode two
PDSCHs each scheduled with SI-RNTI, P-RNTI, RA-RNTI or TC-RNTI, with the
two PDSCHs partially or fully overlapping in time in non-overlapping
PRBs.</p>
<p>The UE:</p>
<p>- is expected to decode PDSCH scheduled with MCCH-RNTI and PBCH in
PCell that partially or fully overlaps in time in non-overlapping PRBs
in PCell.</p>
<p>- is not expected to decode PDSCH scheduled with G-RNTI for broadcast
and PBCH in PCell that partially or fully overlaps in time in
non-overlapping PRBs in PCell.</p>
<p>- is not expected to decode PDSCH scheduled with G-RNTI for multicast
and PBCH in PCell that partially or fully overlaps in time in
non-overlapping PRBs in PCell.</p>
<p>On a frequency range 1 cell, the UE shall be able to decode a PDSCH
scheduled with C-RNTI, MCS-C-RNTI, or CS-RNTI and, during a process of
P-RNTI triggered SI acquisition, another PDSCH scheduled with SI-RNTI
that partially or fully overlap in time in non-overlapping PRBs, unless
the PDSCH scheduled with C-RNTI, MCS-C-RNTI, or CS-RNTI requires
Capability 2 processing time according to clause 5.3 in which case the
UE may skip decoding of the scheduled PDSCH with C-RNTI, MCS-C-RNTI, or
CS-RNTI.</p>
<p>On a frequency range 2 cell, the UE is not expected to decode a PDSCH
scheduled with C-RNTI, MCS-C-RNTI, or CS-RNTI if in the same cell,
during a process of P-RNTI triggered SI acquisition, another PDSCH
scheduled with SI-RNTI partially or fully overlap in time.</p>
<p>The UE is expected to decode a PDSCH scheduled with C-RNTI,
MCS-C-RNTI, or CS-RNTI during a process of autonomous SI
acquisition.</p>
<p>The maximum number of PDSCHs scheduled per slot per component carrier
with C-RNTI/CS-RNTI and G-RNTI/G-CS-RNTI/MCCH-RNTI that the UE shall be
able to decode is the same as the indicated UE capability for the number
of unicast PDSCHs per slot per component carrier. If the UE is capable
of receiving FDMed unicast and multicast PDSCH per slot per carrier, the
UE shall be able to decode a PDSCH scheduled by a DCI format with C-RNTI
or a PDSCH scheduled for a retransmission of a TB by a DCI format with
CS-RNTI and a PDSCH scheduled by a DCI format with G-RNTI for multicast
or a PDSCH scheduled for a retransmission of a TB by a DCI format with
G-CS-RNTI that partially or fully overlap in time in non-overlapping
PRBs. If the UE is capable of receiving FDMed unicast and broadcast
PDSCH per slot per carrier, the UE shall be able to decode a PDSCH
scheduled by a DCI format with C-RNTI or a PDSCH scheduled for a
retransmission of a TB by a DCI format with CS-RNTI and a PDSCH
scheduled with G-RNTI for broadcast/MCCH-RNTI that partially or fully
overlap in time in non-overlapping PRBs.</p>
<p>If the UE is configured by higher layers to decode a PDCCH with its
CRC scrambled by a CS-RNTI or G-CS-RNTI, the UE shall receive PDSCH
transmissions without corresponding PDCCH transmissions using the
higher-layer-provided PDSCH configuration for those PDSCHs.</p>
<p>The UE it is not expected to support reception of FDMed MCCH PDSCH
and broadcast MTCH PDSCH in PCell or SCell, or FDMed multiple broadcast
MTCH PDSCHs in PCell or SCell, or FDMed MCCH/broadcast MTCH/multicast
PDSCH and SIB PDSCH in PCell, or FDMed multicast PDSCHs in PCell or
SCell, or FDMed multicast PDSCH and MCCH/broadcast MTCH PDSCH in PCell
or SCell, or FDMed MCCH/broadcast MTCH/multicast PDSCH and paging
PDSCH.</p>
<p>If a UE is configured by higher layer parameter <em>PDCCH-Config</em>
that contains two different values of <em>coresetPoolIndex</em> in
<em>ControlResourceSet</em>, the UE may expect to receive multiple
PDCCHs scheduling fully/partially/non-overlapped PDSCHs in time and
frequency domain. The UE may expect the reception of
full/partially-overlapped PDSCHs in time, only when PDCCHs that schedule
two PDSCHs are associated to different <em>ControlResourceSets</em>
having different values of <em>coresetPoolIndex</em>. For a
<em>ControlResourceSet</em> without <em>coresetPoolIndex</em>, the UE
may assume that the <em>ControlResourceSet</em> is assigned with
<em>coresetPoolIndex</em> as 0. When the UE is configured with
<em>SSB-MTC-AdditionalPCI</em>, <em>ControlResourceSets</em>
corresponding to different <em>coresetPoolIndex</em> values may be
associated with different physical cell IDs via activated TCI states of
the <em>ControlResourceSets</em>, where <em>ControlResourceSets</em>
corresponding to one <em>coresetPoolIndex</em> is associated with the
serving cell physical cell ID and <em>ControlResourceSets</em>
corresponding to another <em>coresetPoolIndex</em> can be associated
with another physical cell ID. When the UE is scheduled with
full/partially/non-overlapped PDSCHs in time and frequency domain, the
full scheduling information for receiving a PDSCH is indicated and
carried only by the corresponding PDCCH, the UE is expected to be
scheduled with the same active BWP and the same SCS. When the UE is
scheduled with full/partially-overlapped PDSCHs in time and frequency
domain, the UE can be scheduled with at most two codewords
simultaneously. When PDCCHs that schedule two PDSCHs are associated to
different <em>ControlResourceSets</em> having different values of
<em>coresetPoolIndex,</em> the following operations are allowed:</p>
<p>- For any two HARQ process IDs in a given scheduled cell, if the UE
is scheduled to start receiving a first PDSCH starting in symbol
<em>j</em> by a PDCCH associated with a value of
<em>coresetPoolIndex</em> ending in symbol <em>i</em>, the UE can be
scheduled to receive a PDSCH starting earlier than the end of the first
PDSCH with a PDCCH associated with a different value of
<em>coresetPoolIndex</em> that ends later than symbol <em>i</em>.</p>
<p>- In a given scheduled cell, the UE can receive a first PDSCH in slot
<em>i</em>, with the corresponding HARQ-ACK assigned to be transmitted
in slot <em>j</em>, and a second PDSCH associated with a value of
<em>coresetPoolIndex</em> different from that of the first PDSCH
starting later than the first PDSCH with its corresponding HARQ-ACK
assigned to be transmitted in a slot before slot <em>j</em>.</p>
<p>If PDCCHs that schedule corresponding PDSCHs are associated to the
same or different <em>ControlResourceSets</em> having the same value of
<em>coresetPoolIndex</em>, the UE procedure for receiving the PDSCH upon
detection of a PDCCH follows Clause 5.1.</p>
<p>A UE does not expect to be configured with <em>repetitionScheme</em>
if the UE is configured with higher layer parameter
<em>repetitionNumber</em> for the same PDSCH.</p>
<p>When a UE is configured by higher layer parameter
<em>repetitionScheme</em> set to one of 'fdmSchemeA<em>'</em>,
'fdmSchemeB<em>'</em>, 'tdmSchemeA<em>'</em>, if the UE is indicated
with two TCI states in a codepoint of the DCI field <em>'Transmission
Configuration Indication'</em> and DM-RS port(s) within one CDM group in
the DCI field '<em>Antenna Port(s)'</em>.</p>
<p>- When two TCI states are indicated in a DCI and the UE is set to
'fdmSchemeA<em>',</em> the UE shall receive a single PDSCH transmission
occasion of the TB with each TCI state associated to a non-overlapping
frequency domain resource allocation as described in Clause 5.1.2.3.</p>
<p>- When two TCI states are indicated in a DCI and the UE is set to
'fdmSchemeB<em>'</em>, the UE shall receive two PDSCH transmission
occasions of the same TB with each TCI state associated to a PDSCH
transmission occasion which has non-overlapping frequency domain
resource allocation with respect to the other PDSCH transmission
occasion as described in Clause 5.1.2.3.</p>
<p>- When two TCI states are indicated in a DCI and the UE is set to
'tdmSchemeA<em>'</em>, the UE shall receive two PDSCH transmission
occasions of the same TB with each TCI state associated to a PDSCH
transmission occasion which has non-overlapping time domain resource
allocation with respect to the other PDSCH transmission occasion and
both PDSCH transmission occasions shall be received within a given slot
as described in Clause 5.1.2.1.</p>
<p>When a UE is configured by the higher layer parameter
<em>repetitionNumber</em> in
<em>PDSCH-TimeDomainResourceAllocation</em>, the UE may expect to be
indicated with one or two TCI states in a codepoint of the DCI field
<em>'Transmission Configuration Indication'</em> together with the DCI
field '<em>Time domain resource assignment</em>' indicating an entry
which contains <em>repetitionNumber</em> in
<em>PDSCH-TimeDomainResourceAllocation</em> and DM-RS port(s) within one
CDM group in the DCI field '<em>Antenna Port(s)'</em>.</p>
<p>- When two TCI states are indicated in a DCI with '<em>Transmission
Configuration Indication</em>' field, the UE may expect to receive
multiple slot level PDSCH transmission occasions of the same TB with two
TCI states used across multiple PDSCH transmission occasions in the
<em>repetitionNumber</em> consecutive slots as defined in Clause
5.1.2.1.</p>
<p>- When one TCI state is indicated in a DCI with '<em>Transmission
Configuration Indication</em>' field, the UE may expect to receive
multiple slot level PDSCH transmission occasions of the same TB with one
TCI state used across multiple PDSCH transmission occasions in the
<em>repetitionNumber</em> consecutive slots as defined in Clause
5.1.2.1.</p>
<p>When a UE is not indicated with a DCI that DCI field '<em>Time domain
resource assignment</em>' indicating an entry which contains
<em>repetitionNumber</em> in
<em>PDSCH-TimeDomainResourceAllocation</em>, and it is indicated with
two TCI states in a codepoint of the DCI field <em>'Transmission
Configuration Indication'</em> and DM-RS port(s) within two CDM groups
in the DCI field '<em>Antenna Port(s)'</em> and it is not configured
with higher layer parameter <em>sfnSchemePDSCH</em>, the UE may expect
to receive a single PDSCH where the association between the DM-RS ports
and the TCI states are as defined in Clause 5.1.6.2.</p>
<p>When a UE is not indicated with a DCI that DCI field '<em>Time domain
resource assignment</em>' indicating an entry which contains
<em>repetitionNumber</em> in
<em>PDSCH-TimeDomainResourceAllocation</em>, and it is indicated with
one TCI states in a codepoint of the DCI field <em>'Transmission
Configuration Indication',</em> the UE procedure for receiving the PDSCH
upon detection of a PDCCH follows Clause 5.1.</p>
<p>When a UE is configured with higher layer parameter
<em>sfnSchemePDSCH</em> set to either <em>'</em>sfnSchemeA<em>'</em> or
<em>'</em>sfnSchemeB<em>'</em> and</p>
<p>- if the UE reports its capability of
<em>sfn-SchemeA-DynamicSwitching-r17</em> or
<em>sfn-SchemeB-DynamicSwitching-r17</em>, the UE is indicated with one
or two TCI state(s) in a codepoint of the DCI field <em>'Transmission
Configuration Indication'</em> in DCI format 1_1/1_2, or</p>
<p>- otherwise, the UE is not expected to be indicated with one TCI
state per any of TCI codepoint by MAC CE, and the UE is indicated with
two TCI states in a codepoint of the DCI field <em>'Transmission
Configuration Indication'</em> in DCI format 1_1/1_2, and</p>
<p>the UE procedure for receiving the PDSCH upon detection of a PDCCH
follows clause 5.1 and the QCL assumption for the PDSCH as defined in
clause 5.1.5.</p>
<p>When a UE is configured with both <em>sfnSchemePDSCH</em> and
<em>sfnSchemePDCCH</em>, the UE shall expect that
<em>sfnSchemePDSCH</em> and <em>sfnSchemePDCCH</em> are set to the same
scheme, either <em>'</em>sfnSchemeA<em>'</em> or
<em>'</em>sfnSchemeB<em>'</em>.</p>
<p>If a UE is configured with <em>sfnSchemePDCCH</em> set to
'sfnSchemeA' and activated with two TCI states by MAC CE, and the UE
does not report its capability of <em>sfn-SchemeA-PDCCH-only</em>, the
UE is expected to be configured with <em>sfnSchemePDSCH</em> set to
<em>'sfnSchemeA'</em> and indicated with two TCI states in a codepoint
of the DCI field <em>'Transmission Configuration Indication',</em> if
the PDSCH is scheduled by DCI format 1_1/1_2.</p>
<p>If a UE is configured with <em>sfnSchemePDCCH</em> set to
'sfnSchemeB' and activated with two TCI states by MAC CE, the UE is
expected to be configured with <em>sfnSchemePDSCH</em> set to
<em>'sfnSchemeB'</em> and indicated with two TCI states in a codepoint
of the DCI field <em>'Transmission Configuration Indication',</em> if
the PDSCH is scheduled by DCI format 1_1/1_2.</p>
<p>When a UE is configured with <em>sfnSchemePDSCH</em> and/or
<em>sfnSchemePDCCH</em>, the UE shall expect that the
<em>sfnSchemePDSCH</em> and/or <em>sfnSchemePDCCH</em> configuration are
the same within a CC, and the UE shall expect that the
<em>sfnSchemePDSCH</em> and/or <em>sfnSchemePDCCH</em> configuration are
the same in all CCs in a same frequency band if the UE is configured
with CA, where the UE does not expect to be configured with
<em>sfnSchemePDSCH</em> and/or <em>sfnSchemePDCCH</em> in initial BWP in
each CC.</p>
<p>If more than one PDSCH on a serving cell each without a corresponding
PDCCH transmission are in a slot, after resolving overlapping with
symbols in the slot indicated as uplink by
<em>tdd-UL-DL-ConfigurationCommon</em>, or by
<em>tdd-UL-DL-ConfigurationDedicated</em>, a UE receives one or more
PDSCHs without corresponding PDCCH transmissions in the slot as
specified below.</p>
<p>‒ Step 0: set <em>j=0</em>, where <em>j</em> is the number of
selected PDSCH(s) for decoding. <em>Q</em> is the set of activated
PDSCHs without corresponding PDCCH transmissions within the slot</p>
<p>‒ Step 1: A UE receives one PDSCH with the lowest configured
<em>sps-ConfigIndex</em> within <em>Q</em>, set <em>j=j+1</em>.
Designate the received PDSCH as survivor PDSCH.</p>
<p>‒ Step 2: The survivor PDSCH in step 1 and any other PDSCH(s)
overlapping (even partially) with the survivor PDSCH in step 1 are
excluded from <em>Q</em>.</p>
<p>‒ Step 3: Repeat step 1 and 2 until <em>Q</em> is empty or <em>j</em>
is equal to the number of unicast/multicast PDSCHs in a slot supported
by the UE</p>
<h3 id="transmission-schemes">5.1.1 Transmission schemes</h3>
<p>Only one transmission scheme is defined for the PDSCH, and is used
for all PDSCH transmissions.</p>
<h4 id="transmission-scheme-1">5.1.1.1 Transmission scheme 1</h4>
<p>For transmission scheme 1 of the PDSCH, the UE may assume that a gNB
transmission on the PDSCH would be performed with up to 8 transmission
layers on antenna ports 1000-1011 as defined in Clause 7.3.1.4 of [4, TS
38.211], subject to the DM-RS reception procedures in Clause
5.1.6.2.</p>
<h3 id="resource-allocation">5.1.2 Resource allocation</h3>
<h4 id="resource-allocation-in-time-domain">5.1.2.1 Resource allocation
in time domain</h4>
<p>When the UE is scheduled to receive PDSCH by a DCI, the <em>Time
domain resource assignment</em> field value <em>m</em> of the DCI
provides a row index <em>m</em> + 1 to an allocation table. The
determination of the used resource allocation table is defined in Clause
5.1.2.1.1. The indexed row defines the slot offset
<em>K<sub>0</sub></em>, the start and length indicator <em>SLIV</em>, or
directly the start symbol <em>S</em> and the allocation length
<em>L</em>, and the PDSCH mapping type to be assumed in the PDSCH
reception.</p>
<p>Given the parameter values of the indexed row:</p>
<p>- The slot allocated for the PDSCH is <em>K<sub>s</sub></em>, where
<img src="media/image11.svg" />, if UE is configured with
<em>ca-SlotOffset</em> for at least one of the scheduled and scheduling
cell, and <em>K<sub>s </sub></em>= <img src="media/image12.svg"
style="width:1.02847in;height:0.51458in" />, otherwise, and where
<em>n</em> is the slot with the scheduling DCI, and
<em>K<sub>0</sub></em> is based on the numerology of PDSCH, and <img
src="media/image13.svg" /> and <img src="media/image14.svg" />are the
subcarrier spacing configurations for PDSCH and PDCCH, respectively,
and</p>
<p>- <span class="math inline">\(N_{\text{slot, offset,
PDCCH}}^{\text{CA}}\)</span> and <span
class="math inline">\(\mu_{\text{offset,PDCCH}}\)</span> are the <span
class="math inline">\(N_{\text{slot, offset}}^{\text{CA}}\)</span> and
the<img src="media/image15.svg" />, respectively, which are determined
by higher-layer configured <em>ca-SlotOffset,</em> for the cell
receiving the PDCCH respectively,<span class="math inline">\(\
N_{\text{slot, offset, PDSCH}}^{\text{CA}}\)</span> and <span
class="math inline">\(\mu_{\text{offset,PDSCH}}\)</span> are the <span
class="math inline">\(N_{\text{slot, offset}}^{\text{CA}}\)</span> and
the<img src="media/image15.svg" />, respectively, which are determined
by higher-layer configured <em>ca-SlotOffset</em> for the cell receiving
the PDSCH, as defined in clause 4.5 of [4, TS 38.211].</p>
<p>- The reference point <em>S<sub>0</sub></em> for starting symbol
<em>S</em> is defined as:</p>
<blockquote>
<p>- if configured with <em>referenceOfSLIVDCI-1-2</em>, and when
receiving PDSCH scheduled by DCI format 1_2 with CRC scrambled by
C-RNTI, MCS-C-RNTI, CS-RNTI with <em>K<sub>0</sub>=0</em>, and PDSCH
mapping Type B, the starting symbol <em>S</em> is relative to the
starting symbol <em>S<sub>0</sub></em> of the PDCCH monitoring occasion
where DCI format 1_2 is detected; when the PDCCH reception includes two
PDCCH candidates from two respective search space sets, as described in
clause 10.1 of [6, TS 38.213], the PDCCH candidate that starts later in
time is used for the purpose of determining the starting symbol
<em>S<sub>0</sub></em>;</p>
</blockquote>
<p>- otherwise, the starting symbol <em>S</em> is relative to the start
of the slot using <em>S<sub>0</sub>=0.</em></p>
<p>- The number of consecutive symbols <em>L</em> counting from the
starting symbol <em>S</em> allocated for the PDSCH are determined from
the start and length indicator <em>SLIV</em>:</p>
<p>if <img src="media/image16.svg" /> then</p>
<p><img src="media/image17.svg" /></p>
<p>else</p>
<p><img src="media/image18.svg" /></p>
<p>where<img src="media/image19.svg" />, and</p>
<p>- the PDSCH mapping type is set to Type A or Type B as defined in
Clause 7.4.1.1.2 of [4, TS 38.211].</p>
<p>The UE shall consider the <em>S</em> and <em>L</em> combinations
defined in table 5.1.2.1-1 satisfying <img src="media/image20.svg" />
for normal cyclic prefix and <img src="media/image21.svg" /> for
extended cyclic prefix as valid PDSCH allocations:</p>
<p>Table 5.1.2.1-1: Valid <em>S</em> and <em>L</em> combinations</p>
<table>
<colgroup>
<col style="width: 16%" />
<col style="width: 11%" />
<col style="width: 11%" />
<col style="width: 17%" />
<col style="width: 11%" />
<col style="width: 11%" />
<col style="width: 19%" />
</colgroup>
<thead>
<tr>
<th rowspan="2">PDSCH mapping type</th>
<th colspan="3">Normal cyclic prefix</th>
<th colspan="3">Extended cyclic prefix</th>
</tr>
<tr>
<th><em>S</em></th>
<th><em>L</em></th>
<th><em>S+L</em></th>
<th><em>S</em></th>
<th><em>L</em></th>
<th><em>S+L</em></th>
</tr>
</thead>
<tbody>
<tr>
<td>Type A</td>
<td><p>{0,1,2,3}</p>
<p>(Note 1)</p></td>
<td>{3,…,14}</td>
<td>{3,…,14}</td>
<td><p>{0,1,2,3}</p>
<p>(Note 1)</p></td>
<td>{3,…,12}</td>
<td>{3,…,12}</td>
</tr>
<tr>
<td>Type B</td>
<td>{0,…,12}</td>
<td>{2,…,13}</td>
<td>{2,…,14}</td>
<td>{0,…,10}</td>
<td>{2,4,6}</td>
<td>{2,…,12}</td>
</tr>
<tr>
<td colspan="7">Note 1: S = 3 is applicable only if
<em>dmrs-TypeA-Position</em> = 3</td>
</tr>
</tbody>
</table>
<p>When configured with SCS μ = 5 or μ = 6, the UE does not expect to be
scheduled with more than one unicast PDSCH in a slot, by a single DCI
scheduling multiple PDSCHs or by multiple DCIs, where multiple DCIs are
not associated with CORESETs having different
<em>coresetpoolIndex</em>.</p>
<p>When receiving PDSCH scheduled by DCI format 1_1 or 1_2 in PDCCH with
CRC scrambled by C-RNTI, MCS-C-RNTI, or CS-RNTI with NDI=1, if the UE is
configured with <em>pdsch-AggregationFactor</em> in
<em>pdsch-config</em>, the same symbol allocation is applied across the
<em>pdsch-AggregationFactor</em> consecutive slots. When receiving PDSCH
scheduled by DCI format 1_1 or 1_2 in PDCCH with CRC scrambled by
CS-RNTI with NDI=0, or PDSCH scheduled without corresponding PDCCH
transmission using <em>sps-Config</em> and activated by DCI format 1_1
or 1_2, the same symbol allocation is applied across the
<em>pdsch-AggregationFactor</em>, in <em>sps-Config</em> if configured,
or across the <em>pdsch-AggregationFactor</em> in <em>pdsch-config</em>
otherwise, consecutive slots. The UE may expect that the TB is repeated
within each symbol allocation among each of the
<em>pdsch-AggregationFactor</em> consecutive slots and the PDSCH is
limited to a single transmission layer. For PDSCH scheduled by DCI
format 1_1 or 1_2 in PDCCH with CRC scrambled by CS-RNTI with NDI=0, or
PDSCH scheduled without corresponding PDCCH transmission using
<em>sps-Config</em> and activated by DCI format 1_1 or 1_2, the UE is
not expected to be configured with the time duration for the reception
of <em>pdsch-AggregationFactor</em> repetitions, in <em>sps-Config</em>
if configured, or across the <em>pdsch-AggregationFactor</em> in
<em>pdsch-config</em> otherwise, larger than the time duration derived
by the periodicity P obtained from the corresponding
<em>sps-Config</em>. The redundancy version to be applied on the
<em>n</em><sup>th</sup> transmission occasion of the TB, where
<em>n</em> = 0, 1, …<em>pdsch-AggregationFactor</em> -1, is determined
according to table 5.1.2.1-2 and "<em>rv<sub>id</sub></em> indicated by
the DCI scheduling the PDSCH" in table 5.1.2.1-2 is assumed to be 0 for
PDSCH scheduled without corresponding PDCCH transmission using
<em>sps-Config</em> and activated by DCI format 1_1 or 1_2.</p>
<p>When receiving PDSCH scheduled by DCI format 4_1, or 4_2 in PDCCH
with CRC scrambled by G-RNTI for multicast, if the UE is configured with
<em>pdsch-AggregationFactor</em> in the <em>MBS-RNTI-SpecificConfig</em>
associated with the corresponding G-RNTI for multicast, the same symbol
allocation is applied across the <em>pdsch-AggregationFactor</em>
consecutive slots. When receiving PDSCH scheduled by DCI format 4_1 or
4_2 for multicast reception in PDCCH with CRC scrambled by G-CS-RNTI, or
PDSCH without corresponding PDCCH transmission using associated
<em>SPS-Config</em> and activated by the DCI format 4_1 or 4_2 in PDCCH
with CRC scrambled by G-CS-RNTI, the same symbol allocation is applied
across the <em>pdsch-AggregationFactor</em> in associated
<em>SPS-Config</em> if configured, or across <em>repetitionNumber</em>
in <em>PDSCH-TimeDomainResourceAllocation</em> in
<em>pdsch-ConfigMulticast</em> if provided by an entry indicated by the
'Time domain resource assignment' field of the activating DCI, or 1
otherwise, consecutive slots. The redundancy version to be applied on
the <em>n</em>th transmission occasion of the TB, where <em>n</em> = 0,
1, …<em>pdsch-AggregationFactor</em> -1, is determined according to
table 5.1.2.1-2 and "rvid indicated by the DCI scheduling the PDSCH" in
table 5.1.2.1-2 is assumed to be 0 for PDSCH scheduled without
corresponding PDCCH transmission using <em>SPS-Config</em> and activated
by DCI format 4_1 or 4_2. When receiving PDSCH scheduled by DCI format
4_0 in PDCCH with CRC scrambled by G-RNTI for broadcast, if the UE is
configured with <em>pdsch-AggregationFactor</em> in the
<em>PDSCH-ConfigPTM</em>, the same symbol allocation is applied across
the <em>pdsch-AggregationFactor</em> consecutive slots, and the
redundancy version to be applied on the <em>n</em>th transmission
occasion of the TB, where <em>n</em> = 0, 1,
…<em>pdsch-AggregationFactor</em> -1, is determined according to table
5.1.2.1-2.</p>
<p>When receiving PDSCH scheduled by DCI in PDCCH with CRC scrambled by
G-CS-RNTI for multicast reception or G-RNTI, if the DCI field 'Time
domain resource assignment' indicates an entry which contains
<em>repetitionNumber</em> in <em>PDSCH-TimeDomainResourceAllocation</em>
in the <em>pdsch-ConfigMulticast</em> or
<em>PDSCH-Config-Broadcast</em>, the same SLIV is applied for all PDSCH
transmission occasions across the <em>repetitionNumber</em> consecutive
slots. When receiving PDSCH scheduled without corresponding PDCCH
transmission using associated <em>SPS-Config</em> and activated by DCI
in PDCCH with CRC scrambled by G-CS-RNTI for multicast reception, if the
DCI field 'Time domain resource assignment' of the activating DCI
indicates an entry which contains <em>repetitionNumber</em> in
<em>PDSCH-TimeDomainResourceAllocation</em> in the
<em>pdsch-ConfigMulticast</em>, the same SLIV is applied for all PDSCH
transmission occasions across the <em>repetitionNumber</em> consecutive
slots. The redundancy version to be applied on the
<em>n</em><sup>th</sup> transmission occasion of the TB, where
<em>n</em> = 0, 1, …<em>repetitionNumber</em> -1, is determined
according to table 5.1.2.1-2 and "<em>rv<sub>id</sub></em> indicated by
the DCI scheduling the PDSCH" in table 5.1.2.1-2 is assumed to be 0 for
PDSCH scheduled without corresponding PDCCH transmission using
<em>sps-Config</em> and activated by DCI format with CRC scrambled by
G-CS-RNTI.</p>
<p>If a UE is configured with higher layer parameter
<em>repetitionNumber</em> or if the UE is configured by
<em>repetitionScheme</em> set to one of ' fdmSchemeA', ' fdmSchemeB' and
'tdmSchemeA', the UE does not expect to be configured with
<em>pdsch-AggregationFactor</em> for the same PDSCH.</p>
<p>If a UE is configured with
<em>pdsch-TimeDomainAllocationListForMultiPDSCH</em> in which one or
more rows contain multiple SLIVs for PDSCH, the UE does not expect to be
configured with higher layer parameter <em>repetitionNumber</em> in
<em>pdsch-TimeDomainAllocationListForMultiPDSCH</em>.</p>
<p>If a UE is configured with
<em>pdsch-TimeDomainAllocationListForMultiPDSCH</em> in which one or
more rows contain multiple SLIVs for PDSCH on a DL BWP of a serving
cell, the UE does not apply <em>pdsch-AggregationFactor</em> in
<em>PDSCH-config</em>, if configured, to DCI format 1_1 on the DL BWP of
the serving cell.</p>
<p>If a UE is configured with
<em>pdsch-TimeDomainAllocationListForMultiPDSCH</em> in which one or
more rows contain multiple <em>SLIV</em>s for PDSCH on a DL BWP of a
serving cell, when any two DL DCIs end in the same symbol and at least
one of the DCIs schedules multiple PDSCHs, the UE does not expect that
the scheduled PDSCH(s) by the two DCIs have overlapping spans, where the
span associated with a DCI is defined from the beginning of the first
scheduled PDSCH or up to the end of the last scheduled PDSCH.</p>
<p>Table 5.1.2.1-2: Applied redundancy version when
<em>pdsch-AggregationFactor</em> or <em>repetitionNumber</em> is
present</p>
<table>
<colgroup>
<col style="width: 24%" />
<col style="width: 18%" />
<col style="width: 18%" />
<col style="width: 18%" />
<col style="width: 18%" />
</colgroup>
<thead>
<tr>
<th rowspan="2"><em>rv<sub>id </sub></em>indicated by the DCI scheduling
the PDSCH</th>
<th colspan="4"><em>rv<sub>id</sub></em> to be applied to
<em>n</em><sup>th</sup> transmission occasion</th>
</tr>
<tr>
<th><em>n</em> mod 4 = 0</th>
<th><em>n</em> mod 4 = 1</th>
<th><em>n</em> mod 4 = 2</th>
<th><em>n</em> mod 4 = 3</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>0</td>
<td>2</td>
<td>3</td>
<td>1</td>
</tr>
<tr>
<td>2</td>
<td>2</td>
<td>3</td>
<td>1</td>
<td>0</td>
</tr>
<tr>
<td>3</td>
<td>3</td>
<td>1</td>
<td>0</td>
<td>2</td>
</tr>
<tr>
<td>1</td>
<td>1</td>
<td>0</td>
<td>2</td>
<td>3</td>
</tr>
</tbody>
</table>
<p>A PDSCH reception in a slot of a multi-slot PDSCH reception is
omitted according to the conditions in clause 11.1 and clause 17.2 of
[6, TS38.213].</p>
<p>The UE is not expected to receive a PDSCH with mapping type A in a
slot, if the PDCCH scheduling the PDSCH was received in the same slot
and was not contained within the first three symbols of the slot. When
the PDCCH reception includes two PDCCH candidates from two respective
search space sets, as described in clause 10.1 of [6, TS 38.213], if the
two PDCCH candidates scheduling the PDSCH with mapping Type A were
received in the same slot as the PDSCH, both PDCCH candidates are
expected to be contained within the first three symbols of the slot.</p>
<p>The UE is not expected to receive a PDSCH with mapping type B in a
slot, if the first symbol of the PDCCH scheduling the PDSCH was received
in a later symbol than the first symbol indicated in the PDSCH time
domain resource allocation. When the PDCCH reception includes two PDCCH
candidates from two respective search space sets, as described in clause
10.1 of [6, TS 38.213], the UE is not expected to receive a PDSCH with
mapping type B in a slot, if the first symbol of the PDCCH candidate
that starts later in time scheduling the PDSCH was received in a later
symbol than the first symbol indicated in the PDSCH time domain resource
allocation.</p>
<p>When the UE is configured with <em>minimumSchedulingOffsetK0</em> in
an active DL BWP it applies a minimum scheduling offset restriction
indicated by the 'Minimum applicable scheduling offset indicator' field
in DCI format 1_1 or DCI format 0_1 if the same field is available. When
the UE is configured with <em>minimumSchedulingOffsetK0</em> in an
active DL BWP and it has not received 'Minimum applicable scheduling
offset indicator' field in DCI format 0_1 or 1_1, the UE shall apply a
minimum scheduling offset restriction indicated based on 'Minimum
applicable scheduling offset indicator' value '0'. When the minimum
scheduling offset restriction is applied the UE is not expected to be
scheduled with a DCI in slot <em>n</em> to receive a PDSCH scheduled
with C-RNTI, CS-RNTI or MCS-C-RNTI with <em>K</em><sub>0</sub> smaller
than <span class="math inline">\(\ \left\lceil K_{0min} \cdot
\frac{2^{\mu&#39;}}{2^{\mu}} \right\rceil\)</span>, where
<em>K</em><sub>0min</sub> and <span class="math inline">\(\mu\)</span>
are the applied minimum scheduling offset restriction and the numerology
of the active DL BWP of the scheduled cell when receiving the DCI in
slot <em>n,</em> respectively, and <span
class="math inline">\(\mu&#39;\)</span> is the numerology of the new
active DL BWP in case of active DL BWP change in the scheduled cell and
is equal to <span class="math inline">\(\mu\)</span>, otherwise. The
minimum scheduling offset restriction is not applied when PDSCH
transmission is scheduled with C-RNTI, CS-RNTI or MCS-C-RNTI in common
search space associated with CORESET0 and default PDSCH time domain
resource allocation is used, in the search space set provided by
<em>recoverySearchSpaceId</em> when monitoring PDCCH as described in [6,
TS 38.213] or when PDSCH transmission is scheduled with SI-RNTI,
MSGB-RNTI or RA-RNTI. The application delay of the change of the minimum
scheduling offset restriction is determined in Clause 5.3.1.</p>
<p>The UE is not expected to be configured with
<em>referenceOfSLIVDCI-1-2</em> for serving cells configured for
cross-carrier scheduling with a scheduling cell of a different downlink
SCS configuration.</p>
<p>When a UE is configured by the higher layer parameter
<em>repetitionScheme</em> set to 'tdmSchemeA<em>'</em> and indicated
DM-RS port(s) within one CDM group in the DCI field '<em>Antenna
Port(s)'</em>, the number of PDSCH transmission occasions is derived by
the number of TCI states indicated by the DCI field <em>'Transmission
Configuration Indication'</em> of the scheduling DCI<em>.</em></p>
<p>- If two TCI states are indicated by the DCI field '<em>Transmission
Configuration Indication</em>', the UE is expected to receive two PDSCH
transmission occasions, where the first TCI state is applied to the
first PDSCH transmission occasion and resource allocation in time domain
for the first PDSCH transmission occasion follows Clause 5.1.2.1. The
second TCI state is applied to the second PDSCH transmission occasion,
and the second PDSCH transmission occasion shall have the same number of
symbols as the first PDSCH transmission occasion. If the UE is
configured by the higher layers with a value<span
class="math inline">\(\ \overline{K}\)</span> in
<em>StartingSymbolOffsetK</em>, it shall determine that the first symbol
of the second PDSCH transmission occasion starts after <span
class="math inline">\(\overline{K}\)</span> symbols from the last symbol
of the first PDSCH transmission occasion. If the value<span
class="math inline">\(\ \overline{K}\)</span> is not configured via the
higher layer parameter <em>StartingSymbolOffsetK</em>, <span
class="math inline">\(\overline{K}\)</span> = 0 shall be assumed by the
UE. The UE is not expected to receive more than two PDSCH transmission
layers for each PDSCH transmission occasion. For two PDSCH transmission
occasions, the redundancy version to be applied is derived according to
Table 5.1.2.1-2, where <span class="math inline">\(n = 0,\ 1\)</span>
applied respectively to the first and second TCI state. The UE expects
the PDSCH mapping type indicated by DCI field '<em>Time domain resource
assignment</em>' to be mapping type B, and the indicated PDSCH mapping
type is applied to both PDSCH transmission occasions.</p>
<p>- Otherwise, the UE is expected to receive a single PDSCH
transmission occasion, and the resource allocation in the time domain
follows Clause 5.1.2.1.</p>
<p>When a UE configured by the higher layer parameter
<em>PDSCH-config</em> that indicates at least one entry contains
<em>repetitionNumber</em> in
<em>PDSCH-TimeDomainResourceAllocation</em>,</p>
<p>- If two TCI states are indicated by the DCI field 'Transmission
Configuration Indication' together with the DCI field 'Time domain
resource assignment' indicating an entry which contains
<em>repetitionNumber</em> in <em>PDSCH-TimeDomainResourceAllocation</em>
and DM-RS port(s) within one CDM group in the DCI field 'Antenna
Port(s)', the same SLIV is applied for all PDSCH transmission occasions
across the <em>repetitionNumber</em> consecutive slots, the first TCI
state is applied to the first PDSCH transmission occasion and resource
allocation in time domain for the first PDSCH transmission occasion
follows Clause 5.1.2.1.</p>
<p>When the value indicated by <em>repetitionNumber</em> in
<em>PDSCH-TimeDomainResourceAllocation</em> equals to two, the second
TCI state is applied to the second PDSCH transmission occasion. When the
value indicated by <em>repetitionNumber</em> in
<em>PDSCH-TimeDomainResourceAllocation</em> is larger than two, the UE
may be further configured to enable <em>cyclicMapping</em> or
<em>sequenticalMapping</em> in <em>tciMapping</em>.</p>
<p>- When <em>cyclicMapping</em> is enabled, the first and second TCI
states are applied to the first and second PDSCH transmission occasions,
respectively, and the same TCI mapping pattern continues to the
remaining PDSCH transmission occasions.</p>
<p>- When <em>sequenticalMapping</em> is enabled, first TCI state is
applied to the first and second PDSCH transmission occasions, and the
second TCI state is applied to the third and fourth PDSCH transmission
occasions, and the same TCI mapping pattern continues to the remaining
PDSCH transmission occasions.</p>
<p>The UE may expect that each PDSCH transmission occasion is limited to
two transmission layers. For all PDSCH transmission occasions associated
with the first TCI state, the redundancy version to be applied is
derived according to Table 5.1.2.1-2, where <span
class="math inline">\(n\)</span> is counted only considering PDSCH
transmission occasions associated with the first TCI state. The
redundancy version for PDSCH transmission occasions associated with the
second TCI state is derived according to Table 5.1.2.1-3, where
additional shifting operation for each redundancy version <span
class="math inline">\({rv}_{s}\ \)</span>is configured by higher layer
parameter <em>sequenceOffsetforRV</em> and <span
class="math inline">\(n\)</span> is counted only considering PDSCH
transmission occasions associated with the second TCI state.</p>
<p>Table 5.1.2.1-3: Applied redundancy version for the second TCI state
when <em>sequenceOffsetforRV</em> is present</p>
<table>
<colgroup>
<col style="width: 24%" />
<col style="width: 18%" />
<col style="width: 18%" />
<col style="width: 18%" />
<col style="width: 18%" />
</colgroup>
<thead>
<tr>
<th rowspan="2"><em>rv<sub>id </sub></em>indicated by the DCI scheduling
the PDSCH</th>
<th colspan="4"><em>rv<sub>id</sub></em> to be applied to
<em>n</em><sup>th</sup> transmission occasion with second TCI state</th>
</tr>
<tr>
<th><em>n</em> mod 4 = 0</th>
<th><em>n</em> mod 4 = 1</th>
<th><em>n</em> mod 4 = 2</th>
<th><em>n</em> mod 4 = 3</th>
</tr>
</thead>
<tbody>
<tr>
<td><span class="math display">\[0\]</span></td>
<td><span class="math display">\[(0 + \ {rv}_{s})\ mod\ 4\]</span></td>
<td><span class="math display">\[(2 + \ {rv}_{s})\ mod\ 4\]</span></td>
<td><span class="math display">\[(3 + \ {rv}_{s})\ mod\ 4\]</span></td>
<td><span class="math display">\[(1 + \ {rv}_{s})\ mod\ 4\]</span></td>
</tr>
<tr>
<td><span class="math display">\[2\]</span></td>
<td><span class="math display">\[(2 + \ {rv}_{s})\ mod\ 4\]</span></td>
<td><span class="math display">\[(3 + \ {rv}_{s})\ mod\ 4\]</span></td>
<td><span class="math display">\[(1 + \ {rv}_{s})\ mod\ 4\]</span></td>
<td><span class="math display">\[(0 + \ {rv}_{s})\ mod\ 4\]</span></td>
</tr>
<tr>
<td><span class="math display">\[3\]</span></td>
<td><span class="math display">\[(3 + \ {rv}_{s})\ mod\ 4\]</span></td>
<td><span class="math display">\[(1 + \ {rv}_{s})\ mod\ 4\]</span></td>
<td><span class="math display">\[(0 + \ {rv}_{s})\ mod\ 4\]</span></td>
<td><span class="math display">\[(2 + \ {rv}_{s})\ mod\ 4\]</span></td>
</tr>
<tr>
<td><span class="math display">\[1\]</span></td>
<td><span class="math display">\[(1 + \ {rv}_{s})\ mod\ 4\]</span></td>
<td><span class="math display">\[(0 + \ {rv}_{s})\ mod\ 4\]</span></td>
<td><span class="math display">\[(2 + \ {rv}_{s})\ mod\ 4\]</span></td>
<td><span class="math display">\[(3 + \ {rv}_{s})\ mod\ 4\]</span></td>
</tr>
</tbody>
</table>
<p>- If one TCI state is indicated by the DCI field 'Transmission
Configuration Indication' together with the DCI field 'Time domain
resource assignment' indicating an entry which contains
<em>repetitionNumber</em> in <em>PDSCH-TimeDomainResourceAllocation</em>
and DM-RS port(s) within one CDM group in the DCI field 'Antenna
Port(s)', the same SLIV is applied for all PDSCH transmission occasions
across the <em>repetitionNumber</em> consecutive slots, the first PDSCH
transmission occasion follows Clause 5.1.2.1, the same TCI state is
applied to all PDSCH transmission occasions. The UE may expect that each
PDSCH transmission occasion is limited to two transmission layers. For
all PDSCH transmission occasions, the redundancy version to be applied
is derived according to Table 5.1.2.1-2, where <span
class="math inline">\(n\)</span> is counted considering PDSCH
transmission occasions.</p>
<p>- Otherwise, the UE is expected to receive a single PDSCH
transmission occasion, and the resource allocation in the time domain
follows Clause 5.1.2.1.</p>
<p>For <em>pdsch-TimeDomainAllocationListForMultiPDSCH</em> in
<em>pdsch-Config</em> each PDSCH has a separate SLIV, mapping type and
<em>K<sub>0</sub></em>. The number of scheduled PDSCHs is signalled by
the number of indicated SLIVs in the row of the
<em>pdsch-TimeDomainAllocationListForMultiPDSCH</em> signalled in DCI
format 1_1.</p>
<p>If a UE is configured with
<em>pdsch-TimeDomainAllocationListForMultiPDSCH</em> in which one or
more rows contain multiple <em>SLIV</em>s for PDSCH on a DL BWP of a
serving cell, and the UE is indicated re-transmission of PDSCH
corresponding to a DL SPS by DCI format 1_1, the UE does not expect that
the number of indicated <em>SLIV</em>s in the row of the
<em>pdsch-TimeDomainAllocationListForMultiPDSCH</em> by the DCI is more
than one.</p>
<p>If a UE is configured with
<em>pdsch-TimeDomainAllocationListForMultiPDSCH</em> in which one or
more rows contain multiple <em>SLIV</em>s for PDSCH on a DL BWP of a
serving cell, the UE does not expect to be scheduled with one or
multiple PDSCH receptions by a single DCI format 1_1, where each PDSCH
reception overlaps with a UL symbol indicated by
<em>tdd-UL-DL-ConfigurationCommon</em> or
<em>tdd-UL-DL-ConfigurationDedicated</em> if provided.</p>
<h5
id="determination-of-the-resource-allocation-table-to-be-used-for-pdsch">5.1.2.1.1
Determination of the resource allocation table to be used for PDSCH</h5>
<p>Table 5.1.2.1.1-1 and Table 5.1.2.1.1-1A define which PDSCH time
domain resource allocation configuration to apply. Either a default
PDSCH time domain allocation A, B or C according to tables 5.1.2.1.1-2,
5.1.2.1.1-3, 5.1.2.1.1-4 and 5.1.2.1.1-5 is applied, or the higher layer
configured <em>pdsch-TimeDomainAllocationList</em> or
<em>pdsch-TimeDomainAllocationListForMultiPDSCH</em> or
<em>pdsch-TimeDomainAllocationListDCI-1-2</em> is applied. For operation
with shared spectrum channel access in frequency range 1, as described
in [16, TS 37.213], UE reinterprets <em>S</em> and <em>L</em> in row 9
of Table 5.1.2.1.1-2 as <em>S=6</em> and <em>L=7</em>.</p>
<p>Table 5.1.2.1.1-1: Applicable PDSCH time domain resource allocation
for DCI formats 1_0, 1_1, 4_0, 4_1 and 4_2</p>
<table>
<colgroup>
<col style="width: 12%" />
<col style="width: 13%" />
<col style="width: 6%" />
<col style="width: 7%" />
<col style="width: 7%" />
<col style="width: 8%" />
<col style="width: 8%" />
<col style="width: 35%" />
</colgroup>
<thead>
<tr>
<th style="text-align: center;"><strong>RNTI</strong></th>
<th style="text-align: center;"><strong>PDCCH search space</strong></th>
<th style="text-align: center;"><strong>SS/PBCH block and CORESET
multiplexing pattern</strong></th>
<th style="text-align: center;"><strong><em>PDSCH-ConfigCommon</em>
includes <em>pdsch-TimeDomainAllocationList</em></strong></th>
<th style="text-align: center;"><strong><em>PDSCH-Config</em> includes
<em>pdsch-TimeDomainAllocationList</em></strong></th>
<th style="text-align: center;"><p><strong><em>pdsch-ConfigMCCH /
pdsch-ConfigMTCH</em> includes
<em>pdsch-TimeDomainAllocationList</em></strong></p>
<p><em><strong>Or</strong></em></p>
<p><strong><em>pdsch-ConfigMulticast</em> includes
<em>pdsch-TimeDomainAllocationList</em></strong></p></th>
<th style="text-align: center;"><strong><em>PDSCH-Config</em> includes
<em>pdsch-TimeDomainAllocationListForMultiPDSCH</em></strong></th>
<th style="text-align: center;"><strong>PDSCH time domain resource
allocation to apply</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td rowspan="3" style="text-align: center;">SI-RNTI</td>
<td rowspan="3" style="text-align: center;">Type0 common</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">Default A for normal CP</td>
</tr>
<tr>
<td style="text-align: center;">2</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">Default B</td>
</tr>
<tr>
<td style="text-align: center;">3</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">Default C</td>
</tr>
<tr>
<td rowspan="4" style="text-align: center;">SI-RNTI</td>
<td rowspan="4" style="text-align: center;">Type0A common</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">No</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">Default A</td>
</tr>
<tr>
<td style="text-align: center;">2</td>
<td style="text-align: center;">No</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">Default B</td>
</tr>
<tr>
<td style="text-align: center;">3</td>
<td style="text-align: center;">No</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">Default C</td>
</tr>
<tr>
<td style="text-align: center;">1,2,3</td>
<td style="text-align: center;">Yes</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;"><em>Pdsch-TimeDomainAllocationList</em>
provided in <em>PDSCH-ConfigCommon</em></td>
</tr>
<tr>
<td rowspan="2" style="text-align: center;">RA-RNTI, MSGB-RNTI,
TC-RNTI</td>
<td rowspan="2" style="text-align: center;">Type1 common</td>
<td style="text-align: center;">1,2,3</td>
<td style="text-align: center;">No</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">Default A</td>
</tr>
<tr>
<td style="text-align: center;">1,2,3</td>
<td style="text-align: center;">Yes</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;"><em>Pdsch-TimeDomainAllocationList</em>
provided in <em>PDSCH-ConfigCommon</em></td>
</tr>
<tr>
<td rowspan="4" style="text-align: center;">P-RNTI</td>
<td rowspan="4" style="text-align: center;">Type2 common</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">No</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">Default A</td>
</tr>
<tr>
<td style="text-align: center;">2</td>
<td style="text-align: center;">No</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">Default B</td>
</tr>
<tr>
<td style="text-align: center;">3</td>
<td style="text-align: center;">No</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">Default C</td>
</tr>
<tr>
<td style="text-align: center;">1,2,3</td>
<td style="text-align: center;">Yes</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;"><em>Pdsch-TimeDomainAllocationList</em>
provided in <em>PDSCH-ConfigCommon</em></td>
</tr>
<tr>
<td rowspan="5" style="text-align: center;">MCCH-RNTI</td>
<td rowspan="5" style="text-align: center;">Type 0/0B/3 common for
broadcast</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">No</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">No</td>
<td style="text-align: center;"><em>-</em></td>
<td style="text-align: center;">Default A</td>
</tr>
<tr>
<td style="text-align: center;">2</td>
<td style="text-align: center;">No</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">No</td>
<td style="text-align: center;"><em>-</em></td>
<td style="text-align: center;">Default B</td>
</tr>
<tr>
<td style="text-align: center;">3</td>
<td style="text-align: center;">No</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">No</td>
<td style="text-align: center;"><em>-</em></td>
<td style="text-align: center;">Default C</td>
</tr>
<tr>
<td style="text-align: center;">1,2,3</td>
<td style="text-align: center;">Yes</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">No</td>
<td style="text-align: center;"><em>-</em></td>
<td style="text-align: center;"><em>pdsch-TimeDomainAllocationList</em>
provided in <em>PDSCH-ConfigCommon</em></td>
</tr>
<tr>
<td style="text-align: center;">1,2,3</td>
<td style="text-align: center;">No/Yes</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">Yes</td>
<td style="text-align: center;"><em>-</em></td>
<td style="text-align: center;"><em>pdsch-TimeDomainAllocationList
provided in pdsch-ConfigMCCH</em></td>
</tr>
<tr>
<td rowspan="5" style="text-align: center;">G-RNTI for broadcast</td>
<td rowspan="5" style="text-align: center;">Type 0/0B/3 common for
broadcast</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">No</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">No</td>
<td style="text-align: center;"><em>-</em></td>
<td style="text-align: center;">Default A</td>
</tr>
<tr>
<td style="text-align: center;">2</td>
<td style="text-align: center;">No</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">No</td>
<td style="text-align: center;"><em>-</em></td>
<td style="text-align: center;">Default B</td>
</tr>
<tr>
<td style="text-align: center;">3</td>
<td style="text-align: center;">No</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">No</td>
<td style="text-align: center;"><em>-</em></td>
<td style="text-align: center;">Default C</td>
</tr>
<tr>
<td style="text-align: center;">1,2,3</td>
<td style="text-align: center;">Yes</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">No</td>
<td style="text-align: center;"><em>-</em></td>
<td style="text-align: center;"><em>pdsch-TimeDomainAllocationList</em>
provided in <em>PDSCH-ConfigCommon</em></td>
</tr>
<tr>
<td style="text-align: center;">1,2,3</td>
<td style="text-align: center;">No/Yes</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">Yes</td>
<td style="text-align: center;"><em>-</em></td>
<td style="text-align: center;"><em>pdsch-TimeDomainAllocationList</em>
provided in <em>pdsch-ConfigMTCH,</em> if configured, otherwise
<em>pdsch-TimeDomainAllocationList</em> provided in
<em>pdsch-ConfigMCCH</em></td>
</tr>
<tr>
<td rowspan="2" style="text-align: center;">C-RNTI, MCS-C-RNTI,
CS-RNTI</td>
<td rowspan="2" style="text-align: center;">Any common search space
associated with CORESET 0</td>
<td style="text-align: center;">1, 2, 3</td>
<td style="text-align: center;">No</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">Default A</td>
</tr>
<tr>
<td style="text-align: center;">1, 2, 3</td>
<td style="text-align: center;">Yes</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;"><em>-</em></td>
<td style="text-align: center;"><em>pdsch-TimeDomainAllocationList</em>
provided in <em>PDSCH-ConfigCommon</em></td>
</tr>
<tr>
<td rowspan="4" style="text-align: center;">C-RNTI, MCS-C-RNTI,
CS-RNTI</td>
<td rowspan="4" style="text-align: center;"><p>Any common search space
not associated with CORESET 0</p>
<p>UE specific search space</p></td>
<td style="text-align: center;">1,2,3</td>
<td style="text-align: center;">No</td>
<td style="text-align: center;">No</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">Default A</td>
</tr>
<tr>
<td style="text-align: center;">1,2,3</td>
<td style="text-align: center;">Yes</td>
<td style="text-align: center;">No</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;"><em>-</em></td>
<td style="text-align: center;"><em>pdsch-TimeDomainAllocationList</em>
provided in <em>PDSCH-ConfigCommon</em></td>
</tr>
<tr>
<td style="text-align: center;">1,2,3</td>
<td style="text-align: center;">No/Yes</td>
<td style="text-align: center;">Yes</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;"><em>-</em></td>
<td style="text-align: center;"><em>pdsch-TimeDomainAllocationList</em>
provided in <em>PDSCH-Config</em></td>
</tr>
<tr>
<td style="text-align: center;">1,2,3</td>
<td style="text-align: center;">No/Yes</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">Yes</td>
<td
style="text-align: center;"><em>pdsch-TimeDomainAllocationListForMultiPDSCH</em>
provided in <em>PDSCH-Config (Note 2)</em></td>
</tr>
<tr>
<td rowspan="3" style="text-align: center;">G-RNTI for multicast,
G-CS-RNTI</td>
<td rowspan="3" style="text-align: center;">Type 3 common search space
for multicast</td>
<td style="text-align: center;">1,2,3</td>
<td style="text-align: center;">No</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">No</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;"><em>Default A</em></td>
</tr>
<tr>
<td style="text-align: center;">1,2,3</td>
<td style="text-align: center;">Yes</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">No</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;"><em>pdsch-TimeDomainAllocationList</em>
provided in <em>PDSCH-ConfigCommon (Note 1)</em></td>
</tr>
<tr>
<td style="text-align: center;">1,2,3</td>
<td style="text-align: center;">No/Yes</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">Yes</td>
<td style="text-align: center;">-</td>
<td
style="text-align: center;"><p><em>pdsch-TimeDomainAllocationList</em>
provided in <em>pdsch-ConfigMulticast</em></p>
<p><em>(Note 1)</em></p></td>
</tr>
<tr>
<td colspan="8" style="text-align: center;"><p>Note 1: For a UE that
supports multicast, the same TDRA table applies to all G-RNTIs and
G-CS-RNTIs (configured for multicast) if configured on a given serving
cell.</p>
<p>Note 2: If <em>pdsch-TimeDomainAllocationListForMultiPDSCH</em> is
provided, it is applicable to DCI format 1_1 only.</p></td>
</tr>
</tbody>
</table>
<p>Table 5.1.2.1.1-1A: Applicable PDSCH time domain resource allocation
for DCI format 1_2</p>
<table>
<colgroup>
<col style="width: 23%" />
<col style="width: 23%" />
<col style="width: 27%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr>
<th><em>PDSCH-ConfigCommon</em> includes
<em>pdsch-TimeDomainAllocationList</em></th>
<th><em>PDSCH-Config includes pdsch-TimeDomainAllocationList</em></th>
<th><em>PDSCH-Config</em> includes <em>pdsch-
TimeDomainAllocationListDCI-1-2</em></th>
<th>PDSCH time domain resource allocation to apply</th>
</tr>
</thead>
<tbody>
<tr>
<td>No</td>
<td>No</td>
<td>No</td>
<td>Default A</td>
</tr>
<tr>
<td>Yes</td>
<td>No</td>
<td>No</td>
<td><em>pdsch-TimeDomainAllocationList</em> provided in
<em>PDSCH-ConfigCommon</em></td>
</tr>
<tr>
<td>No/Yes</td>
<td>Yes</td>
<td>No</td>
<td><em>pdsch-TimeDomainAllocationList</em> provided in
<em>PDSCH-Config</em></td>
</tr>
<tr>
<td>No/Yes</td>
<td>No/Yes</td>
<td>Yes</td>
<td><em>pdsch-TimeDomainAllocationListDCI-1-2</em> provided in
<em>PDSCH-Config</em></td>
</tr>
</tbody>
</table>
<p>Table 5.1.2.1.1-2: Default PDSCH time domain resource allocation A
for normal CP</p>
<table>
<colgroup>
<col style="width: 16%" />
<col style="width: 16%" />
<col style="width: 16%" />
<col style="width: 16%" />
<col style="width: 16%" />
<col style="width: 16%" />
</colgroup>
<thead>
<tr>
<th>Row index</th>
<th><em>dmrs-TypeA-Position</em></th>
<th>PDSCH mapping type</th>
<th><em>K<sub>0</sub></em></th>
<th><em>S</em></th>
<th><em>L</em></th>
</tr>
</thead>
<tbody>
<tr>
<td rowspan="2">1</td>
<td>2</td>
<td>Type A</td>
<td>0</td>
<td>2</td>
<td>12</td>
</tr>
<tr>
<td>3</td>
<td>Type A</td>
<td>0</td>
<td>3</td>
<td>11</td>
</tr>
<tr>
<td rowspan="2">2</td>
<td>2</td>
<td>Type A</td>
<td>0</td>
<td>2</td>
<td>10</td>
</tr>
<tr>
<td>3</td>
<td>Type A</td>
<td>0</td>
<td>3</td>
<td>9</td>
</tr>
<tr>
<td rowspan="2">3</td>
<td>2</td>
<td>Type A</td>
<td>0</td>
<td>2</td>
<td>9</td>
</tr>
<tr>
<td>3</td>
<td>Type A</td>
<td>0</td>
<td>3</td>
<td>8</td>
</tr>
<tr>
<td rowspan="2">4</td>
<td>2</td>
<td>Type A</td>
<td>0</td>
<td>2</td>
<td>7</td>
</tr>
<tr>
<td>3</td>
<td>Type A</td>
<td>0</td>
<td>3</td>
<td>6</td>
</tr>
<tr>
<td rowspan="2">5</td>
<td>2</td>
<td>Type A</td>
<td>0</td>
<td>2</td>
<td>5</td>
</tr>
<tr>
<td>3</td>
<td>Type A</td>
<td>0</td>
<td>3</td>
<td>4</td>
</tr>
<tr>
<td rowspan="2">6</td>
<td>2</td>
<td>Type B</td>
<td>0</td>
<td>9</td>
<td>4</td>
</tr>
<tr>
<td>3</td>
<td>Type B</td>
<td>0</td>
<td>10</td>
<td>4</td>
</tr>
<tr>
<td rowspan="2">7</td>
<td>2</td>
<td>Type B</td>
<td>0</td>
<td>4</td>
<td>4</td>
</tr>
<tr>
<td>3</td>
<td>Type B</td>
<td>0</td>
<td>6</td>
<td>4</td>
</tr>
<tr>
<td>8</td>
<td>2,3</td>
<td>Type B</td>
<td>0</td>
<td>5</td>
<td>7</td>
</tr>
<tr>
<td>9</td>
<td>2,3</td>
<td>Type B</td>
<td>0</td>
<td>5</td>
<td>2</td>
</tr>
<tr>
<td>10</td>
<td>2,3</td>
<td>Type B</td>
<td>0</td>
<td>9</td>
<td>2</td>
</tr>
<tr>
<td>11</td>
<td>2,3</td>
<td>Type B</td>
<td>0</td>
<td>12</td>
<td>2</td>
</tr>
<tr>
<td>12</td>
<td>2,3</td>
<td>Type A</td>
<td>0</td>
<td>1</td>
<td>13</td>
</tr>
<tr>
<td>13</td>
<td>2,3</td>
<td>Type A</td>
<td>0</td>
<td>1</td>
<td>6</td>
</tr>
<tr>
<td>14</td>
<td>2,3</td>
<td>Type A</td>
<td>0</td>
<td>2</td>
<td>4</td>
</tr>
<tr>
<td>15</td>
<td>2,3</td>
<td>Type B</td>
<td>0</td>
<td>4</td>
<td>7</td>
</tr>
<tr>
<td>16</td>
<td>2,3</td>
<td>Type B</td>
<td>0</td>
<td>8</td>
<td>4</td>
</tr>
</tbody>
</table>
<p>Table 5.1.2.1.1-3: Default PDSCH time domain resource allocation A
for extended CP</p>
<table>
<colgroup>
<col style="width: 16%" />
<col style="width: 16%" />
<col style="width: 16%" />
<col style="width: 16%" />
<col style="width: 16%" />
<col style="width: 16%" />
</colgroup>
<thead>
<tr>
<th>Row index</th>
<th><em>dmrs-TypeA-Position</em></th>
<th>PDSCH mapping type</th>
<th><em>K<sub>0</sub></em></th>
<th><em>S</em></th>
<th><em>L</em></th>
</tr>
</thead>
<tbody>
<tr>
<td rowspan="2">1</td>
<td>2</td>
<td>Type A</td>
<td>0</td>
<td>2</td>
<td>6</td>
</tr>
<tr>
<td>3</td>
<td>Type A</td>
<td>0</td>
<td>3</td>
<td>5</td>
</tr>
<tr>
<td rowspan="2">2</td>
<td>2</td>
<td>Type A</td>
<td>0</td>
<td>2</td>
<td>10</td>
</tr>
<tr>
<td>3</td>
<td>Type A</td>
<td>0</td>
<td>3</td>
<td>9</td>
</tr>
<tr>
<td rowspan="2">3</td>
<td>2</td>
<td>Type A</td>
<td>0</td>
<td>2</td>
<td>9</td>
</tr>
<tr>
<td>3</td>
<td>Type A</td>
<td>0</td>
<td>3</td>
<td>8</td>
</tr>
<tr>
<td rowspan="2">4</td>
<td>2</td>
<td>Type A</td>
<td>0</td>
<td>2</td>
<td>7</td>
</tr>
<tr>
<td>3</td>
<td>Type A</td>
<td>0</td>
<td>3</td>
<td>6</td>
</tr>
<tr>
<td rowspan="2">5</td>
<td>2</td>
<td>Type A</td>
<td>0</td>
<td>2</td>
<td>5</td>
</tr>
<tr>
<td>3</td>
<td>Type A</td>
<td>0</td>
<td>3</td>
<td>4</td>
</tr>
<tr>
<td rowspan="2">6</td>
<td>2</td>
<td>Type B</td>
<td>0</td>
<td>6</td>
<td>4</td>
</tr>
<tr>
<td>3</td>
<td>Type B</td>
<td>0</td>
<td>8</td>
<td>2</td>
</tr>
<tr>
<td rowspan="2">7</td>
<td>2</td>
<td>Type B</td>
<td>0</td>
<td>4</td>
<td>4</td>
</tr>
<tr>
<td>3</td>
<td>Type B</td>
<td>0</td>
<td>6</td>
<td>4</td>
</tr>
<tr>
<td>8</td>
<td>2,3</td>
<td>Type B</td>
<td>0</td>
<td>5</td>
<td>6</td>
</tr>
<tr>
<td>9</td>
<td>2,3</td>
<td>Type B</td>
<td>0</td>
<td>5</td>
<td>2</td>
</tr>
<tr>
<td>10</td>
<td>2,3</td>
<td>Type B</td>
<td>0</td>
<td>9</td>
<td>2</td>
</tr>
<tr>
<td>11</td>
<td>2,3</td>
<td>Type B</td>
<td>0</td>
<td>10</td>
<td>2</td>
</tr>
<tr>
<td>12</td>
<td>2,3</td>
<td>Type A</td>
<td>0</td>
<td>1</td>
<td>11</td>
</tr>
<tr>
<td>13</td>
<td>2,3</td>
<td>Type A</td>
<td>0</td>
<td>1</td>
<td>6</td>
</tr>
<tr>
<td>14</td>
<td>2,3</td>
<td>Type A</td>
<td>0</td>
<td>2</td>
<td>4</td>
</tr>
<tr>
<td>15</td>
<td>2,3</td>
<td>Type B</td>
<td>0</td>
<td>4</td>
<td>6</td>
</tr>
<tr>
<td>16</td>
<td>2,3</td>
<td>Type B</td>
<td>0</td>
<td>8</td>
<td>4</td>
</tr>
</tbody>
</table>
<p>Table 5.1.2.1.1-4: Default PDSCH time domain resource allocation
B</p>
<table>
<colgroup>
<col style="width: 16%" />
<col style="width: 16%" />
<col style="width: 16%" />
<col style="width: 16%" />
<col style="width: 16%" />
<col style="width: 16%" />
</colgroup>
<thead>
<tr>
<th><strong>Row index</strong></th>
<th><em><strong>dmrs-TypeA-Position</strong></em></th>
<th><strong>PDSCH mapping type</strong></th>
<th><em><strong>K<sub>0</sub></strong></em></th>
<th><em><strong>S</strong></em></th>
<th><em><strong>L</strong></em></th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>2,3</td>
<td>Type B</td>
<td>0</td>
<td>2</td>
<td>2</td>
</tr>
<tr>
<td>2</td>
<td>2,3</td>
<td>Type B</td>
<td>0</td>
<td>4</td>
<td>2</td>
</tr>
<tr>
<td>3</td>
<td>2,3</td>
<td>Type B</td>
<td>0</td>
<td>6</td>
<td>2</td>
</tr>
<tr>
<td>4</td>
<td>2,3</td>
<td>Type B</td>
<td>0</td>
<td>8</td>
<td>2</td>
</tr>
<tr>
<td>5</td>
<td>2,3</td>
<td>Type B</td>
<td>0</td>
<td>10</td>
<td>2</td>
</tr>
<tr>
<td>6</td>
<td>2,3</td>
<td>Type B</td>
<td>1</td>
<td>2</td>
<td>2</td>
</tr>
<tr>
<td>7</td>
<td>2,3</td>
<td>Type B</td>
<td>1</td>
<td>4</td>
<td>2</td>
</tr>
<tr>
<td>8</td>
<td>2,3</td>
<td>Type B</td>
<td>0</td>
<td>2</td>
<td>4</td>
</tr>
<tr>
<td>9</td>
<td>2,3</td>
<td>Type B</td>
<td>0</td>
<td>4</td>
<td>4</td>
</tr>
<tr>
<td>10</td>
<td>2,3</td>
<td>Type B</td>
<td>0</td>
<td>6</td>
<td>4</td>
</tr>
<tr>
<td>11</td>
<td>2,3</td>
<td>Type B</td>
<td>0</td>
<td>8</td>
<td>4</td>
</tr>
<tr>
<td>12 (Note 1)</td>
<td>2,3</td>
<td>Type B</td>
<td>0</td>
<td>10</td>
<td>4</td>
</tr>
<tr>
<td>13 (Note 1)</td>
<td>2,3</td>
<td>Type B</td>
<td>0</td>
<td>2</td>
<td>7</td>
</tr>
<tr>
<td rowspan="2">14 (Note 1)</td>
<td>2</td>
<td>Type A</td>
<td>0</td>
<td>2</td>
<td>12</td>
</tr>
<tr>
<td>3</td>
<td>Type A</td>
<td>0</td>
<td>3</td>
<td>11</td>
</tr>
<tr>
<td>15</td>
<td>2,3</td>
<td>Type B</td>
<td>1</td>
<td>2</td>
<td>4</td>
</tr>
<tr>
<td>16</td>
<td colspan="5">Reserved</td>
</tr>
<tr>
<td colspan="6">Note 1: If the PDSCH was scheduled with SI-RNTI in PDCCH
Type0 common search space, the UE may assume that this PDSCH resource
allocation is not applied</td>
</tr>
</tbody>
</table>
<p>Table 5.1.2.1.1-5: Default PDSCH time domain resource allocation
C</p>
<table>
<colgroup>
<col style="width: 16%" />
<col style="width: 16%" />
<col style="width: 16%" />
<col style="width: 16%" />
<col style="width: 16%" />
<col style="width: 16%" />
</colgroup>
<thead>
<tr>
<th><strong>Row index</strong></th>
<th><em><strong>dmrs-TypeA-Position</strong></em></th>
<th><strong>PDSCH mapping type</strong></th>
<th><em><strong>K<sub>0</sub></strong></em></th>
<th><em><strong>S</strong></em></th>
<th><em><strong>L</strong></em></th>
</tr>
</thead>
<tbody>
<tr>
<td>1 (Note 1)</td>
<td>2,3</td>
<td>Type B</td>
<td>0</td>
<td>2</td>
<td>2</td>
</tr>
<tr>
<td>2</td>
<td>2,3</td>
<td>Type B</td>
<td>0</td>
<td>4</td>
<td>2</td>
</tr>
<tr>
<td>3</td>
<td>2,3</td>
<td>Type B</td>
<td>0</td>
<td>6</td>
<td>2</td>
</tr>
<tr>
<td>4</td>
<td>2,3</td>
<td>Type B</td>
<td>0</td>
<td>8</td>
<td>2</td>
</tr>
<tr>
<td>5</td>
<td>2,3</td>
<td>Type B</td>
<td>0</td>
<td>10</td>
<td>2</td>
</tr>
<tr>
<td>6 (Note 2)</td>
<td>2,3</td>
<td>Type B</td>
<td>0</td>
<td>11</td>
<td>2</td>
</tr>
<tr>
<td>7</td>
<td colspan="5">Reserved</td>
</tr>
<tr>
<td>8</td>
<td>2,3</td>
<td>Type B</td>
<td>0</td>
<td>2</td>
<td>4</td>
</tr>
<tr>
<td>9</td>
<td>2,3</td>
<td>Type B</td>
<td>0</td>
<td>4</td>
<td>4</td>
</tr>
<tr>
<td>10</td>
<td>2,3</td>
<td>Type B</td>
<td>0</td>
<td>6</td>
<td>4</td>
</tr>
<tr>
<td>11</td>
<td>2,3</td>
<td>Type B</td>
<td>0</td>
<td>8</td>
<td>4</td>
</tr>
<tr>
<td>12</td>
<td>2,3</td>
<td>Type B</td>
<td>0</td>
<td>10</td>
<td>4</td>
</tr>
<tr>
<td>13 (Note 1)</td>
<td>2,3</td>
<td>Type B</td>
<td>0</td>
<td>2</td>
<td>7</td>
</tr>
<tr>
<td rowspan="2">14 (Note 1)</td>
<td>2</td>
<td>Type A</td>
<td>0</td>
<td>2</td>
<td>12</td>
</tr>
<tr>
<td>3</td>
<td>Type A</td>
<td>0</td>
<td>3</td>
<td>11</td>
</tr>
<tr>
<td>15 (Note 1)</td>
<td>2,3</td>
<td>Type A</td>
<td>0</td>
<td>0</td>
<td>6</td>
</tr>
<tr>
<td>16 (Note 1)</td>
<td>2,3</td>
<td>Type A</td>
<td>0</td>
<td>2</td>
<td>6</td>
</tr>
<tr>
<td colspan="6"><p>Note 1: The UE may assume that this PDSCH resource
allocation is not used, if the PDSCH was scheduled with SI-RNTI in PDCCH
Type0 common search space</p>
<p>Note 2: This applies for Case F and Case G candidate SS/PBCH block
pattern described in clause 4 of [6, TS 38.213]</p></td>
</tr>
</tbody>
</table>
<h4 id="resource-allocation-in-frequency-domain">5.1.2.2 Resource
allocation in frequency domain</h4>
<p>Two downlink resource allocation schemes, type 0 and type 1, are
supported. The UE shall assume that when the scheduling grant is
received with DCI format 1_0, 4_0 or 4_1 then downlink resource
allocation type 1 is used.</p>
<p>If the scheduling DCI is configured to indicate the downlink resource
allocation type as part of the '<em>Frequency domain resource
assignment'</em> field by setting a higher layer parameter
<em>resourceAllocation</em> in <em>PDSCH-Config</em> to 'dynamicSwitch',
for DCI format 1_1 or setting a higher layer parameter
<em>resourceAllocationDCI-1-2</em> in <em>PDSCH-Config</em> to
'dynamicSwitch' for DCI format 1_2 or setting a higher layer parameter
<em>resourceAllocation</em> in <em>pdsch-ConfigMulticast</em> to
'dynamicSwitch' for DCI format 4_2, the UE shall use downlink resource
allocation type 0 or type 1 as defined by this DCI field. Otherwise the
UE shall use the downlink frequency resource allocation type as defined
by the higher layer parameter <em>resourceAllocation</em> in
<em>PDSCH-Config</em> for DCI format 1_1 or by the higher layer
parameter <em>resourceAllocationDCI-1-2</em> for DCI format 1_2 or by
the higher layer parameter <em>resourceAllocation</em> in
<em>pdsch-ConfigMulticast</em> for DCI format 4_2.</p>
<p>If a bandwidth part indicator field is not configured in the
scheduling DCI or the UE does not support active BWP change via DCI, the
RB indexing for downlink type 0 and type 1 resource allocation is
determined within the UE's active bandwidth part. If a bandwidth part
indicator field is configured in the scheduling DCI and the UE supports
active BWP change via DCI, the RB indexing for downlink type 0 and type
1 resource allocation is determined within the UE's bandwidth part
indicated by bandwidth part indicator field value in the DCI. The UE
shall upon detection of PDCCH intended for the UE determine first the
downlink bandwidth part and then the resource allocation within the
bandwidth part.</p>
<p>For a PDSCH scheduled with a DCI format 1_0 in any type of PDCCH
common search space, regardless of which bandwidth part is the active
bandwidth part, RB numbering starts from the lowest RB of the CORESET in
which the DCI was received; otherwise RB numbering starts from the
lowest RB in the determined downlink bandwidth part. When the PDCCH
reception includes two PDCCH candidates from two respective search space
sets, as described in clause 10.1 of [6, TS 38.213], for the purpose of
determining the downlink RB set of a PDSCH when scheduled by DCI format
1_0, the CORESET with lower ID among two CORESETs associated with two
PDCCH candidates is used.</p>
<h5 id="downlink-resource-allocation-type-0">5.1.2.2.1 Downlink resource
allocation type 0</h5>
<p>In downlink resource allocation of type 0, the resource block
assignment information includes a bitmap indicating the Resource Block
Groups (RBGs) that are allocated to the scheduled UE where a RBG is a
set of consecutive virtual resource blocks defined by higher layer
parameter <em>rbg-Size</em> configured by <em>PDSCH-Config</em> and the
size of the bandwidth part as defined in Table 5.1.2.2.1-1.</p>
<p>Table 5.1.2.2.1-1: Nominal RBG size <em>P</em></p>
<table>
<colgroup>
<col style="width: 37%" />
<col style="width: 31%" />
<col style="width: 31%" />
</colgroup>
<thead>
<tr>
<th>Bandwidth Part Size</th>
<th>Configuration 1</th>
<th>Configuration 2</th>
</tr>
</thead>
<tbody>
<tr>
<td>1 – 36</td>
<td>2</td>
<td>4</td>
</tr>
<tr>
<td>37 – 72</td>
<td>4</td>
<td>8</td>
</tr>
<tr>
<td>73 – 144</td>
<td>8</td>
<td>16</td>
</tr>
<tr>
<td>145 – 275</td>
<td>16</td>
<td>16</td>
</tr>
</tbody>
</table>
<p>The total number of RBGs (<span
class="math inline">\(N_{\text{RBG}}\)</span>) for a downlink bandwidth
part <em>i</em> of size <span
class="math inline">\(N_{\text{BWP,i}}^{size}\)</span> PRBs is given by
<span class="math inline">\(N_{RBG} = \left\lceil \left(
N_{BWP,i}^{size} + \left( N_{BWP,i}^{start}{mod}P \right) \right)/P
\right\rceil\)</span>, where</p>
<p>- the size of the first RBG is <span
class="math inline">\(RBG_{0}^{size} = P -
N_{BWP,i}^{start}{mod}P\)</span>,</p>
<p>- the size of last RBG is <span
class="math inline">\(RBG_{last}^{size} = \left( N_{BWP,i}^{start} +
N_{BWP,i}^{size} \right){mod}P\)</span> if <span
class="math inline">\(\left( N_{BWP,i}^{start} + N_{BWP,i}^{size}
\right){mod}P &gt; 0\)</span> and <em>P</em> otherwise,</p>
<p>- the size of all other RBGs is <em>P</em>.</p>
<p>In downlink resource allocation of type 0 scheduled using a DCI with
CRC scrambled by G-RNTI for multicast or G-CS-RNTI, the resource block
assignment information bitmap is calculated based on the description
above with the following changes: the parameter <span
class="math inline">\(N_{BWP,i}^{start}\)</span> is the starting PRB of
the CFR, <span class="math inline">\(N_{BWP,i}^{size}\)</span> is the
size of the common frequency resource (CFR) and the value of the higher
layer parameter <em>rbg-Size</em> is configured by
<em>pdsch-ConfigMulticast</em>.</p>
<p>The bitmap is of size <img src="media/image22.svg" />bits with one
bitmap bit per RBG such that each RBG is addressable. The RBGs shall be
indexed in the order of increasing frequency and starting at the lowest
frequency of the bandwidth part. The order of RBG bitmap is such that
RBG 0 to RBG<img src="media/image23.svg" /> are mapped from MSB to LSB.
The RBG is allocated to the UE if the corresponding bit value in the
bitmap is 1, the RBG is not allocated to the UE otherwise.</p>
<h5 id="downlink-resource-allocation-type-1">5.1.2.2.2 Downlink resource
allocation type 1</h5>
<p>In downlink resource allocation of type 1, the resource block
assignment information indicates to a scheduled UE a set of contiguously
allocated non-interleaved or interleaved virtual resource blocks within
the active bandwidth part of size <img src="media/image24.svg" /> PRBs
except for the case when DCI format 1_0 is decoded in any common search
space in which case the size of CORESET 0 shall be used if CORESET 0 is
configured for the cell and the size of initial DL bandwidth part shall
be used if CORESET 0 is not configured for the cell.</p>
<p>A downlink type 1 resource allocation field consists of a resource
indication value (<em>RIV</em>) corresponding to a starting virtual
resource block (<img src="media/image25.svg" />) and a length in terms
of contiguously allocated resource blocks<img
src="media/image26.svg" />. The resource indication value is defined
by</p>
<p>if <img src="media/image27.svg" /> then</p>
<p><img src="media/image28.svg" /></p>
<p>else</p>
<p><img src="media/image29.svg" /></p>
<p>where<img src="media/image30.svg" />≥ 1 and shall not exceed <img
src="media/image31.svg" />.</p>
<p>When the DCI size for DCI format 1_0 in USS is derived from the size
of DCI format 1_0 in CSS but applied to an active BWP with size of <img
src="media/image32.svg" />, a downlink type 1 resource block assignment
field consists of a resource indication value (<em>RIV</em>)
corresponding to a starting resource block <img
src="media/image33.svg" />and a length in terms of virtually
contiguously allocated resource blocks <img src="media/image34.svg" />,
where <img src="media/image35.svg" /> is given by</p>
<p>- the size of CORESET 0 if CORESET 0 is configured for the cell;</p>
<p>- the size of initial DL bandwidth part if CORESET 0 is not
configured for the cell.</p>
<p>The resource indication value is defined by:</p>
<p>if <img src="media/image36.svg" /> then</p>
<p><img src="media/image37.svg" /></p>
<p>else</p>
<p><img src="media/image38.svg" /></p>
<p>where<img src="media/image39.svg" />, <img
src="media/image40.svg" />and where <img src="media/image41.svg" />shall
not exceed <img src="media/image42.svg" />.</p>
<p>If <img src="media/image43.svg" />, <em>K</em> is the maximum value
from set {1, 2, 4, 8} which satisfies <img src="media/image44.svg" />;
otherwise <em>K</em> = 1.</p>
<p>When the scheduling grant is received with DCI format 1_2, a downlink
type 1 resource allocation field consists of a resource indication value
(<em>RIV</em>) corresponding to a starting resource block group
<em>RBG<sub>start</sub></em>=0, 1, …, <em>N<sub>RBG</sub></em>-1 and a
length in terms of virtually contiguously allocated resource block
groups <em>L<sub>RBGs</sub></em>=1, …, <em>N<sub>RBG</sub></em>, where
the resource block groups are defined as in 5.1.2.2.1 with <em>P</em>
defined by <em>resourceAllocationType1GranularityDCI-1-2</em> if the UE
is configured with higher layer parameter
<em>resourceAllocationType1GranularityDCI-1-2</em>, and <em>P</em>=1
otherwise<em>.</em> The resource indication value is defined by</p>
<p>if <img src="media/image45.svg" /> then</p>
<p><img src="media/image46.svg" /></p>
<p>else</p>
<p><img src="media/image47.svg" /></p>
<p>where<img src="media/image48.svg" />≥ 1 and shall not exceed <img
src="media/image49.svg" />.</p>
<h5
id="downlink-resource-allocation-type-1-for-multicastbroadcast">5.1.2.2.3
Downlink resource allocation type 1 for multicast/broadcast</h5>
<p>In downlink resource allocation of type 1 scheduled using DCI format
4_0 or DCI format 4_1 with CRC scrambled by G-RNTI, G-CS-RNTI or
MCCH-RNTI, the resource block assignment information indicates to a
scheduled UE a set of contiguously allocated non-interleaved or
interleaved virtual resource blocks.</p>
<p>A downlink type 1 resource block assignment field in the DCI format
4_0 or DCI format 4_1 consists of a <em>RIV</em> corresponding to a
starting resource block in reference to the lowest RB of the CFR <img
src="media/image33.svg" />and a length in terms of virtually
contiguously allocated resource blocks L<sub>RBs</sub>, where <img
src="media/image35.svg" /> is given by</p>
<p>- the size of CORESET 0 if CORESET 0 is configured for the cell;</p>
<p>- the size of initial DL bandwidth part if CORESET 0 is not
configured for the cell.</p>
<p>The resource indication value is defined by:</p>
<p>if <img src="media/image36.svg" /> then</p>
<p><img src="media/image37.svg" /></p>
<p>else</p>
<p><img src="media/image38.svg" /></p>
<p>where<img src="media/image39.svg" />, <img
src="media/image40.svg" />and where <img src="media/image41.svg" />shall
not exceed <img src="media/image42.svg" />.</p>
<p>If <span class="math inline">\(N_{CFR} &gt;
N_{BWP}^{initial}\)</span>, <em>K</em> is the maximum value from set {1,
2, 4, 6, 8, 10, 12} which satisfies <span class="math inline">\(K \leq
\left\lfloor N_{CFR}/N_{BWP}^{initial} \right\rfloor\)</span>; otherwise
<em>K</em> = 1.</p>
<p>In downlink resource allocation of type 1 scheduled using DCI format
4_2 with CRC scrambled by G-RNTI for multicast or G-CS-RNTI, the
description in clause 5.1.2.2.2 with the following changes: <img
src="media/image25.svg" /> corresponds to a starting resource block in
reference to the lowest RB of the CFR and <img
src="media/image24.svg" /> is the size of the CFR.</p>
<h4 id="physical-resource-block-prb-bundling">5.1.2.3 Physical resource
block (PRB) bundling</h4>
<p>The PRB bundling procedures for PDSCH scheduled by PDCCH with DCI
format 1_1 described in this clause equally apply to PDSCH scheduled by
PDCCH with DCI format 1_2, by applying the parameters of
<em>prb-BundlingTypeDCI-1-2</em> instead of <em>prb-BundlingType</em> as
well as <em>vrb-ToPRB-InterleaverDCI-1-2</em> instead of
<em>vrb-ToPRB-Interleaver</em>. The PRB bundling procedures for PDSCH
scheduled by PDCCH with DCI format 1_1 described in this clause equally
apply to PDSCH scheduled by PDCCH with DCI format 4_2, by applying the
parameters of <em>prb-BundlingType</em> given by
<em>pdsch-ConfigMulticast</em> as well as <em>vrb-ToPRB-Interleaver</em>
given by <em>pdsch-ConfigMulticast</em>.</p>
<p>A UE may assume that precoding granularity is <img
src="media/image50.svg" /> consecutive resource blocks in the frequency
domain. <img src="media/image50.svg" /> can be equal to one of the
values among {2, 4, wideband}.</p>
<p>If <img src="media/image50.svg" /> is determined as "wideband", the
UE is not expected to be scheduled with non-contiguous PRBs and the UE
may assume that the same precoding is applied to the allocated resource
associated with a same TCI state or a same QCL assumption.</p>
<p>If <img src="media/image50.svg" /> is determined as one of the values
among {2, 4}, Precoding Resource Block Group (PRGs) partitions the
bandwidth part <em>i</em> with <img src="media/image50.svg" />
consecutive PRBs. Actual number of consecutive PRBs in each PRG could be
one or more.</p>
<p>The first PRG size is given by <img src="media/image51.svg" /> and
the last PRG size given by <img src="media/image52.svg" /> if <img
src="media/image53.svg" />, and the last PRG size is <img
src="media/image54.svg" />if <img src="media/image55.svg" />. For PDSCH
scheduled by PDCCH with DCI scrambled using G-RNTI or G-CS-RNTI, <span
class="math inline">\(N_{BWP,i}^{start}\)</span> is the starting PRB of
the CFR and <span class="math inline">\(N_{BWP,i}^{size}\)</span> is the
CFR.</p>
<p>The UE may assume the same precoding is applied for any downlink
contiguous allocation of PRBs in a PRG.</p>
<p>For PDSCH carrying SIB1 scheduled by PDCCH with CRC scrambled by
SI-RNTI, a PRG is partitioned from the lowest numbered resource block of
CORESET 0 if the corresponding PDCCH is associated with CORESET 0 and
Type0-PDCCH common search space and is addressed to SI-RNTI; otherwise,
a PRG is partitioned from common resource block 0.</p>
<p>If a UE is scheduled a PDSCH with DCI format 1_0 or 4_0, the UE shall
assume that <img src="media/image50.svg" /> is equal to 2 PRBs.</p>
<p>When receiving PDSCH scheduled by PDCCH with DCI format 1_1 with CRC
scrambled by C-RNTI, MCS-C-RNTI, or CS-RNTI, <img
src="media/image50.svg" /> for bandwidth part is equal to 2 PRBs unless
configured by the higher layer parameter <em>prb-BundlingType</em> given
by <em>PDSCH-Config</em>.</p>
<p>When receiving PDSCH scheduled by PDCCH with DCI format 1_1 with CRC
scrambled by C-RNTI, MCS-C-RNTI, or CS-RNTI, if the higher layer
parameter <em>prb-BundlingType</em> is set to 'dynamicBundling', the
higher layer parameters <em>bundleSizeSet1</em> and
<em>bundleSizeSet2</em> configure two sets of <img
src="media/image50.svg" /> values, the first set can take one or two
<img src="media/image50.svg" /> values among {2, 4, wideband}, and the
second set can take one <img src="media/image50.svg" /> value among {2,
4, wideband}.</p>
<p>If the PRB <em>'bundling size indicator'</em> signalled in DCI format
1_1 as defined in Clause 7.3.1.2.2 of [5, TS 38.212]</p>
<p>- is set to '0', the UE shall use the <img src="media/image50.svg" />
value from the second set of <img src="media/image50.svg" /> values when
receiving PDSCH scheduled by the same DCI.</p>
<p>- is set to '1' and one value is configured for the first set of <img
src="media/image50.svg" /> values, the UE shall use this <img
src="media/image50.svg" /> value when receiving PDSCH scheduled by the
same DCI</p>
<p>- is set to '1' and two values are configured for the first set of
<img src="media/image50.svg" /> values as 'n2-wideband' (corresponding
to two <img src="media/image50.svg" /> values 2 and wideband) or
'n4-wideband' (corresponding to two <img src="media/image50.svg" />
values 4 and wideband), the UE shall use the value when receiving PDSCH
scheduled by the same DCI as follows:</p>
<p>- If the scheduled PRBs are contiguous and the size of the scheduled
PRBs is larger than <img src="media/image56.svg" />, <img
src="media/image50.svg" /> is the same as the scheduled bandwidth,
otherwise <img src="media/image50.svg" /> is set to the remaining
configured value of 2 or 4, respectively.</p>
<p>When receiving PDSCH scheduled by PDCCH with DCI format 1_1 with CRC
scrambled by C-RNTI, MCS-C-RNTI, or CS-RNTI, if the higher layer
parameter <em>prb-BundlingType</em> is set to 'staticBundling', the <img
src="media/image50.svg" /> value is configured with the single value
indicated by the higher layer parameter <em>bundleSize</em>.</p>
<p>When a UE is configured with nominal RBG size <span
class="math inline">\(P = 2\)</span> for bandwidth part <em>i</em>
according to Clause 5.1.2.2.1, or when a UE is configured with
interleaving unit of 2 for VRB to PRB mapping provided by the higher
layer parameter <em>vrb-ToPRB-Interleaver</em> given by
<em>PDSCH-Config</em> for bandwidth part <em>i</em>, the UE is not
expected to be configured with <img src="media/image50.svg" />= 4.</p>
<p>For a UE configured by the higher layer parameter
<em>repetitionScheme</em> set to 'fdmSchemeA<em>' or</em>
'fdmSchemeB<em>', and</em> when the UE is indicated with two TCI states
in a codepoint of the DCI field <em>'Transmission Configuration
Indication'</em> and DM-RS port(s) within one CDM group in the DCI field
'<em>Antenna Port(s)</em>',</p>
<p>- If <img src="media/image57.svg" /> is determined as "wideband", the
first <span class="math inline">\(\left\lceil \frac{n_{PRB}}{2}
\right\rceil\)</span> PRBs are assigned to the first TCI state and the
remaining <span class="math inline">\(\left\lfloor \frac{n_{PRB}}{2}
\right\rfloor\)</span> PRBs are assigned to the second TCI state, where
<span class="math inline">\(n_{PRB}\ \)</span>is the total number of
allocated PRBs for the UE.</p>
<p>- If <img src="media/image57.svg" /> is determined as one of the
values among {2, 4}, even PRGs within the allocated frequency domain
resources are assigned to the first TCI state and odd PRGs within the
allocated frequency domain resources are assigned to the second TCI
state, wherein the PRGs are numbered continuously in increasing order
with the first PRG index equal to 0.</p>
<p>- The UE is not expected to receive more than two PDSCH transmission
layers for each PDSCH transmission occasion.</p>
<p>For a UE configured by the higher layer parameter
<em>repetitionScheme</em> set to 'fdmSchemeB<em>',</em> and when the UE
is indicated with two TCI states in a codepoint of the DCI field
<em>'Transmission Configuration Indication'</em> and DM-RS port(s)
within one CDM group in the DCI field '<em>Antenna Port(s)',</em> each
PDSCH transmission occasion shall follow the Clause 7.3.1 of [4, TS
38.211] with the mapping to resource elements determined by the assigned
PRBs for corresponding TCI state of the PDSCH transmission occasion, and
the UE shall only expect at most two code blocks per PDSCH transmission
occasion when a single transmission layer is scheduled and a single code
block per PDSCH transmission occasion when two transmission layers are
scheduled. For two PDSCH transmission occasions, the redundancy version
to be applied is derived according to Table 5.1.2.1-2, where <span
class="math inline">\(n = 0,\ 1\)</span> are applied to the first and
second TCI state, respectively.</p>
<h3
id="modulation-order-target-code-rate-redundancy-version-and-transport-block-size-determination">5.1.3
Modulation order, target code rate, redundancy version and transport
block size determination</h3>
<p>To determine the modulation order, target code rate, and transport
block size(s) in the physical downlink shared channel, the UE shall
first</p>
<p>- read the 5-bit modulation and coding scheme field
(<em>I<sub>MCS</sub></em>) in the DCI to determine the modulation order
(<em>Q<sub>m</sub></em>) and target code rate (<em>R</em>) based on the
procedure defined in Clause 5.1.3.1, and</p>
<p>- read '<em>redundancy version'</em> field (<em>rv</em>) in the DCI
to determine the redundancy version.</p>
<p>and second</p>
<p>- the UE shall use the number of layers (ʋ), the total number of
allocated PRBs before rate matching (<em>n<sub>PRB</sub></em>) to
determine to the transport block size based on the procedure defined in
Clause 5.1.3.2.</p>
<p>The UE may skip decoding a transport block in an initial transmission
if the effective channel code rate is higher than 0.95, where the
effective channel code rate is defined as the number of downlink
information bits (including CRC bits) divided by the number of physical
channel bits on PDSCH.</p>
<p>When the UE is scheduled with multiple PDSCHs by a DCI, as described
in clause 5.1.2.1, the bits of <em>rv</em> field and NDI field,
respectively, in the DCI are one-to-one mapped to the scheduled PDSCH(s)
indicated by the TDRA information field with the corresponding transport
block(s) in the scheduled order, where the LSB bits of the <em>rv</em>
field and NDI field, respectively, correspond to the last scheduled
PDSCH indicated by the TDRA information field.</p>
<p>The UE is not expected to handle any transport blocks (TBs) in a 14
consecutive-symbol duration for normal CP (or 12 for extended CP) ending
at the last symbol of the latest PDSCH transmission within an active BWP
on a serving cell whenever</p>
<p><span class="math display">\[2^{max(0,\mu - \mu&#39;)}.\sum_{i \in
S}^{}{\left\lfloor \frac{C_{i}&#39;}{L_{i}} \right\rfloor x_{i}.F_{i}}
&gt; \left\lceil \frac{X}{4}
\right\rceil.\frac{1}{R_{LBRM}}.TBS_{LBRM}\]</span></p>
<p>where, for the serving cell,</p>
<p>- S is the set of TBs belonging to PDSCH(s) that are partially or
fully contained in the consecutive-symbol duration</p>
<p>- for the <em>i</em>th TB</p>
<p><em>- C<sub>i</sub>'</em> is the number of scheduled code blocks for
as defined in [5, 38.212].</p>
<p><em>- L<sub>i</sub></em> is the number of OFDM symbols assigned to
the PDSCH</p>
<p><em>- x<sub>i</sub></em> is the number of OFDM symbols of the PDSCH
contained in the consecutive-symbol duration</p>
<p>- <span class="math inline">\(F_{i} = \max_{j = 0,...,J -
1}{(\min{(k_{0,i}^{j} + E_{i}^{j},\ N_{cb,i})})}\)</span> based on the
values defined in Clause 5.4.2.1 [5, TS 38.212]</p>
<p>- <span class="math inline">\(k_{0,i}^{j}\)</span> is the starting
location of RV for the <span class="math inline">\(j\)</span>th
transmission</p>
<p>- <span class="math inline">\(E_{i\ }^{j} = \min{(E_{r})\
}\)</span>of the scheduled code blocks for the <span
class="math inline">\(jth\)</span> transmission</p>
<p>- <span class="math inline">\(N_{cb,i}\)</span> is the circular
buffer length</p>
<p>- <span class="math inline">\(J - 1\)</span> is the current
(re)transmission for the <em>i</em>th TB</p>
<p>- <span class="math inline">\(\mu&#39;\)</span> corresponds to the
subcarrier spacing of the BWP (across all configured BWPs of a carrier)
that has the largest configured number of PRBs</p>
<p>- in case there is more than one BWP corresponding to the largest
configured number of PRBs, <em>µ'</em> follows the BWP with the largest
subcarrier spacing.</p>
<p>- <span class="math inline">\(\mu\)</span> corresponds to the
subcarrier spacing of the active BWP</p>
<p>- R<sub>LBRM</sub> = 2/3 as defined in Clause 5.4.2.1 [5, TS
38.212]</p>
<blockquote>
<p>- TBS<sub>LBRM</sub> as defined based on the parameters for unicast
in Clause 5.4.2.1 [5, TS 38.212]</p>
</blockquote>
<p>- X as defined for downlink max MIMO layer for unicast in Clause
5.4.2.1 [5, TS 38.212].</p>
<p>If the UE skips decoding, the physical layer indicates to higher
layer that the transport block is not successfully decoded.</p>
<p>Within a cell group, a UE is not required to handle PDSCH(s)
transmissions including unicast and/or multicast/broadcast in slot
<em>s<sub>j</sub></em> in serving cell-<em>j</em>, and for <em>j</em> =
0,1,2.. <em>J-1</em>, slot <em>s<sub>j</sub></em> overlapping with any
given point in time, if the following condition is not satisfied at that
point in time:</p>
<p><span class="math display">\[\sum_{j = 0}^{J - 1}\frac{\sum_{m =
0}^{M - 1}V_{j,m}}{T_{slot}^{\mu(j)}} \leq DataRate\]</span></p>
<p>where,</p>
<p>- <em>J</em> is the number of configured serving cells belonging to a
frequency range</p>
<p>- for the <em>j-th</em> serving cell,</p>
<p><em>- M</em> is the number of TB(s) transmitted in slot
<em>s<sub>j</sub></em>. If there are two PDSCH transmission occasions of
the same TB (in time domain or in frequency domain) in the slot
<em>s<sub>j</sub></em>, each transmission occasion is counted
separately.</p>
<p><em>- T<sub>slot</sub><sup>μ(j)</sup></em>
=10<sup>-3</sup>/2<em><sup>μ(j)</sup></em>, where <em>μ(j)</em> is the
numerology for PDSCH(s) in slot <em>s<sub>j</sub></em> of the
<em>j</em>-th serving cell.</p>
<p>- for the <em>m</em>-th TB, <span class="math inline">\(V_{j,m} =
C&#39; \bullet \left\lfloor \frac{A}{C} \right\rfloor\)</span></p>
<p><em>- A</em> is the number of bits in the transport block as defined
in Clause 7.2.1 [5, TS 38.212]</p>
<p><em>- C</em> is the total number of code blocks for the transport
block defined in Clause 5.2.2 [5, TS 38.212].<span
class="math inline">\(\ \)</span></p>
<p><em>-</em> <span class="math inline">\(C&#39;\)</span> is the number
of scheduled code blocks for the transport block as defined in Clause
5.4.2.1 [5, TS 38.212]</p>
<p>- <span class="math inline">\(DataRate\)</span> [Mbps] is computed as
the maximum data rate summed over all the carriers in the frequency
range for any signaled band combination and feature set consistent with
the configured servings cells, where the data rate value is given by the
formula in Clause 4.1.2 in [13, TS 38.306], including the scaling factor
<em>f(i).</em></p>
<p>For a <em>j-</em>th serving cell, if higher layer parameter
<em>processingType2Enabled</em> of <em>PDSCH-ServingCellConfig</em> is
configured for the serving cell and set to '<em>enable',</em> or if at
least one <em>I<sub>MCS</sub> &gt;</em> <em>W</em> for a PDSCH for
unicast or multicast, where <em>W</em> = 28 for MCS tables 5.1.3.1-1 and
5.1.3.1-3, and <em>W</em> = 27 for MCS table 5.1.3.1-2, and <em>W</em> =
26 for MCS table 5.1.3.1-4, or for a j-th serving cell where UE supports
FDM-ed unicast and MBS PDSCH, the UE is not required to handle PDSCH
transmissions, if the following condition is not satisfied:</p>
<p><span class="math display">\[\frac{\sum_{m = 0}^{M - 1}V_{j,m}}{L
\times T_{s}^{\mu}} \leq DataRateCC\]</span></p>
<p>where</p>
<p>- <span class="math inline">\(L\ \)</span>is the number of symbols
assigned to the PDSCH(s). For a PDSCH that consists of two PDSCH
transmission occasions in time domain in one slot, <span
class="math inline">\(L\)</span> is the number of symbols of one
transmission occasion. For FDMed unicast and MBS PDSCHs in one slot,
<span class="math inline">\(L\)</span> is the total number of symbols of
the unicast and MBS PDSCHs with fully or partially-overlapped in time
domain.</p>
<p>- M is the number of TB(s) in the PDSCH(s)</p>
<p>- <span class="math inline">\(T_{s}^{\mu} = \frac{10^{- 3}}{{2^{\mu}
\bullet N}_{symb}^{slot}}\)</span> where <em>μ</em> is the numerology of
the PDSCH(s)</p>
<p>- for the <em>m</em>-th TB, <span class="math inline">\(V_{j,m} =
C&#39; \bullet \left\lfloor \frac{A}{C} \right\rfloor\)</span></p>
<p><em>- A</em> is the number of bits in the transport block as defined
in Clause 7.2.1 [5, TS 38.212]</p>
<p><em>- C</em> is the total number of code blocks for the transport
block defined in Clause 5.2.2 [5, TS 38.212]</p>
<p><em>-</em> <span class="math inline">\(C&#39;\)</span> is the number
of scheduled code blocks for the transport block as defined in Clause
5.4.2.1 [5, TS 38.212]</p>
<p>- <span class="math inline">\(DataRateCC\)</span> [Mbps] is computed
as the maximum data rate for a carrier in the frequency band of the
serving cell for any signaled band combination and feature set
consistent with the serving cell, where the data rate value is given by
the formula in Clause 4.1.2 in [13, TS 38.306], including the scaling
factor <em>f(i).</em></p>
<h4 id="modulation-order-and-target-code-rate-determination">5.1.3.1
Modulation order and target code rate determination</h4>
<p>For the PDSCH scheduled by a PDCCH with DCI format 1_0, format 1_1,
format 1_2, format 4_0, format 4_1 or format 4_2 with CRC scrambled by
C-RNTI, MCS-C-RNTI, TC-RNTI, CS-RNTI, SI-RNTI, RA-RNTI, MSGB-RNTI,
G-RNTI, G-CS-RNTI, MCCH-RNTI or P-RNTI, or for the PDSCH scheduled
without corresponding PDCCH transmissions using the
higher-layer-provided PDSCH configuration <em>SPS-Config</em>,</p>
<p>if the higher layer parameter <em>mcs-Table-r17</em> given by
<em>PDSCH-Config</em> is set to 'qam1024', and the PDSCH is scheduled by
a PDCCH with DCI format 1_1 with CRC scrambled by C-RNTI</p>
<p>- the UE shall use <em>I<sub>MCS</sub></em> and Table 5.1.3.1-4 to
determine the modulation order (<em>Q<sub>m</sub></em>) and Target code
rate (<em>R</em>) used in the physical downlink shared channel.</p>
<p>elseif <em>mcs-TableDCI-1-2-r17</em> given by <em>PDSCH-Config</em>
is set to 'qam1024', and the PDSCH is scheduled by a PDCCH with DCI
format 1_2 with CRC scrambled by C-RNTI</p>
<p>- the UE shall use <em>I<sub>MCS</sub></em> and Table 5.1.3.1-4 to
determine the modulation order (<em>Q<sub>m</sub></em>) and Target code
rate (<em>R</em>) used in the physical downlink shared channel.</p>
<p>elseif the higher layer parameter <em>mcs-TableDCI-1-2</em> given by
<em>PDSCH-Config</em> is set to 'qam256', and the PDSCH is scheduled by
a PDCCH with DCI format 1_2 with CRC scrambled by C-RNTI</p>
<p>- the UE shall use <em>I<sub>MCS</sub></em> and Table 5.1.3.1-2 to
determine the modulation order (<em>Q<sub>m</sub></em>) and Target code
rate (<em>R</em>) used in the physical downlink shared channel.</p>
<p>elseif the UE is not configured with MCS-C-RNTI, the higher layer
parameter <em>mcs-TableDCI-1-2</em> given by <em>PDSCH-Config</em> is
set to 'qam64LowSE', and the PDSCH is scheduled by a PDCCH with DCI
format 1_2 scrambled by C-RNTI</p>
<p>- the UE shall use <em>I<sub>MCS</sub></em> and Table 5.1.3.1-3 to
determine the modulation order (<em>Q<sub>m</sub></em>) and Target code
rate (<em>R</em>) used in the physical downlink shared channel.</p>
<p>elseif the higher layer parameter <em>mcs-Table</em> given by
<em>PDSCH-Config</em> is set to 'qam256', and the PDSCH is scheduled by
a PDCCH with DCI format 1_1 with CRC scrambled by C-RNTI</p>
<p>- the UE shall use <em>I<sub>MCS</sub></em> and Table 5.1.3.1-2 to
determine the modulation order (<em>Q<sub>m</sub></em>) and Target code
rate (<em>R</em>) used in the physical downlink shared channel.</p>
<p>elseif the higher layer parameter <em>mcs-Table</em> given by
<em>pdsch-ConfigMulticast</em> is set to 'qam256', and the PDSCH is
scheduled by a PDCCH with DCI format 4_1 or 4_2 with CRC scrambled by
G-RNTI for multicast</p>
<p>- the UE shall use <em>I<sub>MCS</sub></em> and Table 5.1.3.1-2 to
determine the modulation order (<em>Q<sub>m</sub></em>) and Target code
rate (<em>R</em>) used in the physical downlink shared channel.</p>
<p>elseif the higher layer parameter <em>mcs-Table</em> given by
<em>pdsch-ConfigMCCH and pdsch-ConfigMTCH</em> is set to 'qam256', and
the PDSCH is scheduled by a PDCCH with DCI format 4_0 with CRC scrambled
by MCCH-RNTI or G-RNTI for broadcast</p>
<p>- the UE shall use <em>I<sub>MCS</sub></em> and Table 5.1.3.1-2 to
determine the modulation order (<em>Q<sub>m</sub></em>) and Target code
rate (<em>R</em>) used in the physical downlink shared channel.</p>
<p>elseif the higher layer parameter <em>mcs-Table</em> given by
<em>pdsch-ConfigMulticast</em> is set to 'qam64LowSE', and the PDSCH is
scheduled by a PDCCH with DCI format 4_1 or 4_2 with CRC scrambled by
G-RNTI for multicast</p>
<p>- the UE shall use <em>I<sub>MCS</sub></em> and Table 5.1.3.1-3 to
determine the modulation order (<em>Q<sub>m</sub></em>) and Target code
rate (<em>R</em>) used in the physical downlink shared channel.</p>
<p>elseif the UE is not configured with MCS-C-RNTI, the higher layer
parameter <em>mcs-Table</em> given by <em>PDSCH-Config</em> is set to
'qam64LowSE', and the PDSCH is scheduled by a PDCCH with a DCI format
other than DCI format 1_2 in a UE-specific search space with CRC
scrambled by C-RNTI</p>
<p>- the UE shall use <em>I<sub>MCS</sub></em> and Table 5.1.3.1-3 to
determine the modulation order (<em>Q<sub>m</sub></em>) and Target code
rate (<em>R</em>) used in the physical downlink shared channel.</p>
<p>elseif the UE is configured with MCS-C-RNTI, and the PDSCH is
scheduled by a PDCCH with CRC scrambled by MCS-C-RNTI</p>
<p>- the UE shall use <em>I<sub>MCS</sub></em> and Table 5.1.3.1-3 to
determine the modulation order (<em>Q<sub>m</sub></em>) and Target code
rate (<em>R</em>) used in the physical downlink shared channel.</p>
<p>elseif the UE is not configured with the higher layer parameter
<em>mcs-Table</em> given by <em>SPS-config</em>, and the higher layer
parameter <em>mcs-Table-r17</em> given by <em>PDSCH-Config</em> is set
to 'qam1024',</p>
<p>- if the PDSCH is scheduled by a PDCCH with DCI format 1_1 with CRC
scrambled by CS-RNTI or</p>
<p>- if the PDSCH with SPS activated by DCI format 1_1 is scheduled
without corresponding PDCCH transmission using <em>SPS-Config</em>,</p>
<p>- the UE shall use <em>I<sub>MCS</sub></em> and Table 5.1.3.1-4 to
determine the modulation order (<em>Q<sub>m</sub></em>) and Target code
rate (<em>R</em>) used in the physical downlink shared channel.</p>
<p>elseif the UE is not configured with the higher layer parameter
<em>mcs-Table</em> given by <em>SPS-config</em>, and the higher layer
parameter <em>mcs-TableDCI-1-2-r17</em> given by <em>PDSCH-Config</em>
is set to 'qam1024',</p>
<p>- if the PDSCH is scheduled by a PDCCH with DCI format 1_2 with CRC
scrambled by CS-RNTI or</p>
<p>- if the PDSCH with SPS activated by DCI format 1_2 is scheduled
without corresponding PDCCH transmission using <em>SPS-Config</em>,</p>
<p>- the UE shall use <em>I<sub>MCS</sub></em> and Table 5.1.3.1-4 to
determine the modulation order (<em>Q<sub>m</sub></em>) and Target code
rate (<em>R</em>) used in the physical downlink shared channel.</p>
<p>elseif the UE is not configured with the higher layer parameter
<em>mcs-Table</em> given by <em>SPS-config</em>, and the higher layer
parameter <em>mcs-TableDCI-1-2</em> given by <em>PDSCH-Config</em> is
set to 'qam256',</p>
<p>- if the PDSCH is scheduled by a PDCCH with DCI format 1_2 with CRC
scrambled by CS-RNTI or</p>
<p>- if the PDSCH with SPS activated by DCI format 1_2 is scheduled
without corresponding PDCCH transmission using <em>SPS-Config</em>,</p>
<p>- the UE shall use <em>I<sub>MCS</sub></em> and Table 5.1.3.1-2 to
determine the modulation order (<em>Q<sub>m</sub></em>) and Target code
rate (<em>R</em>) used in the physical downlink shared channel.</p>
<p>elseif the UE is not configured with the higher layer parameter
<em>mcs-Table</em> given by <em>SPS-Config</em>, and the higher layer
parameter <em>mcs-Table</em> given by <em>PDSCH-Config</em> is set to
'qam256',</p>
<p>- if the PDSCH is scheduled by a PDCCH with DCI format 1_1 with CRC
scrambled by CS-RNTI or</p>
<p>- if the PDSCH with SPS activated by DCI format 1_1 is scheduled
without corresponding PDCCH transmission using <em>SPS-Config</em>,</p>
<p>- the UE shall use <em>I<sub>MCS</sub></em> and Table 5.1.3.1-2 to
determine the modulation order (<em>Q<sub>m</sub></em>) and Target code
rate (<em>R</em>) used in the physical downlink shared channel.</p>
<p>elseif the UE is configured with the higher layer parameter
<em>mcs-Table</em> given by <em>SPS-Config</em> set to 'qam64LowSE'</p>
<p>- if the PDSCH is scheduled by a PDCCH with CRC scrambled by CS-RNTI
or</p>
<p>- if the PDSCH is scheduled without corresponding PDCCH transmission
using <em>SPS-Config</em>,</p>
<p>- the UE shall use <em>I<sub>MCS</sub></em> and Table 5.1.3.1-3 to
determine the modulation order (<em>Q<sub>m</sub></em>) and Target code
rate (<em>R</em>) used in the physical downlink shared channel.</p>
<p>elseif the UE is configured with the higher layer parameter
<em>mcs-Table</em> given by <em>SPS-Config</em> or <em>mcs-Table</em> of
<em>pdsch-ConfigMulticast</em> in the same <em>CFR-ConfigMulticast</em>
set to 'qam64LowSE'</p>
<p>- if the GC-PDSCH is scheduled by a GC-PDCCH with CRC scrambled by
G-CS-RNTI or</p>
<p>- if the GC-PDSCH is scheduled without corresponding GC-PDCCH
transmission using <em>SPS-Config</em>,</p>
<p>- the UE shall use <em>I<sub>MCS</sub></em> and Table 5.1.3.1-3 to
determine the modulation order (<em>Q<sub>m</sub></em>) and Target code
rate (<em>R</em>) used in the physical downlink shared channel.</p>
<p>else</p>
<p>- the UE shall use <em>I<sub>MCS</sub></em> and Table 5.1.3.1-1 to
determine the modulation order (<em>Q<sub>m</sub></em>) and Target code
rate (<em>R</em>) used in the physical downlink shared channel.</p>
<p>end</p>
<p>The UE is not expected to decode a PDSCH scheduled with P-RNTI,
RA-RNTI, SI-RNTI and <em>Q<sub>m</sub></em> &gt; 2</p>
<p>For a UE configured with the higher layer parameter
<em>repetitionScheme</em> set to 'fdmSchemeB', and when the UE is
indicated with two TCI states in a codepoint of the DCI field
<em>'Transmission Configuration Indication'</em> and DM-RS port(s)
within one CDM group in the DCI field '<em>Antenna Port(s)</em>', the
determined modulation order of PDSCH transmission occasion associated
with the first TCI state is applied to the PDSCH transmission occasion
associated with the second TCI state.</p>
<p>Table 5.1.3.1-1: MCS index table 1 for PDSCH</p>
<table>
<colgroup>
<col style="width: 15%" />
<col style="width: 22%" />
<col style="width: 36%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr>
<th>MCS Index<br />
<em>I<sub>MCS</sub></em></th>
<th>Modulation Order<br />
<em>Q<sub>m</sub></em></th>
<th>Target code Rate <em>R</em> x [1024]</th>
<th><p>Spectral</p>
<p>efficiency</p></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>0</strong></td>
<td>2</td>
<td>120</td>
<td>0.2344</td>
</tr>
<tr>
<td><strong>1</strong></td>
<td>2</td>
<td>157</td>
<td>0.3066</td>
</tr>
<tr>
<td><strong>2</strong></td>
<td>2</td>
<td>193</td>
<td>0.3770</td>
</tr>
<tr>
<td><strong>3</strong></td>
<td>2</td>
<td>251</td>
<td>0.4902</td>
</tr>
<tr>
<td><strong>4</strong></td>
<td>2</td>
<td>308</td>
<td>0.6016</td>
</tr>
<tr>
<td><strong>5</strong></td>
<td>2</td>
<td>379</td>
<td>0.7402</td>
</tr>
<tr>
<td><strong>6</strong></td>
<td>2</td>
<td>449</td>
<td>0.8770</td>
</tr>
<tr>
<td><strong>7</strong></td>
<td>2</td>
<td>526</td>
<td>1.0273</td>
</tr>
<tr>
<td><strong>8</strong></td>
<td>2</td>
<td>602</td>
<td>1.1758</td>
</tr>
<tr>
<td><strong>9</strong></td>
<td>2</td>
<td>679</td>
<td>1.3262</td>
</tr>
<tr>
<td><strong>10</strong></td>
<td>4</td>
<td>340</td>
<td>1.3281</td>
</tr>
<tr>
<td><strong>11</strong></td>
<td>4</td>
<td>378</td>
<td>1.4766</td>
</tr>
<tr>
<td><strong>12</strong></td>
<td>4</td>
<td>434</td>
<td>1.6953</td>
</tr>
<tr>
<td><strong>13</strong></td>
<td>4</td>
<td>490</td>
<td>1.9141</td>
</tr>
<tr>
<td><strong>14</strong></td>
<td>4</td>
<td>553</td>
<td>2.1602</td>
</tr>
<tr>
<td><strong>15</strong></td>
<td>4</td>
<td>616</td>
<td>2.4063</td>
</tr>
<tr>
<td><strong>16</strong></td>
<td>4</td>
<td>658</td>
<td>2.5703</td>
</tr>
<tr>
<td><strong>17</strong></td>
<td>6</td>
<td>438</td>
<td>2.5664</td>
</tr>
<tr>
<td><strong>18</strong></td>
<td>6</td>
<td>466</td>
<td>2.7305</td>
</tr>
<tr>
<td><strong>19</strong></td>
<td>6</td>
<td>517</td>
<td>3.0293</td>
</tr>
<tr>
<td><strong>20</strong></td>
<td>6</td>
<td>567</td>
<td>3.3223</td>
</tr>
<tr>
<td><strong>21</strong></td>
<td>6</td>
<td>616</td>
<td>3.6094</td>
</tr>
<tr>
<td><strong>22</strong></td>
<td>6</td>
<td>666</td>
<td>3.9023</td>
</tr>
<tr>
<td><strong>23</strong></td>
<td>6</td>
<td>719</td>
<td>4.2129</td>
</tr>
<tr>
<td><strong>24</strong></td>
<td>6</td>
<td>772</td>
<td>4.5234</td>
</tr>
<tr>
<td><strong>25</strong></td>
<td>6</td>
<td>822</td>
<td>4.8164</td>
</tr>
<tr>
<td><strong>26</strong></td>
<td>6</td>
<td>873</td>
<td>5.1152</td>
</tr>
<tr>
<td><strong>27</strong></td>
<td>6</td>
<td>910</td>
<td>5.3320</td>
</tr>
<tr>
<td><strong>28</strong></td>
<td>6</td>
<td>948</td>
<td>5.5547</td>
</tr>
<tr>
<td><strong>29</strong></td>
<td>2</td>
<td colspan="2">reserved</td>
</tr>
<tr>
<td><strong>30</strong></td>
<td>4</td>
<td colspan="2">reserved</td>
</tr>
<tr>
<td><strong>31</strong></td>
<td>6</td>
<td colspan="2">reserved</td>
</tr>
</tbody>
</table>
<p>Table 5.1.3.1-2: MCS index table 2 for PDSCH</p>
<table style="width:100%;">
<colgroup>
<col style="width: 15%" />
<col style="width: 23%" />
<col style="width: 35%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr>
<th>MCS Index<br />
<em>I<sub>MCS</sub></em></th>
<th>Modulation Order<br />
<em>Q<sub>m</sub></em></th>
<th>Target code Rate <em>R</em> x [1024]</th>
<th><p>Spectral</p>
<p>efficiency</p></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>0</strong></td>
<td>2</td>
<td>120</td>
<td>0.2344</td>
</tr>
<tr>
<td><strong>1</strong></td>
<td>2</td>
<td>193</td>
<td>0.3770</td>
</tr>
<tr>
<td><strong>2</strong></td>
<td>2</td>
<td>308</td>
<td>0.6016</td>
</tr>
<tr>
<td><strong>3</strong></td>
<td>2</td>
<td>449</td>
<td>0.8770</td>
</tr>
<tr>
<td><strong>4</strong></td>
<td>2</td>
<td>602</td>
<td>1.1758</td>
</tr>
<tr>
<td><strong>5</strong></td>
<td>4</td>
<td>378</td>
<td>1.4766</td>
</tr>
<tr>
<td><strong>6</strong></td>
<td>4</td>
<td>434</td>
<td>1.6953</td>
</tr>
<tr>
<td><strong>7</strong></td>
<td>4</td>
<td>490</td>
<td>1.9141</td>
</tr>
<tr>
<td><strong>8</strong></td>
<td>4</td>
<td>553</td>
<td>2.1602</td>
</tr>
<tr>
<td><strong>9</strong></td>
<td>4</td>
<td>616</td>
<td>2.4063</td>
</tr>
<tr>
<td><strong>10</strong></td>
<td>4</td>
<td>658</td>
<td>2.5703</td>
</tr>
<tr>
<td><strong>11</strong></td>
<td>6</td>
<td>466</td>
<td>2.7305</td>
</tr>
<tr>
<td><strong>12</strong></td>
<td>6</td>
<td>517</td>
<td>3.0293</td>
</tr>
<tr>
<td><strong>13</strong></td>
<td>6</td>
<td>567</td>
<td>3.3223</td>
</tr>
<tr>
<td><strong>14</strong></td>
<td>6</td>
<td>616</td>
<td>3.6094</td>
</tr>
<tr>
<td><strong>15</strong></td>
<td>6</td>
<td>666</td>
<td>3.9023</td>
</tr>
<tr>
<td><strong>16</strong></td>
<td>6</td>
<td>719</td>
<td>4.2129</td>
</tr>
<tr>
<td><strong>17</strong></td>
<td>6</td>
<td>772</td>
<td>4.5234</td>
</tr>
<tr>
<td><strong>18</strong></td>
<td>6</td>
<td>822</td>
<td>4.8164</td>
</tr>
<tr>
<td><strong>19</strong></td>
<td>6</td>
<td>873</td>
<td>5.1152</td>
</tr>
<tr>
<td><strong>20</strong></td>
<td>8</td>
<td>682.5</td>
<td>5.3320</td>
</tr>
<tr>
<td><strong>21</strong></td>
<td>8</td>
<td>711</td>
<td>5.5547</td>
</tr>
<tr>
<td><strong>22</strong></td>
<td>8</td>
<td>754</td>
<td>5.8906</td>
</tr>
<tr>
<td><strong>23</strong></td>
<td>8</td>
<td>797</td>
<td>6.2266</td>
</tr>
<tr>
<td><strong>24</strong></td>
<td>8</td>
<td>841</td>
<td>6.5703</td>
</tr>
<tr>
<td><strong>25</strong></td>
<td>8</td>
<td>885</td>
<td>6.9141</td>
</tr>
<tr>
<td><strong>26</strong></td>
<td>8</td>
<td>916.5</td>
<td>7.1602</td>
</tr>
<tr>
<td><strong>27</strong></td>
<td>8</td>
<td>948</td>
<td>7.4063</td>
</tr>
<tr>
<td><strong>28</strong></td>
<td>2</td>
<td colspan="2">reserved</td>
</tr>
<tr>
<td><strong>29</strong></td>
<td>4</td>
<td colspan="2">reserved</td>
</tr>
<tr>
<td><strong>30</strong></td>
<td>6</td>
<td colspan="2">reserved</td>
</tr>
<tr>
<td><strong>31</strong></td>
<td>8</td>
<td colspan="2">reserved</td>
</tr>
</tbody>
</table>
<p>Table 5.1.3.1-3: MCS index table 3 for PDSCH</p>
<table>
<colgroup>
<col style="width: 15%" />
<col style="width: 22%" />
<col style="width: 34%" />
<col style="width: 27%" />
</colgroup>
<thead>
<tr>
<th>MCS Index<br />
<em>I<sub>MCS</sub></em></th>
<th>Modulation Order<br />
<em>Q<sub>m</sub></em></th>
<th>Target code Rate <em>R</em> x [1024]</th>
<th><p>Spectral</p>
<p>efficiency</p></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>0</strong></td>
<td>2</td>
<td>30</td>
<td>0.0586</td>
</tr>
<tr>
<td><strong>1</strong></td>
<td>2</td>
<td>40</td>
<td>0.0781</td>
</tr>
<tr>
<td><strong>2</strong></td>
<td>2</td>
<td>50</td>
<td>0.0977</td>
</tr>
<tr>
<td><strong>3</strong></td>
<td>2</td>
<td>64</td>
<td>0.1250</td>
</tr>
<tr>
<td><strong>4</strong></td>
<td>2</td>
<td>78</td>
<td>0.1523</td>
</tr>
<tr>
<td><strong>5</strong></td>
<td>2</td>
<td>99</td>
<td>0.1934</td>
</tr>
<tr>
<td><strong>6</strong></td>
<td>2</td>
<td>120</td>
<td> 0.2344</td>
</tr>
<tr>
<td><strong>7</strong></td>
<td>2</td>
<td>157</td>
<td> 0.3066</td>
</tr>
<tr>
<td><strong>8</strong></td>
<td>2</td>
<td>193</td>
<td> 0.3770</td>
</tr>
<tr>
<td><strong>9</strong></td>
<td>2</td>
<td>251</td>
<td> 0.4902</td>
</tr>
<tr>
<td><strong>10</strong></td>
<td>2</td>
<td>308</td>
<td> 0.6016</td>
</tr>
<tr>
<td><strong>11</strong></td>
<td>2</td>
<td>379</td>
<td> 0.7402</td>
</tr>
<tr>
<td><strong>12</strong></td>
<td>2</td>
<td>449</td>
<td> 0.8770</td>
</tr>
<tr>
<td><strong>13</strong></td>
<td>2</td>
<td>526</td>
<td> 1.0273</td>
</tr>
<tr>
<td><strong>14</strong></td>
<td>2</td>
<td>602</td>
<td> 1.1758</td>
</tr>
<tr>
<td><strong>15</strong></td>
<td>4</td>
<td>340</td>
<td> 1.3281</td>
</tr>
<tr>
<td><strong>16</strong></td>
<td>4</td>
<td>378</td>
<td>1.4766</td>
</tr>
<tr>
<td><strong>17</strong></td>
<td>4</td>
<td>434</td>
<td> 1.6953</td>
</tr>
<tr>
<td><strong>18</strong></td>
<td>4</td>
<td>490</td>
<td> 1.9141</td>
</tr>
<tr>
<td><strong>19</strong></td>
<td>4</td>
<td>553</td>
<td> 2.1602</td>
</tr>
<tr>
<td><strong>20</strong></td>
<td>4</td>
<td>616</td>
<td> 2.4063</td>
</tr>
<tr>
<td><strong>21</strong></td>
<td>6</td>
<td>438</td>
<td> 2.5664</td>
</tr>
<tr>
<td><strong>22</strong></td>
<td>6</td>
<td>466</td>
<td> 2.7305</td>
</tr>
<tr>
<td><strong>23</strong></td>
<td>6</td>
<td>517</td>
<td> 3.0293</td>
</tr>
<tr>
<td><strong>24</strong></td>
<td>6</td>
<td>567</td>
<td> 3.3223</td>
</tr>
<tr>
<td><strong>25</strong></td>
<td>6</td>
<td>616</td>
<td> 3.6094</td>
</tr>
<tr>
<td><strong>26</strong></td>
<td>6</td>
<td>666</td>
<td> 3.9023</td>
</tr>
<tr>
<td><strong>27</strong></td>
<td>6</td>
<td>719</td>
<td> 4.2129</td>
</tr>
<tr>
<td><strong>28</strong></td>
<td>6</td>
<td>772</td>
<td> 4.5234</td>
</tr>
<tr>
<td><strong>29</strong></td>
<td>2</td>
<td colspan="2">reserved</td>
</tr>
<tr>
<td><strong>30</strong></td>
<td>4</td>
<td colspan="2">reserved</td>
</tr>
<tr>
<td><strong>31</strong></td>
<td>6</td>
<td colspan="2">reserved</td>
</tr>
</tbody>
</table>
<p>Table 5.1.3.1-4: MCS index table 4 for PDSCH</p>
<table>
<colgroup>
<col style="width: 15%" />
<col style="width: 23%" />
<col style="width: 34%" />
<col style="width: 26%" />
</colgroup>
<thead>
<tr>
<th><u>MCS Index<br />
<em>I<sub>MCS</sub></em></u></th>
<th><u>Modulation Order<br />
<em>Q<sub>m</sub></em></u></th>
<th><u>Target code Rate <em>R</em> x [1024]</u></th>
<th><p><u>Spectral</u></p>
<p><u>efficiency</u></p></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong><u>0</u></strong></td>
<td><u>2</u></td>
<td><u>120</u></td>
<td><u>0.2344</u></td>
</tr>
<tr>
<td><strong><u>1</u></strong></td>
<td><u>2</u></td>
<td><u>193</u></td>
<td><u>0.3770</u></td>
</tr>
<tr>
<td><strong><u>2</u></strong></td>
<td><u>2</u></td>
<td><u>449</u></td>
<td><u>0.8770</u></td>
</tr>
<tr>
<td><strong><u>3</u></strong></td>
<td><u>4</u></td>
<td><u>378</u></td>
<td><u>1.4766</u></td>
</tr>
<tr>
<td><strong><u>4</u></strong></td>
<td><u>4</u></td>
<td><u>490</u></td>
<td><u>1.9141</u></td>
</tr>
<tr>
<td><strong><u>5</u></strong></td>
<td><u>4</u></td>
<td><u>616</u></td>
<td><u>2.4063</u></td>
</tr>
<tr>
<td><strong><u>6</u></strong></td>
<td><u>6</u></td>
<td><u>466</u></td>
<td><u>2.7305</u></td>
</tr>
<tr>
<td><strong><u>7</u></strong></td>
<td><u>6</u></td>
<td><u>517</u></td>
<td><u>3.0293</u></td>
</tr>
<tr>
<td><strong><u>8</u></strong></td>
<td><u>6</u></td>
<td><u>567</u></td>
<td><u>3.3223</u></td>
</tr>
<tr>
<td><strong><u>9</u></strong></td>
<td><u>6</u></td>
<td><u>616</u></td>
<td><u>3.6094</u></td>
</tr>
<tr>
<td><strong><u>10</u></strong></td>
<td><u>6</u></td>
<td><u>666</u></td>
<td><u>3.9023</u></td>
</tr>
<tr>
<td><strong><u>11</u></strong></td>
<td><u>6</u></td>
<td><u>719</u></td>
<td><u>4.2129</u></td>
</tr>
<tr>
<td><strong><u>12</u></strong></td>
<td><u>6</u></td>
<td><u>772</u></td>
<td><u>4.5234</u></td>
</tr>
<tr>
<td><strong><u>13</u></strong></td>
<td><u>6</u></td>
<td><u>822</u></td>
<td><u>4.8164</u></td>
</tr>
<tr>
<td><strong><u>14</u></strong></td>
<td><u>6</u></td>
<td><u>873</u></td>
<td><u>5.1152</u></td>
</tr>
<tr>
<td><strong><u>15</u></strong></td>
<td><u>8</u></td>
<td><u>682.5</u></td>
<td><u>5.3320</u></td>
</tr>
<tr>
<td><strong><u>16</u></strong></td>
<td><u>8</u></td>
<td><u>711</u></td>
<td><u>5.5547</u></td>
</tr>
<tr>
<td><strong><u>17</u></strong></td>
<td><u>8</u></td>
<td><u>754</u></td>
<td><u>5.8906</u></td>
</tr>
<tr>
<td><strong><u>18</u></strong></td>
<td><u>8</u></td>
<td><u>797</u></td>
<td><u>6.2266</u></td>
</tr>
<tr>
<td><strong><u>19</u></strong></td>
<td><u>8</u></td>
<td><u>841</u></td>
<td><u>6.5703</u></td>
</tr>
<tr>
<td><strong><u>20</u></strong></td>
<td><u>8</u></td>
<td><u>885</u></td>
<td><u>6.9141</u></td>
</tr>
<tr>
<td><strong><u>21</u></strong></td>
<td><u>8</u></td>
<td><u>916.5</u></td>
<td><u>7.1602</u></td>
</tr>
<tr>
<td><strong><u>22</u></strong></td>
<td><u>8</u></td>
<td><u>948</u></td>
<td><u>7.4063</u></td>
</tr>
<tr>
<td><strong><u>23</u></strong></td>
<td><u>10</u></td>
<td><u>805.5</u></td>
<td><u>7.8662</u></td>
</tr>
<tr>
<td><strong><u>24</u></strong></td>
<td><u>10</u></td>
<td><u>853</u></td>
<td><u>8.3301</u></td>
</tr>
<tr>
<td><strong><u>25</u></strong></td>
<td><u>10</u></td>
<td><u>900.5</u></td>
<td><u>8.7939</u></td>
</tr>
<tr>
<td><strong><u>26</u></strong></td>
<td><u>10</u></td>
<td><u>948</u></td>
<td><u>9.2578</u></td>
</tr>
<tr>
<td><strong><u>27</u></strong></td>
<td><u>2</u></td>
<td colspan="2"><u>reserved</u></td>
</tr>
<tr>
<td><strong><u>28</u></strong></td>
<td><u>4</u></td>
<td colspan="2"><u>reserved</u></td>
</tr>
<tr>
<td><strong><u>29</u></strong></td>
<td><u>6</u></td>
<td colspan="2"><u>reserved</u></td>
</tr>
<tr>
<td><strong><u>30</u></strong></td>
<td><u>8</u></td>
<td colspan="2"><u>reserved</u></td>
</tr>
<tr>
<td><strong><u>31</u></strong></td>
<td><u>10</u></td>
<td colspan="2"><u>reserved</u></td>
</tr>
</tbody>
</table>
<h4 id="transport-block-size-determination">5.1.3.2 Transport block size
determination</h4>
<p>In case the higher layer parameter
<em>maxNrofCodeWordsScheduledByDCI</em> in <em>PDSCH-config</em>
indicates that two codeword transmission is enabled, then one of the two
transport blocks is disabled by DCI format 1_1 if <em>I<sub>MCS
</sub></em>= 26 and if <em>rv<sub>id</sub></em> = 1 for the
corresponding transport block. In case the higher layer parameter
<em>maxNrofCodeWordsScheduledByDCI</em> in
<em>pdsch-ConfigMulticast</em> indicates that two codeword transmission
is enabled, then one of the two transport blocks is disabled by DCI
format 4_2 if <em>I<sub>MCS </sub></em>= 26 and if
<em>rv<sub>id</sub></em> = 1 for the corresponding transport block. When
the UE is configured with higher layer parameter
<em>pdsch-TimeDomainAllocationListForMultiPDSCH</em>, either the first
or the second transport block of all scheduled PDSCHs is disabled by the
DCI format 1_1 if <em>I<sub>MCS </sub></em>= 26 and if
<em>rv<sub>id</sub></em> = 2 for the corresponding transport block of
all scheduled PDSCHs. If both transport blocks are enabled, transport
block 1 and 2 are mapped to codeword 0 and 1 respectively. If only one
transport block is enabled, then the enabled transport block is always
mapped to the first codeword.</p>
<p>For the PDSCH assigned by a PDCCH with DCI format 1_0, 1_1, 4_0, 4_1,
4_2 or 1_2 with CRC scrambled by C-RNTI, MCS-C-RNTI, TC-RNTI, CS-RNTI,
G-RNTI, G-CS-RNTI, MCCH-RNTI or SI-RNTI, if Table 5.1.3.1-2 is used and
<img src="media/image58.svg" /><span class="math inline">\(0\  \leq \
I_{MCS\ } \leq 27\)</span><em>,</em> else if Table 5.1.3.1-4 is used and
<span class="math inline">\(0 \leq I_{MCS} \leq 26\)</span> or a table
other than Table 5.1.3.1-2 and Table 5.1.3.1-4 is used and <img
src="media/image59.svg" /><span class="math inline">\(0\  \leq \ I_{MCS\
} \leq 28\)</span><em>,</em> the UE shall, except if the transport block
is disabled in DCI format 1_1, first determine the TBS as specified
below:</p>
<p>1) The UE shall first determine the number of REs
(<em>N<sub>RE</sub></em>) <span
class="math inline">\(N_{RE})\)</span>within the slot.</p>
<p>- A UE first determines the number of REs allocated for PDSCH within
a PRB (<img src="media/image60.svg" />) by <img
src="media/image61.svg" />, where<img src="media/image62.svg" /> is the
number of subcarriers in a physical resource block, <img
src="media/image63.svg" /><span
class="math inline">\(N_{symb}^{slot}\)</span> is the number of symbols
of the PDSCH allocation within the slot, <img
src="media/image64.svg" /><span
class="math inline">\(N_{DMRS}^{PRB}\)</span> is the number of REs for
DM-RS per PRB in the scheduled duration including the overhead of the
DM-RS CDM groups without data, as indicated by DCI format 1_1 or format
1_2 or as described for format 1_0 in Clause 5.1.6.2, and <img
src="media/image65.svg" /> <span
class="math inline">\(N_{oh}^{PRB}\)</span>is the overhead configured by
higher layer parameter <em>xOverhead</em> in
<em>PDSCH-ServingCellConfig</em>. If the <em>xOverhead</em> in
<em>PDSCH-ServingCellconfig</em> is not configured (a value from 6, 12,
or 18), the <img src="media/image65.svg" /> is set to 0. If the PDSCH is
scheduled by PDCCH with a CRC scrambled by SI-RNTI, RA-RNTI, MSGB-RNTI
or P-RNTI, <span class="math inline">\(N_{oh}^{PRB}\)</span> is assumed
to be 0. If the PDSCH is scheduled by PDCCH with a CRC scrambled by
G-RNTI for multicast or G-CS-RNTI or PDSCH without PDCCH is activated by
PDCCH with a CRC scrambled by G-CS-RNTI, <span
class="math inline">\(N_{oh}^{PRB}\)</span> <span
class="math inline">\(N_{oh}^{PRB}\)</span>is the overhead configured by
higher layer parameter <em>xOverhead-Multicast</em> in
<em>pdsch-ConfigMulticast</em>. If the <em>xOverhead-Multicast</em> in
<em>pdsch-ConfigMulticast</em> is not configured, the <span
class="math inline">\(N_{oh}^{PRB}\)</span> is set to 0. If the PDSCH is
scheduled by PDCCH with a CRC scrambled by G-RNTI for broadcast or
MCCH-RNTI, <span class="math inline">\(N_{oh}^{PRB}\)</span> <span
class="math inline">\(N_{oh}^{PRB}\)</span>is the overhead configured by
higher layer parameter <em>xOverhead</em> in
<em>pdsch-ConfigBroadcast</em>. If the <em>xOverhead</em> in <em>pdsch-
ConfigBroadcast</em> is not configured, the <span
class="math inline">\(N_{oh}^{PRB}\)</span> is set to 0.</p>
<p>- A UE determines the total number of REs allocated for PDSCH (<img
src="media/image66.svg" />)<span class="math inline">\(N_{RE})\)</span>
by <img src="media/image67.svg" /><span class="math inline">\(N_{RE} = \
{\overline{N}}_{RE}&#39;*\ n_{PRB}\)</span>, where
<em>n<sub>PRB</sub></em> is the total number of allocated PRBs for the
UE.</p>
<p>2) Unquantized intermediate variable (<em>N<sub>info</sub></em>)
<span class="math inline">\({TBS}_{temp})\ \)</span>is obtained by <img
src="media/image68.svg" /><span class="math inline">\({TBS}_{temp} = \
N_{RE}*R*Q_{m}*ʋ\)</span>.</p>
<p>If <img src="media/image69.svg" /></p>
<p>Use step 3 as the next step of the TBS determination</p>
<p>else</p>
<p>Use step 4 as the next step of the TBS determination</p>
<p>end if</p>
<p>3) When <img src="media/image69.svg" />, TBS is determined as
follows</p>
<p>- quantized intermediate number of information bits <img
src="media/image70.svg" />, where <img src="media/image71.svg" />.</p>
<p>- use Table 5.1.3.2-1 find the closest TBS that is not less than <img
src="media/image72.svg" />.</p>
<p>Table 5.1.3.2-1: TBS for <img src="media/image69.svg" /></p>
<table style="width:100%;">
<colgroup>
<col style="width: 13%" />
<col style="width: 13%" />
<col style="width: 12%" />
<col style="width: 12%" />
<col style="width: 12%" />
<col style="width: 12%" />
<col style="width: 12%" />
<col style="width: 12%" />
</colgroup>
<thead>
<tr>
<th>Index</th>
<th>TBS</th>
<th>Index</th>
<th>TBS</th>
<th>Index</th>
<th>TBS</th>
<th>Index</th>
<th>TBS</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>24</td>
<td>31</td>
<td>336</td>
<td>61</td>
<td>1288</td>
<td>91</td>
<td>3624</td>
</tr>
<tr>
<td>2</td>
<td>32</td>
<td>32</td>
<td>352</td>
<td>62</td>
<td>1320</td>
<td>92</td>
<td>3752</td>
</tr>
<tr>
<td>3</td>
<td>40</td>
<td>33</td>
<td>368</td>
<td>63</td>
<td>1352</td>
<td>93</td>
<td>3824</td>
</tr>
<tr>
<td>4</td>
<td>48</td>
<td>34</td>
<td>384</td>
<td>64</td>
<td>1416</td>
<td></td>
<td></td>
</tr>
<tr>
<td>5</td>
<td>56</td>
<td>35</td>
<td>408</td>
<td>65</td>
<td>1480</td>
<td></td>
<td></td>
</tr>
<tr>
<td>6</td>
<td>64</td>
<td>36</td>
<td>432</td>
<td>66</td>
<td>1544</td>
<td></td>
<td></td>
</tr>
<tr>
<td>7</td>
<td>72</td>
<td>37</td>
<td>456</td>
<td>67</td>
<td>1608</td>
<td></td>
<td></td>
</tr>
<tr>
<td>8</td>
<td>80</td>
<td>38</td>
<td>480</td>
<td>68</td>
<td>1672</td>
<td></td>
<td></td>
</tr>
<tr>
<td>9</td>
<td>88</td>
<td>39</td>
<td>504</td>
<td>69</td>
<td>1736</td>
<td></td>
<td></td>
</tr>
<tr>
<td>10</td>
<td>96</td>
<td>40</td>
<td>528</td>
<td>70</td>
<td>1800</td>
<td></td>
<td></td>
</tr>
<tr>
<td>11</td>
<td>104</td>
<td>41</td>
<td>552</td>
<td>71</td>
<td>1864</td>
<td></td>
<td></td>
</tr>
<tr>
<td>12</td>
<td>112</td>
<td>42</td>
<td>576</td>
<td>72</td>
<td>1928</td>
<td></td>
<td></td>
</tr>
<tr>
<td>13</td>
<td>120</td>
<td>43</td>
<td>608</td>
<td>73</td>
<td>2024</td>
<td></td>
<td></td>
</tr>
<tr>
<td>14</td>
<td>128</td>
<td>44</td>
<td>640</td>
<td>74</td>
<td>2088</td>
<td></td>
<td></td>
</tr>
<tr>
<td>15</td>
<td>136</td>
<td>45</td>
<td>672</td>
<td>75</td>
<td>2152</td>
<td></td>
<td></td>
</tr>
<tr>
<td>16</td>
<td>144</td>
<td>46</td>
<td>704</td>
<td>76</td>
<td>2216</td>
<td></td>
<td></td>
</tr>
<tr>
<td>17</td>
<td>152</td>
<td>47</td>
<td>736</td>
<td>77</td>
<td>2280</td>
<td></td>
<td></td>
</tr>
<tr>
<td>18</td>
<td>160</td>
<td>48</td>
<td>768</td>
<td>78</td>
<td>2408</td>
<td></td>
<td></td>
</tr>
<tr>
<td>19</td>
<td>168</td>
<td>49</td>
<td>808</td>
<td>79</td>
<td>2472</td>
<td></td>
<td></td>
</tr>
<tr>
<td>20</td>
<td>176</td>
<td>50</td>
<td>848</td>
<td>80</td>
<td>2536</td>
<td></td>
<td></td>
</tr>
<tr>
<td>21</td>
<td>184</td>
<td>51</td>
<td>888</td>
<td>81</td>
<td>2600</td>
<td></td>
<td></td>
</tr>
<tr>
<td>22</td>
<td>192</td>
<td>52</td>
<td>928</td>
<td>82</td>
<td>2664</td>
<td></td>
<td></td>
</tr>
<tr>
<td>23</td>
<td>208</td>
<td>53</td>
<td>984</td>
<td>83</td>
<td>2728</td>
<td></td>
<td></td>
</tr>
<tr>
<td>24</td>
<td>224</td>
<td>54</td>
<td>1032</td>
<td>84</td>
<td>2792</td>
<td></td>
<td></td>
</tr>
<tr>
<td>25</td>
<td>240</td>
<td>55</td>
<td>1064</td>
<td>85</td>
<td>2856</td>
<td></td>
<td></td>
</tr>
<tr>
<td>26</td>
<td>256</td>
<td>56</td>
<td>1128</td>
<td>86</td>
<td>2976</td>
<td></td>
<td></td>
</tr>
<tr>
<td>27</td>
<td>272</td>
<td>57</td>
<td>1160</td>
<td>87</td>
<td>3104</td>
<td></td>
<td></td>
</tr>
<tr>
<td>28</td>
<td>288</td>
<td>58</td>
<td>1192</td>
<td>88</td>
<td>3240</td>
<td></td>
<td></td>
</tr>
<tr>
<td>29</td>
<td>304</td>
<td>59</td>
<td>1224</td>
<td>89</td>
<td>3368</td>
<td></td>
<td></td>
</tr>
<tr>
<td>30</td>
<td>320</td>
<td>60</td>
<td>1256</td>
<td>90</td>
<td>3496</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>4) When <img src="media/image73.svg" />, TBS is determined as
follows.</p>
<p>- quantized intermediate number of information bits <img
src="media/image74.svg" />, where <img src="media/image75.svg" />and
ties in the round function are broken towards the next largest
integer.</p>
<p>- if <img src="media/image76.svg" /></p>
<p><img src="media/image77.svg" />, where <img
src="media/image78.svg" /></p>
<p>else</p>
<p>if <img src="media/image79.svg" /></p>
<p><img src="media/image80.svg" />, where <img
src="media/image81.svg" /></p>
<p>else</p>
<p><img src="media/image82.svg" /></p>
<p>end if</p>
<p>end if</p>
<p>else if Table 5.1.3.1-2 is used and <img
src="media/image83.svg" /><em>,</em></p>
<p>- the TBS is assumed to be as determined from the DCI transported in
the latest PDCCH for the same transport block using <img
src="media/image58.svg" /><span class="math inline">\(0\  \leq \ I_{MCS\
} \leq 27\)</span>. If there is no PDCCH for the same transport block
using <img src="media/image58.svg" /><span
class="math inline">\(0\  \leq \ I_{MCS\ } \leq 27\)</span>, and if the
initial PDSCH for the same transport block is semi-persistently
scheduled, the TBS shall be determined from the most recent
semi-persistent scheduling assignment PDCCH.</p>
<p>else if Table 5.1.3.1-4 is used and <span class="math inline">\(27
\leq I_{MCS} \leq 31\)</span><em>,</em></p>
<p>- the TBS is assumed to be as determined from the DCI transported in
the latest PDCCH for the same transport block using <span
class="math inline">\(0 \leq I_{MCS} \leq 26\)</span><span
class="math inline">\(0\  \leq \ I_{MCS\ } \leq 27\)</span>. If there is
no PDCCH for the same transport block using <span
class="math inline">\(0 \leq I_{MCS} \leq 26\)</span><span
class="math inline">\(0\  \leq \ I_{MCS\ } \leq 27\)</span>, and if the
initial PDSCH for the same transport block is semi-persistently
scheduled, the TBS shall be determined from the most recent
semi-persistent scheduling assignment PDCCH.</p>
<p>else</p>
<p>- the TBS is assumed to be as determined from the DCI transported in
the latest PDCCH for the same transport block using <img
src="media/image84.svg" /><span class="math inline">\(0\  \leq \ I_{MCS\
} \leq 28\)</span>. If there is no PDCCH for the same transport block
using<img src="media/image85.svg" /><span class="math inline">\(\
0\  \leq \ I_{MCS\ } \leq 28\)</span>, and if the initial PDSCH for the
same transport block is semi-persistently scheduled, the TBS shall be
determined from the most recent semi-persistent scheduling assignment
PDCCH.</p>
<p>The UE is not expected to receive a PDSCH assigned by a PDCCH with
CRC scrambled by SI-RNTI with a TBS exceeding 2976 bits.</p>
<p>For a UE configured with the higher layer parameter
<em>repetitionScheme</em> set to 'fdmSchemeB' and indicated with two TCI
states in a codepoint of the DCI field <em>'Transmission Configuration
Indication'</em> and DM-RS port(s) within one CDM group in the DCI field
'<em>Antenna Port(s)</em>', the TBS determination follows the steps 1-4
with the following modification in step 1: a UE determines the total
number of REs allocated for PDSCH (<img src="media/image66.svg" />)<span
class="math inline">\(N_{RE})\)</span> by <img
src="media/image67.svg" /><span class="math inline">\(N_{RE} = \
{\overline{N}}_{RE}&#39;*\ n_{PRB}\)</span>, where
<em>n<sub>PRB</sub></em> is the total number of allocated PRBs
corresponding to the first TCI state, and the determined TBS of PDSCH
transmission occasion associated with the first TCI state is also
applied to the PDSCH transmission occasion associated with the second
TCI state. For a UE configured with the higher layer parameter
<em>repetitionScheme</em> set to 'tdmSchemeA' and indicated with two TCI
states in a codepoint of the DCI field <em>'Transmission Configuration
Indication'</em> and DM-RS port(s) within one CDM group in the DCI field
'<em>Antenna Port(s)</em>', the TBS determination follows the steps 1-4
with the following modification in step 1: a UE determines the number of
REs allocated for PDSCH within a PRB (<img src="media/image60.svg" />)
by <img src="media/image61.svg" />, where <img
src="media/image63.svg" /> is the number of symbols of the PDSCH
allocation within the slot corresponding to the first TCI state, and the
determined TBS of PDSCH transmission occasion associated with the first
TCI state is also applied to the PDSCH transmission occasion associated
with the second TCI state.</p>
<p>For the PDSCH assigned by a PDCCH with DCI format 1_0 with CRC
scrambled by P-RNTI, or RA-RNTI, MsgB-RNTI, TBS determination follows
the steps 1-4 with the following modification in step 2: a scaling <img
src="media/image86.svg" /> is applied in the calculation of
<em>N<sub>info</sub></em>, where the scaling factor is determined based
on the <em>TB scaling</em> field in the DCI as in Table 5.1.3.2-2.</p>
<p>Table 5.1.3.2-2: Scaling factor of <em>N<sub>info</sub></em> for
P-RNTI, RA-RNTI and MSGB-RNTI</p>
<table>
<colgroup>
<col style="width: 54%" />
<col style="width: 45%" />
</colgroup>
<thead>
<tr>
<th>TB scaling field</th>
<th>Scaling factor S</th>
</tr>
</thead>
<tbody>
<tr>
<td>00</td>
<td>1</td>
</tr>
<tr>
<td>01</td>
<td>0.5</td>
</tr>
<tr>
<td>10</td>
<td>0.25</td>
</tr>
<tr>
<td>11</td>
<td></td>
</tr>
</tbody>
</table>
<p>The NDI and HARQ process ID, as signalled on PDCCH, and the TBS, as
determined above, shall be reported to higher layers.</p>
<h3 id="pdsch-resource-mapping">5.1.4 PDSCH resource mapping</h3>
<p>When receiving the PDSCH scheduled with SI-RNTI and the system
information indicator in DCI is set to 0, the UE shall assume that no
SS/PBCH block is transmitted in REs used by the UE for a reception of
the PDSCH.</p>
<p>When receiving the PDSCH scheduled with SI-RNTI and the system
information indicator in DCI is set to 1, RA-RNTI, MSGB-RNTI, P-RNTI or
TC-RNTI, the UE assumes SS/PBCH block transmission according to
<em>ssb-PositionsInBurst</em>, and if the PDSCH resource allocation
overlaps with PRBs containing SS/PBCH block transmission resources the
UE shall assume that the PRBs containing SS/PBCH block transmission
resources are not available for PDSCH in the OFDM symbols where SS/PBCH
block is transmitted.</p>
<p>A UE expects a configuration provided by
<em>ssb-PositionsInBurst</em> in <em>ServingCellConfigCommon</em> to be
same as a configuration provided by <em>ssb-PositionsInBurst</em> in
<em>SIB1</em>.</p>
<p>When receiving PDSCH scheduled by PDCCH with CRC scrambled by C-RNTI,
MCS-C-RNTI, CS-RNTI, G-RNTI, G-CS-RNTI, MCCH-RNTI or PDSCHs with SPS,
the REs corresponding to the configured or dynamically indicated
resources in Clauses 5.1.4.1, 5.1.4.2 are not available for PDSCH.
Furthermore, the UE assumes SS/PBCH block transmission according to
<em>ssb-PositionsInBurst</em> if the PDSCH resource allocation overlaps
with PRBs containing SS/PBCH block transmission resources, and the UE
shall assume that the PRBs containing SS/PBCH block transmission
resources are not available for PDSCH in the OFDM symbols where SS/PBCH
block associated with the same PCI is transmitted.</p>
<p>A UE is not expected to handle the case where PDSCH DM-RS REs are
overlapping, even partially, with any RE(s) not available for
PDSCH<em>.</em></p>
<p>For operation with shared spectrum channel access, SS/PBCH block
transmission according to <em>ssb-PositionsInBurst</em> represents all
of the candidate SS/PBCH blocks corresponding to SS/PBCH block indices
provided by <em>ssb-PositionsInBurst</em> as described in Clause 4.1 of
[6, TS 38.213].</p>
<h4 id="pdsch-resource-mapping-with-rb-symbol-level-granularity">5.1.4.1
PDSCH resource mapping with RB symbol level granularity</h4>
<p>The procedures for PDSCH scheduled by PDCCH with DCI format 1_1
described in this clause equally apply to PDSCH scheduled by PDCCH with
DCI format 1_2, by applying only the parameters of
<em>rateMatchPatternGroup1DCI-1-2</em>,
<em>rateMatchPatternGroup2DCI-1-2</em> instead of
<em>rateMatchPatternGroup1</em> and <em>rateMatchPatternGroup2</em>. The
procedures for PDSCH scheduled by PDCCH with DCI format 1_0 described in
this clause equally apply to PDSCH scheduled by PDCCH with DCI format
4_0, by applying only the parameters of
<em>rateMatchPatternToAddModList</em> configured in
<em>pdsch-ConfigMCCH</em> or <em>pdsch-ConfigMTCH</em>.</p>
<p>The procedures for PDSCH scheduled by PDCCH with DCI format 1_0
described in this clause equally apply to PDSCH scheduled by PDCCH with
DCI format 4_1, and the procedures for PDSCH scheduled by DCI format 1_1
described in this clause equally apply to PDSCH scheduled by PDCCH with
DCI format 4_2 by applying only the parameters of
<em>rateMatchPatternToAddModList, rateMatchPatternGroup1</em> and
<em>rateMatchPatternGroup2</em> configured in
<em>pdsch-ConfigMulticast</em>.</p>
<p>A UE may be configured with any of the following higher layer
parameters indicating REs declared as not available for PDSCH:</p>
<p>- <em>rateMatchPatternToAddModList</em> given by
<em>PDSCH-Config</em>, by <em>pdsch-ConfigMulticast</em>, by
<em>ServingCellConfig</em> or by <em>ServingCellConfigCommon</em>, or by
<em>pdsch-ConfigMCCH</em> or <em>pdsch-ConfigMTCH</em> and configuring
up to 4 <em>RateMatchPattern(s)</em> per BWP and up to 4
<em>RateMatchPattern(s)</em> per serving-cell. The
<em>RateMatchPatterns</em> configured for MBS multicast are counted into
the ones that are configured per BWP. The <em>RateMatchPattern(s)</em>
configured for MBS broadcast is counted into the ones that are
configured per serving-cell. A <em>RateMatchPattern</em> may
contain:</p>
<p>- within a BWP, when provided by <em>PDSCH-Config</em> or
<em>pdsch-ConfigMulticast</em> or within a serving cell when provided by
<em>ServingCellConfig</em> or <em>ServingCellConfigCommon</em>, or by
<em>pdsch-ConfigMCCH</em> or <em>pdsch-ConfigMTCH,</em> a pair of
reserved resources with numerology provided by higher layer parameter
<em>subcarrierSpacing</em> given by <em>RateMatchPattern</em> when
configured per serving cell or by numerology of associated BWP when
configured per BWP. The pair of reserved resources are respectively
indicated by an RB level bitmap (higher layer parameter
<em>resourceBlocks</em> given by <em>RateMatchPattern</em>) with 1RB
granularity and a symbol level bitmap spanning one or two slots (higher
layer parameters <em>symbolsInResourceBlock</em> given by
<em>RateMatchPattern</em>) for which the reserved RBs apply. A bit value
equal to 1 in the RB and symbol level bitmaps indicates that the
corresponding resource is not available for PDSCH. For each pair of RB
and symbol level bitmaps, a UE may be configured with a time-domain
pattern (higher layer parameter <em>periodicityAndPattern</em> given by
<em>RateMatchPattern</em>), where each bit of
<em>periodicityAndPattern</em> corresponds to a unit equal to a duration
of the symbol level bitmap, and a bit value equal to 1 indicates that
the pair is present in the unit. The <em>periodicityAndPattern</em> can
be {1, 2, 4, 5, 8, 10, 20 or 40} units long, but maximum of 40 msec. The
first symbol of <em>periodicityAndPattern</em> every 40 msec/P periods
is a first symbol in frame <span class="math inline">\(n_{f}\)</span>
mod 4 = 0, where P is the duration of <em>periodicityAndPattern</em> in
units of msec. When <em>periodicityAndPattern</em> is not configured for
a pair, for a symbol level bitmap spanning two slots, the bits of the
first and second slots correspond respectively to even and odd slots of
a radio frame, and for a symbol level bitmap spanning one slot, the bits
of the slot correspond to every slot of a radio frame. The pair can be
included in one or two groups of resource sets (higher layer parameters
<em>rateMatchPatternGroup1</em> and <em>rateMatchPatternGroup2</em>).
The <em>rateMatchPatternToAddModList</em> given by
<em>ServingCellConfig</em> or <em>ServingCellConfigCommon</em>
configuration in numerology <em>µ</em> applies only to PDSCH of the same
numerology <em>µ</em>.</p>
<p>- within a BWP, a frequency domain resource of a CORESET configured
by <em>ControlResourceSet</em> with <em>controlResourceSetId</em> or
<em>ControlResourceSetZero</em> and time domain resource determined by
the higher layer parameters <em>monitoringSlotPeriodicityAndOffset,</em>
<em>duration</em> and <em>monitoringSymbolsWithinSlot</em> of all
search-space-sets configured by <em>SearchSpace</em> and time domain
resource of search-space-set zero configured by <em>searchSpaceZero</em>
associated with the CORESET as well as CORESET duration configured by
<em>ControlResourceSet</em> with <em>controlResourceSetId</em> or
<em>ControlResourceSetZero.</em> This resource not available for PDSCH
can be included in one or two groups of resource sets (higher layer
parameters <em>rateMatchPatternGroup1</em> and
<em>rateMatchPatternGroup2</em>).</p>
<p>A configured group <em>rateMatchPatternGroup1</em> or
<em>rateMatchPatternGroup2</em> contains a list of indices of
<em>RateMatchPattern(s)</em> forming a union of resource-sets not
available for a PDSCH dynamically if a corresponding bit of the
'<em>Rate matching indicator</em>' field of the DCI format 1_1
scheduling the PDSCH is equal to 1. The REs corresponding to the union
of resource-sets configured by <em>RateMatchPattern(s)</em> that are not
included in either of the two groups are not available for a PDSCH
scheduled by a DCI format 1_0, a PDSCH scheduled by a DCI format 1_1,
and PDSCHs with SPS. When receiving a PDSCH scheduled by a DCI format
1_0 or PDSCHs with SPS activated by a DCI format 1_0, the REs
corresponding to configured resources in <em>rateMatchPatternGroup1</em>
or <em>rateMatchPatternGroup2</em> are not available for the scheduled
PDSCH or the activated PDSCHs with SPS. When receiving PDSCHs with SPS
activated by a DCI format 1_1, the REs corresponding to configured
resources in <em>rateMatchPatternGroup1</em> or
<em>rateMatchPatternGroup2</em> are not available for the PDSCHs with
SPS if a corresponding bit of the Rate matching indicator field of the
DCI format 1_1 activating the PDSCHs with SPS is equal to 1.</p>
<p>For a bitmap pair included in one or two groups of resource sets, the
dynamic indication of availability for PDSCH applies to a set of slot(s)
where the <em>rateMatchPatternToAddModList</em> is present among the
slots of scheduled PDSCH.</p>
<p>If a UE monitors PDCCH candidates of aggregation levels 8 and 16 with
the same starting CCE index in non-interleaved CORESET spanning one OFDM
symbol:</p>
<p>- and if a detected PDCCH scheduling the PDSCH has aggregation level
8, the resources corresponding to the aggregation level 16 PDCCH
candidate are not available for the PDSCH;</p>
<p>- when at least one of the PDCCH candidates of aggregation levels 8
and 16 linked as indicated by higher layer parameter
<em>searchSpaceLinkingId</em>, the PDCCH candidates of aggregation level
16 and any other PDCCH candidate(s) linked with any of the PDCCH
candidates of aggregation level 8 and 16 are not available for the PDSCH
reception at the UE, if a detected PDCCH scheduling the PDSCH is
associated with the PDCCH candidates of aggregation level 8 or 16.</p>
<p>If a PDSCH scheduled by a PDCCH would overlap with resources in the
CORESET containing the PDCCH, the resources corresponding to a union of
the detected PDCCH that scheduled the PDSCH and associated PDCCH DM-RS
are not available for the PDSCH. When the PDCCH reception includes two
PDCCH candidates from two respective search space sets, as described in
clause 10.1 of [6, TS 38.213], the resources corresponding to a union of
the two PDCCH candidates scheduling the PDSCH and the associated PDCCH
DM-RS are not available for the PDSCH. When <em>precoderGranularity</em>
configured in a CORESET where the PDCCH was detected is set to
'allContiguousRBs<em>'</em>, the associated PDCCH DM-RS are DM-RS in all
REGs of the CORESET. Otherwise, the associated DM-RS are the DM-RS in
REGs of the PDCCH.</p>
<h4 id="pdsch-resource-mapping-with-re-level-granularity">5.1.4.2 PDSCH
resource mapping with RE level granularity</h4>
<p>The procedures for PDSCH scheduled by PDCCH with DCI format 1_1
described in this clause equally apply to PDSCH scheduled by PDCCH with
DCI format 1_2, by applying the parameters of
<em>aperiodicZP-CSI-RS-ResourceSetsToAddModListDCI-1-2</em> instead of
<em>aperiodic-ZP-CSI-RS-ResourceSetsToAddModList</em>.</p>
<p>The procedures for PDSCH scheduled by PDCCH with DCI format 1_0
described in this clause equally apply to PDSCH scheduled by PDCCH with
DCI format 4_1 and the procedures for PDSCH scheduled by PDCCH with DCI
format 1_1 described in this clause equally apply to PDSCH scheduled by
PDCCH with DCI format 4_2, by applying the parameters of
<em>aperiodicZP-CSI-RS-ResourceSetsToAddModList in
pdsch-ConfigMulticast</em> instead of
<em>aperiodic-ZP-CSI-RS-ResourceSetsToAddModList in
PDSCH-Config</em>.</p>
<p>A UE may be configured with any of the following higher layer
parameters:</p>
<p><em>-</em> REs indicated by the '<em>RateMatchPatternLTE-CRS</em>' in
<em>lte-CRS-ToMatchAround</em> in <em>ServingCellConfig</em> or
<em>ServingCellConfigCommon</em> configuring cell-specific RS, in 15 kHz
subcarrier spacing applicable only to 15 kHz subcarrier spacing PDSCH,
of one LTE carrier in a serving cell are declared as not available for
PDSCH.</p>
<p><em>-</em> REs indicated by <em>'RateMatchPatternLTE-CRS'</em> in
<em>lte-CRS-PatternList1-r16</em> in <em>ServingCellConfig</em>
configuring cell-specific RS, in 15 kHz subcarrier spacing applicable
only to 15 kHz subcarrier spacing PDSCH, of one LTE carrier in a serving
cell are declared as not available for PDSCH.</p>
<p>- For the UE for broadcast reception, REs indicated by
<em>'RateMatchPatternLTE-CRS'</em> in <em>pdsch-ConfigMCCH</em> or
<em>pdsch-ConfigMTCH</em> configuring cell-specific RS, in 15 kHz
subcarrier spacing applicable only to 15 kHz subcarrier spacing PDSCH,
of one LTE carrier in a serving cell are declared as not available for
broadcast PDSCH. The total number of <em>RateMatchPatternLTE-CRS</em>
for broadcast reception that a UE can be configured with is the same as
for unicast in Rel-15.</p>
<p>- Each <em>RateMatchPatternLTE-CRS</em> configuration contains
<em>v-Shift</em> consisting of LTE-CRS-vshift(s), <em>nrofCRS-Ports</em>
consisting of LTE-CRS antenna ports 1, 2 or 4 ports,
<em>carrierFreqDL</em> representing the offset in units of 15 kHz
subcarriers from (reference) point A to the LTE carrier centre
subcarrier location, <em>carrierBandwidthDL</em> representing the LTE
carrier bandwidth, and may also configure
<em>mbsfn-SubframeConfigList</em> representing MBSFN subframe
configuration. A UE determines the CRS position within the slot
according to Clause 6.10.1.2 in [15, TS 36.211], where slot corresponds
to LTE subframe.</p>
<p>- If the UE is configured by higher layer parameter
<em>PDCCH-Config</em> with two different values of
<em>coresetPoolIndex</em> in <em>ControlResourceSet</em> and is also
configured by the higher layer parameter
<em>lte-CRS-PatternList1-r16</em> and <em>lte-CRS-PatternList2-r16</em>
in <em>ServingCellConfig</em>, the following REs are declared as not
available for PDSCH:</p>
<p>- if the UE is configured with
<em>crs-RateMatch-PerCoresetPoolIndex</em>, REs indicated by the CRS
pattern(s) in <em>lte-CRS-PatternList1-r16</em> if the PDSCH is
associated with <em>coresetPoolIndex</em> set to '0', or the CRS
pattern(s) in <em>lte-CRS-PatternList2-r16</em> if PDSCH is associated
with <em>coresetPoolIndex</em> set to '1';</p>
<p>- otherwise, REs indicated by <em>lte-CRS-PatternList1-r16</em> and
<em>lte-CRS-PatternList2-r16,</em> in <em>ServingCellConfig</em>.</p>
<p>- Within a BWP, the UE can be configured with one or more ZP CSI-RS
resource set configuration(s) for aperiodic, semi-persistent and
periodic time-domain behaviours (higher layer parameters
<em>aperiodic-ZP-CSI-RS-ResourceSetsToAddModList,</em>
<em>sp-ZP-CSI-RS-ResourceSetsToAddModList</em> and
<em>p-ZP-CSI-RS-ResourceSet</em> respectively comprised in
<em>PDSCH-Config</em>), with each ZP CSI-RS resource set consisting of
at most 16 ZP CSI-RS resources (higher layer parameter
<em>ZP-CSI-RS-Resource</em>) in numerology of the BWP. The REs indicated
by <em>p-ZP-CSI-RS-ResourceSet</em> are declared as not available for
PDSCH. The REs indicated by
<em>sp-ZP-CSI-RS-ResourceSetsToAddModList</em> and
aperiodic-ZP-CSI-RS-ResourceSetsToAddModList are declared as not
available for PDSCH when their triggering and activation are applied,
respectively. The following parameters are configured via higher layer
signaling for each ZP CSI-RS resource configuration:</p>
<p>- <em>zp-CSI-RS-ResourceId</em> in <em>ZP-CSI-RS-Resource</em>
determines ZP CSI-RS resource configuration identity.</p>
<p>- <em>nrofPorts</em> in <em>CSI-RS-ResourceMapping</em> defines the
number of CSI-RS ports, where the allowable values are given in Clause
7.4.1.5 of [4, TS 38.211].</p>
<p>- <em>cdm-Type</em> in <em>CSI-RS-ResourceMapping</em> defines CDM
values and pattern, where the allowable values are given in Clause
7.4.1.5 of [4, TS 38.211].</p>
<p>- <em>resourceMapping</em> in <em>ZP-CSI-RS-Resource</em> defines the
OFDM symbol and subcarrier occupancy of the ZP CSI-RS resource within a
slot that are given in Clause 7.4.1.5 of [4, TS 38.211].</p>
<p>- <em>periodicityAndOffset</em> in <em>ZP-CSI-RS-Resource</em>
defines the ZP-CSI-RS periodicity and slot offset for
periodic/semi-persistent ZP CSI-RS.</p>
<p>- For the UE in RRC_CONNECTED mode for multicast reception,
<em>p-ZP-CSI-RS-ResourceSet</em> can be configured in
<em>pdsch-ConfigMulticast</em> for GC-PDSCH rate matching, subject to UE
capability. The REs indicated by <em>p-ZP-CSI-RS-ResourceSet</em> are
declared as not available for GC-PDSCH. The REs indicated by
<em>p-ZP-CSI-RS-ResourceSet</em> configured in <em>PDSCH-Config</em> for
unicast do not apply for GC-PDSCH and the REs indicated by
<em>p-ZP-CSI-RS-ResourceSet</em> configured in
<em>pdsch-ConfigMulticast</em> for multicast do not apply for unicast
PDSCH. The total number of periodic <em>ZP-CSI-RS-Resources</em> that a
UE can be configured with is the same as for unicast in Rel-16. If
<em>p-ZP-CSI-RS-ResourceSet</em> is configured in both
<em>PDSCH-Config</em> and <em>pdsch-ConfigMulticast</em>, it is subject
to UE capability whether the <em>p-ZP-CSI-RS-ResourceSet</em> configured
in <em>pdsch-ConfigMulticast</em> can be different from the
<em>p-ZP-CSI-RS-ResourceSet</em> configured in
<em>PDSCH-Config</em>.</p>
<p>- For the UE in RRC_CONNECTED mode for multicast reception,
s<em>p-ZP-CSI-RS-ResourceSet</em> can be configured in
<em>pdsch-ConfigMulticast</em> for GC-PDSCH rate matching, subject to UE
capability. The REs indicated by s<em>p-ZP-CSI-RS-ResourceSet</em> are
declared as not available for GC-PDSCH when their triggering and
activation delivered by unicast PDSCH are applied. The REs indicated by
s<em>p-ZP-CSI-RS-ResourceSet</em> configured in <em>PDSCH-Config</em>
for unicast do not apply for GC-PDSCH and the REs indicated by
s<em>p-ZP-CSI-RS-ResourceSet</em> configured in
<em>pdsch-ConfigMulticast</em> for multicast do not apply for unicast
PDSCH. The total number of semi-persistent <em>ZP-CSI-RS-Resources</em>
that a UE can be configured with is the same as for unicast.</p>
<p>The UE may be configured with a DCI field for triggering the
aperiodic ZP CSI-RS. A list of <em>ZP-CSI-RS-ResourceSet(s)</em>,
provided by higher layer parameter
<em>aperiodic-ZP-CSI-RS-ResourceSetsToAddModList</em> in
<em>PDSCH-Config</em>, is configured for aperiodic triggering. The
maximum number of aperiodic <em>ZP-CSI-RS-ResourceSet(s)</em> configured
per BWP is 3. The bit-length of DCI field <em>ZP CSI-RS trigger</em>
depends on the number of aperiodic
<em>ZP-CSI-RS-ResourceSet(s)</em>configured (up to 2 bits). Each
non-zero codepoint of '<em>ZP CSI-RS' trigger</em> in DCI format 1_1
triggers one aperiodic 'ZP-CSI-RS-ResourceSet' in the list
<em>aperiodic-ZP-CSI-RS-ResourceSetsToAddModList</em> by indicating the
aperiodic ZP CSI-RS resource set ID. The DCI codepoint '01' triggers the
resource set with 'ZP-CSI-RS-ResourceSetId' set to '1', the DCI
codepoint '10' triggers the resource set with 'ZP-CSI-RS-ResourceSetId'
set to '2', and the DCI codepoint '11' triggers the resource set with
'ZP-CSI-RS-ResourceSetId' set to '3'. Codepoint '00' is reserved for not
triggering aperiodic ZP CSI-RS. When receiving PDSCH scheduled by DCI
format 1_0 or PDSCHs with SPS activated by DCI format 1_0, the REs
corresponding to configured resources in
<em>aperiodic-ZP-CSI-RS-ResourceSetsToAddModList</em> or in
<em>aperiodicZP-CSI-RS-ResourceSetsToAddModListDCI-1-2</em> are
available for PDSCH.</p>
<p>When the UE is configured with multi-slot and single-slot PDSCH
scheduling or <em>pdsch-TimeDomainAllocationListForMultiPDSCH</em>, the
triggered aperiodic ZP CSI-RS is applied to all the slot(s) of the
PDSCH(s) scheduled or the PDSCHs with SPS activated by the PDCCH
containing the trigger.</p>
<p>For a UE configured with a list of semi-persistent
<em>ZP-CSI-RS-ResourceSet(s)</em> provided by higher layer parameter
<em>sp-ZP-CSI-RS-ResourceSetsToAddModList</em>:</p>
<p>- when the UE would transmit a PUCCH with HARQ-ACK information in
slot <em>n</em> corresponding to the PDSCH carrying the activation
command, as described in clause 6.1.3.19 of [10, TS 38.321], for ZP
CSI-RS resource(s), the corresponding action in [10, TS 38.321] and the
UE assumption on the PDSCH RE mapping corresponding to the activated ZP
CSI-RS resource(s) shall be applied starting from the first slot that is
after slot <span class="math inline">\(n + {3N}_{slot}^{subframe,µ} +
{\frac{2^{\mu}}{2^{\mu_{K_{mac}}}} \bullet k}_{mac}\)</span> where
<em>μ</em> is the SCS configuration for the PUCCH and <span
class="math inline">\(\mu_{K_{mac}}\ \)</span>is the subcarrier spacing
configuration for <span class="math inline">\(k_{mac}\)</span> with a
value of 0 for frequency range 1, and <span
class="math inline">\(k_{mac}\)</span> is provided by <em>K-Mac</em> or
<span class="math inline">\(k_{mac} = 0\)</span> if <em>K-Mac</em> is
not provided.</p>
<p>- when the UE would transmit a PUCCH with HARQ-ACK information in
slot <em>n</em> corresponding to the PDSCH carrying the deactivation
command, as described in clause 6.1.3.19 of [10, TS 38.321], for
activated ZP CSI-RS resource(s), the corresponding action in [10, TS
38.321] and the UE assumption on cessation of the PDSCH RE mapping
corresponding to the de-activated ZP CSI-RS resource(s) shall be applied
starting from the first slot that is after slot <span
class="math inline">\(n + {3N}_{slot}^{subframe,µ} +
{\frac{2^{\mu}}{2^{\mu_{K_{mac}}}} \bullet k}_{mac}\)</span> where
<em>μ</em> is the SCS configuration for the PUCCH and <span
class="math inline">\(\mu_{K_{mac}}\ \)</span>is the subcarrier spacing
configuration for <span class="math inline">\(k_{mac}\)</span> with a
value of 0 for frequency range 1, and <span
class="math inline">\(k_{mac}\)</span> is provided by <em>K-Mac</em> or
<span class="math inline">\(k_{mac} = 0\)</span> if <em>K-Mac</em> is
not provided.</p>
<h3 id="antenna-ports-quasi-co-location">5.1.5 Antenna ports quasi
co-location</h3>
<p>The UE can be configured with a list of up to <em>M</em>
<em>TCI-State</em> configurations within the higher layer parameter
<em>PDSCH-Config</em> to decode PDSCH according to a detected PDCCH with
DCI intended for the UE and the given serving cell, where M depends on
the UE capability <em>maxNumberConfiguredTCIstatesPerCC</em>. Each
<em>TCI-State</em> contains parameters for configuring a quasi
co-location relationship between one or two downlink reference signals
and the DM-RS ports of the PDSCH, the DM-RS port of PDCCH or the CSI-RS
port(s) of a CSI-RS resource. The quasi co-location relationship is
configured by the higher layer parameter <em>qcl-Type1</em> for the
first DL RS, and <em>qcl-Type2</em> for the second DL RS (if
configured). For the case of two DL RSs, the QCL types shall not be the
same, regardless of whether the references are to the same DL RS or
different DL RSs. The quasi co-location types corresponding to each DL
RS are given by the higher layer parameter <em>qcl-Type</em> in
<em>QCL-Info</em> and may take one of the following values:</p>
<p>- 'typeA': {Doppler shift, Doppler spread, average delay, delay
spread}</p>
<p>- 'typeB': {Doppler shift, Doppler spread}</p>
<p>- 'typeC': {Doppler shift, average delay}</p>
<p>- 'typeD': {Spatial Rx parameter}</p>
<p>The UE can be configured with a list of up to <em>128</em>
<em>TCI-State</em> configurations, within the higher layer parameter
<em>dl-OrJointTCI-StateList</em> in <em>PDSCH-Config</em> for providing
a reference signal for the quasi co-location for DM-RS of PDSCH and
DM-RS of PDCCH in a BWP/CC, for CSI-RS, and to provide a reference, if
applicable, for determining UL TX spatial filter for dynamic-grant and
configured-grant based PUSCH and PUCCH resource in a BWP/CC, and
SRS.</p>
<p>If the <em>TCI-State</em> or <em>TCI-UL-State</em> configurations are
absent in a BWP of the CC, the UE can apply the <em>TCI-State</em> or
<em>TCI-UL-State</em> configurations from a reference BWP of a reference
CC configured by <em>unifiedTCI-StateRef</em>. The UE is not expected to
be configured with <em>tci-StatesToAddModList</em>,
<em>SpatialRelationInfo</em> or <em>PUCCH-SpatialRelationInfo</em>,
except <em>SpatialRelationInfoPos</em> in a CC in a band, if the UE is
configured with <em>dl-OrJointTCI-StateList</em> or
<em>ul-TCI-StateList</em> in any CC in the same band. The UE can assume
that when the UE is configured with <em>tci-StatesToAddModList</em> in
any CC in the CC list configured by <em>simultaneousTCI-UpdateList1-r16,
simultaneousTCI-UpdateList2-r16,</em>
<em>simultaneousSpatial-UpdatedList1-r16, or
simultaneousSpatial-UpdatedList2-r16,</em> the UE is not configured with
<em>dl-OrJointTCI-StateList</em> or <em>ul-TCI-StateList</em> in any CC
within the same band in the CC list.</p>
<p>The UE receives an activation command, as described in clause
6.1.3.14 of [10, TS 38.321] or 6.1.3.47 of [10, TS 38.321], used to map
up to 8 TCI states and/or pairs of TCI states, with one TCI state for DL
channels/signals and/or one TCI state for UL channels/signals to the
codepoints of the DCI field <em>'Transmission Configuration
Indication'</em> for one or for a set of CCs/DL BWPs, and if applicable,
for one or for a set of CCs/UL BWPs. When a set of TCI state IDs are
activated for a set of CCs/DL BWPs and if applicable, for a set of
CCs/UL BWPs, where the applicable list of CCs is determined by the
indicated CC in the activation command, the same set of TCI state IDs
are applied for all DL and/or UL BWPs in the indicated CCs. If the
activation command maps <em>TCI-State</em> and/or <em>TCI-UL-State</em>
to only one TCI codepoint, the UE shall apply the indicated
<em>TCI-State</em> and/or <em>TCI-UL-State</em> to one or to a set of
CCs /DL BWPs, and if applicable, to one or to a set of CCs /UL BWPs once
the indicated mapping for the one single TCI codepoint is applied as
described in [11, TS 38.133].</p>
<p>When the <em>bwp-id</em> or <em>cell</em> for QCL-TypeA/D source RS
in a QCL-Info of the TCI state is not configured, the UE assumes that
QCL-TypeA/D source RS is configured in the CC/DL BWP where TCI state
applies.</p>
<p>When <em>tci-PresentInDCI</em> is set as 'enabled' or
<em>tci-PresentDCI-1-2</em> is configured for the CORESET, a UE
configured with <em>dl-OrJointTCI-StateList</em> with activated
<em>TCI-State</em> or <em>ul-TCI-StateList</em> with activated
<em>TCI-UL-State</em> receives DCI format 1_1/1_2 providing indicated
<em>TCI-State</em> and/or <em>TCI-UL-State</em> for a CC or all CCs in
the same CC list configured by <em>simultaneousU-TCI-UpdateList1-r17,
simultaneousU-TCI-UpdateList2-r17, simultaneousU-TCI-UpdateList3-r17,
simultaneousU-TCI-UpdateList4-r17</em>. The DCI format 1_1/1_2 can be
with or without, if applicable, DL assignment. If the DCI format
1_1/1_2/ is without DL assignment, the UE can assume the following:</p>
<p>- CS-RNTI is used to scramble the CRC for the DCI</p>
<p>- The values of the following DCI fields are set as follows:</p>
<p>- RV = all '1's</p>
<p>- MCS = all '1's</p>
<p>- NDI = 0</p>
<p>- Set to all '0's for FDRA Type 0, or all '1's for FDRA Type 1, or
all '0's for dynamicSwitch (same as in Table 10.2-4 of [6, TS
38.213]).</p>
<p>After a UE receives an initial higher layer configuration of
<em>dl-OrJointTCI-StateList</em> with more than one <em>TCI-State</em>
and before application of an indicated TCI state from the configured TCI
states:</p>
<p>- The UE assumes that DM-RS of PDSCH and DM-RS of PDCCH and the
CSI-RS applying the indicated TCI state are quasi co-located with the
SS/PBCH block the UE identified during the initial access procedure</p>
<p>After a UE receives an initial higher layer configuration of
<em>dl-OrJointTCI-StateList</em> with more than one <em>TCI-State</em>
or <em>ul-TCI-StateList</em> with more than one <em>TCI-UL-State</em>
and before application of an indicated TCI state from the configured TCI
states:</p>
<p>- The UE assumes that the UL TX spatial filter, if applicable, for
dynamic-grant and configured-grant based PUSCH and PUCCH, and for SRS
applying the indicated TCI state, is the same as that for a PUSCH
transmission scheduled by a RAR UL grant or a MsgA PUSCH transmission
during the initial access procedure</p>
<p>After a UE receives a higher layer configuration of
<em>dl-OrJointTCI-StateList</em> with more than one <em>TCI-State</em>
as part of a Reconfiguration with sync procedure as described in [12, TS
38.331] and before applying an indicated TCI state from the configured
TCI states:</p>
<p>- The UE assumes that DM-RS of PDSCH and DM-RS of PDCCH, and the
CSI-RS applying the indicated TCI state are quasi co-located with the
SS/PBCH block or the CSI-RS resource the UE identified during the random
access procedure initiated by the Reconfiguration with sync procedure as
described in [12, TS 38.331].</p>
<p>After a UE receives a higher layer configuration of
<em>dl-OrJointTCI-StateList</em> with more than one <em>TCI-State</em>
or more than one <em>TCI-UL-State</em> as part of a Reconfiguration with
sync procedure as described in [12, TS 38.331] and before applying an
indicated TCI state from the configured TCI states:</p>
<p>- The UE assumes that the UL TX spatial filter, if applicable, for
dynamic-grant and configured-grant based PUSCH and PUCCH, and for SRS
applying the indicated TCI state, is the same as that for a PUSCH
transmission scheduled by a RAR UL grant or a MsgA PUSCH transmission
during random access procedure initiated by the Reconfiguration with
sync procedure as described in [12, TS 38.331].</p>
<p>If a UE receives a higher layer configuration of
<em>dl-OrJointTCI-StateList</em> with a single <em>TCI-State</em>, that
can be used as an indicated TCI state<em>,</em> the UE obtains the QCL
assumptions from the configured TCI state for DM-RS of PDSCH and DM-RS
of PDCCH, and the CSI -RS applying the indicated TCI state.</p>
<p>If a UE receives a higher layer configuration of
<em>dl-OrJointTCI-StateList</em> with a single <em>TCI-State</em> or
<em>ul-TCI-StateList</em> with a single <em>TCI-UL-State</em>, that can
be used as an indicated TCI state, the UE determines an UL TX spatial
filter, if applicable, from the configured TCI state for dynamic-grant
and configured-grant based PUSCH and PUCCH, and SRS applying the
indicated TCI state.</p>
<p>When a UE configured with <em>dl-OrJointTCI-StateList</em> would
transmit a PUCCH with positive HARQ-ACK or a PUSCH with positive
HARQ-ACK corresponding to the DCI carrying the TCI State indication and
without DL assignment, or corresponding to the PDSCH scheduled by the
DCI carrying the TCI State indication, and if the indicated TCI State is
different from the previously indicated one, the indicated
<em>TCI-State</em> and/or <em>TCI-UL-State</em> should be applied
starting from the first slot that is at least <span
class="math inline">\(\ beamAppTime\)</span> symbols after the last
symbol of the PUCCH or the PUSCH, and if the UE receives more than one
indicated TCI state for a CC/BWP to be applied starting from the first
slot that is at least <span class="math inline">\(\ beamAppTime\)</span>
symbols after the last symbol of the PUCCH or the PUSCH, the indicated
TCI state carried in the latest DCI in time corresponding to positive
HARQ-ACK value is applied. The first slot and the <span
class="math inline">\(\ beamAppTime\)</span> symbols are both determined
on the active BWP with the smallest SCS among the BWP(s) from the CCs
applying the indicated <em>TCI-State</em> or <em>TCI-UL-State</em> that
are active at the end of the PUCCH or the PUSCH carrying the positive
HARQ-ACK.</p>
<p>When a UE is configured with <em>dl-OrJointTCI-StateList</em>, and if
the UE is configured with <em>unifiedTCI-StateType</em> is set as
'separate', and if the UE receives a TCI codepoint mapped with either of
{<em>TCI-State</em>, <em>TCI-UL-State}</em>, the UE shall update the one
indicated {<em>TCI-State</em>, <em>TCI-UL-State}</em> and maintain the
other {<em>TCI-State</em>, <em>TCI-UL-State}</em> that is not updated by
the received TCI codepoint.</p>
<p>If a UE is configured with
<em>pdsch-TimeDomainAllocationListForMultiPDSCH</em> in which one or
more rows contain multiple <em>SLIV</em>s for PDSCH on a DL BWP of a
serving cell, and the UE is receiving a DCI carrying the
<em>TCI-State</em> indication and without DL assignment, the UE does not
expect that the number of indicated <em>SLIV</em>s in the row of the
<em>pdsch-TimeDomainAllocationListForMultiPDSCH</em> by the DCI is more
than one.</p>
<p>If the UE is configured with <em>SSB-MTC-AddtionalPCI</em> and with
<em>PDCCH-Config</em> that contains two different values of
<em>coresetPoolIndex</em> in <em>ControlResourceSet</em>, the UE
receives an activation command for CORESET associated with each
<em>coresetPoolIndex</em>, as described in clause 6.1.3.14 of [10, TS
38.321], used to map up to 8 TCI states to the codepoints of the DCI
field <em>'Transmission Configuration Indication'</em> in one CC/DL BWP.
When a set of TCI state IDs are activated for a
<em>coresetPoolIndex</em>, the activated TCI states corresponding to one
<em>coresetPoolIndex</em> is associated with the serving cell physical
cell ID and activated TCI states corresponding to another
<em>coresetPoolIndex</em> can be associated with another physical cell
ID.</p>
<p>When a UE supports two TCI states in a codepoint of the DCI field
'<em>Transmission Configuration Indication'</em> the UE may receive an
activation command, as described in clause 6.1.3.24 of [10, TS 38.321],
the activation command is used to map up to 8 combinations of one or two
TCI states to the codepoints of the DCI field <em>'Transmission
Configuration Indication'</em>. The UE is not expected to receive more
than 8 TCI states in the activation command.</p>
<p>When the DCI field <em>'Transmission Configuration Indication'</em>
is present in DCI format 1_2 and when the number of codepoints S in the
DCI field <em>'Transmission Configuration Indication'</em> of DCI format
1_2 is smaller than the number of TCI codepoints that are activated by
the activation command, as described in clause 6.1.3.14, 6.1.3.24 and
6.1.3.47 of [10, TS38.321], only the first S activated codepoints are
applied for DCI format 1_2.</p>
<p>When the UE would transmit a PUCCH with HARQ-ACK information in slot
<em>n</em> corresponding to the PDSCH carrying the activation command,
the indicated mapping between TCI states and codepoints of the DCI field
<em>'Transmission Configuration Indication'</em> should be applied
starting from the first slot that is after slot<span
class="math inline">\(\ n + {3N}_{slot}^{subframe,µ} +
{\frac{2^{\mu}}{2^{\mu_{K_{mac}}}} \bullet k}_{mac}\)</span> where
<em>μ</em> is the SCS configuration for the PUCCH and <span
class="math inline">\(\mu_{K_{mac}}\ \)</span>is the subcarrier spacing
configuration for <span class="math inline">\(k_{mac}\)</span> with a
value of 0 for frequency range 1, and <span
class="math inline">\(k_{mac}\)</span> is provided by <em>K-Mac</em> or
<span class="math inline">\(k_{mac} = 0\)</span> if <em>K-Mac</em> is
not provided. If <em>tci-PresentInDCI</em> is set to 'enabled' or
<em>tci-PresentDCI-1-2</em> is configured for the CORESET scheduling the
PDSCH, and the time offset between the reception of the DL DCI and the
corresponding PDSCH is equal to or greater than
<em>timeDurationForQCL</em> if applicable, after a UE receives an
initial higher layer configuration of TCI states and before reception of
the activation command, the UE may assume that the DM-RS ports of PDSCH
of a serving cell are quasi co-located with the SS/PBCH block determined
in the initial access procedure with respect to <em>qcl-Type</em> set to
'typeA', and when applicable, also with respect to <em>qcl-Type</em> set
to 'typeD'.</p>
<p>If a UE is configured with the higher layer parameter
<em>tci-PresentInDCI</em> that is set as 'enabled' for the CORESET
scheduling a PDSCH, the UE assumes that the TCI field is present in the
DCI format 1_1 of the PDCCH transmitted on the CORESET. If a UE is
configured with the higher layer parameter <em>tci-PresentDCI-1-2</em>
for the CORESET scheduling the PDSCH, the UE assumes that the TCI field
with a DCI field size indicated by <em>tci-PresentDCI-1-2</em> is
present in the DCI format 1_2 of the PDCCH transmitted on the CORESET.
If a UE is configured with the higher layer parameter
<em>tci-PresentInDCI</em> that is set as 'enabled' for the CORESET
scheduling the multicast PDSCH, the UE assumes that the TCI field is
present in the DCI format 4_2 of the PDCCH transmitted on the CORESET.
If the PDSCH is scheduled by a DCI format not having the TCI field
present, and the time offset between the reception of the DL DCI and the
corresponding PDSCH of a serving cell is equal to or greater than a
threshold <em>timeDurationForQCL</em> if applicable, where the threshold
is based on reported UE capability [13, TS 38.306], for determining
PDSCH antenna port quasi co-location, the UE assumes that the TCI state
or the QCL assumption for the PDSCH is identical to the TCI state or QCL
assumption whichever is applied for the CORESET used for the PDCCH
transmission within the active BWP of the serving cell.</p>
<p>When a UE is configured with both <em>sfnSchemePDCCH</em> and
<em>sfnSchemePDSCH</em> scheduled by DCI format 1_0 or by DCI format
1_1/1_2, if the time offset between the reception of the DL DCI and the
corresponding PDSCH of a serving cell is equal to or greater than a
threshold <em>timeDurationForQCL</em> if applicable:</p>
<p>- if the UE supports <em>sfn-DefaultDL-BeamSetup-r17</em> for DCI
scheduling without TCI field, the UE assumes that the TCI state(s) or
the QCL assumption(s) for the PDSCH is identical to the TCI state(s) or
QCL assumption(s) whichever is applied for the CORESET used for the
reception of the DL DCI within the active BWP of the serving cell
regardless of the number of active TCI states of the CORESET. If the UE
does not support <em>sfn-SchemeA-DynamicSwitching-r17</em> or
<em>sfn-SchemeB-DynamicSwitching-r17</em>, the UE should be activated
with the CORESET with two TCI states.</p>
<p>- else if the UE does not support
<em>sfn-DefaultDL-BeamSetup-r17</em> for DCI scheduling without TCI
field, the UE shall expect TCI field present when scheduled by DCI
format 1_1/1_2.</p>
<p>When a UE is configured with <em>sfnSchemePDSCH</em> and
<em>sfnSchemePDCCH</em> is not configured, when scheduled by DCI format
1_1/1_2, if the time offset between the reception of the DL DCI and the
corresponding PDSCH of a serving cell is equal to or greater than a
threshold <em>timeDurationForQCL</em> if applicable, the UE shall expect
TCI field present.</p>
<p>For PDSCH scheduled by DCI format 1_0, 1_1, 1_2, when a UE is
configured with <em>sfnSchemePDCCH</em> set to 'sfnSchemeA' and
<em>sfnSchemePDSCH</em> is not configured, and there is no TCI codepoint
with two TCI states in the activation command, and if the time offset
between the reception of the DL DCI and the corresponding PDSCH is equal
or larger than the threshold <em>timeDurationForQCL</em> if applicable
and the CORESET which schedules the PDSCH is indicated with two TCI
states, the UE assumes that the TCI state or the QCL assumption for the
PDSCH is identical to the first TCI state or QCL assumption which is
applied for the CORESET used for the PDCCH transmission within the
active BWP of the serving cell.</p>
<p>If a UE is not provided <em>dl-OrJointTCI-StateList-r17</em>, and if
a PDSCH is scheduled by a DCI format having the TCI field present, the
TCI field in DCI in the scheduling component carrier points to the
activated TCI states in the scheduled component carrier or DL BWP, the
UE shall use the <em>TCI-State</em> according to the value of the
'<em>Transmission Configuration Indication</em>' field in the detected
PDCCH with DCI for determining PDSCH antenna port quasi co-location. The
UE may assume that the DM-RS ports of PDSCH of a serving cell are quasi
co-located with the RS(s) in the TCI state with respect to the QCL type
parameter(s) given by the indicated TCI state if the time offset between
the reception of the DL DCI and the corresponding PDSCH is equal to or
greater than a threshold <em>timeDurationForQCL</em>, where the
threshold is based on reported UE capability [13, TS 38.306]. For a
single slot PDSCH, the indicated TCI state(s) should be based on the
activated TCI states in the slot with the scheduled PDSCH. For a
multi-slot PDSCH or the UE is configured with higher layer parameter
<em>pdsch-TimeDomainAllocationListForMultiPDSCH</em>, the indicated TCI
state(s) should be based on the activated TCI states in the first slot
with the scheduled PDSCH(s), and UE shall expect the activated TCI
states are the same across the slots with the scheduled PDSCH(s). When
the UE is configured with CORESET associated with a search space set for
cross-carrier scheduling and the UE is not configured with
<em>enableDefaultBeamForCCS</em>, the UE expects
<em>tci-PresentInDCI</em> is set as 'enabled' or
<em>tci-PresentDCI-1-2</em> is configured for the CORESET, and if one or
more of the TCI states configured for the serving cell scheduled by the
search space set contains <em>qcl-Type</em> set to 'typeD', the UE
expects the time offset between the reception of the detected PDCCH in
the search space set and a corresponding PDSCH is larger than or equal
to the threshold <em>timeDurationForQCL.</em></p>
<p>Independent of the configuration of <em>tci-PresentInDCI</em> and
<em>tci-PresentDCI-1-2</em> in RRC connected mode, if the UE is not
provided <em>dl-OrJointTCI-StateList-r17</em>, and if the offset between
the reception of the DL DCI and the corresponding PDSCH is less than the
threshold <em>timeDurationForQCL</em> and at least one configured TCI
state for the serving cell of scheduled PDSCH contains <em>qcl-Type</em>
set to 'typeD',</p>
<p>- the UE may assume that the DM-RS ports of PDSCH(s) of a serving
cell are quasi co-located with the RS(s) with respect to the QCL
parameter(s) used for PDCCH quasi co-location indication of the CORESET
associated with a monitored search space with the lowest
<em>controlResourceSetId</em> in the latest slot in which one or more
CORESETs within the active BWP of the serving cell are monitored by the
UE. In this case, if the <em>qcl-Type</em> is set to 'typeD' of the
PDSCH DM-RS is different from that of the PDCCH DM-RS with which they
overlap in at least one symbol, the UE is expected to prioritize the
reception of PDCCH associated with that CORESET. This also applies to
the intra-band CA case (when PDSCH and the CORESET are in different
component carriers).</p>
<p>- If a UE is configured with
<em>enableDefaultTCI-StatePerCoresetPoolIndex</em> and the UE is
configured by higher layer parameter <em>PDCCH-Config</em> that contains
two different values of <em>coresetPoolIndex</em> in different
<em>ControlResourceSets,</em></p>
<p>- the UE may assume that the DM-RS ports of PDSCH associated with a
value of <em>coresetPoolIndex</em> of a serving cell are quasi
co-located with the RS(s) with respect to the QCL parameter(s) used for
PDCCH quasi co-location indication of the CORESET associated with a
monitored search space with the lowest <em>controlResourceSetId</em>
among CORESETs, which are configured with the same value of
<em>coresetPoolIndex</em> as the PDCCH scheduling that PDSCH, in the
latest slot in which one or more CORESETs associated with the same value
of <em>coresetPoolIndex</em> as the PDCCH scheduling that PDSCH within
the active BWP of the serving cell are monitored by the UE. In this
case, if the 'QCL-TypeD' of the PDSCH DM-RS is different from that of
the PDCCH DM-RS with which they overlap in at least one symbol and they
are associated with same value of <em>coresetPoolIndex</em>, the UE is
expected to prioritize the reception of PDCCH associated with that
CORESET. This also applies to the intra-band CA case (when PDSCH and the
CORESET are in different component carriers).</p>
<p>- If a UE is configured with <em>enableTwoDefaultTCI-States</em>, and
at least one TCI codepoint indicates two TCI states, the UE may assume
that the DM-RS ports of PDSCH or PDSCH transmission occasions of a
serving cell are quasi co-located with the RS(s) with respect to the QCL
parameter(s) associated with the TCI states corresponding to the lowest
codepoint among the TCI codepoints containing two different TCI states.
When the UE is configured by higher layer parameter
<em>repetitionScheme</em> set to 'tdmSchemeA' or is configured with
higher layer parameter <em>repetitionNumber</em>, and the offset between
the reception of the DL DCI and the first PDSCH transmission occasion is
less than the threshold <em>timeDurationForQCL,</em> the mapping of the
TCI states to PDSCH transmission occasions is determined according to
clause 5.1.2.1 by replacing the indicated TCI states with the TCI states
corresponding to the lowest codepoint among the TCI codepoints
containing two different TCI states based on the activated TCI states in
the slot with the first PDSCH transmission occasion. In this case, if
the 'QCL-TypeD' in both of the TCI states corresponding to the lowest
codepoint among the TCI codepoints containing two different TCI states
is different from that of the PDCCH DM-RS with which they overlap in at
least one symbol, the UE is expected to prioritize the reception of
PDCCH associated with that CORESET. This also applies to the intra-band
CA case (when PDSCH and the CORESET are in different component
carriers)</p>
<p>- If a UE is not configured with <em>sfnSchemePDSCH</em>, and the UE
is configured with <em>sfnSchemePDCCH</em> set to 'sfnSchemeA' and there
is no TCI codepoint with two TCI states in the activation command and
the CORESET with the lowest ID in the latest slot is indicated with two
TCI states, the UE may assume that the DM-RS ports of PDSCH of a serving
cell are quasi co-located with the RS(s) with respect to the QCL
parameter(s) associated with the first TCI state of two TCI states
indicated for the CORESET. In this case, if the <em>qcl-Type</em> is set
to 'typeD' of the PDSCH DM-RS is different from that of the PDCCH DM-RS
with which they overlap in at least one symbol, the UE is expected to
prioritize the reception of PDCCH associated with that CORESET with
single active TCI state. This also applies to the intra-band CA case
(when PDSCH and the CORESET are in different component carriers).</p>
<p>- In all cases above, if none of configured TCI states for the
serving cell of scheduled PDSCH is configured with <em>qcl-Type</em> set
to 'typeD', the UE shall obtain the other QCL assumptions from the
indicated TCI state(s) for its scheduled PDSCH irrespective of the time
offset between the reception of the DL DCI and the corresponding
PDSCH.</p>
<p>Independent of the configuration of <em>tci-PresentInDCI</em> and
<em>tci-PresentDCI-1-2</em> in RRC connected mode, if the UE is provided
<em>dl-OrJointTCI-StateList-r17</em>, and if the offset between the
reception of the DL DCI and the corresponding PDSCH is less than the
threshold <em>timeDurationForQCL</em> and at least one configured TCI
state for the serving cell of scheduled PDSCH contains <em>qcl-Type</em>
set to 'typeD', regardless of configuration of
<em>followUnifiedTCI-State</em>,</p>
<p>- if the indicated TCI state is associated with the PCI of the
serving cell, the indicated TCI state is applied to PDSCH reception.</p>
<p>- if the indicated TCI state is associated with a PCI different from
the serving cell, the UE may assume that the DM-RS ports of PDSCH(s) of
a serving cell are quasi co-located with the RS(s) with respect to the
QCL parameter(s) used for PDCCH quasi co-location indication of the
CORESET associated with a monitored search space with the lowest
<em>controlResourceSetId</em> in the latest slot in which one or more
CORESETs within the active BWP of the serving cell are monitored by the
UE. In the CA case, if the 'QCL-TypeD' of the PDSCH DM-RSs from
respective CCs in a band are different in a slot, the QCL-TypeD
assumption of the PDSCH DM-RS in the CC with lowest CC ID in the band is
applied to all the PDSCH DM-RSs in the CCs in the band. In this case, if
the <em>qcl-Type</em> is set to 'typeD' of the PDSCH DM-RS is different
from that of the PDCCH DM-RS with which they overlap in at least one
symbol, the UE is expected to prioritize the reception of PDCCH
associated with that CORESET. This also applies to the intra-band CA
case (when PDSCH and the CORESET are in different component
carriers).</p>
<p>If the PDCCH carrying the scheduling DCI is received on one component
carrier, and a PDSCH scheduled by that DCI is on another component
carrier:</p>
<p>- The <em>timeDurationForQCL</em> is determined based on the
subcarrier spacing of the scheduled PDSCH. If µ<sub>PDCCH</sub> &lt;
µ<sub>PDSCH</sub> an additional timing delay <span
class="math inline">\(d\frac{2^{\mu_{PDSCH}}}{2^{\mu_{PDCCH}}}\)</span>
is added to the <em>timeDurationForQCL</em>, where <em>d</em> is defined
in 5.2.1.5.1a-1, otherwise <em>d</em> is zero;</p>
<p>- When the UE is configured with <em>enableDefaultBeamForCCS</em>, if
the offset between the reception of the DL DCI and the corresponding
PDSCH is less than the threshold <em>timeDurationForQCL,</em> or if the
DL DCI does not have the TCI field present, the UE obtains its QCL
assumption for the scheduled PDSCH from the activated TCI state with the
lowest ID applicable to PDSCH in the active BWP of the scheduled
cell.</p>
<p>A UE that has indicated a capability
<em>beamCorrespondenceWithoutUL-BeamSweeping</em> set to 'supported', as
described in [13, TS 38.306], can determine a spatial domain filter to
be used while performing the applicable channel access procedures
described in [16, TS 37.213] prior to a UL transmission on the channel
as follows:</p>
<p>- if UE is indicated with an SRI corresponding to the UL
transmission, the UE may use a spatial domain filter that is same as the
spatial domain transmission filter associated with the indicated
SRI,</p>
<p>- if UE is configured with <em>SRS-spatialRelationInfo</em> for the
UL transmission, the UE may use a spatial domain filter that is same as
the spatial domain filter associated with <em>referenceSignal</em> in
the corresponding <em>SRS-spatialRelationInfo</em>,</p>
<p>- if UE is configured with <em>TCI-State</em> in
<em>dl-OrJointTCI-StateList</em> or <em>TCI-UL-State</em> in
<em>ul-TCI-StateList</em>, the UE may use a spatial domain filter that
is same as the spatial domain receive filter the UE may use to receive
the DL reference signal associated with the indicated TCI state.</p>
<p>When the PDCCH reception includes two PDCCH from two respective
search space sets, as described in clause 10.1 of [6, TS 38.213], for
the purpose of determining the time offset between the reception of the
DL DCI and the corresponding PDSCH, the PDCCH candidate that ends later
in time is used. When the PDCCH reception includes two PDCCH candidates
from two respective search space sets, as described in clause 10.1 of
[6, TS 38.213], for the configuration of <em>tci-PresentInDCI</em> or
<em>tci-PresentDCI-1-2</em>, the UE expects the same configuration in
the first and second CORESETs associated with the two PDCCH candidates;
and if the PDSCH is scheduled by a DCI format not having the TCI field
present and if the scheduling offset is equal to or larger than
<em>timeDurationForQCL,</em> if applicable, PDSCH QCL assumption is
based on the CORESET with lower ID among the first and second CORESETs
associated with the two PDCCH candidates.</p>
<p>For a periodic CSI-RS resource in an <em>NZP-CSI-RS-ResourceSet</em>
configured with higher layer parameter <em>trs-Info</em>, the UE shall
expect that a TCI-State indicates one of the following quasi co-location
type(s):</p>
<p>- 'typeC' with an SS/PBCH block and, when applicable, 'typeD' with
the same SS/PBCH block where SS/PBCH block may have a PCI different from
the PCI of the serving cell. The UE can assume center frequency, SCS,
SFN offset are the same for SS/PBCH block from the serving cell and
SS/PBCH block having a PCI different from the serving cell, or</p>
<p>- 'typeC' with an SS/PBCH block and, when applicable,'typeD' with a
CSI-RS resource in an <em>NZP-CSI-RS-ResourceSet</em> configured with
higher layer parameter <em>repetition,</em> where SS/PBCH block may have
a PCI different from the PCI of the serving cell. The UE can assume
center frequency, SCS, SFN offset are the same for SS/PBCH block from
the serving cell and SS/PBCH block having a PCI different from the
serving cell.</p>
<p>For periodic/semi-persistent CSI-RS, if the UE is configured with
<em>dl-OrJointTCI-StateList,</em> the UE can assume that the indicated
<em>TCI-State</em> is not applied.</p>
<p>For an aperiodic CSI-RS resource in an
<em>NZP-CSI-RS-ResourceSet</em> configured with higher layer parameter
<em>trs-Info,</em> the UE shall expect that a <em>TCI-State</em>
indicates <em>qcl-Type</em> set to 'typeA' with a periodic CSI-RS
resource in a <em>NZP-CSI-RS-ResourceSet</em> configured with higher
layer parameter <em>trs-Info</em> and, when applicable,
<em>qcl-Type</em> set to 'typeD' with the same periodic CSI-RS
resource.</p>
<p>For a CSI-RS resource in an <em>NZP-CSI-RS-ResourceSet</em>
configured without higher layer parameter <em>trs-Info</em> and without
the higher layer parameter <em>repetition</em>, the UE shall expect that
a TCI-State indicates one of the following quasi co-location
type(s):</p>
<p>- 'typeA' with a CSI-RS resource in a <em>NZP-CSI-RS-ResourceSet</em>
configured with higher layer parameter <em>trs-Info</em> and, when
applicable, 'typeD' with the same CSI-RS resource, or</p>
<p>- 'typeA' with a CSI-RS resource in a <em>NZP-CSI-RS-ResourceSet</em>
configured with higher layer parameter <em>trs-Info</em> and, when
applicable, 'typeD' with an SS/PBCH block, where SS/PBCH block may have
a PCI different from the PCI of the serving cell. The UE can assume
center frequency, SCS, SFN offset are the same for SS/PBCH block from
the serving cell and SS/PBCH block having a PCI different from the
serving cell, or</p>
<p>- 'typeA' with a CSI-RS resource in a <em>NZP-CSI-RS-ResourceSet</em>
configured with higher layer parameter <em>trs-Info</em> and, when
applicable, 'typeD' with a CSI-RS resource in a
<em>NZP-CSI-RS-ResourceSet</em> configured with higher layer parameter
<em>repetition</em>, or</p>
<p>- 'typeB' with a CSI-RS resource in a <em>NZP-CSI-RS-ResourceSet</em>
configured with higher layer parameter <em>trs-Info</em> when 'typeD' is
not applicable.</p>
<p>For a CSI-RS resource in an <em>NZP-CSI-RS-ResourceSet</em>
configured with higher layer parameter <em>repetition,</em> the UE shall
expect that a TCI-State indicates one of the following quasi co-location
type(s):</p>
<p>- 'typeA' with a CSI-RS resource in a <em>NZP-CSI-RS-ResourceSet</em>
configured with higher layer parameter <em>trs-Info</em> and, when
applicable, 'typeD' with the same CSI-RS resource, or</p>
<p>- 'typeA' with a CSI-RS resource in a <em>NZP-CSI-RS-ResourceSet</em>
configured with higher layer parameter <em>trs-Info</em> and, when
applicable, 'typeD' with a CSI-RS resource in a
<em>NZP-CSI-RS-ResourceSet</em> configured with higher layer parameter
<em>repetition</em>, or</p>
<p>- 'typeC' with an SS/PBCH block and, when applicable, 'typeD' with
the same SS/PBCH block, the reference RS may additionally be an SS/PBCH
block having a PCI different from the PCI of the serving cell. The UE
can assume center frequency, SCS, SFN offset are the same for SS/PBCH
block from the serving cell and SS/PBCH block having a PCI different
from the serving cell.</p>
<p>For the DM-RS of PDCCH, if the UE is not configured with
<em>dl-OrJointTCI-StateList,</em> the UE shall expect that a
<em>TCI-State</em> indicates one of the following quasi co-location
type(s):</p>
<p>- 'typeA' with a CSI-RS resource in a <em>NZP-CSI-RS-ResourceSet</em>
configured with higher layer parameter <em>trs-Info</em> and, when
applicable, 'typeD' with the same CSI-RS resource, or</p>
<p>- 'typeA' with a CSI-RS resource in a <em>NZP-CSI-RS-ResourceSet</em>
configured with higher layer parameter <em>trs-Info</em> and, when
applicable, 'typeD' with a CSI-RS resource in an
<em>NZP-CSI-RS-ResourceSet</em> configured with higher layer parameter
<em>repetition</em>, or</p>
<p>- 'typeA' with a CSI-RS resource in a <em>NZP-CSI-RS-ResourceSet</em>
configured without higher layer parameter trs-Info and without higher
layer parameter <em>repetition</em> and, when applicable, 'typeD' with
the same CSI-RS resource.</p>
<p>When a UE is configured with <em>sfnSchemePdcch</em> set to
'sfnSchemeA', and CORESET is activated with two TCI states, the UE shall
assume that the DM-RS port(s)of the PDCCH in the CORESET is quasi
co-located with the DL-RSs of the two TCI states. When a UE is
configured with <em>sfnSchemePdcch</em> set to 'sfnSchemeB', and a
CORESET is activated with two TCI states, the UE shall assume that the
DM-RS port(s)of the PDCCH is quasi co-located with the DL-RSs of the two
TCI states except for quasi co-location parameters {Doppler shift,
Doppler spread} of the second indicated TCI state.</p>
<p>For the DM-RS of PDSCH, if the UE is not configured with
<em>dl-OrJointTCI-StateList,</em> the UE shall expect that a
<em>TCI-State</em> indicates one of the following quasi co-location
type(s):</p>
<p>- 'typeA' with a CSI-RS resource in a <em>NZP-CSI-RS-ResourceSet</em>
configured with higher layer parameter <em>trs-Info</em> and, when
applicable, 'typeD' with the same CSI-RS resource<em>,</em> or</p>
<p>- 'typeA' with a CSI-RS resource in a <em>NZP-CSI-RS-ResourceSet</em>
configured with higher layer parameter <em>trs-Info</em> and, when
applicable, 'typeD' with a CSI-RS resource in an
<em>NZP-CSI-RS-ResourceSet</em> configured with higher layer parameter
<em>repetition</em>,or</p>
<p>- typeA' with a CSI-RS resource in a <em>NZP-CSI-RS-ResourceSet</em>
configured without higher layer parameter <em>trs-Info</em> and without
higher layer parameter <em>repetition</em> and, when applicable, 'typeD'
with the same CSI-RS resource.</p>
<p>For the DM-RS of PDCCH, if the UE is configured with
<em>dl-OrJointTCI-StateList,</em> the UE shall expect that an indicated
<em>TCI-State</em> indicates one of the following quasi co-location
type(s):</p>
<p>- 'typeA' with a CSI-RS resource in a <em>NZP-CSI-RS-ResourceSet</em>
configured with higher layer parameter <em>trs-Info</em> and, when
applicable, 'typeD' with the same CSI-RS resource, or</p>
<p>- 'typeA' with a CSI-RS resource in a <em>NZP-CSI-RS-ResourceSet</em>
configured with higher layer parameter <em>trs-Info</em> and, when
applicable, 'typeD' with a CSI-RS resource in an
<em>NZP-CSI-RS-ResourceSet</em> configured with higher layer parameter
<em>repetition.</em></p>
<p>For the DM-RS of PDSCH, if the UE is configured with
<em>dl-OrJointTCI-StateList,</em> the UE shall expect that an indicated
<em>TCI-State</em> indicates one of the following quasi co-location
type(s):</p>
<p>- 'typeA' with a CSI-RS resource in a <em>NZP-CSI-RS-ResourceSet</em>
configured with higher layer parameter <em>trs-Info</em> and, when
applicable, 'typeD' with the same CSI-RS resource<em>,</em> or</p>
<p>- 'typeA' with a CSI-RS resource in a <em>NZP-CSI-RS-ResourceSet</em>
configured with higher layer parameter <em>trs-Info</em> and, when
applicable, 'typeD' with a CSI-RS resource in an
<em>NZP-CSI-RS-ResourceSet</em> configured with higher layer parameter
<em>repetition.</em></p>
<p>When a UE is configured with <em>sfnSchemePDSCH</em> set to
'sfnSchemeA', and the UE is indicated with two TCI states in a codepoint
of the DCI field 'Transmission Configuration Indication' in a DCI
scheduling a PDSCH, the UE shall assume that the DM-RS port(s)of the
PDSCH is quasi co-located with the DL-RSs of the two TCI states. When a
UE is configured with <em>sfnSchemePDSCH</em> set to 'sfnSchemeB', and
the UE is indicated with two TCI states in a codepoint of the DCI field
'Transmission Configuration Indication' in a DCI scheduling a PDSCH, the
UE shall assume that the DM-RS port(s)of the PDSCH is quasi co-located
with the DL-RSs of the two TCI states except for quasi co-location
parameters {Doppler shift, Doppler spread} of the second indicated TCI
state.</p>
<h3 id="ue-procedure-for-receiving-reference-signals">5.1.6 UE procedure
for receiving reference signals</h3>
<h4 id="csi-rs-reception-procedure">5.1.6.1 CSI-RS reception
procedure</h4>
<p>The CSI-RS defined in Clause 7.4.1.5 of [4, TS 38.211], may be used
for time/frequency tracking, CSI computation, L1-RSRP computation,
L1-SINR computation, mobility, and tracking during fast SCell
activation.</p>
<p>For a CSI-RS resource associated with a
<em>NZP-CSI-RS-ResourceSet</em> with the higher layer parameter
<em>repetition</em> set to 'on', the UE shall not expect to be
configured with CSI-RS over the symbols during which the UE is also
configured to monitor the CORESET, while for other
<em>NZP-CSI-RS-ResourceSet</em> configurations, if the UE is configured
with a CSI-RS resource and a search space set associated with a CORESET
in the same OFDM symbol(s), the UE may assume that the CSI-RS and a
PDCCH DM-RS transmitted in all the search space sets associated with
CORESET are quasi co-located with 'typeD', if 'typeD' is applicable. If
the CORESET is activated with two TCI states, UE may assume that the
first TCI state of the CORESET as the default QCL assumption for the
CSI-RS. This also applies to the case when CSI-RS and the CORESET are in
different intra-band component carriers, if 'typeD' is applicable.
Furthermore, the UE shall not expect to be configured with the CSI-RS in
PRBs that overlap those of the CORESET in the OFDM symbols occupied by
the search space set(s).</p>
<p>The UE is not expected to receive CSI-RS and <em>SIB1</em> message in
the overlapping PRBs in the OFDM symbols where <em>SIB1</em> is
transmitted.</p>
<p>If the UE is configured with DRX,</p>
<p>- if the UE is configured to monitor DCI format 2_6 and configured by
higher layer parameter <em>ps-TransmitOtherPeriodicCSI</em> to report
CSI with the higher layer parameter <em>reportConfigType</em> set to
'periodic' and <em>reportQuantity</em> set to quantities other than
'cri-RSRP' and 'ssb-Index-RSRP' when <em>drx-onDurationTimer</em> in
<em>DRX-Config</em> is not started, the most recent CSI measurement
occasion occurs in DRX active time or during the time duration indicated
by <em>drx-onDurationTimer</em> in <em>DRX-Config</em> also outside DRX
active time for CSI to be reported;</p>
<p>- if the UE is configured to monitor DCI format 2_6 and configured by
higher layer parameter <em>ps-TransmitPeriodicL1-RSRP</em> to report
L1-RSRP with the higher layer parameter <em>reportConfigType</em> set to
'periodic' and <em>reportQuantity</em> set to cri-RSRP when
<em>drx-onDurationTimer</em> in <em>DRX-Config</em> is not started, the
most recent CSI measurement occasion occurs in DRX active time or during
the time duration indicated by <em>drx-onDurationTimer</em> in
<em>DRX-Config</em> also outside DRX active time for CSI to be
reported;</p>
<p>- otherwise, the most recent CSI measurement occasion occurs in DRX
active time for CSI to be reported.</p>
<h5 id="csi-rs-for-tracking">5.1.6.1.1 CSI-RS for tracking</h5>
<p>A UE in RRC connected mode is expected to receive the higher layer UE
specific configuration of a <em>NZP-CSI-RS-ResourceSet</em> configured
with higher layer parameter <em>trs-Info</em>.</p>
<p>For a <em>NZP-CSI-RS-ResourceSet</em> configured with the higher
layer parameter <em>trs-Info</em>, the UE shall assume the antenna port
with the same port index of the configured NZP CSI-RS resources in the
<em>NZP-CSI-RS-ResourceSet</em> is the same.</p>
<p>- For frequency range 1, the UE may be configured with one or more
NZP CSI-RS set(s), where a <em>NZP-CSI-RS-ResourceSet</em> consists of
four periodic NZP CSI-RS resources in two consecutive slots with two
periodic NZP CSI-RS resources in each slot. If no two consecutive slots
are indicated as downlink slots by
<em>tdd-UL-DL-ConfigurationCommon</em> or
<em>tdd-UL-DL-ConfigDedicated</em>, then the UE may be configured with
one or more NZP CSI-RS set(s), where a <em>NZP-CSI-RS-ResourceSet</em>
consists of two periodic NZP CSI-RS resources in one slot.</p>
<p>- For frequency range 2 the UE may be configured with one or more NZP
CSI-RS set(s), where a <em>NZP-CSI-RS-ResourceSet</em> consists of two
periodic CSI-RS resources in one slot or with a
<em>NZP-CSI-RS-ResourceSet</em> of four periodic NZP CSI-RS resources in
two consecutive slots with two periodic NZP CSI-RS resources in each
slot.</p>
<p>A UE configured with <em>NZP-CSI-RS-ResourceSet(s)</em> configured
with higher layer parameter <em>trs-Info</em> may have the CSI-RS
resources configured as:</p>
<p>- Periodic, with the CSI-RS resources in the
<em>NZP-CSI-RS-ResourceSet</em> configured with same periodicity,
bandwidth and subcarrier location.</p>
<p>- Periodic CSI-RS resource in one set and aperiodic CSI-RS resources
in a second set, with the aperiodic CSI-RS and periodic CSI-RS resource
having the same bandwidth (with same RB location) and the aperiodic
CSI-RS being configured with <em>qcl-Type</em> set to 'typeA' and
'typeD', where applicable, with the periodic CSI-RS resources. For
frequency range 2, the UE does not expect that the scheduling offset
between the last symbol of the PDCCH carrying the triggering DCI and the
first symbol of the aperiodic CSI-RS resources is smaller than
<em>beamSwitchTiming</em> + <em>d</em> <span
class="math inline">\(\bullet 2^{\mu_{CSIRS}}/2^{\mu_{PDCCH}}\)</span>
in CSI-RS symbols<em>,</em> where <em>beamSwitchTiming</em> is UE
reported value defined in [13, TS 38.306], the reported value is one of
the values of {14, 28, 48}<span class="math inline">\(\bullet
2^{{max(0,\ \mu}_{CSIRS} - 3)}\)</span>, and the beam switching timing
delay <em>d</em> is defined in Table 5.2.1.5.1a-1 if µ<sub>PDCCH</sub>
&lt; µ<sub>CSIRS</sub> , else <em>d</em> is zero. The UE shall expect
that the periodic CSI-RS resource set and aperiodic CSI-RS resource set
are configured with the same number of CSI-RS resources and with the
same number of CSI-RS resources in a slot. For the aperiodic CSI-RS
resource set if triggered, and if the associated periodic CSI-RS
resource set is configured with four periodic CSI-RS resources with two
consecutive slots with two periodic CSI-RS resources in each slot, the
higher layer parameter <em>aperiodicTriggeringOffset</em> indicates the
triggering offset for the first slot for the first two CSI-RS resources
in the set.</p>
<p>A UE does not expect to be configured with a
<em>CSI-ReportConfig</em> that is linked to a
<em>CSI-ResourceConfig</em> containing an
<em>NZP-CSI-RS-ResourceSet</em> configured with <em>trs-Info</em> and
with the <em>CSI-ReportConfig</em> configured with the higher layer
parameter <em>timeRestrictionForChannelMeasurements</em> set to
'configured'.</p>
<p>A UE does not expect to be configured with a
<em>CSI-ReportConfig</em> with the higher layer parameter
<em>reportQuantity</em> set to other than 'none' for aperiodic NZP
CSI-RS resource set configured with <em>trs-Info.</em></p>
<p>A UE does not expect to be configured with a
<em>CSI-ReportConfig</em> for periodic NZP CSI-RS resource set
configured with <em>trs-Info</em>.</p>
<p>A UE does not expect to be configured with a
<em>NZP-CSI-RS-ResourceSet</em> configured both with <em>trs-Info</em>
and <em>repetition</em>.</p>
<p>Each CSI-RS resource, defined in Clause 7.4.1.5.3 of [4, TS 38.211],
is configured by the higher layer parameter <em>NZP-CSI-RS-Resource</em>
with the following restrictions:</p>
<p>- the time-domain locations of the two CSI-RS resources in a slot, or
of the four CSI-RS resources in two consecutive slots (which are the
same across two consecutive slots), as defined by higher layer parameter
<em>CSI-RS-resourceMapping</em>, is given by one of</p>
<p>- <img src="media/image87.svg" />, <img src="media/image88.svg" />,
or<img src="media/image89.svg" /> for frequency range 1 and frequency
range 2,</p>
<p>- <img src="media/image90.svg" />, <img src="media/image91.svg" />,
<img src="media/image92.svg" />, <img src="media/image93.svg" />, <img
src="media/image94.svg" />, <img src="media/image95.svg" /> or <img
src="media/image96.svg" /> for frequency range 2.</p>
<p>- a single port CSI-RS resource with density <img
src="media/image97.svg" /> given by Table 7.4.1.5.3-1 from [4, TS
38.211] and higher layer parameter <em>density</em> configured by
<em>CSI-RS-ResourceMapping.</em></p>
<p>- if carrier <span
class="math inline">\(N_{\text{grid}}^{\text{size},\mu} = 52\)</span>,
<span class="math inline">\(N_{\text{BWP,i}}^{\text{size}} =
52\)</span>, <span class="math inline">\(\mu = 0\)</span> and the
carrier is configured in paired spectrum, the bandwidth of the CSI-RS
resource, as given by the higher layer parameter <em>freqBand</em>
configured by <em>CSI-RS-ResourceMapping</em>, is <em>X</em> resource
blocks, where <span class="math inline">\(X\  \geq \ 28\)</span>
resource blocks if the UE indicates <em>trs-AddBW-Set1</em> for the
<em>trs-AdditionalBandwidth</em> capability for CSI-RS for tracking or
<em>addBW-Set1</em> for the
<em>aperiodicCSI-RS</em>-<em>AdditionalBandwidth</em> capability for
aperiodic CSI-RS for fast SCell activation and <span
class="math inline">\(X\  \geq \ 32\)</span> if the UE indicates
<em>trs-AddBW-Set2</em> for the <em>AdditionalBandwidth</em> capability
for CSI-RS for tracking or <em>addBW-Set2</em> for the
<em>aperiodicCSI-RS</em>-<em>AdditionalBandwidth</em> capability for
aperiodic CSI-RS for fast SCell activation; in these cases, if the UE is
configured with CSI-RS comprising X&lt;52 resource blocks, the UE does
not expect that the total number of PRBs allocated for DL transmissions
but not overlapped with the PRBs carrying CSI-RS for tracking is more
than 4, where all CSI-RS resource configurations shall span the same set
of resource blocks; otherwise, the bandwidth of the CSI-RS resource, as
given by the higher layer parameter <em>freqBand</em> configured by
<em>CSI-RS-ResourceMapping</em>, is the minimum of 52 and <span
class="math inline">\(N_{\text{BWP,i}}^{\text{size}}\)</span> resource
blocks, or is equal to <span
class="math inline">\(N_{\text{BWP,i}}^{\text{size}}\)</span> resource
blocks. For operation with shared spectrum channel access in FR1,
<em>freqBand</em> configured by <em>CSI-RS-ResourceMapping</em>, is the
minimum of 48 and <span
class="math inline">\(N_{\text{BWP,i}}^{\text{size}}\)</span> resource
blocks, or is equal to <span
class="math inline">\(N_{\text{BWP,i}}^{\text{size}}\)</span> resource
blocks.</p>
<p>- the UE is not expected to be configured with the periodicity of
<img src="media/image98.svg" /> slots if the bandwidth of CSI-RS
resource is larger than 52 resource blocks.</p>
<p>- the periodicity and slot offset for periodic NZP CSI-RS resources,
as given by the higher layer parameter <em>periodicityAndOffset</em>
configured b<em>y NZP-CSI-RS-Resource</em>, is one of <img
src="media/image99.svg" />slots where <img
src="media/image100.svg" />10, 20, 40, or 80 and where µ is defined in
Clause 4.3 of [4, TS 38.211].</p>
<p>- same <em>powerControlOffset</em> and <em>powerControlOffsetSS</em>
given by <em>NZP-CSI-RS-Resource</em> value across all resources.</p>
<p>A UE in RRC_IDLE or RRC_INACTIVE can receive a higher layer
configuration of TRS occasions via a <em>trs-ResourceSetConfig</em>.</p>
<p>- For frequency range 1, the UE may be configured with one or more
TRS resource set(s), where each TRS resource set configured by a
<em>TRS-ResourceSet</em> consists of four periodic NZP CSI-RS resources
in two consecutive slots with two periodic NZP CSI-RS resources in each
slot. If no two consecutive slots are indicated as downlink slots by
<em>tdd-UL-DL-ConfigurationCommon</em>, then the UE may be configured
with one or more TRS resource set(s), where a <em>TRS-ResourceSet</em>
consists of two periodic NZP CSI-RS resources in one slot.</p>
<p>- For frequency range 2 the UE may be configured with one or more TRS
resource set(s), where each TRS resource set configured by a
<em>TRS-ResourceSet</em> consists of two periodic NZP CSI-RS resources
in one slot or by a <em>TRS-ResourceSet</em> of four periodic NZP CSI-RS
resources in two consecutive slots with two periodic NZP CSI-RS
resources in each slot.</p>
<p>Each NZP CSI-RS resource, defined in Clause 7.4.1.5.3 of [4, TS
38.211], is configured by the higher layer parameter
<em>TRS-ResourceSet</em> with the following restrictions for a UE in
RRC_IDLE or RRC_INACTIVE:</p>
<p>- the number of periodic NZP CSI-RS resources configured by a
<em>TRS-ResourceSet</em> is given by <em>nrofResources</em></p>
<p>- the time-domain locations of the two CSI-RS resources in a slot, or
of the four CSI-RS resources in two consecutive slots (which are the
same across two consecutive slots), is one of</p>
<p>- <img src="media/image87.svg" />, <img src="media/image88.svg" />,
or<img src="media/image89.svg" /> for frequency range 1 and frequency
range 2,</p>
<p>- <img src="media/image90.svg" />, <img src="media/image91.svg" />,
<img src="media/image92.svg" />, <img src="media/image93.svg" />, <img
src="media/image94.svg" />, <img src="media/image95.svg" /> or <img
src="media/image96.svg" /> for frequency range 2.</p>
<p>- where the first symbol location in a slot is indicated by
<em>firstOFDMSymbolInTimeDomain</em> in the <em>TRS-ResourceSet</em> and
the second symbol location in a slot is <em>firstOFDMSymbolInTimeDomain
+</em> 4</p>
<p>- a single port CSI-RS resource with density <img
src="media/image97.svg" /> given by Table 7.4.1.5.3-1 from [4, TS
38.211]<em>.</em></p>
<p>- the bandwidth and the frequency location of the NZP CSI-RS
resource, is given by the higher layer parameter <em>nrofRBs</em>,
<em>startingRB</em> and <em>frequencyDomainAllocation</em> in a
<em>TRS-ResourceSet</em> and applies to all resources in a
<em>TRS-ResourceSet</em>. Bandwidth, <em>nrofRBs</em>, and the initial
CRB index, <em>startingRB</em>, of the NZP CSI-RS resource configured by
<em>TRS-ResourceSet</em> are not restricted by initial DL BWP.</p>
<p>- UE is not required to receive TRS occasions outside the initial DL
BWP.</p>
<p>- the periodicity for periodic NZP CSI-RS resources, is given by the
higher layer parameter <em>periodicityAndOffset</em> configured
b<em>y</em> a <em>TRS-ResourceSet</em>, is one of <img
src="media/image99.svg" />slots where <img
src="media/image100.svg" />10, 20, 40, or 80 and where µ is defined in
Clause 4.3 of [4, TS 38.211], applies to all resources in a
<em>TRS-ResourceSet</em>. The slot offset given by the higher layer
parameter <em>periodicityAndOffset</em> configured b<em>y</em> a
<em>TRS-ResourceSet</em> provides the location of the first slot
containing the periodic NZP CSI-RS resources configured by b<em>y</em> a
<em>TRS-ResourceSet.</em></p>
<p>- the UE does not expect the <em>TRS-ResourceSet</em> to be
configured with the periodicity of <img src="media/image98.svg" /> slots
if the bandwidth of NZP CSI-RS resource is larger than 52 resource
blocks.</p>
<p>- the UE may assume the sub-carrier spacing of the NZP CSI-RS
resources configured by <em>TRS-ResourceSet</em> to be same as the
sub-carrier spacing of the initial DL BWP.</p>
<p>- <em>powerControlOffsetSS</em> given by a <em>TRS-ResourceSet</em>
applies to all resources in a <em>TRS-ResourceSet</em>.</p>
<p>- the QCL information for periodic NZP CSI-RS resources, is given by
the higher layer parameter <em>ssb-Index</em> configured by a
<em>TRS-ResourceSet</em>, is a SS/PBCH block, applies to all resources
in a <em>TRS-ResourceSet</em>.</p>
<p>- One or more scrambling IDs according to <em>scramblingID-Info</em>
where if a single <em>scramblingIDforCommon</em> is configured, it
applies to all NZP-CSI-RS resources in the resource set, otherwise, each
NZP-CSI-RS resource is provided with a scrambling IDs according to
<em>scramblingIDperResourceListWith2</em> or
<em>scramblingIDperResourceListWith4</em>.</p>
<p>- the UE may assume the following quasi co-location type(s):</p>
<p>- 'typeC' with an SS/PBCH block and, when applicable, 'typeD' with
the same SS/PBCH block.</p>
<p>For each <em>TRS-ResourceSet</em> the index of the associated bit in
TRS availability indication field [5, TS 38.212], is given by the higher
layer parameter <em>indBitID</em>.</p>
<h5
id="aperiodic-csi-rs-for-tracking-for-fast-scell-activation">5.1.6.1.1.1
Aperiodic CSI-RS for tracking for fast SCell activation</h5>
<p>A UE can be configured with aperiodic CSI-RS resources for tracking
for an SCell for fast SCell activation using
<em>NZP-CSI-RS-ResourceSet(s)</em> with the higher layer parameter
<em>scellActivationRS-ConfigToAddModList</em>, with the QCL relation,
provided by higher layer parameter <em>qcl-Info</em> given by
<em>SCellActivationRS-Config</em> as with aperiodic CSI-RS for tracking
in clause 5.1.6.1.1.</p>
<p>Each CSI-RS resource, defined in clause 7.4.1.5.3 of [4, TS 38.211],
for fast SCell activation is configured by the higher layer parameter
<em>NZP-CSI-RS-Resource</em> with the same restrictions as defined for
CSI-RS for tracking in clause 5.1.6.1.1.</p>
<h5 id="csi-rs-for-l1-rsrp-and-l1-sinr-computation">5.1.6.1.2 CSI-RS for
L1-RSRP and L1-SINR computation</h5>
<p>If a UE is configured with a <em>NZP-CSI-RS-ResourceSet</em>
configured with the higher layer parameter <em>repetition</em> set to
'on', the UE may assume that the CSI-RS resources, described in Clause
5.2.2.3.1, within the <em>NZP-CSI-RS-ResourceSet</em> are transmitted
with the same downlink spatial domain transmission filter, where the
CSI-RS resources in the <em>NZP-CSI-RS-ResourceSet</em> are transmitted
in different OFDM symbols. If <em>repetition</em> is set to 'off', the
UE shall not assume that the CSI-RS resources within the
<em>NZP-CSI-RS-ResourceSet</em> are transmitted with the same downlink
spatial domain transmission filter.</p>
<p>If the UE is configured with a <em>CSI-ReportConfig</em> with
<em>reportQuantity</em> set to 'cri-RSRP', 'cri-SINR' or 'none' and if
the <em>CSI-ResourceConfig</em> for channel measurement (higher layer
parameter <em>resourcesForChannelMeasurement</em>) contains a
<em>NZP-CSI-RS-ResourceSet</em> that is configured with the higher layer
parameter <em>repetition</em> and without the higher layer parameter
<em>trs-Info</em>, the UE can only be configured with the same number (1
or 2) of ports with the higher layer parameter <em>nrofPorts</em> for
all CSI-RS resources within the set. If the UE is configured with the
CSI-RS resource in the same OFDM symbol(s) as an SS/PBCH block, the UE
may assume that the CSI-RS and the SS/PBCH block are quasi co-located
with 'typeD' if 'typeD' is applicable. Furthermore, the UE shall not
expect to be configured with the CSI-RS in PRBs that overlap with those
of the SS/PBCH block, and the UE shall expect that the same subcarrier
spacing is used for both the CSI-RS and the SS/PBCH block.</p>
<h5 id="csi-rs-for-mobility">5.1.6.1.3 CSI-RS for mobility</h5>
<p>If a UE is configured with the higher layer parameter
<em>CSI-RS-Resource-Mobility</em> and the higher layer parameter
<em>associatedSSB</em> is not configured, the UE shall perform
measurements based on <em>CSI-RS-Resource-Mobility</em> and the UE may
base the timing of the CSI-RS resource on the timing of the serving
cell.</p>
<p>If a UE is configured with the higher layer parameters
<em>CSI-RS-Resource-Mobility</em> and <em>associatedSSB</em>, the UE may
base the timing of the CSI-RS resource on the timing of the cell given
by the <em>cellId</em> of the CSI-RS resource configuration.
Additionally, for a given CSI-RS resource, if the associated SS/PBCH
block is configured but not detected by the UE, the UE is not required
to monitor the corresponding CSI-RS resource. The higher layer parameter
<em>isQuasiColocated</em> indicates whether the associated SS/PBCH block
given by the <em>associatedSSB</em> and the CSI-RS resource(s) are quasi
co-located with respect to 'typeD', when applicable.</p>
<p>If a UE is configured with the higher layer parameter
<em>CSI-RS-Resource-Mobility</em> and with periodicity greater than 10
msec in paired spectrum, the UE may assume the absolute value of the
time difference between radio frame <em>i</em> between any two cells,
listed in the configuration with the higher layer parameter
<em>CSI-RS-CellMobility</em> and with same <em>refFreqCSI-RS</em>, is
less than 153600 <em>T<sub>s</sub></em>.</p>
<p>If the UE is configured with DRX, the UE is not required to perform
measurement of CSI-RS resources other than during the active time for
measurements based on <em>CSI-RS-Resource-Mobility</em>. When the UE is
configured to monitor DCI format 2_6, the UE is not required to perform
measurements other than during the active time and during the timer
duration indicated by <em>drx-onDurationTimer</em> in
<em>DRX-Config</em> also outside active time based on
<em>CSI-RS-Resource-Mobility</em>.</p>
<p>If the UE is configured with DRX and DRX cycle in use is larger than
80 msec, the UE may not expect CSI-RS resources are available other than
during the active time for measurements based on
<em>CSI-RS-Resource-Mobility</em>. If the UE is configured with DRX and
configured to monitor DCI format 2_6 and DRX cycle in use is larger than
80 msec, the UE may not expect that the CSI-RS resources are available
other than during the active time and during the time duration indicated
by <em>drx-onDurationTimer</em> in <em>DRX-Config</em> also outside
active time for measurements based on <em>CSI-RS-Resource-Mobility.</em>
Otherwise, the UE may assume CSI-RS are available for measurements based
on <em>CSI-RS-Resource-Mobility</em>.</p>
<p>A UE configured with the higher layer parameters
<em>CSI-RS-Resource-Mobility</em> may expect to be configured</p>
<p>- with no more than 96 CSI-RS resources per higher layer parameter
<em>MeasObjectNR</em> for UEs not supporting
[<em>increasedNumberofCSIRSPerMO-r16</em>] when all CSI-RS resources
configured by the same higher layer parameter <em>MeasObjectNR</em> have
been configured with <em>associatedSSB</em>, or,</p>
<p>- with no more than 192 CSI-RS resources per higher layer parameter
<em>MeasObjectNR</em> for UEs supporting
[<em>increasedNumberofCSIRSPerMO-r16</em>] when all CSI-RS resources
configured by the same higher layer parameter <em>MeasObjectNR</em> have
been configured with <em>associatedSSB</em>, or,</p>
<p>- with no more than 64 CSI-RS resources per higher layer parameter
<em>MeasObjectNR</em> when all CSI-RS resources have been configured
without <em>associatedSSB</em> or when only some of the CSI-RS resources
have been configured with associatedSSB by the same higher layer
parameter <em>MeasObjectNR</em></p>
<p>- For frequency range 1 the <em>associatedSSB</em> is optionally
present for each CSI-RS resource.</p>
<p>- For frequency range 2 the <em>associatedSSB</em> is either present
for all configured CSI-RS resources or not present for any configured
CSI-RS resource per higher layer parameter <em>MeasObjectNR</em>.</p>
<p>For any CSI-RS resource configuration, the UE shall assume that the
value for parameter <em>cdm-Type</em> is 'noCDM', and there is only one
antenna port.</p>
<h4 id="dm-rs-reception-procedure">5.1.6.2 DM-RS reception
procedure</h4>
<p>The DM-RS reception procedures for PDSCH scheduled by PDCCH with DCI
format 1_1 described in this clause equally apply to PDSCH scheduled by
PDCCH with DCI format 1_2, by applying the parameters of
<em>dmrs-DownlinkForPDSCH-MappingTypeA-DCI-1-2</em> and
<em>dmrs-DownlinkForPDSCH-MappingTypeB-DCI-1-2</em> instead of
<em>dmrs-DownlinkForPDSCH-MappingTypeA</em> and
<em>dmrs-DownlinkForPDSCH-MappingTypeB</em>.</p>
<p>The DM-RS reception procedures for PDSCH scheduled by PDCCH with DCI
format 1_1 described in this clause equally apply to PDSCH scheduled by
PDCCH with DCI format 4_2, by applying the parameters of
<em>dmrs-DownlinkForPDSCH-MappingTypeA</em> and
<em>dmrs-DownlinkForPDSCH-MappingTypeB</em> in
<em>pdsch-ConfigMulticast</em> instead of
<em>dmrs-DownlinkForPDSCH-MappingTypeA</em> and
<em>dmrs-DownlinkForPDSCH-MappingTypeB in PDSCH-Config</em>.</p>
<p>When receiving PDSCH scheduled by DCI format 1_0, 4_0, or 4_1, or
receiving PDSCH before dedicated higher layer configuration of any of
the parameters <em>dmrs-AdditionalPosition</em>, <em>maxLength</em> and
<em>dmrs-Type,</em> the UE shall assume that the PDSCH is not present in
any symbol carrying DM-RS except for PDSCH with allocation duration of 2
symbols with PDSCH mapping type B (described in clause 7.4.1.1.2 of [4,
TS 38.211]), and a single symbol front-loaded DM-RS of configuration
type 1 on DM-RS port 1000 is transmitted, and that all the remaining
orthogonal antenna ports are not associated with transmission of PDSCH
to another UE and in addition</p>
<p>- For PDSCH with mapping type A and type B, the UE shall assume
<em>dmrs-AdditionalPosition</em>='pos2' and up to two additional
single-symbol DM-RS present in a slot according to the PDSCH duration
indicated in the DCI as defined in Clause 7.4.1.1 of [4, TS 38.211],
and</p>
<p>- For PDSCH with allocation duration of 2 symbols with mapping type
B, the UE shall assume that the PDSCH is present in the symbol carrying
DM-RS.</p>
<p>When receiving PDSCH scheduled by DCI format 1_1 by PDCCH with CRC
scrambled by C-RNTI, MCS-C-RNTI, or CS-RNTI or DCI format 4_2 by PDCCH
with CRC scrambled by G-RNTI for multicast or G-CS-RNTI,</p>
<p>- the UE may be configured with the higher layer parameter
<em>dmrs-Type</em>, and the configured DM-RS configuration type is used
for receiving PDSCH in as defined in Clause 7.4.1.1 of [4, TS
38.211].</p>
<p>- the UE may be configured with the maximum number of front-loaded
DM-RS symbols for PDSCH by higher layer parameter <em>maxLength</em>
given by <em>DMRS-DownlinkConfig..</em></p>
<p>- if <em>maxLength</em> is set to 'len1', single-symbol DM-RS can be
scheduled for the UE by DCI, and the UE can be configured with a number
of additional DM-RS for PDSCH by higher layer parameter
<em>dmrs-AdditionalPosition,</em> which can be set to 'pos0', 'pos1',
'pos2' or 'pos3'.</p>
<p>- if <em>maxLength</em> is set to 'len2', both single-symbol DM-RS
and double symbol DM-RS can be scheduled for the UE by DCI, and the UE
can be configured with a number of additional DM-RS for PDSCH by higher
layer parameter <em>dmrs-AdditionalPosition,</em> which can be set to
'pos0' or 'pos1'.</p>
<p>- and the UE shall assume to receive additional DM-RS as specified in
Table 7.4.1.1.2-3 and Table 7.4.1.1.2-4 as described in Clause 7.4.1.1.2
of [4, TS 38.211].</p>
<p>For the UE-specific reference signals generation as defined in Clause
7.4.1.1 of [4, TS 38.211], a UE can be configured by higher layers with
one or two scrambling identity(s), <span
class="math inline">\(n_{ID}^{DMRS,i}\ \)</span><em>i</em> = 0,1 which
are the same for both PDSCH mapping Type A and Type B.</p>
<p>A UE may be scheduled with a number of DM-RS ports by the antenna
port index in DCI format 1_1 as described in Clause 7.3.1.2 of [5, TS
38.212].</p>
<p>For DM-RS configuration type 1,</p>
<p>- if a UE is scheduled with one codeword and assigned with the
antenna port mapping with indices of {2, 9, 10, 11 or 30} in Table
7.3.1.2.2-1 and Table 7.3.1.2.2-2 of Clause 7.3.1.2 of [5, TS 38.212],
or</p>
<p>- if a UE is scheduled with one codeword and assigned with the
antenna port mapping with indices of {2, 9, 10, 11 or 12} in Table
7.3.1.2.2-1A and {2, 9, 10, 11, 30 or 31} in Table 7.3.1.2.2-2A of
Clause 7.3.1.2 of [5, TS 38.212], or</p>
<p>- if a UE is scheduled with two codewords,</p>
<p>the UE may assume that all the remaining orthogonal antenna ports are
not associated with transmission of PDSCH to another UE.</p>
<p>For DM-RS configuration type 2,</p>
<p>- if a UE is scheduled with one codeword and assigned with the
antenna port mapping with indices of {2, 10 or 23} in Table 7.3.1.2.2-3
and Table 7.3.1.2.2-4 of Clause 7.3.1.2 of [5, TS38.212], or</p>
<p>- if a UE is scheduled with one codeword and assigned with the
antenna port mapping with indices of {2, 10, 23 or 24} in Table
7.3.1.2.2-3A and {2, 10, 23 or 58} in Table 7.3.1.2.2-4A of Clause
7.3.1.2 of [5, TS 38.212], or</p>
<p>- if a UE is scheduled with two codewords,</p>
<p>the UE may assume that all the remaining orthogonal antenna ports are
not associated with transmission of PDSCH to another UE.</p>
<p>If a UE receiving PDSCH scheduled by DCI format 1_2 is configured
with the higher layer parameter <em>phaseTrackingRS</em> in
<em>dmrs-DownlinkForPDSCH-MappingTypeA-DCI-1-2</em> or
<em>dmrs-DownlinkForPDSCH-MappingTypeB-DCI-1-2</em> or a UE receiving
PDSCH scheduled by DCI format 1_0 or DCI format 1_1 is configured with
the higher layer parameter <em>phaseTrackingRS</em> in
<em>dmrs-DownlinkForPDSCH-MappingTypeA</em> or
<em>dmrs-DownlinkForPDSCH-MappingTypeB</em>, the UE may assume that the
following configurations are not occurring simultaneously for the
received PDSCH:</p>
<p>- any DM-RS ports among 1004-1007 or 1006-1011 for DM-RS
configurations type 1 and type 2, respectively are scheduled for the UE
and the other UE(s) sharing the DM-RS REs on the same CDM group(s),
and</p>
<p>- PT-RS is transmitted to the UE.</p>
<p>The UE is not expected to simultaneously be configured with the
maximum number of front-loaded DM-RS symbols for PDSCH by higher layer
parameter <em>maxLength</em> being set equal to 'len2' and more than one
additional DM-RS symbol as given by the higher layer parameter
<em>dmrs-AdditionalPosition</em>.</p>
<p>The UE is not expected to assume co-scheduled UE(s) with different
DM-RS configuration with respect to the actual number of front-loaded
DM-RS symbol(s), the actual number of additional DM-RS, the DM-RS symbol
location, and DM-RS configuration type as described in Clause 7.4.1.1 of
[4, TS 38.211].</p>
<p>The UE does not expect the precoding of the potential co-scheduled
UE(s) in other DM-RS ports of the same CDM group to be different in the
PRG-level grid configured to this UE with PRG =2 or 4.</p>
<p>The UE does not expect the resource allocation of the potential
co-scheduled UE(s) in other DM-RS ports of the same CDM group to be
misaligned in the PRG-level grid to this UE with PRG=2 or 4.</p>
<p>When receiving PDSCH scheduled by DCI format 1_1, the UE shall assume
that the CDM groups indicated in the configured index from Tables
7.3.1.2.2-1, 7.3.1.2.2-1A, 7.3.1.2.2-2, 7.3.1.2.2-2A, 7.3.1.2.2-3,
7.3.1.2.2-3A, 7.3.1.2.2-4, 7.3.1.2.2-4A of [5, TS. 38.212] contain
potential co-scheduled downlink DM-RS and are not used for data
transmission, where "1", "2" and "3" for the number of DM-RS CDM
group(s) in Tables 7.3.1.2.2-1, 7.3.1.2.2-1A, 7.3.1.2.2-2, 7.3.1.2.2-3,
7.3.1.2.2-3A, 7.3.1.2.2-4, 7.3.1.2.2-4A of [5, TS. 38.212] correspond to
CDM group 0, {0,1}, {0,1,2}, respectively.</p>
<p>When receiving PDSCH scheduled by DCI format 1_0, 4_0, or 4_1, the UE
shall assume the number of DM-RS CDM groups without data is 1 which
corresponds to CDM group 0 for the case of PDSCH with allocation
duration of 2 symbols, and the UE shall assume that the number of DM-RS
CDM groups without data is 2 which corresponds to CDM group {0,1} for
all other cases.</p>
<p>The UE is not expected to receive PDSCH scheduling DCI which
indicates CDM group(s) with potential DM-RS ports which overlap with any
configured CSI-RS resource(s) for that UE.</p>
<p>If the UE receives the DM-RS for PDSCH and an SS/PBCH block
associated with the same PCI in the same OFDM symbol(s), then the UE may
assume that the DM-RS and SS/PBCH block are quasi co-located with
'typeD', if 'typeD' is applicable. Furthermore, the UE shall not expect
to receive DM-RS in resource elements that overlap with those of the
SS/PBCH block associated with the same PCI as the DM-RS, and the UE can
expect that the same or different subcarrier spacing is configured for
the DM-RS and SS/PBCH block in a CC except for the case of 240 kHz where
only different subcarrier spacing is supported. A DM-RS for PDSCH is
said to be associated with an additional PCI if the indicated TCI state
for the PDSCH is associated with the additional PCI, otherwise a DM-RS
for PDSCH is associated with serving cell PCI.</p>
<p>If at least one TCI codepoint indicates two TCI states and the UE
receives the DM-RS for PDSCH and an SS/PBCH block in the same OFDM
symbol(s), then the UE may assume that at least one DM-RS port for the
PDSCH and SS/PBCH block are quasi co-located with 'QCL-TypeD', if
'QCL-TypeD' is applicable.</p>
<p>If the UE is configured by higher layer parameter
<em>PDCCH-Config</em> that contains two different values of
CORESETPoolIndex in different ControlResourceSets, and the UE receives
the DM-RS for PDSCH(s) and an SS/PBCH block in the same OFDM symbol(s),
then the UE may assume that at least one DM-RS port for the PDSCH(s) and
SS/PBCH block are quasi co-located with 'QCL-TypeD', if 'QCL-TypeD' is
applicable.</p>
<p>If a UE is configured by the higher layer parameter
<em>PDCCH-Config</em> that contains two different values of
<em>coresetPoolIndex</em> in <em>ControlResourceSet</em>, the UE may be
scheduled with fully or partially overlapping PDSCHs in the time and
frequency domain by multiple PDCCHs with the following restrictions,</p>
<p>- the UE is not expected to assume different DM-RS configuration with
respect to the actual number of front-loaded DM-RS symbol(s), the actual
number of additional DM-RS symbol(s), the actual DM-RS symbol location,
and DM-RS configuration type.</p>
<p>- the UE is not expected to assume DM-RS ports in a CDM group
indicated by two TCI states.</p>
<p>When a UE is not indicated with a DCI that DCI field '<em>Time domain
resource assignment</em>' indicating an entry which contains
<em>repetitionNumber</em> in
<em>PDSCH-TimeDomainResourceAllocation,</em> the UE is not configured
with <em>sfnSchemePDSCH</em> and it is indicated with two TCI states in
a codepoint of the DCI field <em>'Transmission Configuration
Indication'</em> and DM-RS port(s) within two CDM groups in the DCI
field '<em>Antenna Port(s)',</em></p>
<p>- the first TCI state corresponds to the CDM group of the first
antenna port indicated by the antenna port indication table, and the
second TCI state corresponds to the other CDM group.</p>
<p>If a UE is configured with higher layer parameter
<em>dmrs-FD-OCC-DisabledForRank1-PDSCH</em> and the UE is scheduled with
PDSCH with single DM-RS port, the UE may assume that set of orthogonal
DM-RS antenna ports from the same CDM group using different set of
<em>w</em><sub>f</sub>(<em>k</em>') codes are not associated with the
transmission of PDSCH to another UE.</p>
<h4 id="pt-rs-reception-procedure">5.1.6.3 PT-RS reception
procedure</h4>
<p>The procedures on PT-RS reception described in this clause apply to a
UE receiving PDSCH scheduled by DCI format 1_2 configured with the
higher layer parameter <em>phaseTrackingRS</em> in
<em>dmrs-DownlinkForPDSCH-MappingTypeA-DCI-1-2</em> or
<em>dmrs-DownlinkForPDSCH-MappingTypeB-DCI-1-2</em> and to a UE
receiving PDSCH scheduled by DCI format 1_0 or DCI format 1_1 configured
with the higher layer parameter <em>phaseTrackingRS</em> in
<em>dmrs-DownlinkForPDSCH-MappingTypeA</em> or
<em>dmrs-DownlinkForPDSCH-MappingTypeB</em>. The procedures on PT-RS
reception described in this clause apply to a UE receiving PDSCH
scheduled by DCI format 4_1 or 4_2 configured with the higher layer
parameter <em>phaseTrackingRS</em> in
<em>dmrs-DownlinkForPDSCH-MappingTypeA</em> or
<em>dmrs-DownlinkForPDSCH-MappingTypeB</em> in
<em>pdsch-ConfigMulticast</em>.</p>
<p>A UE shall report the preferred MCS and bandwidth thresholds based on
the UE capability at a given carrier frequency, for each subcarrier
spacing applicable to data channel at this carrier frequency, assuming
the MCS table with the maximum Modulation Order as it reported to
support.</p>
<p>If a UE is configured with the higher layer parameter
<em>phaseTrackingRS</em> in <em>DMRS-DownlinkConfig</em>,</p>
<p>- the higher layer parameters <em>timeDensity</em> and
<em>frequencyDensity</em> in <em>PTRS-DownlinkConfig</em> indicate the
threshold values <em>ptrs-MCS<sub>i</sub></em>, <em>i</em>=1,2,3 and
<em>N<sub>RB,i</sub></em> , <em>i</em>=0,1, as shown in Table 5.1.6.3-1
and Table 5.1.6.3-2, respectively.</p>
<p>- if either or both of the additional higher layer parameters
<em>timeDensity</em> and <em>frequencyDensity</em> are configured, and
the RNTI equals MCS-C-RNTI, C-RNTI or CS-RNTI, the UE shall assume the
PT-RS antenna port' presence and pattern is a function of the
corresponding scheduled MCS of the corresponding codeword and scheduled
bandwidth in corresponding bandwidth part as shown in Table 5.1.6.3-1
and Table 5.1.6.3-2,</p>
<p>- if the higher layer parameter <em>timeDensity</em> given by
<em>PTRS-DownlinkConfig</em> is not configured, the UE shall assume
<em>L<sub>PT-RS </sub></em>= 1.</p>
<p>- if the higher layer parameter <em>frequencyDensity</em> given by
<em>PTRS-DownlinkConfig</em> is not configured, the UE shall assume
<em>K<sub>PT-RS</sub></em> = 2.</p>
<p>- otherwise, if neither of the additional higher layer parameters
<em>timeDensity</em> and <em>frequencyDensity</em> are configured and
the RNTI equals MCS-C-RNTI, C-RNTI or CS-RNTI, the UE shall assume the
PT-RS is present with <em>L<sub>PT-RS </sub></em>= 1,
<em>K<sub>PT-RS</sub></em> = 2, and the UE shall assume PT-RS is not
present when</p>
<p>- the scheduled MCS from Table 5.1.3.1-1 is smaller than 10, or</p>
<p>- the scheduled MCS from Table 5.1.3.1-2 is smaller than 5, or</p>
<p>- the scheduled MCS from Table 5.1.3.1-3 is smaller than 15, or</p>
<p>- the scheduled MCS from Table 5.1.3.1-4 is smaller than 3, or</p>
<p>- the number of scheduled RBs is smaller than 3, or</p>
<p>- otherwise, if the RNTI equals RA-RNTI, [MSGB-RNTI], SI-RNTI, or
P-RNTI, the UE shall assume PT-RS is not present</p>
<p>Table 5.1.6.3-1: Time density of PT-RS as a function of scheduled
MCS</p>
<table>
<colgroup>
<col style="width: 51%" />
<col style="width: 48%" />
</colgroup>
<thead>
<tr>
<th>Scheduled MCS</th>
<th>Time density (<img src="media/image101.svg" />)</th>
</tr>
</thead>
<tbody>
<tr>
<td>I<sub>MCS</sub> &lt; ptrs-MCS<sub>1</sub></td>
<td>PT-RS is not present</td>
</tr>
<tr>
<td>ptrs-MCS1 <img src="media/image102.svg" /> I<sub>MCS</sub> &lt;
ptrs-MCS2</td>
<td>4</td>
</tr>
<tr>
<td>ptrs-MCS2 <img src="media/image103.svg" /> I<sub>MCS</sub> &lt;
ptrs-MCS3</td>
<td>2</td>
</tr>
<tr>
<td>ptrs-MCS3 <img src="media/image103.svg" /> I<sub>MCS</sub> &lt;
ptrs-MCS4</td>
<td>1</td>
</tr>
</tbody>
</table>
<p>Table 5.1.6.3-2: Frequency density of PT-RS as a function of
scheduled bandwidth</p>
<table>
<colgroup>
<col style="width: 49%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr>
<th>Scheduled bandwidth</th>
<th>Frequency density (<img src="media/image104.svg" />)</th>
</tr>
</thead>
<tbody>
<tr>
<td><em>N<sub>RB</sub></em> &lt; <em>N<sub>RB0</sub></em></td>
<td>PT-RS is not present</td>
</tr>
<tr>
<td><em>N<sub>RB0</sub></em> <img src="media/image103.svg" />
<em>N<sub>RB</sub></em> &lt; <em>N<sub>RB1</sub></em></td>
<td>2</td>
</tr>
<tr>
<td><em>N<sub>RB1</sub></em> <img src="media/image103.svg" />
<em>N<sub>RB</sub></em></td>
<td>4</td>
</tr>
</tbody>
</table>
<p>If a UE is not configured with the higher layer parameter
<em>phaseTrackingRS</em> in <em>DMRS-DownlinkConfig</em>, the UE assumes
PT-RS is not present.</p>
<p>The higher layer parameter <em>PTRS-DownlinkConfig</em> provides the
parameters <em>ptrs-MCS<sub>i</sub></em>, <em>i</em>=1,2,3 and with
values in range 0-29 when MCS Table 5.1.3.1-1 or MCS Table 5.1.3.1-3 is
used and 0-28 when MCS Table 5.1.3.1-2 is used, and 0-27 when MCS Table
5.1.3.1-4 is used, respectively. <em>ptrs-MCS4</em> is not explicitly
configured by higher layers but assumed 29 when MCS Table 5.1.3.1-1 or
MCS Table 5.1.3.1-3 is used and 28 when MCS Table 5.1.3.1-2 is used and
27 when MCS Table 5.1.3.1-4 is used, respectively. The higher layer
parameter <em>frequencyDensity</em> in <em>PTRS-DownlinkConfig</em>
provides the parameters <em>N<sub>RBi</sub></em> <em>i</em>=0,1 with
values in range 1-276.</p>
<p>If the higher layer parameter <em>PTRS-DownlinkConfig</em> indicates
that the time density thresholds <em>ptrs-MCS<sub>i</sub></em> =
<em>ptrs-MCS<sub>i+1</sub></em>, then the time density
<em>L<sub>PT-RS</sub></em> of the associated row where both these
thresholds appear in Table 5.1.6.3-1 is disabled. If the higher layer
parameter <em>PTRS-DownlinkConfig</em> indicates that the frequency
density thresholds <em>N<sub>RBi</sub></em> = <em>N<sub>RBi</sub></em>
<em><sub>+1</sub></em>, then the frequency density
<em>K<sub>PTRS</sub></em> of the associated row where both these
thresholds appear in Table 5.1.6.3-2 is disabled.</p>
<p>If either or both of the parameters PT-RS time density
(<em>L<sub>PT-RS</sub></em>) and PT-RS frequency density
(<em>K<sub>PT-RS</sub></em>), shown in Table 5.1.6.3-1 and Table
5.1.6.3-2, indicates that 'PT-RS not present', the UE shall assume that
PT-RS is not present.</p>
<p>When the UE is receiving a PDSCH with allocation duration of 2
symbols as defined in Clause 7.4.1.1.2 of [4, TS 38.211] and if
<em>L<sub>PT-RS</sub></em> is set to 2 or 4, the UE shall assume PT-RS
is not transmitted.</p>
<p>When the UE is receiving a PDSCH with allocation duration of 4
symbols and if <em>L<sub>PT-RS</sub></em> is set to 4, the UE shall
assume PT-RS is not transmitted.</p>
<p>When a UE is receiving PDSCH for retransmission, if the UE is
scheduled with an MCS index greater than V, where V=28 for MCS Table
5.1.3.1-1 and Table 5.1.3.1-3, and V=27 for MCS Table 5.1.3.1-2, and
V=26 for MCS Table 5.1.3.1-4 respectively, the MCS for the PT-RS
time-density determination is obtained from the DCI received for the
same transport block in the initial transmission, which is smaller than
or equal to V.</p>
<p>The DL DM-RS port(s) associated with a PT-RS port are assumed to be
quasi co-located with respect to 'typeA' and 'typeD'. If a UE is
scheduled with one codeword, the PT-RS antenna port is associated with
the lowest indexed DM-RS antenna port among the DM-RS antenna ports
assigned for the PDSCH.</p>
<p>If a UE is scheduled with two codewords, the PT-RS antenna port is
associated with the lowest indexed DM-RS antenna port among the DM-RS
antenna ports assigned for the codeword with the higher MCS. If the MCS
indices of the two codewords are the same, the PT-RS antenna port is
associated with the lowest indexed DM-RS antenna port assigned for
codeword 0.</p>
<p>When a UE is not indicated with a DCI that DCI field '<em>Time domain
resource assignment</em>' indicating an entry which contains
<em>repetitionNumber</em> in
<em>PDSCH-TimeDomainResourceAllocation</em>, and if the UE is configured
with the higher layer parameter <em>maxNrofPorts</em> equal to
<em>n2</em>, the UE is not configured with <em>sfnSchemePDSCH</em> and
if the UE is indicated with two TCI states by the codepoints of the DCI
field <em>'Transmission Configuration Indication'</em> and DM-RS port(s)
within two CDM groups in the DCI field '<em>Antenna Port(s)'</em>, the
UE shall receive two PT-RS ports which are associated to the lowest
indexed DM-RS port among the DM-RS ports corresponding to the
first/second indicated TCI state, respectively.</p>
<p>When a UE configured by the higher layer parameter
<em>repetitionScheme</em> set to 'fdmSchemeA<em>'</em> or
'fdmSchemeB<em>',</em> and the UE is indicated with two TCI states in a
codepoint of the DCI field <em>'Transmission Configuration
Indication'</em> and DM-RS port(s) within one CDM group in the DCI field
'<em>Antenna Port(s)</em>', the UE shall receive a single PT-RS port
which is associated with the lowest indexed DM-RS antenna port among the
DM-RS antenna ports assigned for the PDSCH, a PT-RS frequency density is
determined by the number of PRBs associated to each TCI state, and a
PT-RS resource element mapping is associated to the allocated PRBs for
each TCI state.</p>
<h4 id="srs-reception-procedure-for-cli">5.1.6.4 SRS reception procedure
for CLI</h4>
<p>The SRS resources defined in Clause 6.4.1.4 of [4, TS 38.211] may be
configured for SRS-RSRP measurement for CLI, as defined in Clause 5.1.19
of [7, TS 38.215]. The UE is not expected to measure SRS-RSRP with a
subcarrier spacing other than the one configured for the active BWP
confining the SRS resource. The UE is not expected to measure SRS-RSRP
using the SRS-RSRP measurement resource which is not fully confined
within the DL active BWP. The UE is not expected to measure more than 32
SRS resources, and the UE is not expected to receive more than 8 SRS
resources in a slot.</p>
<h4 id="prs-reception-procedure">5.1.6.5 PRS reception procedure</h4>
<p>The UE can be configured with one or more DL PRS resource set
configuration(s) as indicated by the higher layer parameters
<em>NR-DL-PRS-ResourceSet</em> and <em>NR-DL-PRS-Resource</em> as
defined by Clause 6.4.3 [17, TS 37.355]. Each DL PRS resource set
consists of K≥1 DL PRS resource(s) where each has an associated spatial
transmission filter. The UE can be configured with one or more DL PRS
positioning frequency layer configuration(s) as indicated by the higher
layer parameter <em>NR-DL-PRS-PositioningFrequencyLayer.</em> A DL PRS
positioning frequency layer is defined as a collection of DL PRS
resource sets which have common parameters configured by
<em>NR-DL-PRS-PositioningFrequencyLayer</em>.</p>
<p>The UE assumes that the following parameters for each DL PRS
resource(s) are configured via higher layer parameters
<em>NR-DL-PRS-PositioningFrequencyLayer, NR-DL-PRS-ResourceSet</em> and
<em>NR-DL-PRS-Resource</em>.</p>
<p>A DL PRS positioning frequency layer is configured by
<em>NR-DL-PRS-PositioningFrequencyLayer,</em> consists of one or more DL
PRS resource sets and it is defined by:</p>
<p><em>- dl-PRS-SubcarrierSpacing</em> defines the subcarrier spacing
for the DL PRS resource. All DL PRS resources and DL PRS resource sets
in the same DL PRS positioning frequency layer have the same value of
<em>dl-PRS-SubcarrierSpacing</em>. The supported values of
<em>dl-PRS-SubcarrierSpacing</em> are given in Table 4.2-1 of [4,
TS38.211], excluding the values of 240kHz, 480 kHz, and 960 kHz.</p>
<p><em>- dl-PRS-CyclicPrefix</em> defines the cyclic prefix for the DL
PRS resource. All DL PRS Resources and DL PRS Resource sets in the same
DL PRS positioning frequency layer have the same value of
<em>dl-PRS-CyclicPrefix.</em> The supported values of
<em>dl-PRS-CyclicPrefix</em> are given in Table 4.2-1 of [4,
TS38.211].</p>
<p><em>- dl-PRS-PointA</em> defines the absolute frequency of the
reference resource block. Its lowest subcarrier is also known as Point
A. All DL PRS resources belonging to the same DL PRS resource set have
common Point A and all DL PRS resources sets belonging to the same DL
PRS positioning frequency layer have a common Point A.</p>
<p>The UE expects that it will be configured with <em>dl-PRS-ID</em>
each of which is defined such that it is associated with multiple DL PRS
resource sets. The UE expects that one of these <em>dl-PRS-ID</em> along
with a <em>nr-DL-PRS-ResourceSetID</em> and a
<em>nr-DL-PRS-ResourceID-r16</em> can be used to uniquely identify a DL
PRS resource.</p>
<p>The UE may be configured by the network with <em>nr-PhysCellID</em>,
<em>nr-CellGlobalID</em>, and <em>nr-ARFCN</em> [17, TS 37.355]
associated with a <em>dl-PRS-ID</em>.</p>
<p>- If <em>nr-PhysCellID</em> or <em>nr-CellGlobalID</em> is provided,
and if <em>nr-PhysCellID</em>, <em>nr-CellGlobalID</em> and
<em>nr-ARFCN</em> associated with the <em>dl-PRS-ID</em>, if provided,
are the same as the corresponding information of a serving cell, the UE
may assume that the DL PRS is transmitted from the serving cell;</p>
<p>- Otherwise, the UE may assume that the DL PRS is not transmitted
from a serving cell.</p>
<p>If the UE assumes that the DL PRS is transmitted from a serving cell,
and if the serving cell is the same as the serving cell defined by the
SS/PBCH block, the UE may assume that the DL PRS and the SS/PBCH block
are transmitted from the same serving cell.</p>
<p>If the UE assumes that the DL PRS is not transmitted from a serving
cell, and if <em>nr-PhysCellID</em> is provided, and is the same as
physical cell ID of the SS/PBCH block from a non-serving cell of the
same band as the DL PRS, the UE may assume that the DL PRS and the
SS/PBCH block are transmitted from the same non-serving cell.</p>
<p>A DL PRS resource set is configured by
<em>NR-DL-PRS-ResourceSet</em>, consists of one or more DL PRS resources
and it is defined by:</p>
<p><em>- nr-DL-PRS-ResourceSetID</em> defines the identity of the DL PRS
resource set configuration.</p>
<p><em>- dl-PRS-Periodicity-and-ResourceSetSlotOffset</em> defines the
DL PRS resource periodicity and takes values <span
class="math inline">\(T_{\text{per}}^{\text{PRS}} \in 2^{\mu}\left\{ 4,\
5,\ 8,\ 10,\ 16,\ 20,\ 32,\ 40,\ 64,\ 80,\ 160,\ 320,\ 640,\ 1280,\
2560,\ 5120,\ 10240 \right\}\ \)</span>slots, where <span
class="math inline">\(\mu = 0,\ 1,\ 2,\ 3\ \)</span>for
<em>dl-PRS-SubcarrierSpacing</em>=15, 30, 60 and 120 kHz respectively
and the slot offset for DL PRS resource set with respect to SFN0 slot 0.
All the DL PRS resources within one DL PRS resource set are configured
with the same DL PRS resource periodicity. The UE does not expect that
the product of DL PRS resource periodicity <span
class="math inline">\(T_{\text{per}}^{\text{PRS}}\)</span>, the higher
layer parameter <em>dl-prs-MutingBitRepetitionFactor</em> and the size
of the bitmap of <em>dl-PRS-MutingOption1</em> exceeds <span
class="math inline">\(2^{\mu} \times 10240\)</span>, where <span
class="math inline">\(\mu = 0,\ 1,\ 2,\ 3\ \)</span>for
<em>dl-PRS-SubcarrierSpacing</em>=15, 30, 60 and 120 kHz
respectively.</p>
<p><em>- dl-PRS-ResourceRepetitionFactor</em> defines how many times
each DL-PRS resource is repeated for a single instance of the DL-PRS
resource set and takes values <span
class="math inline">\(T_{\text{rep}}^{\text{PRS}} \in \left\{
1,2,4,6,8,16,32 \right\}\)</span>. All the DL PRS resources within one
resource set have the same resource repetition factor.</p>
<p><em>- dl-PRS-ResourceTimeGap</em> defines the offset in number of
slots between two repeated instances of a DL PRS resource with the same
<em>nr-DL-PRS-ResourceID</em> within a single instance of the DL PRS
resource set. The UE only expects to be configured with
<em>dl-PRS-ResourceTimeGap</em> if
<em>dl-PRS-ResourceRepetitionFactor</em> is configured with value
greater than 1. The time duration spanned by one instance of a
<em>nr-DL-PRS-ResourceSet</em> is not expected to exceed the configured
value of DL PRS periodicity. All the DL PRS resources within one
resource set have the same value of <em>dl-PRS-ResourceTimeGap.</em></p>
<p><em>- dl-PRS-MutingOption1</em> and <em>dl-PRS-MutingOption2</em>
define the time locations where the DL PRS resource is expected to not
be transmitted for a DL PRS resource set. If
<em>dl-PRS-MutingOption1</em> is configured, each bit in the bitmap of
<em>dl-PRS-MutingOption1</em> corresponds to a configurable number
provided by higher layer parameter
<em>dl-prs-MutingBitRepetitionFactor</em> of consecutive instances of a
DL PRS resource set where all the DL PRS resources within the set are
muted for the instance that is indicated to be muted. The length of the
bitmap can be {2, 4, 6, 8, 16, 32} bits. If
<em>dl-PRS-MutingOption2</em> is configured each bit in the bitmap of
<em>dl-PRS-MutingOption2</em> corresponds to a single repetition index
for each of the DL PRS resources within each instance of a
<em>nr-DL-PRS-ResourceSet</em> and the length of the bitmap is equal to
the values of <em>dl-PRS-ResourceRepetitionFactor</em>. Both
<em>dl-PRS-MutingOption1</em> and <em>dl-PRS-MutingOption2</em> may be
configured at the same time in which case the logical AND operation is
applied to the bit maps as described in Clause 7.4.1.7.4 of [4, TS
38.211].</p>
<p><em>- NR-DL-PRS-SFN0-Offset</em> defines the time offset of the SFN0
slot 0 for the DL PRS resource set with respect to SFN0 slot 0 of
reference provided by <em>nr-DL-PRS-ReferenceInfo</em>.</p>
<p><em>- dl-PRS-ResourceList</em> determines the DL PRS resources that
are contained within one DL PRS resource set.</p>
<p><em>- dl-PRS-CombSizeN</em> defines the comb size of a DL PRS
resource where the allowable values are given in Clause 7.4.1.7.3 of
[TS38.211]. All DL PRS resource sets belonging to the same DL PRS
positioning frequency layer have the same value of
<em>dl-PRS-CombSizeN</em>.</p>
<p><em>- dl-PRS-ResourceBandwidth</em> defines the number of resource
blocks configured for DL PRS transmission. The parameter has a
granularity of 4 PRBs with a minimum of 24 PRBs and a maximum of 272
PRBs. All DL PRS resources sets within a DL PRS positioning frequency
layer have the same value of <em>dl-PRS-ResourceBandwidth</em>.</p>
<p><em>- dl-PRS-StartPRB</em> defines the starting PRB index of the DL
PRS resource with respect to reference Point A, where reference Point A
is given by the higher-layer parameter <em>dl-PRS-PointA</em>. The
starting PRB index has a granularity of one PRB with a minimum value of
0 and a maximum value of 2176 PRBs. All DL PRS resource sets belonging
to the same DL PRS positioning frequency layer have the same value of
<em>dl-PRS-StartPRB</em>.</p>
<p><em>- dl-PRS-NumSymbols</em> defines the number of symbols of the DL
PRS resource within a slot where the allowable values are given in
Clause 7.4.1.7.3 of [4, TS38.211].</p>
<p>A DL PRS resource is defined by:</p>
<p><em>- nr-DL-PRS-ResourceID</em> determines the DL PRS resource
configuration identity. All DL PRS resource IDs are locally defined
within a DL PRS resource set.</p>
<p><em>- dl-PRS-SequenceID</em> is used to initialize c<sub>init</sub>
value used in pseudo random generator as described in Clause 7.4.1.7.2
of [4, TS 38.211] for generation of DL PRS sequence for a given DL PRS
resource.</p>
<p><em>- dl-PRS-CombSizeN-AndReOffset</em> defines the starting RE
offset of the first symbol within a DL PRS resource in frequency. The
relative RE offsets of the remaining symbols within a DL PRS resource
are defined based on the initial offset and the rule described in Clause
7.4.1.7.3 of [4, TS 38.211].</p>
<p><em>- dl-PRS-ResourceSlotOffset</em> determines the starting slot of
the DL PRS resource with respect to corresponding DL PRS resource set
slot offset.</p>
<p><em>- dl-PRS-ResourceSymbolOffset</em> determines the starting symbol
of a slot configured with the DL PRS resource.</p>
<p><em>- dl-PRS-QCL-Info</em> defines any quasi co-location information
of the DL PRS resource with other reference signals. The DL PRS may be
configured with QCL 'typeD' with a DL PRS associated with the same
<em>dl-PRS-ID</em>, or with <em>rs-Type</em> set to 'typeC', 'typeD', or
'typeC-plus-typeD' with a SS/PBCH Block from a serving or non-serving
cell.</p>
<p>- <em>dl-PRS-ResourcePrioritySubset</em> defines a subset of DL-PRS
resources for the DL PRS resource for the purpose of prioritization of
measurement reporting as described in [17, TS 37.355].</p>
<p>The UE assumes constant EPRE is used for all REs of a given DL PRS
resource.</p>
<p>The UE may be indicated by the network that DL PRS resource(s) can be
used as the reference for the DL RSTD, DL PRS-RSRP, DL PRS-RSRPP, and UE
Rx-Tx time difference measurements in a higher layer parameter
<em>nr-DL-PRS-ReferenceInfo</em>. The reference indicated by the network
to the UE can also be used by the UE to determine how to apply higher
layer parameters <em>nr-DL-PRS-ExpectedRSTD</em> and
<em>nr-DL-PRS-ExpectedRSTD-Uncertainty</em>. The UE expects the
reference to be indicated whenever it is expected to receive the DL PRS.
This reference provided by <em>nr-DL-PRS-ReferenceInfo</em> may include
a <em>dl-PRS-ID</em>, a DL PRS resource set ID, and optionally a single
DL PRS resource ID or a list of DL PRS resource IDs [17, TS 37.355]. The
UE may use different DL PRS resources or a different DL PRS resource set
to determine the reference for the RSTD measurement as long as the
condition that the DL PRS resources used belong to a single DL PRS
resource set is met. If the UE chooses to use a different reference than
indicated by the network, then it is expected to report the
<em>dl-PRS-ID</em>, the DL PRS resource ID(s) or the DL PRS resource set
ID used to determine the reference.</p>
<p>The UE may be configured to report quality metrics
<em>NR-TimingQuality</em> corresponding to the DL RSTD and UE Rx-Tx time
difference measurements which include the following fields:</p>
<p><em>- timingQualityValue</em> which provides the best estimate of the
uncertainty of the measurement</p>
<p><em>- timingQualityResolution</em> which specifies the resolution
levels used in the <em>timingQualityValue</em> field.</p>
<p>The UE expects to be configured with higher layer parameter
<em>nr-DL-PRS-ExpectedRSTD</em>, which defines the time difference with
respect to the received DL subframe timing the UE is expected to receive
DL PRS, and <em>nr-DL-PRS-ExpectedRSTD-Uncertainty</em>, which defines a
search window around the <em>nr-DL-PRS-ExpectedRSTD</em>.</p>
<p>For DL UE positioning measurement reporting in higher layer
parameters <em>NR-DL-TDOA-SignalMeasurementInformation</em> or
<em>NR-Multi-RTT-SignalMeasurementInformation</em> the UE can be
configured to report the DL PRS resource ID(s) or the DL PRS resource
set ID(s) associated with the DL PRS resource(s) or the DL PRS resource
set(s) which are used in determining the UE measurements DL RSTD, or UE
Rx-Tx time difference, respectively.</p>
<p>For the DL RSTD, DL PRS-RSRP, DL PRS-RSRPP, and UE Rx-Tx time
difference measurements the UE reports an associated higher layer
parameter <em>nr-TimeStamp</em>. The <em>nr-TimeStamp</em> can include
the <em>dl-PRS-ID</em>, the SFN and the slot number for a subcarrier
spacing. These values correspond to the reference which is provided by
<em>nr-DL-PRS-ReferenceInfo</em>.</p>
<p>The UE is expected to measure the DL PRS resource outside the active
DL BWP or with a numerology different from the numerology of the active
DL BWP if the measurement is made during a configured measurement gap.
When the UE is expected to measure the DL PRS resource, the UE may
request a measurement gap via higher layer parameter
<em>NR-PRS-MeasurementInfoList</em> [12, TS 38.331] or as specified in
clause 6.1.3.40 of [10, TS 38.321]. The UE may be preconfigured with one
or more measurement gaps each associated with a
<em>measPosPreConfigGapId</em>. When the UE requests activation or
deactivation of a measurement gap as specified in clause 6.1.3.40 of
[10, TS 38.321] it can request one of the preconfigured measurement gaps
by referring to the <em>measPosPreConfigGapId</em>. The UE may have one
of the preconfigured measurement gap(s) activated or deactivated as
specified in clause 6.1.3.41 of [10, TS 38.321].</p>
<p>The UE assumes that the DL PRS from the serving cell is not mapped to
any symbol that contains SS/PBCH block from the serving cell. If the
time frequency location of the SS/PBCH block transmissions from
non-serving cells are provided to the UE then the UE also assumes that
the DL PRS from a non-serving cell is not mapped to any symbol that
contains the SS/PBCH block of the same non-serving cell.</p>
<p>The UE may be configured to measure and report, subject to UE
capability, up to 4 DL RSTD measurements per pair of <em>dl-PRS-ID</em>
with each measurement between a different pair of DL PRS resources or DL
PRS resource sets within the DL PRS configured for those
<em>dl-PRS-ID</em>. If the UE is not configured to report with
<em>multiMeasInSameReport-r17</em>, the up to 4 measurements being
performed on the same pair of <em>dl-PRS-ID</em> and all DL RSTD
measurements in the same report use a single reference timing. If the UE
is configured to report with <em>multiMeasInSameReport-r17</em>, the up
to 4 measurements being performed on the same pair of <em>dl-PRS-ID</em>
and all DL RSTD measurements in the same measurement instance of the
same report use a single reference timing.</p>
<p>The UE may be configured to measure and report, subject to UE
capability, up to 24 DL PRS-RSRP measurements on DL PRS resources
associated with the same <em>dl-PRS-ID</em>. When the UE reports DL
PRS-RSRP measurements from one DL PRS resource set, the UE may indicate
which DL PRS-RSRP measurements associated with the same higher layer
parameter <em>nr-DL-PRS-RxBeamIndex</em> [17, TS 37.355] have been
performed using the same spatial domain filter for reception if for each
<em>nr-DL-PRS-RxBeamIndex</em> reported there are at least 2 DL PRS-RSRP
measurements associated with it within the DL PRS resource set. When the
UE reports DL PRS-RSRP measurements for a DL PRS resource, the reported
multiple DL PRS-RSRP measurements associated with the same or different
higher layer parameter <em>nr-DL-PRS-RxBeamIndex</em> may have the same
or different timestamps.</p>
<p>The UE may be configured to measure and optionally report, subject to
UE capability, up to 24 DL PRS-RSRPP for the first detected path on DL
PRS resources associated with the same <em>dl-PRS-ID</em>. When the UE
reports DL PRS-RSRPP measurements for a DL PRS resource, the reported
multiple DL PRS-RSRPP measurements associated with the same or different
higher layer parameter <em>nr-DL-PRS-RxBeamIndex</em> may have the same
or different timestamps. When the UE reports DL PRS-RSRPP measurements
from one DL PRS resource set, the UE may indicate which DL PRS-RSRPP
measurements associated with the same higher layer parameter
<em>nr-DL-PRS-RxBeamIndex</em> [17, TS 37.355] have been performed using
the same spatial domain filter for reception if for each
<em>nr-DL-PRS-RxBeamIndex</em> reported there are at least 2 DL
PRS-RSRPP measurements associated with it within the DL PRS resource
set.</p>
<p>The UE may be configured to optionally report a differential DL
PRS-RSRPP for a DL PRS resource with reference to
<em>nr-DL-PRS-FirstPathRSRP-Result</em> and/or a differential DL PRS
RSRP with reference to <em>nr-DL-PRS-RSRP-Result</em> via higher layer
parameter <em>NR-DL-AoD-AdditionalMeasurementElement</em>.</p>
<p>For each DL PRS resource, the UE may be configured, subject to UE
capability, with <em>dl-PRS-ResourcePrioritySubset</em> that is
associated with this DL PRS resource, where the subset of DL PRS
resources associated with the DL PRS resource can be in the same or
different DL PRS resource set than the DL PRS resource. The UE may
include UE measurements for the subset of DL PRS resources in
<em>NR-DL-AoD-AdditionalMeasurementElement</em> if the UE measurements
of the associated PRS resource are reported, where the UE measurement
can be DL PRS-RSRP and/or DL PRS-RSRPP. The UE may report DL PRS-RSRP
and/or DL PRS-RSRPP measurements only for the subset of DL PRS
resources. Subject to UE capability, the UE may be configured with
boresight direction via higher layer parameter
<em>DL-PRS-BeamInfoElement</em> for each DL PRS resource.</p>
<p>The UE may be provided with beam/antenna information via higher layer
parameter <em>NR-TRP-BeamAntennaInfo</em>.</p>
<p>The UE may request to be provided with either expected DL-AoD/ZoD and
uncertainty range(s) of expected DL-AoD/ZoD, or expected DL-AoA/ZoA and
uncertainty range(s) of the expected DL-AoA/ZoA. The UE may be provided
with expected DL-AoD/ZoD and uncertainty range(s) of the expected
DL-AoD/ZoD. The UE may be provided with expected DL-AoA/ZoA and
uncertainty range(s) of the expected DL-AoA/ZoA. The uncertainty
range(s) of the expected DL-AoD/DL-AoA may be configured within [0, 60].
The uncertainty range(s) of expected DL-ZoD/DL-ZoA may be configured
within [0, 30].</p>
<p>The UE may be configured to measure and report, subject to UE
capability, up to 4 UE Rx-Tx time difference measurements corresponding
to a single configured SRS resource or resource set for positioning.
Each measurement corresponds to a single received DL PRS resource or
resource set which can be in different DL PRS positioning frequency
layers.</p>
<p>The UE may be configured to measure and report via higher layer
parameter <em>additionalPaths</em> or <em>additionalPathsExt</em>,
subject to UE capability, the timing and the quality metrics of up to 8
additional detected paths, that are associated with each RSTD or UE Rx –
Tx time difference. The timing of each additional path is reported
relative to the path timing used for determining <em>nr-RSTD</em> or
<em>nr-UE-RxTxTimeDiff</em>. For UE positioning measurement reporting in
higher layer parameters <em>NR-DL-TDOA-SignalMeasurementInformation</em>
or <em>NR-Multi-RTT-SignalMeasurementInformation</em>, the UE may be
configured to measure and report, subject to UE capability, the DL
PRS-RSRPP of the first path and the up to 8 additional paths that are
associated with each RSTD or UE Rx – Tx time difference.</p>
<p>The UE may be requested, subject to UE capability, to measure and
report one or more of the DL RSTD, DL PRS-RSRP, DL PRS-RSRPP, or UE
Rx-Tx time difference measurements with either <span
class="math inline">\(N_{sample}\)</span> or 4 samples, where <span
class="math inline">\(N_{sample}\)</span> = 1 or 2 is as defined in [11,
TS 38.133], via higher layer parameter
<em>reducedDL-PRS-ProcessingSamples</em> [17, TS 37.355] which applies
for all DL PRS positioning frequency layers.</p>
<p>The UE may be requested, subject to UE capability, to report LoS/NLoS
indicator(s) via higher layer parameter
<em>nr-los-nlos-IndicatorRequest</em>. The UE can report LoS/NLoS
indicator(s) via higher layer parameter <em>nr-los-nlos-Indicator</em>
associated with each DL RSTD, DL PRS-RSRP, DL PRS-RSRPP, and UE Rx-Tx
time difference measurements. The UE can report LoS/NLoS indicator(s)
via higher layer parameter <em>nr-los-nlos-Indicator</em> associated
with each <em>dl-PRS-ID</em> in a measurement report. For the LoS/NLoS
indicator(s) associated with DL RSTD, the UE may report one indicator
associated with the <em>dl-PRS-ID</em> indicated by higher layer
parameter <em>dl-PRS-ReferenceInfo</em> and one indicator associated
with the <em>dl-PRS-ID</em> of the DL RSTD measurement. A UE may be
provided with LoS/NLoS indicator(s) via higher layer parameter
<em>nr-los-nlos-Indicator</em>, and it may be associated with each DL
PRS resource of each configured <em>dl-PRS-ID</em> or may be associated
with each configured <em>dl-PRS-ID</em>. The values of the higher layer
parameter <em>LOS-NLOS-Indicator</em> may be soft values (0, 0.1, …,
0.9, 1) or hard values (0, 1) with the values corresponding to the
likelihood of LoS, with a value of 1 corresponding to LoS and a value of
0 corresponding to NLoS.</p>
<p>If the UE is configured with <em>DL-PRS-QCL-Info</em> and the QCL
relation is between two DL PRS resources, then the UE assumes those DL
PRS resources are associated with the same <em>dl-PRS-ID</em>. If
<em>DL-PRS-QCL-Info</em> is configured to the UE with QCL set to
'type-D' with a source DL PRS resource then the
<em>nr-DL-PRS-ResourceSetId</em> and the <em>nr-DL-PRS-ResourceId</em>
of the source DL PRS resource are expected to be indicated to the
UE.</p>
<p>The UE is expected to measure the DL PRS outside the measurement gap,
subject to UE capability, if the DL PRS is inside the active DL BWP and
has the same numerology as the active DL BWP and is within the DL PRS
processing window indicated by higher layer parameter
<em>DL-PPW-PreConfig</em>. The UE is not expected to measure the DL PRS
outside the measurement gap if the expected received timing difference
between the DL PRS from the non-serving cell and that from the serving
cell, determined by the higher layer parameters
<em>nr-DL-PRS-ExpectedRSTD</em> and
<em>nr-DL-PRS-ExpectedRSTD-Uncertainty,</em> is larger than maximum Rx
timing difference provided by UE capability<em>.</em> For receiving the
DL PRS outside the measurement gap and within the DL PRS processing
window, the priority between DL PRS and SSB is defined in [11, TS
38.133] and the UE determines the DL PRS priority as indicated by higher
layer parameter <em>priority</em> subject to UE capability or as implied
by UE capability, except for SSB:</p>
<p>- with value <em>'st1'</em> where the DL PRS is higher priority than
all the DL signals and channels, or</p>
<p>- with value <em>'st2'</em> where the DL PRS is lower priority than
PDCCH and the PDSCH scheduled by DCI formats 1_1 or 1_2 or 4_2 with the
priority indicator field in the corresponding DCI format set to 1, and
is higher priority than other DL signals and channels, or</p>
<p>- with value <em>'st3'</em> where the DL PRS is lower priority than
all the DL signals and channels.</p>
<p>Inside one <em>DL-PPW-PreConfig</em> the UE is only expected to
measure a single DL PRS positioning frequency layer.</p>
<p>When the UE is expected to measure the DL PRS outside the measurement
gap in a configured DL PRS processing window with <em>type1A</em> and if
the DL PRS is determined to be higher priority than the DL signals and
channels inside the DL PRS processing window, those DL signals and
channels are not expected to be measured by the UE. When the UE is
expected to measure the DL PRS outside the measurement gap in a
configured DL PRS processing window with <em>type1B</em> and if the DL
PRS is determined to be higher priority than the DL signals and channels
inside the DL PRS processing window, those DL signals and channels in
the same band as the DL PRS are not expected to be measured by the UE.
When the UE is expected to measure the DL PRS outside the measurement
gap in a configured DL PRS processing window with <em>type2</em> if the
DL PRS is determined to be higher priority than the DL signals and
channels inside the DL PRS processing window, those DL signals and
channels from the impacted serving cells are not expected to be measured
by the UE on the overlapped symbols with the DL PRS, where impacted
serving cells refer to the serving cell on which the
<em>DL-PPW-PreConfig</em> is configured for a frequency range 1 band,
and all the serving cells in the same band as the DL PRS for a frequency
range 2 band. When the UE is expected to measure the DL PRS outside the
measurement gap in a configured DL PRS processing window with
<em>type1B</em> or <em>type2,</em> and if the DL PRS is determined to be
higher priority than the DL signals and channels inside the DL PRS
processing window, the UE behavior is described in [11, TS 38.133] for
inter-band case for frequency range 2 for the DL signals/channels from a
different frequency range 2 band than the frequency range 2 band of the
DL PRS.</p>
<p>When the UE has an activated DL PRS processing window with
<em>type1A</em> or <em>type1B</em> and the UE determines the presence of
other DL signals and channels, except SSB, of higher priority than the
DL PRS in the DL PRS processing window no later than
<em>N<sub>2</sub></em> symbols, defined in clause 6.4 for the subcarrier
spacing <span class="math inline">\(\mu\)</span> of the DL PRS, before
the first symbol of the DL PRS processing window, the UE is expected to
receive the other DL signals and channels and drop all PRS within the DL
PRS processing window. When the UE has an activated DL PRS processing
window with <em>type2</em> and the UE determines the presence of other
DL signals and channels, except SSB, of higher priority than the DL PRS
on a symbol configured with the DL PRS no later than
<em>N<sub>2</sub></em> symbols, defined in clause 6.4 for the subcarrier
spacing <span class="math inline">\(\mu\)</span> of the DL PRS, before
the DL PRS symbol, the UE is expected to receive the other DL signals
and channels and drop the DL PRS symbol.</p>
<p>When the UE has an activated DL PRS processing window with
<em>type1A</em> or <em>type1B</em> and the UE determines the presence of
other DL signals and channels, except SSB, of higher priority than the
DL PRS in the DL PRS processing window later than <em>N<sub>2</sub></em>
symbols, defined in clause 6.4 for the subcarrier spacing <span
class="math inline">\(\mu\)</span> of the DL PRS, before the first
symbol of the DL PRS processing window, the UE is not required to
receive the other DL signals and channels and may receive the DL PRS and
consider the DL PRS as higher priority in the DL PRS processing window.
When the UE has an activated DL PRS processing window with
<em>type2</em> and the UE determines the presence of other DL signals
and channels, except SSB, of higher priority than the DL PRS on a symbol
configured with the DL PRS later than <em>N<sub>2</sub></em> symbols,
defined in clause 6.4 for the subcarrier spacing <span
class="math inline">\(\mu\)</span> of the DL PRS, before the DL PRS
symbols, the UE is not required to receive the other DL signals and
channels and may receive the DL PRS symbol and consider the DL PRS as
higher priority in that symbol.</p>
<p>Within a positioning frequency layer, the DL PRS resources are sorted
in the decreasing order of priority for measurement to be performed by
the UE, with the reference indicated by <em>nr-DL-PRS-ReferenceInfo</em>
being the highest priority for measurement, and the following priority
is assumed:</p>
<p>- Up to 64 <em>NR-SelectedDL-PRS-IndexPerTRP</em> of the DL PRS
positioning frequency layer are sorted according to priority if
<em>nr-SelectedDL-PRS-IndexListPerFreq</em> is provided, or up to 64
<em>NR-DL-PRS-AssistanceDataPerTRP</em> of the frequency layer are
sorted according to priority otherwise;</p>
<p>- Up to 2 <em>DL-SelectedPRS-ResourceSetIndex</em> per
<em>dl-PRS-ID</em> of the DL PRS positioning frequency layer are sorted
according to priority if <em>dl-SelectedPRS-ResourceSetIndexList</em> is
provided, or up to 2 <em>NR-DL-PRS-ResourceSet</em> per
<em>dl-PRS-ID</em> of the DL PRS positioning frequency layer are sorted
according to priority otherwise.</p>
<p>The UE DL PRS processing capability is defined in [TS 37.355]. For
the purpose of DL PRS processing capability, the duration <em>K</em>
msec of DL PRS symbols within <em>P</em> msec window, is calculated
by</p>
<p><em>-</em> Type 1 duration calculation with UE symbol level buffering
capability</p>
<p><span class="math display">\[{K = \sum_{s \in S}^{}K_{s}
}{K_{s} = T_{s}^{end} - T_{s}^{start}}\]</span></p>
<p><em>-</em> Type 2 duration calculation with UE slot level buffering
capability</p>
<p><span class="math display">\[K = \frac{1}{2^{\mu}}|S|\]</span></p>
<p><em>- S</em> is the set of slots based on the numerology of the DL
PRS of a serving cell within the <em>P</em> msec window in the
positioning frequency layer that contains potential DL PRS resources
considering the actual <em>nr-DL-PRS-ExpectedRSTD</em>,
<em>nr-DL-PRS-ExpectedRSTD-Uncertainty</em> provided for each pair of DL
PRS Resource Sets.</p>
<p><em>-</em> For Type 1, <span class="math inline">\(\left\lbrack
T_{s}^{start},\ T_{s}^{end} \right\rbrack\)</span> is the smallest
interval in msec within slot <span class="math inline">\(s\)</span>
corresponding to an integer number of OFDM symbols based on the
numerology of the DL PRS of a serving cell that covers the union of the
potential DL PRS symbols and determines the DL PRS symbol occupancy
within slot <span class="math inline">\(s\)</span>, where the interval
<span class="math inline">\(\left\lbrack T_{s}^{start},\ T_{s}^{end}
\right\rbrack\)</span> considers the actual
<em>nr-DL-PRS-ExpectedRSTD</em>,
<em>nr-DL-PRS-ExpectedRSTD-Uncertainty</em> provided for each pair of DL
PRS resource sets (target and reference).</p>
<p><em>-</em> For Type 2, <span class="math inline">\(\mu\)</span> is
the numerology of the DL PRS, and <span
class="math inline">\(|S|\)</span> is the cardinality of the set <span
class="math inline">\(S\)</span>.</p>
<p>The UE may be configured to report one or more measurement instances,
each with its own timestamp, on DL RSTD, DL PRS-RSRP, DL PRS-RSRPP,
and/or UE Rx-Tx time difference measurements, in a single measurement
report.</p>
<p>Timing Error Group(s) (TEG(s)) at UE side are defined:</p>
<p><em>-</em> UE Rx TEG is associated with one or more DL measurements,
which have the Rx timing error difference within a certain margin.</p>
<p><em>-</em> UE RxTx TEG is associated with one or more UE Rx-Tx time
difference measurements, which have the 'Rx timing errors+Tx timing
errors' difference within a certain margin.</p>
<p>The UE may be configured to report, subject to UE capability, via
high layer parameter <em>nr-UE-RxTEG-Request</em>, the association
information of DL RSTD measurement(s) with UE Rx TEG(s) via higher layer
parameter <em>nr-UE-Rx-TEG-ID</em> when the UE reports the DL RSTD
measurement(s). The UE may report up to 4 RSTD measurements associated
with different DL PRS resources per UE Rx TEG per
<em>dl-PRS-ID</em>.</p>
<p>The UE may report a UE Rx TEG ID via higher layer parameter
<em>nr-UE-Rx-TEG-ID</em> for a RSTD reference time
<em>dl-PRS-ReferenceInfo</em> and a UE Rx TEG ID for each DL RSTD
measurement, where the DL RSTD can be DL RSTD measurement in
<em>NR-DL-TDOA-MeasElement</em> and/or
<em>NR-DL-TDOA-AdditionalMeasurementElement</em>.</p>
<p>If the UE reports a UE Rx TEG ID with a DL RSTD measurement, the UE
may report a UE Rx TEG timing error margin value, via high layer
parameter <em>nr-UE-RxTEG-TimingErrorMargin</em>, for all the UE Rx TEGs
within one <em>NR-DL-TDOASignalMeasurementInformation.</em></p>
<p>The UE may be configured to measure and report, via high layer
parameter <em>measureSameDL-PRS-ResourceWithDifferentRxTEGs</em> subject
to UE capability, RSTD measurements on a DL PRS resource associated with
a <em>dl-PRS-ID</em> using up to 8 different UE Rx TEGs with the same
<em>dl-PRS-ReferenceInfo.</em> The higher layer parameter
<em>measureSameDL-PRS-ResourceWithDifferentRxTEGs</em> applies to all DL
PRS positioning frequency layers.</p>
<p>The UE may be provided with association information of DL PRS
resource(s) with TRP Tx TEGs via higher layer parameter
<em>dl-prs-trp-Tx-TEG-ID</em> for a <em>dl-PRS-ID</em>.</p>
<p>The UE may be configured to report, via high layer parameter
<em>nr-UE-RxTxTEG-Request</em>, subject to UE capability, the
association information of UE Rx-Tx time difference measurement(s) with
UE RxTx TEG(s) via higher layer parameter <em>nr-UE-RxTx-TEG-ID</em>.
The UE may report up to 4 UE Rx-Tx time difference measurements
associated with different DL PRS resources per UE RxTx TEG per
<em>dl-PRS-ID</em>.</p>
<p>If the UE reports a UE RxTx TEG ID with a UE Rx-Tx time difference
measurement, the UE may report a UE RxTx TEG timing error margin value,
via high layer parameter <em>nr-UE-RxTxTEG-TimingErrorMargin</em>, for
all the UE RxTx TEGs within one
<em>NR-Multi-RTT-SignalMeasurementInformation.</em></p>
<p>The UE may be configured to report, via high layer parameter
<em>nr-UE-RxTxTEG-Request</em>, subject to UE capability, the
association information of UE Rx-Tx time difference measurement(s) with
the UE Rx TEG(s) and UE Tx TEG(s) via the higher layer parameters of
<em>nr-UE-Rx-TEG-ID</em>, and <em>nr-UE-Tx-TEG-Index</em>. The UE may
report up to 4 UE Rx-Tx time difference measurements associated with
different DL PRS resources per UE Rx TEG per <em>dl-PRS-ID</em>.</p>
<p>If the UE reports a UE Rx TEG ID with a UE Rx-Tx time difference
measurement, the UE may report a UE Rx TEG timing error margin value,
via high layer parameter <em>nr-UE-RxTEG-TimingErrorMargin</em>, for all
the UE Rx TEGs within one
<em>NR-Multi-RTT-SignalMeasurementInformation</em>.</p>
<p>The UE may be configured to measure and report, via high layer
parameter <em>measureSameDL-PRS-ResourceWithDifferentRxTEGs</em> subject
to UE capability, UE Rx-Tx time difference measurements on a PRS
resource associated with a <em>dl-PRS-ID</em> using up to 8 different UE
Rx TEGs. The high layer parameter
<em>measureSameDL-PRS-ResourceWithDifferentRxTEGs</em> applies to all DL
PRS positioning frequency layers.</p>
<p>The UE may be configured to measure and report, via high layer
parameter <em>measureSameDL-PRS-ResourceWithDifferentRxTxTEGs</em>
subject to UE capability, UE Rx-Tx time difference measurements with the
same UE Tx TEG using up to 8 different UE RxTx TEGs<em>.</em> The high
layer parameter <em>measureSameDL-PRS-ResourceWithDifferentRxTxTEGs</em>
applies to all DL PRS positioning frequency layers.</p>
<p>The UE in RRC_INACTIVE mode is expected to prioritize the reception
of any other DL signals and DL channels than the reception of DL
PRS.</p>
<p>The UE in RRC_INACTIVE mode, subject to UE capability, is expected to
process DL PRS outside or inside of the initial DL BWP. For DL PRS
processing outside of the initial DL BWP, the UE may be configured with
the same or different subcarrier spacing and CP for DL PRS resources
than those of the initial DL BWP. For DL PRS processing inside of the
initial DL BWP, the UE is configured with the same subcarrier spacing
and CP for DL PRS resources as those of the initial DL BWP.</p>
<p>For a UE configured with preconfigured Measurement gap(s) for
Positioning, when the UE receives an activation command, as described in
clause 6.1.3.41 of [10, TS 38.321], for a preconfigured Measurement Gap
for Positioning activation/deactivation, and when the UE would transmit
a PUCCH with HARQ-ACK information in slot n corresponding to the PDSCH
carrying the command, the corresponding actions in [10, TS 38.321] and
the UE assumptions shall be applied starting from the first slot that is
after slot <span class="math inline">\(n +
{3N}_{slot}^{subframe,µ}\)</span> where <em>μ</em> is the SCS
configuration for the PUCCH.</p>
<p>For a UE configured with DL PRS Processing Window(s), when the UE
receives an activation/deactivation command, as described in clause
6.1.3.42 of [10, TS 38.321], for a DL PRS processing window activation,
and when the UE would transmit a PUCCH with HARQ-ACK information in slot
n corresponding to the PDSCH carrying the command, the corresponding
actions in [10, TS 38.321] and the UE assumptions shall be applied
starting from the first slot that is after slot <span
class="math inline">\(n + {3N}_{slot}^{subframe,µ}\)</span> where
<em>μ</em> is the SCS configuration for the PUCCH. The UE is not
expected to be indicated with more than 4 activated DL PRS processing
windows across all active DL BWPs and is not expected to be indicated
with the activated DL PRS processing windows that overlap in time.</p>
<h3 id="code-block-group-based-pdsch-transmission">5.1.7 Code block
group based PDSCH transmission</h3>
<h4
id="ue-procedure-for-grouping-of-code-blocks-to-code-block-groups">5.1.7.1
UE procedure for grouping of code blocks to code block groups</h4>
<p>If a UE is configured to receive code block group (CBG) based
transmissions by receiving the higher layer parameter
<em>PDSCH-CodeBlockGroupTransmission</em> for PDSCH, the UE shall
determine the number of CBGs for a transport block reception as</p>
<p><img src="media/image105.svg" />,</p>
<p>where <em>N</em> is the maximum number of CBGs per transport block as
configured by <em>maxCodeBlockGroupsPerTransportBlock</em> for PDSCH,
and <em>C</em> is the number of code blocks in the transport block
according to the procedure defined in Clause 7.2.3 of [5, TS
38.212].</p>
<p>Define <img src="media/image106.svg" />, <img
src="media/image107.svg" />, and <img src="media/image108.svg" />.</p>
<p>If <img src="media/image109.svg" />, CBG <em>m</em>, <img
src="media/image110.svg" />, consists of code blocks with indices <img
src="media/image111.svg" />. CBG <em>m</em>, <img
src="media/image112.svg" />, consists of code blocks with indices <img
src="media/image113.svg" />.</p>
<h4
id="ue-procedure-for-receiving-code-block-group-based-transmissions">5.1.7.2
UE procedure for receiving code block group based transmissions</h4>
<p>If a UE is configured to receive code block group-based transmissions
by receiving the higher layer parameter
<em>PDSCH-CodeBlockGroupTransmission</em> for PDSCH,</p>
<p>- The <em>'CBG transmission information'</em> (CBGTI) field of DCI
format 1_1 is of length <span class="math inline">\(N_{TB} \bullet N\
\)</span> bits, where <span class="math inline">\(N_{TB}\)</span> is the
value of the higher layer parameter
<em>maxNrofCodeWordsScheduledByDCI</em>. If <span
class="math inline">\(N_{TB} = 2\)</span> the CBGTI field bits are
mapped such that the first set of <span class="math inline">\(N\
\)</span> bits starting from the MSB corresponds to the first TB while
the second set of <span class="math inline">\(N\ \)</span> bits
corresponds to a second TB, if scheduled. The first <em>M</em> bits of
each set of <span class="math inline">\(N\ \)</span> bits in the CBGTI
field have an in-order one-to-one mapping with the <em>M</em> CBGs of
the TB, with the MSB mapped to CBG#0.</p>
<p>- For initial transmission of a TB as indicated by the '<em>New Data
Indicator'</em> field of the scheduling DCI, the UE may assume that all
the code block groups of the TB are present.</p>
<p>- For a retransmission of a TB as indicated by the '<em>New Data
Indicator'</em> field of the scheduling DCI, the UE may assume that</p>
<p>- The '<em>CBGTI'</em> field of the scheduling DCI indicates which
CBGs of the TB are present in the transmission. A bit value of '0' in
the <em>CBGTI</em> field indicates that the corresponding CBG is not
transmitted and '1' indicates that it is transmitted.</p>
<p>- If the <em>'CBG flushing out information'</em> <em>(CBGFI)</em>
field of the scheduling DCI is present, '<em>CBGFI'</em> set to '0'
indicates that the earlier received instances of the same CBGs being
transmitted may be corrupted, and '<em>CBGFI'</em> set to '1' indicates
that the CBGs being retransmitted are combinable with the earlier
received instances of the same CBGs.</p>
<p>- A CBG contains the same CBs as in the initial transmission of the
TB.</p>
<h2 id="ue-procedure-for-reporting-channel-state-information-csi">5.2 UE
procedure for reporting channel state information (CSI)</h2>
<h3 id="channel-state-information-framework">5.2.1 Channel state
information framework</h3>
<p>The procedures on aperiodic CSI reporting described in this clause
assume that the CSI reporting is triggered by DCI format 0_1, but they
equally apply to CSI reporting triggered by DCI format 0_2, by applying
the higher layer parameter <em>reportTriggerSizeDCI-0-2</em> instead of
<em>reportTriggerSize</em>.</p>
<p>The time and frequency resources that can be used by the UE to report
CSI are controlled by the gNB. CSI may consist of Channel Quality
Indicator (CQI), precoding matrix indicator (PMI), CSI-RS resource
indicator (CRI), SS/PBCH Block Resource indicator (SSBRI), layer
indicator (LI), rank indicator (RI), L1-RSRP, L1-SINR or
CapabilityIndex.</p>
<p>For CQI, PMI, CRI, SSBRI, LI, RI, L1-RSRP, L1-SINR, CapabilityIndex a
UE is configured by higher layers with N≥1 <em>CSI-ReportConfig</em>
Reporting Settings, M≥1 <em>CSI-ResourceConfig</em> Resource Settings,
and one or two list(s) of trigger states (given by the higher layer
parameters <em>CSI-AperiodicTriggerStateList</em> and
<em>CSI-SemiPersistentOnPUSCH-TriggerStateList</em>). Each trigger state
in <em>CSI-AperiodicTriggerStateList</em> contains a list of associated
<em>CSI-ReportConfigs</em> indicating the Resource Set IDs for channel
and optionally for interference. Each trigger state in
<em>CSI-SemiPersistentOnPUSCH-TriggerStateList</em> contains one
associated <em>CSI-ReportConfig</em>.</p>
<h4 id="reporting-settings">5.2.1.1 Reporting settings</h4>
<p>Each Reporting Setting <em>CSI-ReportConfig</em> is associated with a
single downlink BWP (indicated by higher layer parameter
<em>BWP-Id</em>) given in the associated <em>CSI-ResourceConfig</em> for
channel measurement and contains the parameter(s) for one CSI reporting
band: codebook configuration including codebook subset restriction,
time-domain behavior, frequency granularity for CQI and PMI, measurement
restriction configurations, and the CSI-related quantities to be
reported by the UE such as the layer indicator (LI), L1-RSRP, L1-SINR,
CRI, and SSBRI (SSB Resource Indicator) and CapabilityIndex.</p>
<p>The time domain behavior of the <em>CSI-ReportConfig</em> is
indicated by the higher layer parameter <em>reportConfigType</em> and
can be set to 'aperiodic', 'semiPersistentOnPUCCH',
'semiPersistentOnPUSCH', or 'periodic'. For 'periodic' and
'semiPersistentOnPUCCH'/'semiPersistentOnPUSCH' CSI reporting, the
configured periodicity and slot offset applies in the numerology of the
UL BWP in which the CSI report is configured to be transmitted on. The
higher layer parameter <em>reportQuantity</em> indicates the
CSI-related, L1-RSRP-related, L1-SINR-related or CapabilityIndex-related
quantities to report. The <em>reportFreqConfiguration</em> indicates the
reporting granularity in the frequency domain, including the CSI
reporting band and if PMI/CQI reporting is wideband or sub-band. The
<em>timeRestrictionForChannelMeasurements</em> parameter in
<em>CSI-ReportConfig</em> can be configured to enable time domain
restriction for channel measurements and
<em>timeRestrictionForInterferenceMeasurements</em> can be configured to
enable time domain restriction for interference measurements. The
<em>CSI-ReportConfig</em> can also contain <em>CodebookConfig</em>,
which contains configuration parameters for Type-I, Type II, Enhanced
Type II CSI, or Further Enhanced Type II Port Selection including
codebook subset restriction when applicable, and configurations of
group-based reporting. A UE is not expected to be configured with a CSI
report setting associated with a dormant DL BWP if the
<em>reportConfigType</em> is set to 'aperiodic'.</p>
<h4 id="resource-settings">5.2.1.2 Resource settings</h4>
<p>Each CSI Resource Setting <em>CSI-ResourceConfig</em> contains a
configuration of a list of S≥1 CSI Resource Sets (given by higher layer
parameter <em>csi-RS-ResourceSetList</em>), where the list is comprised
of references to either or both of NZP CSI-RS resource set(s) and
SS/PBCH block set(s) or the list is comprised of references to CSI-IM
resource set(s). Each CSI Resource Setting is located in the DL BWP
identified by the higher layer parameter <em>BWP-id</em>, and all CSI
Resource Settings linked to a CSI Report Setting have the same DL
BWP.</p>
<p>The time domain behavior of the CSI-RS resources within a CSI
Resource Setting are indicated by the higher layer parameter
<em>resourceType</em> and can be set to aperiodic, periodic, or
semi-persistent. For periodic and semi-persistent CSI Resource Settings,
when the UE is configured with <em>groupBasedBeamReporting-r17</em>, the
number of CSI Resource Sets configured is S=2, otherwise the number of
CSI-RS Resource Sets configured is limited to S=1. For periodic and
semi-persistent CSI Resource Settings, the configured periodicity and
slot offset is given in the numerology of its associated DL BWP, as
given by <em>BWP-id.</em> When a UE is configured with multiple
<em>CSI-ResourceConfigs</em> consisting the same NZP CSI-RS resource ID,
the same time domain behavior shall be configured for the
<em>CSI-ResourceConfigs</em>. When a UE is configured with multiple
<em>CSI-ResourceConfigs</em> consisting the same CSI-IM resource ID, the
same time-domain behavior shall be configured for the
<em>CSI-ResourceConfigs</em>. All CSI Resource Settings linked to a CSI
Report Setting shall have the same time domain behavior.</p>
<p>The following are configured via higher layer signaling for one or
more CSI Resource Settings for channel and interference measurement:</p>
<p>- CSI-IM resource for interference measurement as described in Clause
5.2.2.4.</p>
<p>- NZP CSI-RS resource for interference measurement as described in
Clause 5.2.2.3.1.</p>
<p>- NZP CSI-RS resource for channel measurement as described in Clause
5.2.2.3.1.</p>
<p>The UE may assume that the NZP CSI-RS resource(s) for channel
measurement and the CSI-IM resource(s) for interference measurement
configured for one CSI reporting are resource-wise QCLed with respect to
'typeD'. When NZP CSI-RS resource(s) is used for interference
measurement, the UE may assume that the NZP CSI-RS resource for channel
measurement and the CSI- IM resource or NZP CSI-RS resource(s) for
interference measurement configured for one CSI reporting are QCLed with
respect to 'typeD'.</p>
<p>For L1-SINR measurement:</p>
<p>- When one Resource Setting is configured, the Resource Setting
(given by higher layer parameter
<em>resourcesForChannelMeasurement</em>) is for channel and interference
measurement on NZP CSI-RS for L1-SINR computation. UE may assume that
same 1 port NZP CSI-RS resource(s) with density 3 REs/RB is used for
both channel and interference measurements.</p>
<p>- When two Resource Settings are configured, the first one Resource
Setting (given by higher layer parameter
<em>resourcesForChannelMeasurement</em>) is for channel measurement on
SSB or NZP CSI-RS and the second one (given by either higher layer
parameter <em>csi-IM-ResourcesForInterference</em> or higher layer
parameter <em>nzp-CSI-RS-ResourcesForInterference</em>) is for
interference measurement performed on CSI-IM or on 1 port NZP CSI-RS
with density 3 REs/RB, where each SSB or NZP CSI-RS resource for channel
measurement is associated with one CSI-IM resource or one NZP CSI-RS
resource for interference measurement by the ordering of the SSB or NZP
CSI-RS resource for channel measurement and CSI-IM resource or NZP
CSI-RS resource for interference measurement in the corresponding
resource sets. The number of SSB(s) or CSI-RS resources for channel
measurement equals to the number of CSI-IM resources or the number of
NZP CSI-RS resource for interference measurement.</p>
<p>- UE may apply the SSB, or 'typeD' RS configured with
<em>qcl-Type</em> set to 'typeD' to the NZP CSI-RS resource for channel
measurement, as the reference RS for determining 'typeD' assumption for
the corresponding CSI-IM resource or the corresponding NZP CSI-RS
resource for interference measurement configured for one CSI
reporting.</p>
<p>- UE may expect that the NZP CSI-RS resource set for channel
measurement and the NZP-CSI-RS resource set for interference
measurement, if any, are configured with the higher layer parameter
<em>repetition</em>.</p>
<h4 id="void">5.2.1.3 (void)</h4>
<h4 id="reporting-configurations">5.2.1.4 Reporting configurations</h4>
<p>The UE shall calculate CSI parameters (if reported) assuming the
following dependencies between CSI parameters (if reported)</p>
<p>- LI shall be calculated conditioned on the reported CQI, PMI, RI and
CRI</p>
<p>- CQI shall be calculated conditioned on the reported PMI, RI and
CRI</p>
<p>- PMI shall be calculated conditioned on the reported RI and CRI</p>
<p>- RI shall be calculated conditioned on the reported CRI.</p>
<p>The Reporting configuration for CSI can be aperiodic (using PUSCH),
periodic (using PUCCH) or semi-persistent (using PUCCH, and DCI
activated PUSCH). The CSI-RS Resources can be periodic, semi-persistent,
or aperiodic. Table 5.2.1.4-1 shows the supported combinations of CSI
Reporting configurations and CSI-RS Resource configurations and how the
CSI Reporting is triggered for each CSI-RS Resource configuration.
Periodic CSI-RS is configured by higher layers. Semi-persistent CSI-RS
is activated and deactivated as described in Clause 5.2.1.5.2. Aperiodic
CSI-RS is configured and triggered/activated as described in Clause
5.2.1.5.1.</p>
<p>Table 5.2.1.4-1: Triggering/Activation of CSI Reporting for the
possible CSI-RS Configurations.</p>
<table>
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 24%" />
<col style="width: 24%" />
</colgroup>
<thead>
<tr>
<th>CSI-RS Configuration</th>
<th>Periodic CSI Reporting</th>
<th>Semi-Persistent CSI Reporting</th>
<th>Aperiodic CSI Reporting</th>
</tr>
</thead>
<tbody>
<tr>
<td>Periodic CSI-RS</td>
<td>No dynamic triggering/activation</td>
<td>For reporting on PUCCH, the UE receives an activation command, as
described in clause 6.1.3.16 of [10, TS 38.321]; for reporting on PUSCH,
the UE receives triggering on DCI</td>
<td>Triggered by DCI; additionally, subselection indication as described
in clause 6.1.3.13 of [10, TS 38.321] possible as defined in Clause
5.2.1.5.1.</td>
</tr>
<tr>
<td>Semi-Persistent CSI-RS</td>
<td>Not Supported</td>
<td>For reporting on PUCCH, the UE receives an activation command, as
described in clause 6.1.3.16 of [10, TS 38.321]; for reporting on PUSCH,
the UE receives triggering on DCI</td>
<td>Triggered by DCI; additionally, subselection indication as described
in clause 6.1.3.13 of [10, TS 38.321] possible as defined in Clause
5.2.1.5.1.</td>
</tr>
<tr>
<td>Aperiodic CSI-RS</td>
<td>Not Supported</td>
<td>Not Supported</td>
<td>Triggered by DCI; additionally, subselection indication as described
in clause 6.1.3.13 of [10, TS 38.321] possible as defined in Clause
5.2.1.5.1.</td>
</tr>
</tbody>
</table>
<p>When the UE is configured with higher layer parameter
<em>NZP-CSI-RS-ResourceSet</em> and when the higher layer parameter
<em>repetition</em> is set to 'off', the UE shall determine a CRI from
the supported set of CRI values as defined in Clause 6.3.1.1.2 of [5, TS
38.212] and report the number in each CRI report. When the higher layer
parameter <em>repetition</em> for a CSI-RS Resource Set for channel
measurement is set to 'on', CRI for the CSI-RS Resource Set for channel
measurement is not reported. CRI reporting is not supported when the
higher layer parameter <em>codebookType</em> is set to 'typeII',
'typeII-PortSelection', 'typeII-r16', to 'typeII-PortSelection-r16', or
'typeII-PortSelection-r17'.</p>
<p>For a periodic or semi-persistent CSI report on PUCCH, the
periodicity <span class="math inline">\(T_{CSI}\)</span> (measured in
slots) and the slot offset <span
class="math inline">\(T_{offset}\)</span> are configured by the higher
layer parameter <em>reportSlotConfig</em>. Unless specified otherwise,
the UE shall transmit the CSI report in frames with SFN <span
class="math inline">\(n_{f}\)</span> and slot number within the frame
<span class="math inline">\(n_{s,f}^{\mu}\)</span> satisfying</p>
<p><span class="math inline">\(\left( N_{slot}^{frame,\mu}n_{f} +
n_{s,f}^{\mu} - T_{offset} \right)mod\ T_{CSI} = 0\)</span></p>
<p>where <span class="math inline">\(\ \mu\)</span> is the SCS
configuration of the UL BWP the CSI report is transmitted on.</p>
<p>For a semi-persistent CSI report on PUSCH, the periodicity <span
class="math inline">\(T_{CSI}\)</span> (measured in slots) is configured
by the higher layer parameter <em>reportSlotConfig.</em> Unless
specified otherwise, the UE shall transmit the CSI report in frames with
SFN <span class="math inline">\(n_{f}\)</span> and slot number within
the frame <span class="math inline">\(n_{s,f}^{\mu}\)</span>
satisfying</p>
<p><span class="math inline">\(\left( N_{slot}^{frame,\mu}(n_{f} -
n_{f}^{start})\  + n_{s,f}^{\mu} - n_{s,f}^{start} \right)mod\ T_{CSI} =
0\)</span></p>
<p>where <span class="math inline">\(n_{f}^{start}\)</span> and <span
class="math inline">\(n_{s,f}^{start}\)</span> are the SFN and slot
number within the frame respectively of the initial semi-persistent
PUSCH transmission according to the activating DCI.</p>
<p>For a semi-persistent or aperiodic CSI report on PUSCH, the allowed
slot offsets are configured by the following higher layer
parameters:</p>
<p>- if triggered/activated by DCI format 0_2 and the higher layer
parameter <em>reportSlotOffsetListDCI-0-2</em> or
<em>reportSlotOffsetListDCI-0-2-r17</em> is configured, the allowed slot
offsets are configured by <em>reportSlotOffsetListDCI-0-2</em> or
<em>reportSlotOffsetListDCI-0-2-r17</em>, and</p>
<p>- if triggered/activated by DCI format 0_1 and the higher layer
parameter <em>reportSlotOffsetListDCI-0-1</em> or
<em>reportSlotOffsetListDCI-0-1-r17</em> is configured, the allowed slot
offsets are configured by <em>reportSlotOffsetListDCI-0-1</em> or
<em>reportSlotOffsetListDCI-0-1-r17,</em> and</p>
<p>- otherwise, the allowed slot offsets are configured by the higher
layer parameter <em>reportSlotOffsetList</em> or
<em>reportSlotOffsetList-r17.</em></p>
<p>The offset is selected in the activating/triggering DCI.</p>
<p>For CSI reporting, a UE can be configured via higher layer signaling
with one out of two possible subband sizes, where a subband is defined
as <img src="media/image114.svg" /> contiguous PRBs and depends on the
total number of PRBs in the bandwidth part according to Table
5.2.1.4-2.</p>
<p>Table 5.2.1.4-2: Configurable subband sizes</p>
<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr>
<th style="text-align: center;"><strong>Bandwidth part
(PRBs)</strong></th>
<th style="text-align: center;"><strong>Subband size
(PRBs)</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">24 – 72</td>
<td style="text-align: center;">4, 8</td>
</tr>
<tr>
<td style="text-align: center;">73 – 144</td>
<td style="text-align: center;">8, 16</td>
</tr>
<tr>
<td style="text-align: center;">145 – 275</td>
<td style="text-align: center;">16, 32</td>
</tr>
</tbody>
</table>
<p>The <em>reportFreqConfiguration</em> contained in a
<em>CSI-ReportConfig</em> indicates the frequency granularity of the CSI
Report. A CSI Reporting Setting configuration defines a CSI reporting
band as a subset of subbands of the bandwidth part, where the
<em>reportFreqConfiguration</em> indicates:</p>
<p>- the <em>csi-ReportingBand</em> as a contiguous or non-contiguous
subset of subbands in the bandwidth part for which CSI shall be
reported.</p>
<p>- A UE is not expected to be configured with
<em>csi-ReportingBand</em> which contains a subband where a CSI-RS
resource linked to the CSI Report setting has the frequency density of
each CSI-RS port per PRB in the subband less than the configured density
of the CSI-RS resource.</p>
<p>- If a CSI-IM resource is linked to the CSI Report Setting, a UE is
not expected to be configured with <em>csi-ReportingBand</em> which
contains a subband where not all PRBs in the subband have the CSI-IM REs
present.</p>
<p>- wideband CQI or subband CQI reporting, as configured by the higher
layer parameter <em>cqi-FormatIndicator</em>. When wideband CQI
reporting is configured, a wideband CQI is reported for each codeword
for the entire CSI reporting band. When subband CQI reporting is
configured, one CQI for each codeword is reported for each subband in
the CSI reporting band.</p>
<p>- wideband PMI or subband PMI reporting as configured by the higher
layer parameter <em>pmi-FormatIndicator</em>. When wideband PMI
reporting is configured, a wideband PMI is reported for the entire CSI
reporting band. When subband PMI reporting is configured, except with 2
antenna ports, a single wideband indication (<em>i<sub>1</sub></em> in
Clause 5.2.2.2) is reported for the entire CSI reporting band and one
subband indication (<em>i<sub>2</sub></em> in clause 5.2.2.2) is
reported for each subband in the CSI reporting band. When subband PMIs
are configured with 2 antenna ports, a PMI is reported for each subband
in the CSI reporting band.</p>
<p>- a UE is not expected to be configured with
<em>pmi-FormatIndicator</em> if <em>codebookType</em> is set to
'typeII-r16' or 'typeII-PortSelection-r16' or
'typeII-PortSelection-r17'.</p>
<p>A CSI Reporting Setting is said to have a wideband
frequency-granularity if</p>
<p>- <em>reportQuantity</em> is set to 'cri-RI-PMI-CQI', or
'cri-RI-LI-PMI-CQI', <em>cqi-FormatIndicator</em> is set to
'widebandCQI' and <em>pmi-FormatIndicator</em> is set to 'widebandPMI',
or</p>
<p>- <em>reportQuantity</em> is set to 'cri-RI-PMI-CQI',
<em>codebookType</em> is set to 'typeII-PortSelection-r17' with <span
class="math inline">\(M = 1\)</span> and <em>cqi-FormatIndicator</em> is
set to 'widebandCQI', or</p>
<p>- <em>reportQuantity</em> is set to 'cri-RI-i1' or</p>
<p>- <em>reportQuantity</em> is set to 'cri-RI-CQI' or 'cri-RI-i1-CQI'
and <em>cqi-FormatIndicator</em> is set to 'widebandCQI', or</p>
<p>- <em>reportQuantity</em> is set to 'cri-RSRP' or 'ssb-Index-RSRP' or
'cri-SINR', or 'ssb-Index-SINR' or 'cri-RSRP-Index' or
'ssb-Index-RSRP-Index' or 'cri-SINR-Index', or
'ssb-Index-SINR-Index'</p>
<p>otherwise, the CSI Reporting Setting is said to have a subband
frequency-granularity.</p>
<p>A CSI Reporting Setting with <em>codebookType</em> set to
'typeI-SinglePanel' and the corresponding CSI-RS Resource Set for
channel measurement configured with two Resource Groups and <span
class="math inline">\(N\)</span> Resource Pairs, as described in clause
5.2.1.4.1, can be configured with wideband frequency-granularity only if
<em>csi-ReportMode</em> is set to 'Mode1' and
<em>numberOfSingleTRP-CSI-Mode1</em> is set to <span
class="math inline">\(X = 0\)</span>, as described in clause
5.2.1.4.2.</p>
<p>If the UE is configured with a CSI Reporting Setting for a bandwidth
part with fewer than 24 PRBs, the CSI reporting setting is expected to
have a wideband frequency-granularity, and, if applicable, the higher
layer parameter <em>codebookType</em> is set to 'typeI-SinglePanel'.</p>
<p>The first subband size is given by <img src="media/image115.svg" />
and the last subband size given by <img src="media/image116.svg" /> if
<img src="media/image117.svg" /> and <img src="media/image118.svg" />if
<img src="media/image119.svg" /></p>
<p>If a UE is configured with semi-persistent CSI reporting, the UE
shall report CSI when both CSI-IM and NZP CSI-RS resources are
configured as periodic or semi-persistent. If a UE is configured with
aperiodic CSI reporting, the UE shall report CSI when both CSI-IM and
NZP CSI-RS resources are configured as periodic, semi-persistent or
aperiodic.</p>
<p>A UE configured with DCI format 0_1 or 0_2 does not expect to be
triggered with multiple CSI reports with the same
<em>CSI-ReportConfigId</em>.</p>
<h5 id="resource-setting-configuration">5.2.1.4.1 Resource Setting
configuration</h5>
<p>For aperiodic CSI, each trigger state configured using the higher
layer parameter <em>CSI-AperiodicTriggerState</em> is associated with
one or multiple <em>CSI-ReportConfig</em> where the
<em>CSI-ReportConfig</em> not configured with
<em>groupBasedBeamReporting-r17</em> is linked to periodic, or
semi-persistent, or aperiodic resource setting(s):</p>
<p>- When one Resource Setting is configured, the Resource Setting
(given by higher layer parameter
<em>resourcesForChannelMeasurement</em>) is for channel measurement for
L1-RSRP or for channel and interference measurement for L1-SINR
computation.</p>
<p>- When two Resource Settings are configured, the first one Resource
Setting (given by higher layer parameter
<em>resourcesForChannelMeasurement</em>) is for channel measurement and
the second one (given by either higher layer parameter
<em>csi-IM-ResourcesForInterference</em> or higher layer parameter
<em>nzp-CSI-RS-ResourcesForInterference</em>) is for interference
measurement performed on CSI-IM or on NZP CSI-RS.</p>
<p>- When three Resource Settings are configured, the first Resource
Setting (higher layer parameter <em>resourcesForChannelMeasurement</em>)
is for channel measurement, the second one (given by higher layer
parameter <em>csi-IM-ResourcesForInterference</em>) is for CSI-IM based
interference measurement and the third one (given by higher layer
parameter <em>nzp-CSI-RS-ResourcesForInterference</em>) is for NZP
CSI-RS based interference measurement.</p>
<p>For aperiodic CSI, and for periodic and semi-persistent CSI resource
settings, each trigger state configured using the higher layer parameter
<em>CSI-AperiodicTriggerState</em> is associated with one or multiple
<em>CSI-ReportConfig</em> where the <em>CSI-ReportConfig</em> configured
with <em>groupBasedBeamReporting-r17</em> is linked to periodic or
semi-persistent, setting(s):</p>
<p>- When one Resource Setting is configured, the Resource setting is
given by <em>resourcesForChannelMeasurement</em> for L1-RSRP
measurement. In such a case, the number of configured CSI Resource Sets
in the Resource Setting is S=2</p>
<p>For aperiodic CSI, and for aperiodic CSI resource settings, each
trigger state configured using the higher layer parameter
<em>CSI-AperiodicTriggerState</em> is associated with one or multiple
<em>CSI-ReportConfig</em> where the <em>CSI-ReportConfig</em> configured
with <em>groupBasedBeamReporting-r17</em> is associated with
<em>resourcesForChannel</em> and <em>resourcesForChannel2</em>, which
correspond to first and second resource sets, respectively, for L1-RSRP
measurement.</p>
<p>For semi-persistent or periodic CSI, each <em>CSI-ReportConfig</em>
is linked to periodic or semi-persistent Resource Setting(s):</p>
<p>- When one Resource Setting (given by higher layer parameter
<em>resourcesForChannelMeasurement</em>) is configured, the Resource
Setting is for channel measurement for L1-RSRP or for channel and
interference measurement for L1-SINR computation.</p>
<p>- When two Resource Settings are configured, the first Resource
Setting (given by higher layer parameter
<em>resourcesForChannelMeasurement</em>) is for channel measurement and
the second Resource Setting (given by higher layer parameter
<em>csi-IM-ResourcesForInterference</em>) is used for interference
measurement performed on CSI-IM. For L1-SINR computation, the second
Resource Setting (given by higher layer parameter
<em>csi-IM-ResourcesForInterference</em> or higher layer parameter
<em>nzp-CSI-RS-ResourceForInterference</em>) is used for interference
measurement performed on CSI-IM or on NZP CSI-RS.</p>
<p>A UE is not expected to be configured with more than one CSI-RS
resource in resource set for channel measurement for a
<em>CSI-ReportConfig</em> with the higher layer parameter
<em>codebookType</em> set to 'typeII', 'typeII-PortSelection',
'typeII-r16', 'typeII-PortSelection-r16', or 'typeII-PortSelection-r17'.
A UE is not expected to be configured with more than 64 NZP CSI-RS
resources and/or SS/PBCH block resources in resource setting for channel
measurement for a <em>CSI-ReportConfig</em> with the higher layer
parameter <em>reportQuantity</em> set to 'none', 'cri-RI-CQI',
'cri-RSRP', 'ssb-Index-RSRP', 'cri-SINR' or 'ssb-Index-SINR', 'cri-RSRP-
Index', 'ssb-Index-RSRP- Index', 'cri-SINR- Index' or 'ssb-Index-SINR-
Index'. If interference measurement is performed on CSI-IM, each CSI-RS
resource for channel measurement is resource-wise associated with a
CSI-IM resource by the ordering of the CSI-RS resource and CSI-IM
resource in the corresponding resource sets. The number of CSI-RS
resources for channel measurement equals to the number of CSI-IM
resources.</p>
<p>An NZP CSI-RS Resource Set for channel measurement with <span
class="math inline">\(2 \leq K_{s} \leq 8\)</span> resources can be
configured with two Resource Groups, with <span
class="math inline">\(K_{1} \geq 1\)</span> resources in Group 1 and
<span class="math inline">\(K_{2} \geq 1\)</span> resources in Group 2,
such that <span class="math inline">\(K_{1} + K_{2} = K_{s}\)</span>,
and with <span class="math inline">\(N \in \{ 1,2\}\)</span> Resource
Pairs. Each Resource Pair consists of one resource from Group 1 and one
resource from Group 2. The same resource can be associated with two
Resource Pairs in frequency range 1 but not in frequency range 2.</p>
<p>Except for L1-SINR, if interference measurement is performed on NZP
CSI-RS, a UE does not expect to be configured with more than one NZP
CSI-RS resource in the associated resource set within the resource
setting for channel measurement. Except for L1-SINR, the UE configured
with the higher layer parameter
<em>nzp-CSI-RS-ResourcesForInterference</em> may expect no more than 18
NZP CSI-RS ports configured in a NZP CSI-RS resource set.</p>
<p>For CSI measurement(s) other than L1-SINR, a UE assumes:</p>
<p>- each NZP CSI-RS port configured for interference measurement
corresponds to an interference transmission layer.</p>
<p>- all interference transmission layers on NZP CSI-RS ports for
interference measurement take into account the associated EPRE ratios
configured in 5.2.2.3.1;</p>
<blockquote>
<p>- other interference signal on REs of NZP CSI-RS resource for channel
measurement, NZP CSI-RS resource for interference measurement, or CSI-IM
resource for interference measurement.</p>
</blockquote>
<p>For L1-SINR measurement with dedicated interference measurement
resources, a UE assumes:</p>
<p>- the total received power on dedicated NZP CSI-RS resource for
interference measurement or dedicated CSI-IM resource for interference
measurement corresponds to interference and noise.</p>
<h5 id="report-quantity-configurations">5.2.1.4.2 Report Quantity
Configurations</h5>
<p>A UE may be configured with a <em>CSI-ReportConfig</em> with the
higher layer parameter <em>reportQuantity</em> set to either 'none',
'cri-RI-PMI-CQI ', 'cri-RI-i1', 'cri-RI-i1-CQI', 'cri-RI-CQI',
'cri-RSRP', 'cri-SINR', 'ssb-Index-RSRP', 'ssb-Index-SINR',
'cri-RI-LI-PMI-CQI', 'cri-RSRP- Index', 'ssb-Index-RSRP- Index',
'cri-SINR- Index' or 'ssb-Index-SINR- Index'.</p>
<p>If the UE is configured with a <em>CSI-ReportConfig</em> with the
higher layer parameter <em>reportQuantity</em> set to 'none', then the
UE shall not report any quantity for the <em>CSI-ReportConfig</em>.</p>
<p>If the UE is configured with a <em>CSI-ReportConfig</em> with the
higher layer parameter <em>reportQuantity</em> set to 'cri-RI-PMI-CQI',
or 'cri-RI-LI-PMI-CQI', the UE shall report a preferred precoder matrix
for the entire reporting band, or a preferred precoder matrix per
subband, according to Clause 5.2.2.2.</p>
<p>If the UE is configured with a <em>CSI-ReportConfig</em> with the
higher layer parameter <em>reportQuantity</em> set to 'cri-RI-i1',</p>
<p>- the UE expects, for that <em>CSI-ReportConfig,</em> to be
configured with higher layer parameter <em>codebookType</em> set to
'typeI-SinglePanel' and <em>pmi-FormatIndicator</em> set to
'widebandPMI' and,</p>
<p>- the UE shall report a PMI consisting of a single wideband
indication (<img src="media/image120.svg" /> in Clause 5.2.2.2.1) for
the entire CSI reporting band.</p>
<p>If the UE is configured with a <em>CSI-ReportConfig</em> with the
higher layer parameter <em>reportQuantity</em> set to
'cri-RI-i1-CQI',</p>
<p>- the UE expects, for that <em>CSI-ReportConfig,</em> to be
configured with higher layer parameter <em>codebookType</em> set to
'typeI-SinglePanel' and <em>pmi-FormatIndicator</em> set to
'widebandPMI' and,</p>
<p>- the UE shall report a PMI consisting of a single wideband
indication (<img src="media/image120.svg" /> in Clause 5.2.2.2.1) for
the entire CSI reporting band. The CQI is calculated conditioned on the
reported <img src="media/image121.svg" />assuming PDSCH transmission
with <img src="media/image122.svg" /> precoders (corresponding to the
same <img src="media/image123.svg" />but different <img
src="media/image124.svg" /> in Clause 5.2.2.2.1), where the UE assumes
that one precoder is randomly selected from the set of <img
src="media/image125.svg" /> precoders for each PRG on PDSCH, where the
PRG size for CQI calculation is configured by the higher layer parameter
<em>pdsch-BundleSizeForCSI</em>.</p>
<p>If the UE is configured with a <em>CSI-ReportConfig</em> with the
higher layer parameter <em>reportQuantity</em> set to 'cri-RI-CQI',</p>
<p>- if the UE is configured with higher layer parameter
<em>non-PMI-PortIndication</em> contained in a
<em>CSI-ReportConfig,</em> <em>r</em> ports are indicated in the order
of layer ordering for rank <em>r</em> and each CSI-RS resource in the
CSI resource setting is linked to the <em>CSI-ReportConfig</em> based on
the order of the associated <em>NZP-CSI-RS-ResourceId</em> in the linked
CSI resource setting for channel measurement given by higher layer
parameter <em>resourcesForChannelMeasurement</em>. The configured higher
layer parameter <em>non-PMI-PortIndication</em> contains a sequence <img
src="media/image126.svg" /> of port indices, where <img
src="media/image127.svg" /> are the CSI-RS port indices associated with
rank ν and <img src="media/image128.svg" /> where<img
src="media/image129.svg" /> is the number of ports in the CSI-RS
resource. The UE shall only report RI corresponding to the configured
fields of <em>PortIndexFor8Ranks</em>.</p>
<p>- if the UE is not configured with higher layer parameter
<em>non-PMI-PortIndication,</em> the UE assumes, for each CSI-RS
resource in the CSI resource setting linked to the
<em>CSI-ReportConfig</em>, that the CSI-RS port indices <img
src="media/image130.svg" /> are associated with ranks <img
src="media/image131.svg" /> where <img src="media/image129.svg" /> is
the number of ports in the CSI-RS resource.</p>
<p>- When calculating the CQI for a rank, the UE shall use the ports
indicated for that rank for the selected CSI-RS resource. The precoder
for the indicated ports shall be assumed to be the identity matrix
scaled by <img src="media/image132.svg" />.</p>
<p>If the UE is configured with a <em>CSI-ReportConfig</em> with the
higher layer parameter <em>reportQuantity</em> set to 'cri-RSRP',
'ssb-Index-RSRP', 'cri-RSRP- Index' or 'ssb-Index-RSRP- Index',</p>
<p>- if the UE is configured with the higher layer parameter
<em>groupBasedBeamReporting</em> set to 'disabled', the UE is not
required to update measurements for more than 64 CSI-RS and/or SSB
resources, and the UE shall report in a single report
<em>nrofReportedRS</em> (higher layer configured) different CRI or SSBRI
for each report setting.</p>
<p>- if the UE is configured with the higher layer parameter
<em>groupBasedBeamReporting</em> set to 'enabled', the UE is not
required to update measurements for more than 64 CSI-RS and/or SSB
resources, and the UE shall report in a single reporting instance two
different CRI or SSBRI for each report setting, where CSI-RS and/or SSB
resources can be received simultaneously by the UE either with a single
spatial domain receive filter, or with multiple simultaneous spatial
domain receive filters.</p>
<p>- if the UE is configured with the higher layer parameter
<em>groupBasedBeamReporting-r17</em>, the UE is not required to update
measurements for more than 64 CSI-RS and/or SSB resources, and the UE
shall report in a single reporting instance <em>nrofReportedGroups,</em>
if configured, group(s) of two CRIs or SSBRIs selecting one CSI-RS or
SSB from each of the two CSI Resource Sets for the report setting, where
CSI-RS and/or SSB resources of each group can be received simultaneously
by the UE.</p>
<p>If the UE is configured with a <em>CSI-ReportConfig</em> with the
higher layer parameter <em>reportQuantity</em> set to 'cri-SINR',
'ssb-Index-SINR', 'cri-SINR- Index' or 'ssb-Index-SINR- Index',</p>
<p>- if the UE is configured with the higher layer parameter
<em>groupBasedBeamReporting</em> set to 'disabled', the UE shall report
in a single report <em>nrofReportedRS</em> (higher layer configured)
different CRI or SSBRI for each report setting.</p>
<p>- if the UE is configured with the higher layer parameter
<em>groupBasedBeamReporting</em> set to 'enabled', the UE shall report
in a single reporting instance two different CRI or SSBRI for each
report setting, where CSI-RS and/or SSB resources can be received
simultaneously by the UE.</p>
<p>If the UE is configured with a <em>CSI-ReportConfig</em> with the
higher layer parameter <em>reportQuantity</em> set to 'cri-RSRP',
'cri-RI-PMI-CQI ', 'cri-RI-i1', 'cri-RI-i1-CQI', 'cri-RI-CQI',
'cri-RI-LI-PMI-CQI', 'cri-SINR', or 'cri-SINR- Index ', and <span
class="math inline">\(K_{s} &gt; 1\ \)</span>resources are configured in
the corresponding resource set for channel measurement, then the UE
shall derive the CSI parameters other than CRI conditioned on the
reported CRI, where CRI <em>k</em> (<em>k</em> ≥ 0) corresponds to the
configured (<em>k</em>+1)-th entry of associated
<em>nzp-CSI-RS-Resources</em> in the corresponding
<em>NZP-CSI-RS-ResourceSet</em> for channel measurement, and
(<em>k</em>+1)-th entry of associated <em>csi-IM-Resource</em> in the
corresponding <em>csi-IM-ResourceSet</em> (if configured) or
(<em>k</em>+1)-th entry of associated <em>nzp-CSI-RS-Resources</em> in
the corresponding <em>NZP-CSI-RS-ResourceSet</em> (if configured
for <em>CSI-ReportConfig</em> with <em>reportQuantity</em> set to
'cri-SINR' or 'cri-SINR- Index ') for interference measurement. If <span
class="math inline">\(K_{s} = 2\ \)</span>CSI-RS resources are
configured, each resource shall contain at most 16 CSI-RS ports. If
<span class="math inline">\(2 &lt; K_{s} \leq 8\ \)</span>CSI-RS
resources are configured, each resource shall contain at most 8 CSI-RS
ports.</p>
<p>If the UE is configured with a <em>CSI-ReportConfig</em> with the
higher layer parameter <em>reportQuantity</em> set to 'cri-RI-PMI-CQI',
or 'cri-RI-LI-PMI-CQI' and the corresponding
<em>NZP-CSI-RS-ResourceSet</em> for channel measurement is configured
with <span class="math inline">\(K_{s} \geq 2\)</span> resources, two
Resource Groups with <span class="math inline">\(K_{1} \geq 1\)</span>
resources in Group 1, <span class="math inline">\(K_{2} \geq 1\)</span>
resources in Group 2, <span class="math inline">\(K_{1} + K_{2} =
K_{s}\)</span>, and <span class="math inline">\(N\)</span> Resource
Pairs:</p>
<p>- each resource can contain, subject to UE capability, at most 32
CSI-RS ports. For two Resource Groups with <span
class="math inline">\(K_{i}\)</span> resources (i=1,2), if <span
class="math inline">\(\max\left\{ K_{1},K_{2} \right\} = 1\)</span>, the
resource in NZP-CSI-RS-ResourceSet shall contain at most 32 CSI-RS
ports; if <span class="math inline">\(\ max\left\{ K_{1},K_{2} \right\}
= 2\)</span>, each resource in NZP-CSI-RS-ResourceSet shall contain at
most 16 CSI-RS ports; if <span class="math inline">\(2 &lt; \max\left\{
K_{1},K_{2} \right\} &lt; 8\)</span>, each resource in
NZP-CSI-RS-ResourceSet shall contain at most 8 CSI-RS ports.</p>
<p>- each of the <span class="math inline">\(N\)</span> Resource Pairs
is associated to a CRI value.</p>
<p>- The <em>CSI-ReportConfig</em> may be configured with higher layer
parameter <em>sharedCMR</em>. <span class="math inline">\(M_{1}\)</span>
and <span class="math inline">\(M_{2}\)</span> are the numbers of
resources associated to a CRI value, other than the <em>N</em> CRIs
defined above, in Group 1 and Group 2, respectively, with <span
class="math inline">\(M = M_{1} + M_{2}\)</span>, such that the total
number of CRI values configured for the <em>CSI-ReportConfig</em> is
<span class="math inline">\(M + N\)</span>.</p>
<p>- If the higher layer parameter <em>csi-ReportMode</em> is set to
'Mode1' and the higher layer parameter
<em>numberOfSingleTRP-CSI-Mode1</em> is set to <span
class="math inline">\(X \in \{ 0\}\)</span>, <span
class="math inline">\(M_{1} = M_{2} = 0\)</span>; otherwise,</p>
<p>- if the higher layer parameter <em>csi-ReportMode</em> is set to
'Mode1' and the higher layer parameter
<em>numberOfSingleTRP-CSI-Mode1</em> is set to <span
class="math inline">\(X \in \{ 1,2\}\)</span>, or if
<em>csi-ReportMode</em> is set to 'Mode2',</p>
<p>- if <em>sharedCMR</em> is configured: <span
class="math inline">\(M_{1} = K_{1}\)</span> and <span
class="math inline">\(M_{2} = K_{2}\)</span>; otherwise</p>
<p>- if <em>sharedCMR</em> is not configured, only the resources in
Group 1 and Group 2 that are not referred to in any Resource Pair are
associated to <em>M</em> CRI values other than the <em>N</em> CRIs
defined above.</p>
<p>- If interference measurement is performed on CSI-IM, <span
class="math inline">\(M + N\)</span> resources are configured in the
corresponding <em>csi-IM-ResourceSet</em>. The <span
class="math inline">\(M\)</span> resources for channel measurement
defined above are resource-wise associated with the first <span
class="math inline">\(M\)</span> CSI-IM resources by the ordering of the
CSI-RS resources and CSI-IM resources in the corresponding Resource Set.
The <span class="math inline">\(N\)</span> Resource Pairs for channel
measurement are associated to the last <span
class="math inline">\(N\)</span> CSI-IM resources by the ordering of the
CSI-RS Resource Pairs and CSI-IM resources in the CSI-IM Resource Set.
The UE may assume that the two CSI-RS resources for channel measurement
in a Resource Pair and the associated CSI-IM resource for interference
measurement are resource-wise QCLed with respect to 'typeD'.</p>
<p>- The UE is not expected to be configured with NZP CSI-RS for
interference measurement other than the NZP CSI-RS resources for channel
measurement configured in the <span class="math inline">\(N\)</span>
Resource Pairs.</p>
<p>- The UE expects, for that <em>CSI-ReportConfig,</em> to be
configured with higher layer parameter <em>codebookType</em> set to
'typeI-SinglePanel', and</p>
<p>- The UE shall derive the CSI parameters other than CRI(s)
conditioned on the reported CRI(s), as follows:</p>
<p>- If the higher layer parameter <em>csi-ReportMode</em> is set to
'Mode1' and the higher layer parameter
<em>numberOfSingleTRP-CSI-Mode1</em> is set to <span
class="math inline">\(X \in \{ 0,1,2\}\)</span>, <span
class="math inline">\(X + 1\)</span> CRI(s) are reported:</p>
<p>- one CRI <span class="math inline">\(k_{1}\ \left( k_{1} \geq 0
\right)\)</span> corresponds to the configured <span
class="math inline">\((k_{1} + 1)\)</span>-th entry of the associated
<span class="math inline">\(N\)</span> Resource Pairs in the
corresponding CSI-RS Resource Set for channel measurement, and <span
class="math inline">\(({M + k}_{1} + 1)\)</span>-th entry of the
corresponding CSI-IM Resource Set, if configured. The UE shall report
two RIs, two PMIs, two LIs (if configured), associated to the resource
in Group 1 and the resource in Group 2, respectively, of the <span
class="math inline">\((k_{1} + 1)\)</span>-th Resource Pair, and one
CQI; and</p>
<p>- if <span class="math inline">\(X = 1\)</span>, one CRI <span
class="math inline">\(k_{2}\)</span> (<span class="math inline">\(k_{2}
\geq 0\)</span>) corresponds to the configured <span
class="math inline">\((k_{2} + 1)\)</span>-th entry of the associated
<span class="math inline">\(M\)</span> resources in the corresponding
CSI-RS Resource Set for channel measurement, and <span
class="math inline">\((k_{2} + 1)\)</span>-th entry of the corresponding
CSI-IM Resource Set, if configured. The UE shall report one RI, one PMI,
one LI (if configured) and one or two CQIs conditioned on CRI <span
class="math inline">\(k_{2}\)</span>; or</p>
<p>- if <span class="math inline">\(X = 2\)</span>, one CRI <span
class="math inline">\(k_{2}\)</span> <span class="math inline">\((k_{2}
\geq 0)\)</span> corresponds to the configured <span
class="math inline">\((k_{2} + 1)\)</span>-th entry of the associated
<span class="math inline">\(M_{1}\)</span> resources in Group 1 of the
corresponding CSI-RS Resource Set for channel measurement, and <span
class="math inline">\((k_{2} + 1)\)</span>-th entry of the associated
resources in the corresponding CSI-IM Resource Set, if configured, and
one CRI <span class="math inline">\(k_{3}\)</span> <span
class="math inline">\((k_{3} \geq 0)\)</span> corresponds to the
configured <span class="math inline">\((k_{3} + 1)\)</span>-th entry of
the associated <span class="math inline">\(M_{2}\)</span> resources in
Group 2 of the corresponding CSI-RS Resource Set for channel
measurement, and <span class="math inline">\((M_{1} + k_{3} +
1)\)</span>-th entry of the corresponding CSI-IM Resource Set, if
configured. The UE shall report one RI, one PMI, one LI (if configured)
and one or two CQIs conditioned on CRI <span
class="math inline">\(k_{2}\)</span> and one RI, one PMI, one LI (if
configured) and one or two CQIs conditioned on CRI <span
class="math inline">\(k_{3}\)</span>.</p>
<p>- If the higher layer parameter <em>csi-ReportMode</em> is set to
'Mode2', one CRI <span class="math inline">\(k_{1}\)</span> <span
class="math inline">\((k_{1} \geq 0)\)</span> is reported, which
corresponds to the <span class="math inline">\((k_{1} + 1)\)</span>-th
entry of the <span class="math inline">\(M + N\)</span> resources or
Resource Pairs in the corresponding CSI-RS Resource Set for channel
measurement, and <span class="math inline">\((k_{1} + 1)\)</span>-th
entry of the associated resources in the corresponding CSI-IM Resource
Set, if configured. The first <span class="math inline">\(M\)</span>
codepoints of the CRI correspond to resources associated to Group 1 and
Group 2. The last <span class="math inline">\(N\)</span> codepoints of
the CRI correspond to the <span class="math inline">\(N\)</span>
configured Resource Pairs. The UE shall report one RI, one PMI, one LI,
if configured, and one or two CQIs conditioned on CRI <span
class="math inline">\(k_{1}\)</span> if <span
class="math inline">\(k_{1} &lt; M\)</span>; or two RIs, two PMIs, two
LIs, if configured, associated to the resource in Group 1 and the
resource in Group 2, respectively, of the <span
class="math inline">\((k_{1} - M + 1)\)</span>-th Resource Pair, and one
CQI, otherwise.</p>
<p>- For a reported CRI corresponding to an entry of the <span
class="math inline">\(N\)</span> Resource Pairs configured in the
corresponding CSI-RS Resource Set for channel measurement:</p>
<p>- the UE shall not report a total number of layers larger than
four.</p>
<p>- the two RIs are reported with a joint RI index corresponding to one
of the four rank combinations: <span class="math inline">\(\left\{ 1,1
\right\},\ \left\{ 1,2 \right\},\ \left\{ 2,1 \right\},\ \{
2,2\}\)</span>.</p>
<p>- The <em>CodebookConfig</em> in <em>CSI-ReportConfig</em> can be
configured with two RI restriction parameters
<em>typeI-SinglePanel-ri-RestrictionSTRP</em> and
<em>typeI-SinglePanel-ri-RestrictionSDM</em>. The parameter
<em>typeI-SinglePanel-ri-RestrictionSTRP</em> applies to a reported RI
when conditioned on a CRI corresponding to an entry of the <span
class="math inline">\(M\)</span> CSI-RS resources defined above. The
bitmap parameter <em>typeI-SinglePanel-ri-RestrictionSTRP</em> forms the
bit sequence <img src="media/image133.svg" /> where <img
src="media/image134.svg" /> is the LSB and <img
src="media/image135.svg" /> is the MSB. When <img
src="media/image136.svg" /> is zero, <img src="media/image137.svg" />,
PMI and RI reporting are not allowed to correspond to any precoder
associated with <img src="media/image138.svg" /> layers. The parameter
<em>typeI-SinglePanel-ri-RestrictionSDM</em> applies to a reported joint
RI index when conditioned on a CRI corresponding to an entry of the
<span class="math inline">\(N\)</span> Resource Pairs and indicates one
or more of the four rank combinations that are allowed to correspond to
the reported PMIs and RIs. The bitmap parameter
<em>typeI-SinglePanel-ri-RestrictionSDM</em> forms the bit sequence <img
src="media/image139.svg" /> where <img src="media/image134.svg" /> is
the LSB and <img src="media/image140.svg" /> is the MSB. When <img
src="media/image136.svg" /> is zero, <img src="media/image141.svg" />,
PMI and RI reporting are not allowed to correspond to any precoder
associated with the <span class="math inline">\((i + 1)\)</span>-th rank
combination in the following order: {1,1}, {1,2}, {2,1},{2,2}.</p>
<p>- The <em>CodebookConfig</em> in <em>CSI-ReportConfig</em> can be
configured with two Codebook Subset Restrictions. The first restriction
applies to a reported PMI associated to a CSI-RS resource in Group 1.
The second restriction applies to a reported PMI associated to a CSI-RS
resource in Group 2.</p>
<p>If the UE is configured with a <em>CSI-ReportConfig</em> with the
higher layer parameter <em>reportQuantity</em> set to 'ssb-Index-RSRP'
or 'ssb-Index-RSRP- Index', the UE shall report SSBRI, where SSBRI
<em>k</em> (<em>k</em> ≥ 0) corresponds to the configured
(<em>k</em>+1)-th entry of the associated <em>csi-SSB-ResourceList</em>
in the corresponding <em>CSI-SSB-ResourceSet.</em></p>
<p>If the UE is configured with a <em>CSI-ReportConfig</em> with the
higher layer parameter <em>reportQuantity</em> set to 'ssb-Index-SINR'
or 'ssb-Index-SINR- Index', the UE shall derive L1-SINR conditioned on
the reported SSBRI, where SSBRI <em>k</em> (<em>k</em> ≥ 0) corresponds
to the configured (<em>k</em>+1)-th entry of the associated
<em>csi-SSB-ResourceList</em> in the corresponding
<em>CSI-SSB-ResourceSet</em> for channel measurement, and
(<em>k</em>+1)-th entry of associated <em>csi-IM-Resource</em> in the
corresponding <em>csi-IM-ResourceSet</em> (if configured) or
(<em>k</em>+1)-th entry of associated <em>nzp-CSI-RS-Resources</em> in
the corresponding <em>NZP-CSI-RS-ResourceSet</em> (if configured) for
interference measurement.</p>
<p>If the UE is configured with a <em>CSI-ReportConfig</em> with the
higher layer parameter <em>reportQuantity</em> set to 'cri-RI-PMI-CQI',
' cri-RI-i1', 'cri-RI-i1-CQI', 'cri-RI-CQI' or 'cri-RI-LI-PMI-CQI', then
the UE is not expected to be configured with more than 8 CSI-RS
resources in a CSI-RS resource set contained within a resource setting
that is linked to the <em>CSI-ReportConfig</em>.</p>
<p>If the UE is configured with a <em>CSI-ReportConfig</em> with the
higher layer parameter <em>reportQuantity</em> set to
'cri-RI-LI-PMI-CQI', UE does not expect the <em>CSI-ReportConfig</em> to
be configured with higher layer parameter <em>codebookType</em> set to
'<em>typeII-r16</em>' or '<em>typeII-PortSelection-r16</em>' or
'<em>typeII-PortSelection-r17'</em>.</p>
<p>If the UE is configured with a <em>CSI-ReportConfig</em> with higher
layer parameter <em>reportQuantity</em> set to 'cri-RSRP', 'cri-SINR',
'none', 'cri-RSRP- Index' or 'cri-SINR- Index and the
<em>CSI-ReportConfig</em> is linked to a resource setting configured
with the higher layer parameter <em>resourceType</em> set to
'aperiodic', then the UE is not expected to be configured with more than
16 CSI-RS resources in a CSI-RS resource set contained within the
resource setting.</p>
<p>The LI indicates which column of the precoder matrix of the reported
PMI corresponds to the strongest layer of the codeword corresponding to
the largest reported wideband CQI. If two wideband CQIs are reported and
have equal value, the LI corresponds to strongest layer of the first
codeword. If the UE is configured with a <em>CSI-ReportConfig</em> with
<em>reportQuantity</em> set to 'cri-RI-LI-PMI-CQI' and the corresponding
<em>NZP-CSI-RS-ResourceSet</em> for channel measurement is configured
with two Resource Groups and <span class="math inline">\(N\)</span>
Resource Pairs, and the UE reports a CRI associated to a Resource Pair,
and a rank combination <span
class="math inline">\(\{\nu_{1},\nu_{2}\}\)</span>, the first LI
indicates which column of the precoder matrix of the first reported PMI
corresponds to the strongest of the first <span
class="math inline">\(\nu_{1}\)</span> layers of the codeword and the
second LI indicates which column of the precoder matrix of the second
reported PMI corresponds to the strongest of the last <span
class="math inline">\(\nu_{2}\)</span> layers of the codeword.</p>
<p>For operation with shared spectrum channel access in FR1, or in FR2-2
when the UE is provided <em>ChannelAccessMode2-r17</em> =
'<em>enabled</em>', if the UE is configured with a
<em>CSI-ReportConfig</em> with higher layer parameter
<em>reportQuantity</em> set to 'cri-RI-PMI-CQI ', 'cri-RI-i1',
'cri-RI-i1-CQI', 'cri-RI-CQI' or 'cri-RI-LI-PMI-CQI', the UE shall
derive:</p>
<p>- the CSI parameters without averaging two or more instances of any
periodic or semi-persistent <em>nzp-CSI-RS-Resources</em> in the
corresponding <em>NZP-CSI-RS-ResourceSet</em> for channel measurement or
for interference measurement located in different DL transmissions,</p>
<p>- the instances of the <em>nzp-CSI-RS-Resources</em> are not in the
same channel occupancy duration indicated by DCI format 2_0, if the UE
is provided at least one of <em>SlotFormatIndicator</em> or
co<em>-DurationList</em>; or</p>
<p>- the instances of the <em>nzp-CSI-RS-Resources</em> occur within a
set of consecutive symbols which are not all occupied by PDSCH(s) and/or
aperiodic CSI-RS(s) indicated by DCI formats, if any, and the
corresponding PDCCH(s), if the UE is neither provided with
<em>CO-DurationsPerCell</em> nor <em>SlotFormatIndicator</em>, but is
provided with <em>csi-RS-ValidationWithDCI</em></p>
<p>- the interference measurements for computing CSI value based on
periodic/semi-persistent CSI-IM measured only in OFDM symbol(s) that
fulfill the same conditions under which the UE is expected to receive
periodic/semi-persistent CSI-RS as described in Clause 11.1 and Clause
11.1.1 of [6, TS 38.213].</p>
<p>If the UE is configured with the higher layer parameter
<em>SSB-MTC-AdditionalPCI</em>, the UE is allowed to report in a single
reporting instance up to four SSBRIs for each report setting, where SSB
resources are associated with PCI indices referring to the PCI of the
serving cell and PCI(s) different from the PCI of the serving cell
within the set of PCIs configured.</p>
<h5 id="l1-rsrp-reporting">5.2.1.4.3 L1-RSRP Reporting</h5>
<p>For L1-RSRP computation</p>
<p>- the UE may be configured with CSI-RS resources, SS/PBCH Block
resources or both CSI-RS and SS/PBCH block resources, when resource-wise
quasi co-located with 'type C' and 'typeD' when applicable.</p>
<p>- the UE may be configured with CSI-RS resource setting up to 16
CSI-RS resource sets having up to 64 resources within each set. The
total number of different CSI-RS resources over all resource sets is no
more than 128.</p>
<p>For L1-RSRP reporting, if the higher layer parameter
<em>nrofReportedRS</em> in <em>CSI-ReportConfig</em> is configured to be
one, the reported L1-RSRP value is defined by a 7-bit value in the range
[-140, -44] dBm with 1dB step size, if the higher layer parameter
<em>nrofReportedRS</em> is configured to be larger than one, or if the
higher layer parameter <em>groupBasedBeamReporting</em> is configured as
'enabled', or if the higher layer parameter
<em>groupBasedBeamReporting-r17</em> is configured<em>,</em> the UE
shall use differential L1-RSRP based reporting, where the largest
measured value of L1-RSRP is quantized to a 7-bit value in the range
[-140, -44] dBm with 1dB step size, and the differential L1-RSRP is
quantized to a 4-bit value. The differential L1-RSRP value is computed
with 2 dB step size with a reference to the largest measured L1-RSRP
value which is part of the same L1-RSRP reporting instance. The mapping
between the reported L1-RSRP value and the measured quantity is
described in [11, TS 38.133].</p>
<p>When the higher layer parameter
<em>groupBasedBeamReporting-r17</em>in <em>CSI-ReportConfig</em> is
configured, the UE shall indicate the CSI Resource Set associated with
the largest measured value of L1-RSRP, and for each group, CRI or SSBRI
of the indicated CSI Resource Set is present first.</p>
<p>If the higher layer parameter
<em>timeRestrictionForChannelMeasurements</em> in
<em>CSI-ReportConfig</em> is set to "<em>notConfigured</em>", the UE
shall derive the channel measurements for computing L1-RSRP value
reported in uplink slot <em>n</em> based on only the SS/PBCH or NZP
CSI-RS, no later than the CSI reference resource, (defined in TS
38.211[4]) associated with the CSI resource setting.</p>
<p>If the higher layer parameter
<em>timeRestrictionForChannelMeasurements</em> in
<em>CSI-ReportConfig</em> is set to "<em>Configured</em>", the UE shall
derive the channel measurements for computing L1-RSRP reported in uplink
slot <em>n</em> based on only the most recent, no later than the CSI
reference resource, occasion of SS/PBCH or NZP CSI-RS (defined in [4, TS
38.211]) associated with the CSI resource setting.</p>
<p>When the UE is configured with <em>SSB-MTC-AddtionalPCI</em>, a
CSI-SSB-ResourceSet configured for L1-RSRP reporting includes one set of
SSB indices and one set of PCI indices, where each SSB index is
associated with a PCI index.</p>
<p>When the UE is configured with a <em>CSI-ReportConfig</em> with the
higher layer parameter <em>reportQuantity</em> set to ' cri-RSRP- Index'
or 'ssb-Index-RSRP- Index' an index of UE capability value set,
indicating the maximum supported number of SRS antenna ports, is
reported along with the pair of SSBRI/CRI and L1-RSRP.</p>
<h5 id="l1-sinr-reporting">5.2.1.4.4 L1-SINR Reporting</h5>
<p>For L1-SINR computation, for channel measurement the UE may be
configured with NZP CSI-RS resources and/or SS/PBCH Block resources, for
interference measurement the UE may be configured with NZP CSI-RS or
CSI-IM resources.</p>
<p>- for channel measurement, the UE may be configured with CSI-RS
resource setting with up to 16 resource sets, with a total of up to 64
CSI-RS resources or up to 64 SS/PBCH Block resources.</p>
<p>For L1-SINR reporting, if the higher layer parameter
<em>nrofReportedRS</em> in <em>CSI-ReportConfig</em> is configured to be
one, the reported L1-SINR value is defined by a 7-bit value in the range
[-23, 40] dB with 0.5 dB step size, and if the higher layer parameter
<em>nrofReportedRS</em> is configured to be larger than one, or if the
higher layer parameter <em>groupBasedBeamReporting</em> is configured as
'enabled', the UE shall use differential L1-SINR based reporting, where
the largest measured value of L1-SINR is quantized to a 7-bit value in
the range [-23, 40] dB with 0.5 dB step size, and the differential
L1-SINR is quantized to a 4-bit value. The differential L1-SINR is
computed with 1 dB step size with a reference to the largest measured
L1-SINR value which is part of the same L1-SINR reporting instance. When
NZP CSI-RS is configured for channel measurement and/or interference
measurement, the reported L1-SINR values should not be compensated by
the power offset(s) given by higher layer parameter
<em>powerControOffsetSS</em> or <em>powerControlOffset</em>.</p>
<p>When one or two resource settings are configured for L1-SINR
measurement</p>
<p>- If the higher layer parameter
<em>timeRestrictionForChannelMeasurements</em> in
<em>CSI-ReportConfig</em> is set to <em>'notConfigured'</em>, the UE
shall derive the channel measurements for computing L1-SINR reported in
uplink slot n based on only the SSB or NZP CSI-RS, no later than the CSI
reference resource, (defined in TS 38.211[4]) associated with the CSI
resource setting.</p>
<p>- If the higher layer parameter
<em>timeRestrictionForChannelMeasurements</em> in
<em>CSI-ReportConfig</em> is set to <em>'configured'</em>, the UE shall
derive the channel measurements for computing L1-SINR reported in uplink
slot n based on only the most recent, no later than the CSI reference
resource, occasion of SSB or NZP CSI-RS (defined in [4, TS 38.211])
associated with the CSI resource setting.</p>
<p>- If the higher layer parameter
<em>timeRestrictionForInterferenceMeasurements</em> in
<em>CSI-ReportConfig</em> is set to <em>'notConfigured'</em>, the UE
shall derive the interference measurements for computing L1-SINR
reported in uplink slot n based on only the CSI-IM or NZP CSI-RS for
interference measurement (defined in [4, TS 38.211]) or NZP CSI-RS for
channel and interference measurement no later than the CSI reference
resource associated with the CSI resource setting.</p>
<p>- If the higher layer parameter
<em>timeRestrictionForInterferenceMeasurements</em> in
<em>CSI-ReportConfig</em> is set to <em>'configured'</em>, the UE shall
derive the interference measurements for computing the L1-SINR reported
in uplink slot n based on the most recent, no later than the CSI
reference resource, occasion of CSI-IM or NZP CSI-RS for interference
measurement (defined in [4, TS 38.211]) or NZP CSI-RS for channel and
interference measurement associated with the CSI resource setting.</p>
<p>When the UE is configured a <em>CSI-ReportConfig</em> with the higher
layer parameter <em>reportQuantity</em> set to ' cri-SINR- Index' or
'ssb-Index-SINR- Index' an index of UE capability value, indicating the
maximum supported number of SRS antenna ports, is reported along with
the pair of SSBRI/CRI and L1-SINR.</p>
<h4 id="triggeringactivation-of-csi-reports-and-csi-rs">5.2.1.5
Triggering/activation of CSI Reports and CSI-RS</h4>
<h5
id="aperiodic-csi-reportingaperiodic-csi-rs-when-the-triggering-pdcch-and-the-csi-rs-have-the-same-numerology">5.2.1.5.1
Aperiodic CSI Reporting/Aperiodic CSI-RS when the triggering PDCCH and
the CSI-RS have the same numerology</h5>
<p>For CSI-RS resource sets associated with Resource Settings configured
with the higher layer parameter <em>resourceType</em> set to
'aperiodic', 'periodic', or 'semi-persistent', trigger states for
Reporting Setting(s) (configured with the higher layer parameter
<em>reportConfigType</em> set to 'aperiodic') and/or Resource Setting
for channel and/or interference measurement on one or more component
carriers are configured using the higher layer parameter
<em>CSI-AperiodicTriggerStateList</em>. For aperiodic CSI report
triggering, a single set of CSI triggering states are higher layer
configured, wherein the CSI triggering states can be associated with any
candidate DL BWP. A UE is not expected to receive more than one DCI with
non-zero <em>CSI request</em> field per slot per cell. A UE is not
expected to receive DCI with non-zero <em>CSI request</em> field within
a cell group in a slot overlapping with any slot receiving DCI with
non-zero <em>CSI request</em> field in the same cell group. A UE is not
expected to be configured with different <em>TCI-StateId</em>'s for the
same aperiodic CSI-RS resource ID configured in multiple aperiodic
CSI-RS resource sets with the same triggering offset in the same
aperiodic trigger state. A UE is not expected to receive more than one
aperiodic CSI report request for transmission in a given slot per cell.
A UE is not expected to receive an aperiodic CSI report request for
transmission in a slot overlapping with any slot having an aperiodic CSI
report transmission in the same cell group. If a UE does not indicate
its capability of <em>csi-TriggerStateNon-ActiveBWP</em> the UE is not
expected to be triggered with a CSI report for a non-active DL BWP.
Otherwise, when a UE is triggered with a CSI report for a DL BWP that is
non-active when expecting to receive the most recent occasion, no later
than the CSI reference resource, of the associated NZP CSI-RS, the UE is
not expected to report the CSI for the non-active DL BWP and the CSI
report associated with that BWP is omitted. When a UE is triggered with
aperiodic NZP CSI-RS in a DL BWP that is non-active when expecting to
receive the NZP CSI-RS, the UE is not expected to measure the aperiodic
CSI-RS. In the carrier of the serving cell expecting to receive that
associated NZP CSI-RS, if the active DL BWP when receiving the NZP
CSI-RS is different from the active DL BWP when receiving the triggering
DCI,</p>
<p>- the last symbol of the PDCCH span of the DCI carrying the BWP
switching shall be no later than the last symbol of the PDCCH span of
the DCI carrying the CSI trigger, irrespective of whether they are in
the same carrier of a serving cell or not and irrespective of whether
they are in the same SCS or not;</p>
<p>- the UE is not expected to have any other BWP switching in that
carrier after the last symbol of the PDCCH span covering the DCI
carrying the CSI trigger and before the first symbol of the triggered
NZP CSI-RS or CSI-IM.</p>
<p>- when the PDCCH reception includes two PDCCH candidates from two
respective search space sets, as described in clause 10.1 of [6, TS
38.213], the span that involves the PDCCH candidate that ends later in
time is used.</p>
<p>A trigger state is initiated using the <em>CSI request</em> field in
DCI.</p>
<p>- When all the bits of <em>CSI request</em> field in DCI are set to
zero, no CSI is requested.</p>
<p>- When the number of configured CSI triggering states in
<em>CSI-AperiodicTriggerStateList</em> is greater than <img
src="media/image142.svg" />, where <img src="media/image143.svg" /> is
the number of bits in the DCI <em>CSI request</em> field, the UE
receives a subselection indication, as described in clause 6.1.3.13 of
[10, TS 38.321], used to map up to <img src="media/image142.svg" />
trigger states to the codepoints of the <em>CSI request</em> field in
DCI. <img src="media/image143.svg" /> is configured by the higher layer
parameter <em>reportTriggerSize</em> where <img
src="media/image144.svg" />. When the UE would transmit a PUCCH with
HARQ-ACK information in slot <em>n</em> corresponding to the PDSCH
carrying the subselection indication, the corresponding action in [10,
TS 38.321] and UE assumption on the mapping of the selected CSI trigger
state(s) to the codepoint(s) of DCI CSI request field shall be applied
starting from the first slot that is after slot <span
class="math inline">\(n + {3N}_{slot}^{subframe,µ} +
{\frac{2^{\mu}}{2^{\mu_{K_{mac}}}} \bullet k}_{mac}\)</span> where
<em>μ</em> is the SCS configuration for the PUCCH and <span
class="math inline">\(\mu_{K_{mac}}\ \)</span>is the subcarrier spacing
configuration for <span class="math inline">\(k_{mac}\)</span> with a
value of 0 for frequency range 1, and <span
class="math inline">\(k_{mac}\)</span> is provided by <em>K-Mac</em> or
<span class="math inline">\(k_{mac} = 0\)</span> if <em>K-Mac</em> is
not provided..</p>
<p>- When the number of CSI triggering states in
<em>CSI-AperiodicTriggerStateList</em> is less than or equal to <img
src="media/image142.svg" />, the <em>CSI request</em> field in DCI
directly indicates the triggering state.</p>
<p>- For each aperiodic CSI-RS resource in a CSI-RS resource set
associated with each CSI triggering state, the UE is indicated the quasi
co-location configuration of quasi co-location RS source(s) and quasi
co-location type(s), as described in clause 5.1.5, through higher layer
signaling of <em>qcl-info</em> which contains a list of references to
<em>TCI-State's</em> for the aperiodic CSI-RS resources associated with
the CSI triggering state. If a <em>State</em> referred to in the list is
configured with a reference to an RS configured with <em>qcl-Type</em>
set to 'typeD', that RS may be an SS/PBCH block located in the same or
different CC/DL BWP or a CSI-RS resource configured as periodic or
semi-persistent located in the same or different CC/DL BWP.</p>
<p>- If the scheduling offset between the last symbol of the PDCCH
carrying the triggering DCI and the first symbol of the aperiodic CSI-RS
resources in a <em>NZP-CSI-RS-ResourceSet</em> configured without higher
layer parameter <em>trs-Info</em> is smaller than the UE reported
threshold <em>beamSwitchTiming,</em> as defined in [13, TS 38.306], when
the reported value is one of the values of {14, 28, 48}<span
class="math inline">\(\bullet 2^{{max(0,\ \mu}_{CSIRS} - 3)}\)</span>
and <em>enableBeamSwitchTiming</em> is not provided, or is smaller than
48<span class="math inline">\(\bullet 2^{{max(0,\ \mu}_{CSIRS} -
3)}\)</span> when the UE provides <em>beamSwitchTiming-r16</em>,
<em>enableBeamSwitchTiming</em> is provided and the
<em>NZP-CSI-RS-ResourceSet</em> is configured with the higher layer
parameter <em>repetition</em> set to 'off' or configured without the
higher layer parameter <em>repetition,</em> or is smaller than the UE
reported threshold <em>beamSwitchTiming-r16,</em> when
<em>enableBeamSwitchTiming</em> is provided and the
<em>NZP-CSI-RS-ResourceSet</em> is configured with the higher layer
parameter <em>repetition</em> set to 'on'.</p>
<p>- If a UE is configured with
<em>enableDefaultTCI-StatePerCoresetPoolIndex</em> and the UE is
configured by higher layer parameter <em>PDCCH-Config</em> that contains
two different values of <em>coresetPoolIndex</em> in
<em>ControlResourceSet</em></p>
<p>- if there is any other DL signal with an indicated TCI state in the
same symbols as the CSI-RS, the UE applies the QCL assumption of the
other DL signal also when receiving the aperiodic CSI-RS. The other DL
signal refers to PDSCH scheduled by a PDCCH associated with the same
<em>coresetPoolIndex</em> as the PDCCH triggering the aperiodic CSI-RS
and scheduled with offset larger than or equal to the threshold
<em>timeDurationForQCL,</em> as defined in [13, TS 38.306], aperiodic
CSI-RS triggered by a PDCCH associated with the same
<em>coresetPoolIndex</em> as the PDCCH triggering the aperiodic CSI-RS
and scheduled with offset larger than or equal to the UE reported
threshold <em>beamSwitchTiming</em> when the reported value is one of
the values {14,28,48}<span class="math inline">\(\bullet 2^{{max(0,\
\mu}_{CSIRS} - 3)}\)</span> and <em>enableBeamSwitchTiming</em> is not
provided, aperiodic CSI-RS triggered by a PDCCH associated with the same
<em>coresetPoolIndex</em> as the PDCCH triggering the aperiodic CSI-RS
and scheduled with offset larger than or equal to 48<span
class="math inline">\(\bullet 2^{{max(0,\ \mu}_{CSIRS} - 3)}\)</span>
when the reported value of <em>beamSwitchTiming-r16</em> is one of the
values {224, 336}<span class="math inline">\(\bullet 2^{{max(0,\
\mu}_{CSIRS} - 3)}\)</span> and <em>enableBeamSwitchTiming</em> is
provided, periodic CSI-RS, semi-persistent CSI-RS;</p>
<p>- else, the UE applies the QCL parameter(s) of the CORESET associated
with a monitored search space with the lowest
<em>controlResourceSetId</em> among CORESETs, which are configured with
the same value of <em>coresetPoolIndex</em> as the PDCCH triggering that
aperiodic CSI-RS, in the latest slot in which one or more CORESETs are
associated with the same value of <em>coresetPoolIndex</em> as the PDCCH
triggering that aperiodic CSI-RS</p>
<p>- else if a UE is configured with <em>enableTwoDefaultTCI-States</em>
and at least one TCI codepoint is mapped to two TCI states</p>
<p>- if there is any other DL signal with an indicated TCI state in the
same symbols as the CSI-RS, the UE applies the QCL assumption of the
other DL signal also when receiving the aperiodic CSI-RS. The other DL
signal refers to PDSCH scheduled with offset larger than or equal to the
threshold <em>timeDurationForQCL,</em> as defined in [13, TS 38.306],
aperiodic CSI-RS scheduled with offset larger than or equal to the UE
reported threshold <em>beamSwitchTiming</em> when the reported value is
one of the values {14,28,48}<span class="math inline">\(\bullet
2^{{max(0,\ \mu}_{CSIRS} - 3)}\)</span> and
<em>enableBeamSwitchTiming</em> is not provided, aperiodic CSI-RS
scheduled with offset larger than or equal to 48<span
class="math inline">\(\bullet 2^{{max(0,\ \mu}_{CSIRS} - 3)}\)</span>
when the reported value of <em>beamSwitchTiming-r16</em> is one of the
values {224, 336}<span class="math inline">\(\bullet 2^{{max(0,\
\mu}_{CSIRS} - 3)}\)</span> and <em>enableBeamSwitchTiming</em> is
provided, periodic CSI-RS, semi-persistent CSI-RS. If there is a PDSCH
indicated with two TCI states in the same symbols as the CSI-RS, the UE
applies the first TCI state of the two TCI states when receiving the
aperiodic CSI-RS.</p>
<p>- else, the UE applies the first one of two TCI states corresponding
to the lowest TCI codepoint among those mapped to two TCI states and
applicable to the PDSCH within the active BWP of the cell in which the
CSI-RS is to be received when receiving the aperiodic CSI-RS.</p>
<p>- else if a UE is configured with <em>sfnSchemePdcch</em> set to
<em>'</em>sfnSchemeA' or 'sfnSchemeB', it is not configured with
<em>enableTwoDefaultTCI-States,</em> and the two TCI states are
activated for the CORESET by the activation command as described in
clause 6.1.3.44 of [10, TS 38.321]</p>
<p>- if there is any other DL signal with an indicated TCI state in the
same symbols as the CSI-RS, the UE applies the QCL assumption of the
other DL signal also when receiving the aperiodic CSI-RS. The other DL
signal refers to PDSCH scheduled with an offset larger than or equal to
the threshold <em>timeDurationForQCL,</em> as defined in [13, TS
38.306], periodic CSI-RS, semi-persistent CSI-RS, aperiodic CSI-RS in a
<em>NZP-CSI-RS-ResourceSet</em> scheduled with offset larger than or
equal to the UE reported threshold <em>beamSwitchTiming</em> when the
reported value is one of the values {14,28,48} and when
<em>enableBeamSwitchTiming</em> is not provided or the
<em>NZP-CSI-RS-ResourceSet</em> is configured with the higher layer
parameter <em>trs-Info</em> , aperiodic CSI-RS in a
<em>NZP-CSI-RS-ResourceSet</em> configured with the higher layer
parameter <em>repetition</em> set to 'off' or configured without the
higher layer parameters <em>repetition</em> and <em>trs-Info</em>
scheduled with offset larger than or equal to 48 when the UE provides
<em>beamSwitchTiming-r16</em> and <em>enableBeamSwitchTiming</em> is
provided, aperiodic CSI-RS in a <em>NZP-CSI-RS-ResourceSet</em>
configured with the higher layer parameter <em>repetition</em> set to
'on' scheduled with offset larger than or equal to the UE reported
threshold <em>beamSwitchTiming-r16</em> and
<em>enableBeamSwitchTiming</em> is provided;</p>
<p>- else, the UE applies the first one of TCI states indicated for the
CORESET with the lowest CORESET ID in the latest slot within the active
BWP of the cell in which the CSI-RS is to be received when receiving the
aperiodic CSI-RS, if two TCI states are activated for the CORESET.
Otherwise, the UE applies the single activated TCI state of the CORESET
with the lowest CORESET ID in the latest slot within the active BWP of
the cell in which the CSI-RS is to be received, when receiving the
aperiodic CSI-RS</p>
<p>- else if there is any other DL signal with an indicated TCI state in
the same symbols as the CSI-RS, the UE applies the QCL assumption of the
other DL signal also when receiving the aperiodic CSI-RS. The other DL
signal refers to PDSCH scheduled with offset larger than or equal to the
threshold <em>timeDurationForQCL,</em> as defined in [13, TS 38.306],
periodic CSI-RS, semi-persistent CSI-RS, aperiodic CSI-RS in a
<em>NZP-CSI-RS-ResourceSet</em> scheduled with offset larger than or
equal to the UE reported threshold <em>beamSwitchTiming</em> when the
reported value is one of the values {14,28,48}<span
class="math inline">\(\bullet 2^{{max(0,\ \mu}_{CSIRS} - 3)}\)</span>
and when <em>enableBeamSwitchTiming</em> is not provided or the
<em>NZP-CSI-RS-ResourceSet</em> is configured with the higher layer
parameter <em>trs-Info</em> , aperiodic CSI-RS in a
<em>NZP-CSI-RS-ResourceSet</em> configured with the higher layer
parameter <em>repetition</em> set to 'off' or configured without the
higher layer parameters <em>repetition</em> and <em>trs-Info</em>
scheduled with offset larger than or equal to 48<span
class="math inline">\(\bullet 2^{{max(0,\ \mu}_{CSIRS} - 3)}\)</span>
when the UE provides <em>beamSwitchTiming-r16</em> and
<em>enableBeamSwitchTiming</em> is provided, aperiodic CSI-RS in a
<em>NZP-CSI-RS-ResourceSet</em> configured with the higher layer
parameter <em>repetition</em> set to 'on' scheduled with offset larger
than or equal to the UE reported threshold <em>beamSwitchTiming-r16</em>
and <em>enableBeamSwitchTiming</em> is provided;</p>
<p>- else if the UE is not provided <em>dl-OrJointTCI-StateList</em>,
and if at least one CORESET is configured for the BWP in which the
aperiodic CSI-RS is received, when receiving the aperiodic CSI-RS, the
UE applies the QCL assumption used for the CORESET associated with a
monitored search space with the lowest <em>controlResourceSetId</em> in
the latest slot in which one or more CORESETs within the active BWP of
the serving cell are monitored;</p>
<p>- else if the UE is provided <em>dl-OrJointTCI-StateList</em> and if
the indicated TCI state is associated with a PCI different from the
serving cell, regardless of configuration of
<em>followUnifiedTCI-State</em>, and if at least one CORESET is
configured for the BWP in which the aperiodic CSI-RS is received, when
receiving the aperiodic CSI-RS, the UE applies the QCL assumption used
for the CORESET associated with a monitored search space with the lowest
<em>controlResourceSetId</em> in the latest slot in which one or more
CORESETs within the active BWP of the serving cell are monitored. In the
CA case, if the 'QCL-TypeD' of the aperiodic CSI-RSs from respective CCs
in a band are different in a slot, the QCL-TypeD assumption of the
CSI-RS in the CC with lowest CC ID in the band is applied to all the
aperiodic CSI-RSs in the CCs in the band;</p>
<p>- else if the UE is provided <em>dl-OrJointTCI-StateList</em> and the
indicated TCI state is associated with the PCI of the serving cell,
regardless of configuration of <em>followUnifiedTCI-State</em>, the
indicated TCI state is applied to the aperiodic CSI-RS;</p>
<p>- else if the UE is configured with <em>enableDefaultBeamForCCS</em>
and when receiving the aperiodic CSI-RS, the UE applies the QCL
assumption of the lowest-ID activated TCI state applicable to the PDSCH
within the active BWP of the cell in which the CSI-RS is to be
received.</p>
<p>- If the scheduling offset between the last symbol of the PDCCH
carrying the triggering DCI and the first symbol of the aperiodic CSI-RS
resources in a <em>NZP-CSI-RS-ResourceSet</em> is equal to or greater
than the UE reported threshold <em>beamSwitchTiming</em> when the
reported value is one of the values of {14,28,48}<span
class="math inline">\(\bullet 2^{{max(0,\ \mu}_{CSIRS} - 3)}\)</span>
and <em>enableBeamSwitchTiming</em> is not provided and the
<em>NZP-CSI-RS-ResourceSet</em> is not configured with higher layer
parameter <em>trs-Info</em>, or is equal to or greater than the UE
reported threshold <em>beamSwitchTiming</em> when the reported value is
one of the values of {14,28,48}<span class="math inline">\(\bullet
2^{{max(0,\ \mu}_{CSIRS} - 3)}\)</span> and the
<em>NZP-CSI-RS-ResourceSet</em> is configured with higher layer
parameter <em>trs-Info</em>, or is equal to or greater than 48<span
class="math inline">\(\bullet 2^{{max(0,\ \mu}_{CSIRS} - 3)}\)</span>
when the UE provides <em>beamSwitchTiming-r16</em> and
<em>enableBeamSwitchTiming</em> is provided and the
<em>NZP-CSI-RS-ResourceSet</em> is configured with the higher layer
parameter <em>repetition</em> set to 'off' or configured without the
higher layer parameters <em>repetition</em> and <em>trs-Info</em>, or is
equal to or greater than the UE reported threshold
<em>beamSwitchTiming-r16,</em> when <em>enableBeamSwitchTiming</em> is
provided and the <em>NZP-CSI-RS-ResourceSet</em> is configured with the
higher layer parameter <em>repetition</em> set to 'on', the UE is
expected to apply the QCL assumptions in the indicated TCI states for
the aperiodic CSI-RS resources in the CSI triggering state indicated by
the CSI trigger field in DCI.</p>
<p>- The UE is not expected to receive aperiodic CSI-RS and
PDSCH/aperiodic CSI-RS associated with different values of
<em>coresetPoolIndex</em> in overlapped symbol(s). The UE is not
expected to receive aperiodic CSI-RS and semi-persistent/periodic CSI-RS
with different 'QCL-type D' in overlapped symbol(s).</p>
<p>- If <em>dl-OrJointTCI-StateList-r17</em> is provided, the UE may
assume that a CSI-RS resource in an aperiodic CSI-RS resource set
configured without <em>trs-Info</em> is quasi co-located with the RS(s)
in the indicated TCI state.</p>
<p>- A non-zero codepoint of the CSI request field in the DCI is mapped
to a CSI triggering state according to the order of the associated
positions of the up to <span class="math inline">\(2^{N_{TS}} -
1\)</span> trigger states in <em>CSI-AperiodicTriggerStateList</em> with
codepoint '1' mapped to the triggering state in the first position.</p>
<p>For a UE configured with the higher layer parameter
<em>CSI-AperiodicTriggerStateList</em>, if a Resource Setting linked to
a <em>CSI-ReportConfig</em> has multiple aperiodic resource sets, only
one of the aperiodic CSI-RS resource sets from the Resource Setting is
associated with the trigger state, and the UE is higher layer configured
per trigger state per Resource Setting to select the one CSI-IM/NZP
CSI-RS resource set from the Resource Setting.</p>
<p>When aperiodic CSI-RS is used with aperiodic reporting, the CSI-RS
offset is configured per resource set by the higher layer parameter
<em>aperiodicTriggeringOffset</em> or
<em>aperiodicTriggeringOffset-r16</em> or
<em>aperiodicTriggeringOffset-r17</em>. The CSI-RS triggering offset has
the values of {0, 1, 2, 3, 4, 5, 6, …, 15, 16, 24} slots for <span
class="math inline">\(\mu_{CSIRS} \leq 3\)</span> or {0, 4, 8, 12, …,
60, 64, 96} slots for <span class="math inline">\(\mu_{CSIRS} =
5\)</span> and <span class="math inline">\(\mu_{CSIRS} = 6\)</span>,
where <span class="math inline">\(\mu_{CSIRS}\)</span> is the subcarrier
spacing configurations for CSI-RS. If the UE is not configured with
<em>minimumSchedulingOffsetK0</em> for any DL BWP and
<em>minimumSchedulingOffsetK2</em> for any UL BWP and if all the
associated trigger states do not have the higher layer parameter
<em>qcl-Type</em> set to 'typeD' in the corresponding TCI states, the
CSI-RS triggering offset is fixed to zero. The aperiodic triggering
offset of the CSI-IM follows offset of the associated NZP CSI-RS for
channel measurement. The aperiodic CSI-RS is transmitted in a slot <img
src="media/image145.svg" />, <span class="math inline">\(K_{s} = n + X +
\left\lfloor \left(
\frac{N_{slot,offset,PDCCH}^{CA}}{2^{\mu_{offset,PDCCH}}} -
\frac{N_{slot,offset,CSIRS}^{CA}}{2^{\mu_{offset,CSIRS}}} \right)
\bullet 2^{\mu_{CSIRS}} \right\rfloor\)</span>, if UE is configured with
<em>ca-SlotOffset</em> for at least one of the triggered and triggering
cell, and in slot <img src="media/image146.svg" />, otherwise, and
where</p>
<p><em>- n</em> is the slot containing the triggering DCI, <em>X</em> is
the CSI-RS triggering offset according to the higher layer parameter
<em>aperiodicTriggeringOffset</em> or
<em>aperiodicTriggeringOffset-r16</em> or
<em>aperiodicTriggeringOffset-r17</em>,</p>
<p><em>-</em> <span class="math inline">\(N_{\text{slot, offset,
PDCCH}}^{\text{CA}}\ \)</span>and <span
class="math inline">\(\mu_{\text{offset,PDCCH}}\)</span> are the<span
class="math inline">\({\ N}_{\text{slot, offset}}^{\text{CA}}\)</span>
and the <img src="media/image15.svg" /> which are determined by
higher-layer configured <em>ca-SlotOffset</em> for the cell receiving
the PDCCH, <span class="math inline">\(N_{\text{slot, offset,
CSIRS}}^{\text{CA}}\ \)</span>and <span
class="math inline">\(\mu_{\text{offset,CSIRS}}\)</span> are the<span
class="math inline">\({\ N}_{\text{slot, offset}}^{\text{CA}}\)</span>
and the <img src="media/image15.svg" /> which are determined by
higher-layer configured <em>ca-SlotOffset</em> for the cell transmitting
the CSI-RS respectively, as defined in [4, TS 38.211] clause 4.5.</p>
<p>The UE does not expect that aperiodic CSI-RS is transmitted before
the OFDM symbol(s) carrying its triggering DCI. When the minimum
scheduling offset restriction is applied, UE is not expected to be
triggered by CSI triggering state indicated by the CSI request field in
DCI in which CSI-RS triggering offset is smaller than the currently
applicable minimum scheduling offset restriction
<em>K</em><sub>0min</sub>.</p>
<p>If interference measurement is performed on aperiodic NZP CSI-RS, a
UE is not expected to be configured with a different aperiodic
triggering offset of the NZP CSI-RS for interference measurement from
the associated NZP CSI-RS for channel measurement.</p>
<p>If the UE is configured with a single carrier for uplink, the UE is
not expected to transmit more than one aperiodic CSI report triggered by
different DCIs on overlapping OFDM symbols.</p>
<p>When the PDCCH reception includes two PDCCH candidates from two
respective search space sets, as described in clause 10.1 of [6, TS
38.213], for the purpose of determining scheduling offset between the
last symbol of the PDCCH carrying the triggering DCI and the first
symbol of the aperiodic CSI-RS resources, the PDCCH candidate that ends
later in time is used, and the UE does not expect that the aperiodic
CSI-RS is transmitted before the first symbol of the PDCCH candidate
that starts later in time.</p>
<h5
id="a-aperiodic-csi-reportingaperiodic-csi-rs-when-the-triggering-pdcch-and-the-csi-rs-have-different-numerologies">5.2.1.5.1a
Aperiodic CSI Reporting/Aperiodic CSI-RS when the triggering PDCCH and
the CSI-RS have different numerologies</h5>
<p>When the triggering PDCCH and the triggered aperiodic CSI-RS are of
different numerologies, the behavior defined in 5.2.1.5.1 for the case
where the numerologies are the same applies with the following
exceptions:</p>
<p>Beam switch timing:</p>
<p>- If the scheduling offset between the last symbol of the PDCCH
carrying the triggering DCI and the first symbol of the aperiodic CSI-RS
resources in a <em>NZP-CSI-RS-ResourceSet</em> configured without higher
layer parameter <em>trs-Info</em> is smaller than
<em>beamSwitchTiming</em> + <em>d</em> <span
class="math inline">\(\bullet 2^{\mu_{CSIRS}}/2^{\mu_{PDCCH}}\)</span>
in CSI-RS symbols<em>,</em> as defined in [13, TS 38.306], when the
reported value is one of the values of {14, 28, 48}<span
class="math inline">\(\bullet 2^{{max(0,\ \mu}_{CSIRS} - 3)}\)</span>
and <em>enableBeamSwitchTiming</em> is not provided, or is smaller than
48<span class="math inline">\(\bullet 2^{{max(0,\ \mu}_{CSIRS} -
3)}\)</span>+ <span class="math inline">\(d \bullet
2^{\mu_{CSIRS}}/2^{\mu_{PDCCH}}\)</span> in CSI-RS symbols when the UE
provides <em>beamSwitchTiming-r16</em> and
<em>enableBeamSwitchTiming</em> is provided and the
<em>NZP-CSI-RS-ResourceSet</em> is configured with the higher layer
parameter <em>repetition</em> set to 'off' or configured without the
higher layer parameter <em>repetition,</em> or is smaller than
<em>beamSwitchTiming-r16 +</em> <span class="math inline">\(d \bullet
2^{\mu_{CSIRS}}/2^{\mu_{PDCCH}}\)</span> in CSI-RS symbols<em>,</em>
when <em>enableBeamSwitchTiming</em> is provided and the
<em>NZP-CSI-RS-ResourceSet</em> is configured with the higher layer
parameter <em>repetition</em> set to 'on', where if the
µ<sub>PDCCH</sub> &lt; µ<sub>CSIRS,</sub> the beam switching timing
delay <em>d</em> is defined in Table 5.2.1.5.1a-1, else <em>d</em> is
zero</p>
<p>- if one of the associated trigger states has the higher layer
parameter <em>qcl-Type</em> set to 'typeD',</p>
<p>- if there is any other DL signal with an indicated TCI state in the
same symbols as the CSI-RS, the UE applies the QCL assumption of the
other DL signal also when receiving the aperiodic CSI-RS. The other DL
signal refers to PDSCH scheduled with offset larger than or equal to the
threshold <em>timeDurationForQCL,</em> as defined in [13, TS 38.306],
periodic CSI-RS, semi-persistent CSI-RS, aperiodic CSI-RS scheduled with
offset larger than or equal to <em>beamSwitchTiming</em> + <em>d</em>
<span class="math inline">\(\bullet
2^{\mu_{CSIRS}}/2^{\mu_{PDCCH}}\)</span> in CSI-RS symbols when the
reported value is one of the values {14,28,48}<span
class="math inline">\(\bullet 2^{{max(0,\ \mu}_{CSIRS} - 3)}\)</span>
and when <em>enableBeamSwitchTiming</em> is not provided or the
<em>NZP-CSI-RS-ResourceSet</em> is configured with the higher layer
parameter <em>trs-Info</em>, aperiodic CSI-RS in a
<em>NZP-CSI-RS-ResourceSet</em> configured with the higher layer
parameter <em>repetition</em> set to 'off' or configured without the
higher layer parameters <em>repetition</em> and <em>trs-Info</em>
scheduled with offset larger than or equal to 48<span
class="math inline">\(\bullet 2^{{max(0,\ \mu}_{CSIRS} - 3)}\)</span>+
<span class="math inline">\(d \bullet
2^{\mu_{CSIRS}}/2^{\mu_{PDCCH}}\)</span> in CSI-RS symbols when the UE
provides <em>beamSwitchTiming-r16</em> and
<em>enableBeamSwitchTiming</em> is provided, aperiodic CSI-RS in a
<em>NZP-CSI-RS-ResourceSet</em> configured with the higher layer
parameter <em>repetition</em> set to 'on' and scheduled with offset
larger than or equal to <em>beamSwitchTiming-r16</em> + <em>d</em> <span
class="math inline">\(\bullet 2^{\mu_{CSIRS}}/2^{\mu_{PDCCH}}\)</span>
in CSI-RS symbols when <em>enableBeamSwitchTiming</em> is provided;</p>
<p>- else,</p>
<p>- if at least one CORESET is configured for the BWP in which the
aperiodic CSI-RS is to be received, when receiving the aperiodic CSI-RS,
the UE applies the QCL assumption used for the CORESET associated with a
monitored search space with the lowest <em>controlResourceSetId</em> in
the latest slot in which one or more CORESETs within the active BWP of
the serving cell are monitored.</p>
<p>- else if the UE is configured with <em>enableDefaultBeamForCCS</em>,
when receiving the aperiodic CSI-RS, the UE applies the QCL assumption
of the lowest-ID activated TCI state applicable to the PDSCH within the
active BWP of the cell in which the CSI-RS is to be received.</p>
<p>- If the scheduling offset between the last symbol of the PDCCH
carrying the triggering DCI and the first symbol of the aperiodic CSI-RS
resources in a <em>NZP-CSI-RS-ResourceSet</em> is equal to or greater
than <em>beamSwitchTiming</em> + <em>d</em> <span
class="math inline">\(\bullet 2^{\mu_{CSIRS}}/2^{\mu_{PDCCH}}\)</span>
in CSI-RS symbols, when the reported value is one of the values of
{14,28,48}<span class="math inline">\(\bullet 2^{{max(0,\ \mu}_{CSIRS} -
3)}\)</span> and <em>enableBeamSwitchTiming</em> is not provided and the
<em>NZP-CSI-RS-ResourceSet</em> is not configured with higher layer
parameter <em>trs-Info</em>, or is equal to or greater than
<em>beamSwitchTiming</em> + <em>d</em> <span
class="math inline">\(\bullet 2^{\mu_{CSIRS}}/2^{\mu_{PDCCH}}\)</span>
in CSI-RS symbols when the reported value is one of the values of
{14,28,48}<span class="math inline">\(\bullet 2^{{max(0,\ \mu}_{CSIRS} -
3)}\)</span> and the <em>NZP-CSI-RS-ResourceSet</em> is configured with
higher layer parameter <em>trs-Info</em>, or is equal to or greater than
48<span class="math inline">\(\bullet 2^{{max(0,\ \mu}_{CSIRS} -
3)}\)</span>+<span class="math inline">\(d \bullet
2^{\mu_{CSIRS}}/2^{\mu_{PDCCH}}\)</span> in CSI-RS symbols when the UE
provides <em>beamSwitchTiming-r16</em> and
<em>enableBeamSwitchTiming</em> is provided and the
<em>NZP-CSI-RS-ResourceSet</em> is configured with the higher layer
parameter <em>repetition</em> set to 'off' or configured without the
higher layer parameters <em>repetition</em> and <em>trs-Info</em>, or is
equal to or greater than <em>beamSwitchTiming-r16</em> + <em>d</em>
<span class="math inline">\(2^{\mu_{CSIRS}}/2^{\mu_{PDCCH}}\)</span> in
CSI-RS symbols when <em>enableBeamSwitchTiming</em> is provided and the
<em>NZP-CSI-RS-ResourceSet</em> is configured with the higher layer
parameter <em>repetition</em> set to 'on', where if the
µ<sub>PDCCH</sub> &lt; µ<sub>CSIRS,</sub> the beam switching timing
delay <em>d</em> is defined in Table 5.2.1.5.1a-1, else <em>d</em> is
zero, the UE is expected to apply the QCL assumptions in the indicated
TCI states for the aperiodic CSI-RS resources in the CSI triggering
state indicated by the CSI trigger field in DCI. For
<em><strong>µ<sub>PDCCH</sub></strong></em> = 5, UE shall report one of
values of {56, 112} for additional beam switching time delay
<em>d</em>.</p>
<p>Table 5.2.1.5.1a-1: Additional beam switching timing delay
<em>d</em></p>
<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr>
<th><em><strong>µ<sub>PDCCH</sub></strong></em></th>
<th><strong><em>d</em> [PDCCH symbols]</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>8</td>
</tr>
<tr>
<td>1</td>
<td>8</td>
</tr>
<tr>
<td>2</td>
<td>14</td>
</tr>
<tr>
<td>3</td>
<td>28</td>
</tr>
<tr>
<td>5</td>
<td>{56, 112}</td>
</tr>
</tbody>
</table>
<p>Aperiodic CSI-RS timing:</p>
<p>- When the aperiodic CSI-RS is used with aperiodic CSI reporting, the
CSI-RS triggering offset <em>X</em> is configured per resource set by
the higher layer parameter <em>aperiodicTriggeringOffset</em> or
<em>aperiodicTriggeringOffset-r16</em> or
<em>aperiodicTriggeringOffset-r17,</em> including the case that the UE
is not configured with <em>minimumSchedulingOffsetK0</em> for any DL BWP
or <em>minimumSchedulingOffsetK2</em> for any UL BWP and all the
associated trigger states do not have the higher layer parameter
<em>qcl-Type</em> set to 'typeD' in the corresponding TCI states. The
CSI-RS triggering offset has the values of {0, 1, …, 31} slots for <span
class="math inline">\(\mu_{CSIRS} \leq 3\)</span> or {0, 4, 8, …, 124}
slots for <span class="math inline">\(\mu_{CSIRS} = 5\)</span> and <span
class="math inline">\(\mu_{CSIRS} = 6\)</span> when the
µ<sub>PDCCH</sub> &lt; µ<sub>CSIRS</sub> and {0, 1, 2, 3, 4, 5, 6, …,
15, 16, 24} for <span class="math inline">\(\mu_{CSIRS} \leq 3\)</span>
or {0, 4, 8, 12, …, 60, 64, 96} slots for <span
class="math inline">\(\mu_{CSIRS} = 5\)</span> and <span
class="math inline">\(\mu_{CSIRS} = 6\)</span> when the
µ<sub>PDCCH</sub> &gt; µ<sub>CSIRS</sub>.. The aperiodic CSI-RS is
transmitted in a slot <img src="media/image147.svg" />, if UE is
configured with <em>ca-SlotOffset</em> for at least one of the triggered
and triggering cell, and <em>K<sub>s </sub></em>= <img
src="media/image148.svg" style="width:1in;height:0.51458in" />,
otherwise, and where</p>
<p><em>- n</em> is the slot containing the triggering DCI, <em>X</em> is
the CSI-RS triggering offset in the numerology of CSI-RS according to
the higher layer parameter <em>aperiodicTriggeringOffset</em> or
<em>aperiodicTriggeringOffset-r16</em> or
<em>aperiodicTriggeringOffset-r17</em>,</p>
<p>- <span class="math inline">\(\mu_{CSIRS}\)</span> and <span
class="math inline">\(\mu_{PDCCH}\)</span> are the subcarrier spacing
configurations for CSI-RS and PDCCH, respectively,</p>
<p>- <span class="math inline">\(N_{\text{slot, offset,
PDCCH}}^{\text{CA}}\)</span> and <span
class="math inline">\(\mu_{\text{offset,PDCCH}}\)</span>are the<span
class="math inline">\({\ N}_{\text{slot,
offset}}^{\text{CA}}\)</span> and the<img src="media/image15.svg" />,
respectively, which are determined by higher-layer configured
<em>ca-SlotOffset</em> for the cell receiving the PDCCH
respectively, <span class="math inline">\(N_{\text{slot, offset,
CSIRS}}^{\text{CA}}\ \)</span>and  <span
class="math inline">\(\mu_{\text{offset,CSIRS}}\)</span> are the<span
class="math inline">\({\ N}_{\text{slot,
offset}}^{\text{CA}}\)</span> and the<img src="media/image15.svg" />,
respectively, which are determined by higher-layer configured
<em>ca-SlotOffset</em> for the cell transmitting the CSI-RS
respectively, as defined in [4, TS 38.211] clause 4.5</p>
<p>- If the µ<sub>PDCCH</sub> &lt; µ<sub>CSIRS</sub>, the UE is expected
to be able to measure the aperiodic CSI RS, if the CSI-RS starts no
earlier than the first symbol of the CSI-RS carrier's slot that starts
at least <em>Ncsirs</em> PDCCH symbols after the end of the PDCCH
triggering the aperiodic CSI-RS.</p>
<p>- If the µ<sub>PDCCH</sub> &gt; µ<sub>CSIRS</sub>, the UE is expected
to be able to measure the aperiodic CSI RS, if the CSI-RS starts no
earlier than at least <em>Ncsirs</em> PDCCH symbols after the end of the
PDCCH triggering the aperiodic CSI-RS.</p>
<p>When the PDCCH reception includes two PDCCH candidates from two
respective search space sets, as described in clause 10.1 of [6, TS
38.213], for the purpose of determining <em>Ncsirs</em>, the PDCCH
candidate that ends later in time is used.</p>
<p>Table 5.2.1.5.1a: <em>N<sub>csirs</sub></em> as a function of the
subcarrier spacing of the triggering PDCCH</p>
<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr>
<th><em><strong>µ<sub>PDCCH</sub></strong></em></th>
<th><strong><em>N<sub>csirs</sub></em> [symbols]</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>4</td>
</tr>
<tr>
<td>1</td>
<td>5</td>
</tr>
<tr>
<td>2</td>
<td>10</td>
</tr>
<tr>
<td>3</td>
<td>14</td>
</tr>
<tr>
<td style="text-align: center;">5</td>
<td style="text-align: center;">56</td>
</tr>
<tr>
<td style="text-align: center;">6</td>
<td style="text-align: center;">112</td>
</tr>
</tbody>
</table>
<p>When the triggering PDCCH and the triggered aperiodic CSI-RS are of
different numerologies, the CSI request constraint and CSI reporting
constraint defined in 5.2.1.5.1 for the case where the numerologies are
the same applies with the following additions:</p>
<p>- CSI request constraints:</p>
<p>- A UE is not expected to receive more than one CSI request per
reference slot length across all CCs in a cell group, where the SCS of
the reference slot is the minimum of SCS of the PDCCH with which the DCI
was transmitted, the SCS of the PUSCH with which the CSI report is to be
transmitted, and the SCS of the minimum SCS of the CSI-RS associated to
the CSI reports triggered by the DCI. The beginning of a slot length is
defined according the PDCCH cell with which the DCI carrying the CSI
request is transmitted.</p>
<p>- CSI reporting constraints:</p>
<p>- A UE is not expected to receive more than one CSI request for
transmission in a given reference slot length across all CCs in a cell
group, where the SCS of the reference slot is the minimum of SCS of the
PDCCH with which the DCI was transmitted, the SCS of the PUSCH with
which the CSI report is to be transmitted, and the SCS of the minimum
SCS of the CSI-RS associated to the CSI reports triggered by the DCI.
The beginning of a slot length is defined according the PUSCH cell with
which the CSI report is transmitted.</p>
<h5 id="semi-persistent-csisemi-persistent-csi-rs">5.2.1.5.2
Semi-persistent CSI/Semi-persistent CSI-RS</h5>
<p>For semi-persistent reporting on PUSCH, a set of trigger states are
higher layer configured by
<em>CSI-SemiPersistentOnPUSCH-TriggerStateList,</em> where the CSI
request field in DCI scrambled with SP-CSI-RNTI activates one of the
trigger states. A UE is not expected to receive a DCI scrambled with
SP-CSI-RNTI activating one semi-persistent CSI report with the same
<em>CSI-ReportConfigId</em> as in a semi-persistent CSI report which is
activated by a previously received DCI scrambled with SP-CSI-RNTI.</p>
<p>For semi-persistent reporting on PUCCH, the PUCCH resource used for
transmitting the CSI report are configured by <em>reportConfigType</em>.
Semi-persistent reporting on PUCCH is activated by an activation command
as described in clause 6.1.3.16 of [10, TS 38.321], which selects one of
the semi-persistent Reporting Settings for use by the UE on the PUCCH.
When the UE would transmit a PUCCH with HARQ-ACK information in slot
<em>n</em> corresponding to the PDSCH carrying the activation command,
the indicated semi-persistent Reporting Setting should be applied
starting from the first slot that is after slot <span
class="math inline">\(n + {3N}_{slot}^{subframe,µ}\)</span> where
<em>μ</em> is the SCS configuration for the PUCCH.</p>
<p>For a UE configured with CSI resource setting(s) where the higher
layer parameter <em>resourceType</em> set to 'semiPersistent'.</p>
<p>- when a UE receives an activation command, as described in clause
6.1.3.12 of [10, TS 38.321], for CSI-RS resource set(s) for channel
measurement and CSI-IM/NZP CSI-RS resource set(s) for interference
measurement associated with configured CSI resource setting(s), and when
the UE would transmit a PUCCH with HARQ-ACK information in slot
<em>n</em> corresponding to the PDSCH carrying the selection command,
the corresponding actions in [10, TS 38.321] and the UE assumptions
(including QCL assumptions provided by a list of reference to
<em>TCI-State's,</em> one per activated resource) on CSI-RS/CSI-IM
transmission corresponding to the configured CSI-RS/CSI-IM resource
configuration(s) shall be applied starting from the first slot that is
after slot <span class="math inline">\(n + {3N}_{slot}^{subframe,µ} +
{\frac{2^{\mu}}{2^{\mu_{K_{mac}}}} \bullet k}_{mac}\)</span> where
<em>μ</em> is the SCS configuration for the PUCCH and <span
class="math inline">\(\mu_{K_{mac}}\ \)</span>is the subcarrier spacing
configuration for <span class="math inline">\(k_{mac}\)</span> with a
value of 0 for frequency range 1, and <span
class="math inline">\(k_{mac}\)</span> is provided by <em>K-Mac</em> or
<span class="math inline">\(k_{mac} = 0\)</span> if <em>K-Mac</em> is
not provided. If a <em>TCI-State</em> referred to in the list is
configured with a reference to an RS configured with <em>qcl-Type</em>
set to '<em>typeD</em>', that RS can be an SS/PBCH block, periodic or
semi-persistent CSI-RS located in same or different CC/DL BWP.</p>
<p>- when a UE receives a deactivation command, as described in clause
6.1.3.12 of [10, TS 38.321], for activated CSI-RS/CSI-IM resource set(s)
associated with configured CSI resource setting(s), and when the UE
would transmit a PUCCH with HARQ-ACK information in slot <em>n</em>
corresponding to the PDSCH carrying the deactivation command, the
corresponding actions in [10, TS 38.321] and UE assumption on cessation
of CSI-RS/CSI-IM transmission corresponding to the deactivated
CSI-RS/CSI-IM resource set(s) shall apply starting from the first slot
that is after slot <span class="math inline">\(n +
{3N}_{slot}^{subframe,µ} + {\frac{2^{\mu}}{2^{\mu_{K_{mac}}}} \bullet
k}_{mac}\)</span> where <em>μ</em> is the SCS configuration for the
PUCCH and <span class="math inline">\(\mu_{K_{mac}}\ \)</span>is the
subcarrier spacing configuration for <span
class="math inline">\(k_{mac}\)</span> with a value of 0 for frequency
range 1, and <span class="math inline">\(k_{mac}\)</span> is provided by
<em>K-Mac</em> or <span class="math inline">\(k_{mac} = 0\)</span> if
<em>K-Mac</em> is not provided.</p>
<p>A codepoint of the CSI request field in the DCI is mapped to a SP-CSI
triggering state according to the order of the positions of the
configured trigger states in
<em>CSI-SemiPersistentOnPUSCH-TriggerStateList</em>, with codepoint '0'
mapped to the triggering state in the first position. A UE validates,
for semi-persistent CSI activation or release, a PDCCH on a DCI only if
the following conditions are met:</p>
<p>- the CRC parity bits of the DCI format are scrambled with a
SP-CSI-RNTI provided by higher layer parameter <em>sp-CSI-RNTI</em></p>
<p>- Special fields for the DCI format are set according to Table
5.2.1.5.2-1 or Table 5.2.1.5.2-2.</p>
<p>If validation is achieved, the UE considers the information in the
DCI format as a valid activation or valid release of semi-persistent CSI
transmission on PUSCH, and the UE activates or deactivates a CSI
Reporting Setting indicated by CSI request field in the DCI. If
validation is not achieved, the UE considers the DCI format as having
been detected with a non-matching CRC.</p>
<p>Table 5.2.1.5.2-1: Special fields for semi-persistent CSI activation
PDCCH validation</p>
<table>
<colgroup>
<col style="width: 51%" />
<col style="width: 48%" />
</colgroup>
<tbody>
<tr>
<td></td>
<td>DCI format 0_1/0_2</td>
</tr>
<tr>
<td style="text-align: center;"><p>HARQ process number</p>
<p>(if present)</p></td>
<td>set to all '0's</td>
</tr>
<tr>
<td style="text-align: center;"><p>Redundancy version</p>
<p>(if present)</p></td>
<td>set to all '0's</td>
</tr>
</tbody>
</table>
<p>Table 5.2.1.5.2-2: Special fields for semi-persistent CSI
deactivation PDCCH validation</p>
<table>
<colgroup>
<col style="width: 31%" />
<col style="width: 68%" />
</colgroup>
<tbody>
<tr>
<td></td>
<td>DCI format 0_1/0_2</td>
</tr>
<tr>
<td style="text-align: center;"><p>HARQ process number</p>
<p>(if present)</p></td>
<td>set to all '0's</td>
</tr>
<tr>
<td>Modulation and coding scheme</td>
<td>set to all '1's</td>
</tr>
<tr>
<td>Resource block assignment</td>
<td><p>If higher layer configures RA type 0 only, set to all '0's;</p>
<p>If higher layer configures RA type 1 only, set to all '1's;</p>
<p>If higher layer configures dynamic switch between RA type 0 and 1,
then if MSB is'0', set to all '0's; else, set to all '1's</p>
<p>For DCI 0_1, if higher layer configures RA type 2, set to all '1's if
<em>µ</em> = 0; set to all '0's if <em>µ</em> = 1</p></td>
</tr>
<tr>
<td style="text-align: center;"><p>Redundancy version</p>
<p>(if present)</p></td>
<td>set to all '0's</td>
</tr>
</tbody>
</table>
<p>If the UE has an active semi-persistent CSI-RS/CSI-IM resource
configuration, or an active semi-persistent ZP CSI-RS resource set
configuration, and has not received a deactivation command, the
activated semi-persistent CSI-RS/CSI-IM resource set or the activated
semi-persistent ZP CSI-RS resource set configurations are considered to
be active when the corresponding DL BWP is active, otherwise they are
considered suspended.</p>
<p>If the UE is configured with carrier deactivation, the following
configurations in the carrier in activated state would also be
deactivated and need re-activation configuration(s): semi-persistent
CSI-RS/CSI- IM resource, semi-persistent CSI reporting on PUCCH,
semi-persistent SRS, semi-persistent ZP CSI-RS resource set.</p>
<h5
id="aperiodic-csi-rs-for-tracking-for-fast-scell-activation-1">5.2.1.5.3
Aperiodic CSI-RS for tracking for fast SCell activation</h5>
<p>When the UE receives an <em>Enhanced Scell
Activation/Deactivation</em> MAC-CE that triggers one or two CSI-RS
bursts for fast SCell activation for a (set of) deactivated
SCell(s),</p>
<p>- if the MAC-CE indicates that the first CSI-RS burst for SCell
activation is present in an SCell, then the UE may assume that the first
CSI-RS burst for SCell activation is present in that SCell. The first
slot of the first CSI-RS burst starts at the
<em>m<sub>1</sub></em><sup>th</sup> SCell slot after the last SCell slot
coinciding with the reference slot <em>n+k</em>, as defined in clause
4.3 of [6, TS38.213].</p>
<p>- if the MAC-CE indicates that the second CSI-RS burst for SCell
activation is present in an SCell, then the UE may assume that the
second CSI-RS burst for SCell activation is present in that SCell. The
first slot of the second CSI-RS burst starts at the
<em>m<sub>2</sub></em><sup>th</sup> SCell slot after the end of the
first CSI-RS burst. The CSI-RS of the second burst shall have the same
antenna port index, OFDM symbol allocations in a slot, same PRB
allocation location as the CSI-RS of the first burst.</p>
<p>- where the CSI-RS burst is defined as four CSI-RS resources in two
consecutive slots in clause 5.1.6.1.1.1, and <em>m<sub>1</sub></em> and
<em>m<sub>2</sub></em> are provided by
<em>aperiodicTriggeringOffsetL2</em> in <em>NZP-CSI-RS-ResourceSet</em>
and <em>gapBetweenBursts</em>, respectively, associated with the CSI-RS
burst(s) triggered by the MAC-CE.</p>
<h4 id="csi-processing-criteria">5.2.1.6 CSI processing criteria</h4>
<p>The UE indicates the number of supported simultaneous CSI
calculations <span class="math inline">\(N_{CPU}\)</span> with parameter
<em>simultaneousCSI-ReportsPerCC</em> in a component carrier, and
<em>simultaneousCSI-ReportsAllCC</em> across all component carriers. If
a UE supports <span class="math inline">\(N_{CPU}\)</span> simultaneous
CSI calculations it is said to have <span
class="math inline">\(N_{CPU}\)</span> CSI processing units for
processing CSI reports. If <em>L</em> CPUs are occupied for calculation
of CSI reports in a given OFDM symbol, the UE has <span
class="math inline">\(N_{CPU} - L\)</span> unoccupied CPUs. If
<em>N</em> CSI reports start occupying their respective CPUs on the same
OFDM symbol on which <span class="math inline">\(N_{CPU} - L\)</span>
CPUs are unoccupied, where each CSI report <span class="math inline">\(n
= 0,\ \ldots,\ N - 1\)</span> corresponds to <span
class="math inline">\(O_{CPU}^{(n)}\)</span>, the UE is not required to
update the <span class="math inline">\(N - M\)</span> requested CSI
reports with lowest priority (according to Clause 5.2.5), where <span
class="math inline">\(0 \leq M \leq N\ \)</span>is the largest value
such that <span class="math inline">\(\sum_{n = 0}^{M - 1}O_{CPU}^{(n)}
\leq N_{CPU} - L\ \)</span> holds.</p>
<p>A UE is not expected to be configured with an aperiodic CSI trigger
state containing more than <span class="math inline">\(N_{CPU}\)</span>
Reporting Settings. Processing of a CSI report occupies a number of CPUs
for a number of symbols as follows:</p>
<p>- <span class="math inline">\(O_{CPU} = 0\ \ \)</span>for a CSI
report with CSI-ReportConfig with higher layer parameter
<em>reportQuantity</em> set to 'none' and <em>CSI-RS-ResourceSet</em>
with higher layer parameter <em>trs-Info</em> configured</p>
<p>- <span class="math inline">\(O_{CPU} = 1\ \)</span> for a CSI report
with <em>CSI-ReportConfig</em> with higher layer parameter
<em>reportQuantity</em> set to 'cri-RSRP', 'ssb-Index-RSRP', 'cri-SINR',
'ssb-Index-SINR', 'cri-RSRP- Index', 'ssb-Index-RSRP- Index', 'cri-SINR-
Index', 'ssb-Index-SINR- Index ' or 'none' (and
<em>CSI-RS-ResourceSet</em> with higher layer parameter
<em>trs-Info</em> not configured)</p>
<p>- for a CSI report with <em>CSI-ReportConfig</em> with higher layer
parameter <em>reportQuantity</em> set to 'cri-RI-PMI-CQI', 'cri-RI-i1',
'cri-RI-i1-CQI', 'cri-RI-CQI', or 'cri-RI-LI-PMI-CQI',</p>
<p>- if max{ <em>µ<sub>PDCCH</sub></em>, <em>µ<sub>CSI-RS</sub>,
µ<sub>UL</sub></em>} ≤ 3, and if a CSI report is aperiodically triggered
without transmitting a PUSCH with either transport block or HARQ-ACK or
both when <em>L</em> = 0 CPUs are occupied, where the CSI corresponds to
a single CSI with wideband frequency-granularity and to at most 4 CSI-RS
ports in a single resource without CRI report and where
<em>codebookType</em> is set to 'typeI-SinglePanel' or where
<em>reportQuantity</em> is set to 'cri-RI-CQI', <span
class="math inline">\(O_{CPU} = N_{CPU}\)</span><span
class="math inline">\(O_{CPU} = N_{CPU}\)</span>,</p>
<p>- If a <em>CSI-ReportConfig</em> is configured with
<em>codebookType</em> set to 'typeI-SinglePanel' and the corresponding
CSI-RS Resource Set for channel measurement is configured with two
Resource Groups and <span class="math inline">\(N\)</span> Resource
Pairs, <span class="math inline">\(O_{CPU} = X \cdot N + M\)</span>,
where <span class="math inline">\(X\)</span> is the number of CPUs
occupied by a pair of CMRs subject to <em>mTRP-CSI-numCPU-r17</em> and
<span class="math inline">\(M\)</span> is defined in clause
5.2.1.4.2.</p>
<p>- otherwise, <span class="math inline">\(O_{CPU} =
K_{s}\)</span><span class="math inline">\(O_{CPU} = K_{S}\)</span>,
where <span class="math inline">\(K_{s}\ \)</span><span
class="math inline">\(K_{s}\ \)</span>is the number of CSI-RS resources
in the CSI-RS resource set for channel measurement.</p>
<p>For a CSI report with <em>CSI-ReportConfig</em> with higher layer
parameter <em>reportQuantity</em> not set to 'none', the CPU(s) are
occupied for a number of OFDM symbols as follows:</p>
<p>- A periodic or semi-persistent CSI report (excluding an initial
semi-persistent CSI report on PUSCH after the PDCCH triggering the
report) occupies CPU(s) from the first symbol of the earliest one of
each CSI-RS/CSI-IM/SSB resource for channel or interference measurement,
respective latest CSI-RS/CSI-IM/SSB occasion no later than the
corresponding CSI reference resource, until the last symbol of the
configured PUSCH/PUCCH carrying the report.</p>
<p>- An aperiodic CSI report occupies CPU(s) from the first symbol after
the PDCCH triggering the CSI report until the last symbol of the
scheduled PUSCH carrying the report. When the PDCCH reception includes
two PDCCH candidates from two respective search space sets, as described
in clause 10.1 of [6, TS 38.213], for the purpose of determining the CPU
occupation duration, the PDCCH candidate that ends later in time is
used.</p>
<p>- An initial semi-persistent CSI report on PUSCH after the PDCCH
trigger occupies CPU(s) from the first symbol after the PDCCH until the
last symbol of the scheduled PUSCH carrying the report. When the PDCCH
reception includes two PDCCH candidates from two respective search space
sets, as described in clause 10.1 of [6, TS 38.213], for the purpose of
determining the CPU occupation duration, the PDCCH candidate that ends
later in time is used.</p>
<p>For a CSI report with <em>CSI-ReportConfig</em> with higher layer
parameter <em>reportQuantity</em> set to 'none' and
<em>CSI-RS-ResourceSet</em> with higher layer parameter
<em>trs-Info</em> not configured, the CPU(s) are occupied for a number
of OFDM symbols as follows:</p>
<p>- A semi-persistent CSI report (excluding an initial semi-persistent
CSI report on PUSCH after the PDCCH triggering the report) occupies
CPU(s) from the first symbol of the earliest one of each transmission
occasion of periodic or semi-persistent CSI-RS/SSB resource for channel
measurement for L1-RSRP computation, until <span
class="math inline">\(Z_{3}&#39;\)</span> symbols after the last symbol
of the latest one of the CSI-RS/SSB resource for channel measurement for
L1-RSRP computation in each transmission occasion.</p>
<p>- An aperiodic CSI report occupies CPU(s) from the first symbol after
the PDCCH triggering the CSI report until the last symbol between <span
class="math inline">\(Z_{3}\)</span> symbols after the first symbol
after the PDCCH triggering the CSI report and <span
class="math inline">\(Z_{3}&#39;\)</span> symbols after the last symbol
of the latest one of each CSI-RS/SSB resource for channel measurement
for L1-RSRP computation.</p>
<p>where <span class="math inline">\((Z_{3},Z_{3}&#39;)\)</span> are
defined in the table 5.4-2.</p>
<p>In any slot, the UE is not expected to have more active CSI-RS ports
or active CSI-RS resources in active BWPs than reported as capability.
NZP CSI-RS resource is active in a duration of time defined as follows.
For aperiodic CSI-RS, starting from the end of the PDCCH containing the
request and ending at the end of the scheduled PUSCH containing the
report associated with this aperiodic CSI-RS. When the PDCCH candidates
are associated with a search space set configured with
<em>searchSpaceLinkingId</em>, for the purpose of determining the NZP
CSI-RS resource active duration, the PDCCH candidate that ends later in
time among the two linked PDCCH candidates is used. For semi-persistent
CSI-RS, starting from the end of when the activation command is applied,
and ending at the end of when the deactivation command is applied. For
periodic CSI-RS, starting when the periodic CSI-RS is configured by
higher layer signalling, and ending when the periodic CSI-RS
configuration is released. If a CSI-RS resource is referred <em>N</em>
times by one or more CSI Reporting Settings, the CSI-RS resource and the
CSI-RS ports within the CSI-RS resource are counted <em>N</em> times.
For a CSI-RS Resource Set for channel measurement configured with two
Resource Groups and <span class="math inline">\(N\)</span> Resource
Pairs, if a CSI-RS resource is referred <span
class="math inline">\(X\)</span> times by one of the <span
class="math inline">\(M\)</span> CSI-RS resources, where <span
class="math inline">\(M\)</span> is defined in clause 5.2.1.4.2, and/or
one or two Resource Pairs, the CSI-RS resource and the CSI-RS ports
within the CSI-RS resource are counted <span
class="math inline">\(X\)</span> times.</p>
<h3 id="channel-state-information">5.2.2 Channel state information</h3>
<h4 id="channel-quality-indicator-cqi">5.2.2.1 Channel quality indicator
(CQI) </h4>
<p>The CQI indices and their interpretations are given in Table
5.2.2.1-2 or Table 5.2.2.1-4 for reporting CQI based on QPSK, 16QAM and
64QAM. The CQI indices and their interpretations are given in Table
5.2.2.1-3 for reporting CQI based on QPSK, 16QAM, 64QAM and 256QAM. The
CQI indices and their interpretations are given in Table 5.2.2.1-5 for
reporting CQI based on QPSK, 16QAM, 64QAM, 256QAM and 1024 QAM.</p>
<p>Based on an unrestricted observation interval in time unless
specified otherwise in this Clause, and an unrestricted observation
interval in frequency, the UE shall derive for each CQI value reported
in uplink slot <em>n</em> the highest CQI index which satisfies the
following condition:</p>
<p>- A single PDSCH transport block with a combination of modulation
scheme, target code rate and transport block size corresponding to the
CQI index, and occupying a group of downlink physical resource blocks
termed the CSI reference resource, could be received with a transport
block error probability not exceeding:</p>
<p>- 0.1, if the higher layer parameter <em>cqi-Table</em> in
<em>CSI-ReportConfig</em> configures 'table1' (corresponding to Table
5.2.2.1-2), or 'table2' (corresponding to Table 5.2.2.1-3), or if the
higher layer parameter <em>cqi-Table</em> in <em>CSI-ReportConfig</em>
configures 'table4-r17' (corresponding to Table 5.2.2.1-5), or</p>
<p>- 0.00001, if the higher layer parameter <em>cqi-Table</em> in
<em>CSI-ReportConfig</em> configures 'table3' (corresponding to Table
5.2.2.1-4).</p>
<p>If the higher layer parameter
<em>timeRestrictionForChannelMeasurements</em> is set to
"<em>notConfigured</em>", the UE shall derive the channel measurements
for computing CSI value reported in uplink slot <em>n</em> based on only
the NZP CSI-RS, no later than the CSI reference resource, (defined in TS
38.211[4]) associated with the CSI resource setting.</p>
<p>If the higher layer parameter
<em>timeRestrictionForChannelMeasurements</em> in
<em>CSI-ReportConfig</em> is set to "<em>Configured</em>", the UE shall
derive the channel measurements for computing CSI reported in uplink
slot <em>n</em> based on only the most recent, no later than the CSI
reference resource, occasion of NZP CSI-RS (defined in [4, TS 38.211])
associated with the CSI resource setting.</p>
<p>If the higher layer parameter
<em>timeRestrictionForInterferenceMeasurements</em> is set to
"<em>notConfigured</em>", the UE shall derive the interference
measurements for computing CSI value reported in uplink slot <em>n</em>
based on only the CSI-IM and/or NZP CSI-RS for interference measurement
no later than the CSI reference resource associated with the CSI
resource setting.</p>
<p>If the higher layer parameter
<em>timeRestrictionForInterferenceMeasurements</em> in
<em>CSI-ReportConfig</em> is set to "<em>Configured</em>", the UE shall
derive the interference measurements for computing the CSI value
reported in uplink slot <em>n</em> based on the most recent, no later
than the CSI reference resource, occasion of CSI-IM and/or NZP CSI-RS
for interference measurement (defined in [4, TS 38.211]) associated with
the CSI resource setting.</p>
<p>If the higher layer parameter <em>cqi-BitsPerSubband</em> in
<em>CSI-ReportConfig</em> is not configured, for each sub-band index
<em>s,</em> a 2-bit sub-band differential CQI is defined as:</p>
<p>- Sub-band Offset level (<em>s</em>) = sub-band CQI index
(<em>s</em>) - wideband CQI index.</p>
<p>The mapping from the 2-bit sub-band differential CQI values to the
offset level is shown in Table 5.2.2.1-1</p>
<p>Table 5.2.2.1-1: Mapping sub-band differential CQI value to offset
level</p>
<table>
<colgroup>
<col style="width: 51%" />
<col style="width: 48%" />
</colgroup>
<thead>
<tr>
<th>Sub-band differential CQI value</th>
<th>Offset level</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>2</td>
<td>≥ 2</td>
</tr>
<tr>
<td>3</td>
<td>≤-1</td>
</tr>
</tbody>
</table>
<p>If the higher layer parameter <em>cqi-BitsPerSubband</em> in
<em>CSI-ReportConfig</em> is configured, for each sub-band index
<em>s</em>, a 4-bit sub-band CQI is reported<em>.</em> The 4-bit
sub-band CQI for each sub-band <em>s</em> is a CQI index in Table
5.2.2.1-2, Table 5.2.2.1-3, or Table 5.2.2.1-4 as configured by the
higher layer parameter <em>cqi-Table</em> in
<em>CSI-ReportConfig</em>.</p>
<p>A combination of modulation scheme and transport block size
corresponds to a CQI index if:</p>
<p>- the combination could be signaled for transmission on the PDSCH in
the CSI reference resource according to the Transport Block Size
determination described in Clause 5.1.3.2, and</p>
<p>- the modulation scheme is indicated by the CQI index, and</p>
<p>- the combination of transport block size and modulation scheme when
applied to the reference resource results in the effective channel code
rate which is the closest possible to the code rate indicated by the CQI
index. If more than one combination of transport block size and
modulation scheme results in an effective channel code rate equally
close to the code rate indicated by the CQI index, only the combination
with the smallest of such transport block sizes is relevant.</p>
<p>Table 5.2.2.1-2: 4-bit CQI Table</p>
<table>
<colgroup>
<col style="width: 21%" />
<col style="width: 25%" />
<col style="width: 32%" />
<col style="width: 20%" />
</colgroup>
<tbody>
<tr>
<td>CQI index</td>
<td>modulation</td>
<td>code rate x 1024</td>
<td>efficiency</td>
</tr>
<tr>
<td>0</td>
<td colspan="3">out of range</td>
</tr>
<tr>
<td>1</td>
<td>QPSK</td>
<td>78</td>
<td>0.1523</td>
</tr>
<tr>
<td>2</td>
<td>QPSK</td>
<td>120</td>
<td>0.2344</td>
</tr>
<tr>
<td>3</td>
<td>QPSK</td>
<td>193</td>
<td>0.3770</td>
</tr>
<tr>
<td>4</td>
<td>QPSK</td>
<td>308</td>
<td>0.6016</td>
</tr>
<tr>
<td>5</td>
<td>QPSK</td>
<td>449</td>
<td>0.8770</td>
</tr>
<tr>
<td>6</td>
<td>QPSK</td>
<td>602</td>
<td>1.1758</td>
</tr>
<tr>
<td>7</td>
<td>16QAM</td>
<td>378</td>
<td>1.4766</td>
</tr>
<tr>
<td>8</td>
<td>16QAM</td>
<td>490</td>
<td>1.9141</td>
</tr>
<tr>
<td>9</td>
<td>16QAM</td>
<td>616</td>
<td>2.4063</td>
</tr>
<tr>
<td>10</td>
<td>64QAM</td>
<td>466</td>
<td>2.7305</td>
</tr>
<tr>
<td>11</td>
<td>64QAM</td>
<td>567</td>
<td>3.3223</td>
</tr>
<tr>
<td>12</td>
<td>64QAM</td>
<td>666</td>
<td>3.9023</td>
</tr>
<tr>
<td>13</td>
<td>64QAM</td>
<td>772</td>
<td>4.5234</td>
</tr>
<tr>
<td>14</td>
<td>64QAM</td>
<td>873</td>
<td>5.1152</td>
</tr>
<tr>
<td>15</td>
<td>64QAM</td>
<td>948</td>
<td>5.5547</td>
</tr>
</tbody>
</table>
<p>Table 5.2.2.1-3: 4-bit CQI Table 2</p>
<table>
<colgroup>
<col style="width: 21%" />
<col style="width: 25%" />
<col style="width: 32%" />
<col style="width: 20%" />
</colgroup>
<tbody>
<tr>
<td>CQI index</td>
<td>modulation</td>
<td>code rate x 1024</td>
<td>efficiency</td>
</tr>
<tr>
<td style="text-align: center;">0</td>
<td colspan="3" style="text-align: center;">out of range</td>
</tr>
<tr>
<td style="text-align: center;">1</td>
<td style="text-align: center;">QPSK</td>
<td style="text-align: center;">78</td>
<td style="text-align: center;">0.1523</td>
</tr>
<tr>
<td style="text-align: center;">2</td>
<td style="text-align: center;">QPSK</td>
<td style="text-align: center;">193</td>
<td style="text-align: center;">0.3770</td>
</tr>
<tr>
<td style="text-align: center;">3</td>
<td style="text-align: center;">QPSK</td>
<td style="text-align: center;">449</td>
<td style="text-align: center;">0.8770</td>
</tr>
<tr>
<td style="text-align: center;">4</td>
<td style="text-align: center;">16QAM</td>
<td style="text-align: center;">378</td>
<td style="text-align: center;">1.4766</td>
</tr>
<tr>
<td style="text-align: center;">5</td>
<td style="text-align: center;">16QAM</td>
<td style="text-align: center;">490</td>
<td style="text-align: center;">1.9141</td>
</tr>
<tr>
<td style="text-align: center;">6</td>
<td style="text-align: center;">16QAM</td>
<td style="text-align: center;">616</td>
<td style="text-align: center;">2.4063</td>
</tr>
<tr>
<td style="text-align: center;">7</td>
<td style="text-align: center;">64QAM</td>
<td style="text-align: center;">466</td>
<td style="text-align: center;">2.7305</td>
</tr>
<tr>
<td style="text-align: center;">8</td>
<td style="text-align: center;">64QAM</td>
<td style="text-align: center;">567</td>
<td style="text-align: center;">3.3223</td>
</tr>
<tr>
<td style="text-align: center;">9</td>
<td style="text-align: center;">64QAM</td>
<td style="text-align: center;">666</td>
<td style="text-align: center;">3.9023</td>
</tr>
<tr>
<td style="text-align: center;">10</td>
<td style="text-align: center;">64QAM</td>
<td style="text-align: center;">772</td>
<td style="text-align: center;">4.5234</td>
</tr>
<tr>
<td style="text-align: center;">11</td>
<td style="text-align: center;">64QAM</td>
<td style="text-align: center;">873</td>
<td style="text-align: center;">5.1152</td>
</tr>
<tr>
<td style="text-align: center;">12</td>
<td style="text-align: center;">256QAM</td>
<td style="text-align: center;">711</td>
<td style="text-align: center;">5.5547</td>
</tr>
<tr>
<td style="text-align: center;">13</td>
<td style="text-align: center;">256QAM</td>
<td style="text-align: center;">797</td>
<td style="text-align: center;">6.2266</td>
</tr>
<tr>
<td style="text-align: center;">14</td>
<td style="text-align: center;">256QAM</td>
<td style="text-align: center;">885</td>
<td style="text-align: center;">6.9141</td>
</tr>
<tr>
<td style="text-align: center;">15</td>
<td style="text-align: center;">256QAM</td>
<td style="text-align: center;">948</td>
<td style="text-align: center;">7.4063</td>
</tr>
</tbody>
</table>
<p>Table 5.2.2.1-4: 4-bit CQI Table 3</p>
<table>
<colgroup>
<col style="width: 21%" />
<col style="width: 25%" />
<col style="width: 32%" />
<col style="width: 20%" />
</colgroup>
<tbody>
<tr>
<td>CQI index</td>
<td>modulation</td>
<td>code rate x 1024</td>
<td>efficiency</td>
</tr>
<tr>
<td>0</td>
<td colspan="3">out of range</td>
</tr>
<tr>
<td>1</td>
<td>QPSK</td>
<td>30</td>
<td>0.0586</td>
</tr>
<tr>
<td>2</td>
<td>QPSK</td>
<td>50</td>
<td>0.0977</td>
</tr>
<tr>
<td>3</td>
<td>QPSK</td>
<td>78</td>
<td>0.1523</td>
</tr>
<tr>
<td>4</td>
<td>QPSK</td>
<td>120</td>
<td>0.2344</td>
</tr>
<tr>
<td>5</td>
<td>QPSK</td>
<td>193</td>
<td>0.3770</td>
</tr>
<tr>
<td>6</td>
<td>QPSK</td>
<td>308</td>
<td>0.6016</td>
</tr>
<tr>
<td>7</td>
<td>QPSK</td>
<td>449</td>
<td>0.8770</td>
</tr>
<tr>
<td>8</td>
<td>QPSK</td>
<td>602</td>
<td>1.1758</td>
</tr>
<tr>
<td>9</td>
<td>16QAM</td>
<td>378</td>
<td>1.4766</td>
</tr>
<tr>
<td>10</td>
<td>16QAM</td>
<td>490</td>
<td>1.9141</td>
</tr>
<tr>
<td>11</td>
<td>16QAM</td>
<td>616</td>
<td>2.4063</td>
</tr>
<tr>
<td>12</td>
<td>64QAM</td>
<td>466</td>
<td>2.7305</td>
</tr>
<tr>
<td>13</td>
<td>64QAM</td>
<td>567</td>
<td>3.3223</td>
</tr>
<tr>
<td>14</td>
<td>64QAM</td>
<td>666</td>
<td>3.9023</td>
</tr>
<tr>
<td>15</td>
<td>64QAM</td>
<td>772</td>
<td>4.5234</td>
</tr>
</tbody>
</table>
<p>Table 5.2.2.1-5: 4-bit CQI Table 4</p>
<table>
<colgroup>
<col style="width: 21%" />
<col style="width: 25%" />
<col style="width: 32%" />
<col style="width: 20%" />
</colgroup>
<tbody>
<tr>
<td>CQI index</td>
<td>modulation</td>
<td>code rate x 1024</td>
<td>efficiency</td>
</tr>
<tr>
<td>0</td>
<td colspan="3">out of range</td>
</tr>
<tr>
<td><u>1</u></td>
<td><u>QPSK</u></td>
<td><u>78</u></td>
<td><u>0.1523</u></td>
</tr>
<tr>
<td><u>2</u></td>
<td><u>QPSK</u></td>
<td><u>193</u></td>
<td><u>0.377</u></td>
</tr>
<tr>
<td><u>3</u></td>
<td><u>QPSK</u></td>
<td><u>449</u></td>
<td><u>0.877</u></td>
</tr>
<tr>
<td><u>4</u></td>
<td><u>16QAM</u></td>
<td><u>378</u></td>
<td><u>1.4766</u></td>
</tr>
<tr>
<td><u>5</u></td>
<td><u>16QAM</u></td>
<td><u>616</u></td>
<td><u>2.4063</u></td>
</tr>
<tr>
<td><u>6</u></td>
<td><u>64QAM</u></td>
<td><u>567</u></td>
<td><u>3.3223</u></td>
</tr>
<tr>
<td><u>7</u></td>
<td><u>64QAM</u></td>
<td><u>666</u></td>
<td><u>3.9023</u></td>
</tr>
<tr>
<td><u>8</u></td>
<td><u>64QAM</u></td>
<td><u>772</u></td>
<td><u>4.5234</u></td>
</tr>
<tr>
<td><u>9</u></td>
<td><u>64QAM</u></td>
<td><u>873</u></td>
<td><u>5.1152</u></td>
</tr>
<tr>
<td><u>10</u></td>
<td><u>256QAM</u></td>
<td><u>711</u></td>
<td><u>5.5547</u></td>
</tr>
<tr>
<td><u>11</u></td>
<td><u>256QAM</u></td>
<td><u>797</u></td>
<td><u>6.2266</u></td>
</tr>
<tr>
<td><u>12</u></td>
<td><u>256QAM</u></td>
<td><u>885</u></td>
<td><u>6.9141</u></td>
</tr>
<tr>
<td><u>13</u></td>
<td><u>256QAM</u></td>
<td><u>948</u></td>
<td><u>7.4063</u></td>
</tr>
<tr>
<td><u>14</u></td>
<td><u>1024QAM</u></td>
<td><u>853</u></td>
<td><u>8.3301</u></td>
</tr>
<tr>
<td><u>15</u></td>
<td><u>1024QAM</u></td>
<td><u>948</u></td>
<td><u>9.2578</u></td>
</tr>
</tbody>
</table>
<h5 id="void-1">5.2.2.1.1 (void)</h5>
<h4 id="precoding-matrix-indicator-pmi">5.2.2.2 Precoding matrix
indicator (PMI) </h4>
<h5 id="type-i-single-panel-codebook">5.2.2.2.1 Type I Single-Panel
Codebook</h5>
<p>For 2 antenna ports {3000, 3001} and the UE configured with higher
layer parameter <em>codebookType</em> set to 'typeI-SinglePanel' each
PMI value corresponds to a codebook index given in Table 5.2.2.2.1-1.
The UE is configured with the higher layer parameter
<em>twoTX-CodebookSubsetRestriction</em>. The bitmap parameter
<em>twoTX-CodebookSubsetRestriction</em> forms the bit sequence <img
src="media/image149.svg" /> where <img src="media/image150.svg" /> is
the LSB and <img src="media/image151.svg" /> is the MSB and where a bit
value of zero indicates that PMI reporting is not allowed to correspond
to the precoder associated with the bit. Bits 0 to 3 are associated
respectively with the codebook indices 0 to 3 for <img
src="media/image152.svg" /> layer, and bits 4 and 5 are associated
respectively with the codebook indices 0 and 1 for <img
src="media/image153.svg" /> layers.</p>
<p>Table 5.2.2.2.1-1: Codebooks for 1-layer and 2-layer CSI reporting
using antenna ports 3000 to 3001</p>
<table>
<colgroup>
<col style="width: 31%" />
<col style="width: 35%" />
<col style="width: 32%" />
</colgroup>
<thead>
<tr>
<th rowspan="2">Codebook index</th>
<th colspan="2">Number of layers <img src="media/image154.svg" /></th>
</tr>
<tr>
<th>1</th>
<th>2</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td><img src="media/image155.svg" /></td>
<td><img src="media/image156.svg" /></td>
</tr>
<tr>
<td>1</td>
<td><img src="media/image157.svg" /></td>
<td><img src="media/image158.svg" /></td>
</tr>
<tr>
<td>2</td>
<td><img src="media/image159.svg" /></td>
<td>-</td>
</tr>
<tr>
<td>3</td>
<td><img src="media/image160.svg" /></td>
<td>-</td>
</tr>
</tbody>
</table>
<p>For 4 antenna ports {3000, 3001, 3002, 3003}, 8 antenna ports {3000,
3001, …, 3007}, 12 antenna ports {3000, 3001, …, 3011}, 16 antenna ports
{3000, 3001, …, 3015}, 24 antenna ports {3000, 3001, …, 3023}, and 32
antenna ports {3000, 3001, …, 3031}, and the UE configured with higher
layer parameter <em>codebookType</em> set to 'typeI-SinglePanel', except
when the number of layers <img src="media/image161.svg" />(where <img
src="media/image162.svg" /> is the associated RI value), each PMI value
corresponds to three codebook indices <img
src="media/image163.svg" />,<img src="media/image164.svg" />,<img
src="media/image165.svg" />. When the number of layers <img
src="media/image166.svg" />, each PMI value corresponds to four codebook
indices <img src="media/image163.svg" />,<img
src="media/image164.svg" />,<img src="media/image167.svg" />,<img
src="media/image165.svg" />. The composite codebook index <img
src="media/image168.svg" /> is defined by</p>
<p><img src="media/image169.svg" /></p>
<p>The codebooks for 1-8 layers are given respectively in Tables
5.2.2.2.1-5, 5.2.2.2.1-6, 5.2.2.2.1-7, 5.2.2.2.1-8, 5.2.2.2.1-9,
5.2.2.2.1-10, 5.2.2.2.1-11, and 5.2.2.2.1-12. The mapping from <img
src="media/image170.svg" /> to <img src="media/image171.svg" /> and <img
src="media/image172.svg" /> for 2-layer reporting is given in Table
5.2.2.2.1-3. The mapping from <img src="media/image170.svg" /> to <img
src="media/image171.svg" /> and <img src="media/image172.svg" /> for
3-layer and 4-layer reporting when <img src="media/image173.svg" /> is
given in Table 5.2.2.2.1-4. The quantities <img
src="media/image174.svg" />, <img src="media/image175.svg" />, <img
src="media/image176.svg" />, <img src="media/image177.svg" />, and <img
src="media/image178.svg" /> are given by</p>
<p><img src="media/image179.svg" /></p>
<p>- The values of <img src="media/image180.svg" />and <img
src="media/image181.svg" /> are configured with the higher layer
parameter <em>n1-n2</em>, respectively. The supported configurations of
<img src="media/image182.svg" /> for a given number of CSI-RS ports and
the corresponding values of <img src="media/image183.svg" /> are given
in Table 5.2.2.2.1-2. The number of CSI-RS ports, <img
src="media/image184.svg" />, is<img src="media/image185.svg" />.</p>
<p>- UE shall only use <img src="media/image186.svg" /> and shall not
report <img src="media/image187.svg" /> if the value of
<em>N<sub>2</sub></em> is 1.</p>
<p>The bitmap parameter <em>n1-n2</em> forms the bit sequence <img
src="media/image188.svg" /> where <img src="media/image150.svg" /> is
the LSB and <img src="media/image189.svg" /> is the MSB and where a bit
value of zero indicates that PMI reporting is not allowed to correspond
to any precoder associated with the bit. The number of bits is given by
<img src="media/image190.svg" />. Except when the number of layers <img
src="media/image191.svg" />and the number of antenna ports is 16, 24, or
32, bit <img src="media/image192.svg" /> is associated with all
precoders based on the quantity <img src="media/image193.svg" />, <img
src="media/image194.svg" />, <img src="media/image195.svg" />. When the
number of layers <img src="media/image191.svg" />and the number of
antenna ports is 16, 24, or 32,</p>
<p>- bits <img src="media/image196.svg" />, <img
src="media/image197.svg" />, and <img src="media/image198.svg" /> are
each associated with all precoders based on the quantity <img
src="media/image199.svg" />, <img src="media/image200.svg" />, <img
src="media/image195.svg" />;</p>
<p>- if one or more of the associated bits is zero, then PMI reporting
is not allowed to correspond to any precoder based on <img
src="media/image199.svg" />.</p>
<p>For UE configured with higher layer parameter <em>codebookType</em>
set to 'typeI-SinglePanel', the bitmap parameter
<em>typeI-SinglePanel-ri‑Restriction</em> forms the bit sequence <img
src="media/image133.svg" /> where <img src="media/image134.svg" /> is
the LSB and <img src="media/image135.svg" /> is the MSB. When <img
src="media/image136.svg" /> is zero, <img src="media/image137.svg" />,
PMI and RI reporting are not allowed to correspond to any precoder
associated with <img src="media/image138.svg" /> layers.</p>
<p>For UE configured with higher layer parameter <em>reportQuantity</em>
set to 'cri-RI-i1-CQI', the bitmap parameter
<em>typeI-SinglePanel-codebookSubsetRestriction-i2</em> forms the bit
sequence <span class="math inline">\(b_{15},\ldots\)</span>,<span
class="math inline">\(b_{1},\ b_{0}\)</span><img
src="media/image201.png" /> where <span
class="math inline">\(b_{0}\)</span><img src="media/image202.png" /> is
the LSB and <span class="math inline">\(b_{15}\)</span><img
src="media/image203.png" /> is the MSB. The bit <span
class="math inline">\(b_{i}\)</span><img src="media/image204.png" /> is
associated with precoders corresponding to codebook index <span
class="math inline">\(i_{2} = i\)</span><img
src="media/image205.png" />. When <span
class="math inline">\(b_{i}\)</span><img src="media/image204.png" /> is
zero, the randomly selected precoder for CQI calculation is not allowed
to correspond to any precoder associated with the bit <span
class="math inline">\(b_{i}\)</span><img
src="media/image204.png" />.</p>
<p>Table 5.2.2.2.1-2: Supported configurations of <img
src="media/image182.svg" />and <img src="media/image206.svg" /></p>
<table>
<colgroup>
<col style="width: 37%" />
<col style="width: 31%" />
<col style="width: 31%" />
</colgroup>
<tbody>
<tr>
<td rowspan="2">Number of<br />
CSI-RS antenna ports, <img src="media/image184.svg" /></td>
<td rowspan="2"><img src="media/image182.svg" /></td>
<td rowspan="2"><img src="media/image206.svg" /></td>
</tr>
<tr>
</tr>
<tr>
<td>4</td>
<td>(2,1)</td>
<td>(4,1)</td>
</tr>
<tr>
<td rowspan="2">8</td>
<td>(2,2)</td>
<td>(4,4)</td>
</tr>
<tr>
<td>(4,1)</td>
<td>(4,1)</td>
</tr>
<tr>
<td rowspan="2">12</td>
<td>(3,2)</td>
<td>(4,4)</td>
</tr>
<tr>
<td>(6,1)</td>
<td>(4,1)</td>
</tr>
<tr>
<td rowspan="2">16</td>
<td>(4,2)</td>
<td>(4,4)</td>
</tr>
<tr>
<td>(8,1)</td>
<td>(4,1)</td>
</tr>
<tr>
<td rowspan="3">24</td>
<td>(4,3)</td>
<td>(4,4)</td>
</tr>
<tr>
<td>(6,2)</td>
<td>(4,4)</td>
</tr>
<tr>
<td>(12,1)</td>
<td>(4,1)</td>
</tr>
<tr>
<td rowspan="3">32</td>
<td>(4,4)</td>
<td>(4,4)</td>
</tr>
<tr>
<td>(8,2)</td>
<td>(4,4)</td>
</tr>
<tr>
<td>(16,1)</td>
<td>(4,1)</td>
</tr>
</tbody>
</table>
<p>Table 5.2.2.2.1-3: Mapping of <img src="media/image207.svg" /> to
<img src="media/image208.svg" /> and <img src="media/image209.svg" />
for 2-layer CSI reporting</p>
<table style="width:100%;">
<colgroup>
<col style="width: 9%" />
<col style="width: 12%" />
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 12%" />
<col style="width: 12%" />
<col style="width: 14%" />
<col style="width: 10%" />
</colgroup>
<thead>
<tr>
<th rowspan="2"><img src="media/image207.svg" /></th>
<th colspan="2"><img src="media/image210.svg" /></th>
<th colspan="2"><img src="media/image211.svg" /></th>
<th colspan="2"><img src="media/image212.svg" /></th>
<th colspan="2"><img src="media/image213.svg" /></th>
</tr>
<tr>
<th><img src="media/image214.svg" /></th>
<th><img src="media/image215.svg" /></th>
<th><img src="media/image214.svg" /></th>
<th><img src="media/image215.svg" /></th>
<th><img src="media/image214.svg" /></th>
<th><img src="media/image215.svg" /></th>
<th><img src="media/image214.svg" /></th>
<th><img src="media/image215.svg" /></th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>1</td>
<td><img src="media/image216.svg" /></td>
<td>0</td>
<td><img src="media/image216.svg" /></td>
<td>0</td>
<td><img src="media/image216.svg" /></td>
<td>0</td>
<td><img src="media/image216.svg" /></td>
<td>0</td>
</tr>
<tr>
<td>2</td>
<td>0</td>
<td><img src="media/image217.svg" /></td>
<td>0</td>
<td><img src="media/image217.svg" /></td>
<td></td>
<td></td>
<td><img src="media/image218.svg" /></td>
<td>0</td>
</tr>
<tr>
<td>3</td>
<td><img src="media/image219.svg" /></td>
<td>0</td>
<td><img src="media/image216.svg" /></td>
<td><img src="media/image217.svg" /></td>
<td></td>
<td></td>
<td><img src="media/image220.svg" /></td>
<td>0</td>
</tr>
</tbody>
</table>
<p>Table 5.2.2.2.1-4: Mapping of <img src="media/image207.svg" /> to
<img src="media/image208.svg" /> and <img src="media/image209.svg" />
for 3-layer and 4-layer CSI reporting when <img
src="media/image173.svg" /></p>
<table style="width:100%;">
<colgroup>
<col style="width: 6%" />
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 10%" />
<col style="width: 7%" />
<col style="width: 10%" />
<col style="width: 7%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 7%" />
</colgroup>
<thead>
<tr>
<th rowspan="2"><img src="media/image207.svg" /></th>
<th colspan="2"><img src="media/image212.svg" /></th>
<th colspan="2"><img src="media/image221.svg" /></th>
<th colspan="2"><img src="media/image222.svg" /></th>
<th colspan="2"><img src="media/image223.svg" /></th>
<th colspan="2"><img src="media/image224.svg" /></th>
</tr>
<tr>
<th><img src="media/image214.svg" /></th>
<th><img src="media/image215.svg" /></th>
<th><img src="media/image214.svg" /></th>
<th><img src="media/image215.svg" /></th>
<th><img src="media/image214.svg" /></th>
<th><img src="media/image215.svg" /></th>
<th><img src="media/image214.svg" /></th>
<th><img src="media/image215.svg" /></th>
<th><img src="media/image214.svg" /></th>
<th><img src="media/image215.svg" /></th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td><img src="media/image216.svg" /></td>
<td>0</td>
<td><img src="media/image216.svg" /></td>
<td>0</td>
<td><img src="media/image216.svg" /></td>
<td>0</td>
<td><img src="media/image216.svg" /></td>
<td>0</td>
<td><img src="media/image216.svg" /></td>
<td>0</td>
</tr>
<tr>
<td>1</td>
<td></td>
<td></td>
<td><img src="media/image225.svg" /></td>
<td>0</td>
<td><img src="media/image225.svg" /></td>
<td>0</td>
<td>0</td>
<td><img src="media/image217.svg" /></td>
<td>0</td>
<td><img src="media/image217.svg" /></td>
</tr>
<tr>
<td>2</td>
<td></td>
<td></td>
<td><img src="media/image226.svg" /></td>
<td>0</td>
<td><img src="media/image226.svg" /></td>
<td>0</td>
<td><img src="media/image216.svg" /></td>
<td><img src="media/image217.svg" /></td>
<td><img src="media/image216.svg" /></td>
<td><img src="media/image217.svg" /></td>
</tr>
<tr>
<td>3</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td><img src="media/image227.svg" /></td>
<td>0</td>
<td></td>
<td></td>
<td><img src="media/image225.svg" /></td>
<td>0</td>
</tr>
</tbody>
</table>
<p>Table 5.2.2.2.1-5: Codebook for 1-layer CSI reporting using antenna
ports 3000 to 2999+<em>P</em><sub>CSI-RS</sub></p>
<table>
<colgroup>
<col style="width: 32%" />
<col style="width: 29%" />
<col style="width: 17%" />
<col style="width: 20%" />
</colgroup>
<thead>
<tr>
<th colspan="4"><em>codebookMode</em> = 1</th>
</tr>
</thead>
<tbody>
<tr>
<td><img src="media/image228.svg" /></td>
<td><img src="media/image229.svg" /></td>
<td><img src="media/image230.svg" /></td>
<td></td>
</tr>
<tr>
<td><img src="media/image231.svg" /></td>
<td><img src="media/image232.svg" /></td>
<td><img src="media/image233.svg" /></td>
<td><img src="media/image234.svg" /></td>
</tr>
<tr>
<td colspan="4">where <img src="media/image235.svg" />.</td>
</tr>
</tbody>
</table>
<table>
<colgroup>
<col style="width: 15%" />
<col style="width: 16%" />
<col style="width: 16%" />
<col style="width: 16%" />
<col style="width: 16%" />
<col style="width: 16%" />
</colgroup>
<thead>
<tr>
<th colspan="6"><em>codebookMode</em> = 2, <img
src="media/image236.svg" /></th>
</tr>
</thead>
<tbody>
<tr>
<td rowspan="2"><img src="media/image228.svg" /></td>
<td rowspan="2"><img src="media/image229.svg" /></td>
<td colspan="4"><img src="media/image230.svg" /></td>
</tr>
<tr>
<td>0</td>
<td>1</td>
<td>2</td>
<td>3</td>
</tr>
<tr>
<td><img src="media/image237.svg" /></td>
<td><img src="media/image238.svg" /></td>
<td><img src="media/image239.svg" /></td>
<td><img src="media/image240.svg" /></td>
<td><img src="media/image241.svg" /></td>
<td><img src="media/image242.svg" /></td>
</tr>
<tr>
<td rowspan="2"><img src="media/image228.svg" /></td>
<td rowspan="2"><img src="media/image229.svg" /></td>
<td colspan="4"><img src="media/image230.svg" /></td>
</tr>
<tr>
<td>4</td>
<td>5</td>
<td>6</td>
<td>7</td>
</tr>
<tr>
<td><img src="media/image237.svg" /></td>
<td><img src="media/image238.svg" /></td>
<td><img src="media/image243.svg" /></td>
<td><img src="media/image244.svg" /></td>
<td><img src="media/image245.svg" /></td>
<td><img src="media/image246.svg" /></td>
</tr>
<tr>
<td rowspan="2"><img src="media/image228.svg" /></td>
<td rowspan="2"><img src="media/image229.svg" /></td>
<td colspan="4"><img src="media/image230.svg" /></td>
</tr>
<tr>
<td>8</td>
<td>9</td>
<td>10</td>
<td>11</td>
</tr>
<tr>
<td><img src="media/image237.svg" /></td>
<td><img src="media/image238.svg" /></td>
<td><img src="media/image247.svg" /></td>
<td><img src="media/image248.svg" /></td>
<td><img src="media/image249.svg" /></td>
<td><img src="media/image250.svg" /></td>
</tr>
<tr>
<td rowspan="2"><img src="media/image228.svg" /></td>
<td rowspan="2"><img src="media/image229.svg" /></td>
<td colspan="4"><img src="media/image230.svg" /></td>
</tr>
<tr>
<td>12</td>
<td>13</td>
<td>14</td>
<td>15</td>
</tr>
<tr>
<td><img src="media/image237.svg" /></td>
<td><img src="media/image238.svg" /></td>
<td><img src="media/image251.svg" /></td>
<td><img src="media/image252.svg" /></td>
<td><img src="media/image253.svg" /></td>
<td><img src="media/image254.svg" /></td>
</tr>
<tr>
<td colspan="6">where <img src="media/image255.svg" />.</td>
</tr>
</tbody>
</table>
<table>
<colgroup>
<col style="width: 19%" />
<col style="width: 8%" />
<col style="width: 17%" />
<col style="width: 17%" />
<col style="width: 17%" />
<col style="width: 17%" />
</colgroup>
<thead>
<tr>
<th colspan="6"><em>codebookMode =</em> 2, <img
src="media/image256.svg" /></th>
</tr>
</thead>
<tbody>
<tr>
<td rowspan="2"><img src="media/image228.svg" /></td>
<td rowspan="2"><img src="media/image229.svg" /></td>
<td colspan="4"><img src="media/image230.svg" /></td>
</tr>
<tr>
<td>0</td>
<td>1</td>
<td>2</td>
<td>3</td>
</tr>
<tr>
<td><img src="media/image237.svg" /></td>
<td><img src="media/image257.svg" /></td>
<td><img src="media/image258.svg" /></td>
<td><img src="media/image259.svg" /></td>
<td><img src="media/image260.svg" /></td>
<td><img src="media/image261.svg" /></td>
</tr>
<tr>
<td rowspan="2"><img src="media/image228.svg" /></td>
<td rowspan="2"><img src="media/image229.svg" /></td>
<td colspan="4"><img src="media/image230.svg" /></td>
</tr>
<tr>
<td>4</td>
<td>5</td>
<td>6</td>
<td>7</td>
</tr>
<tr>
<td><img src="media/image237.svg" /></td>
<td><img src="media/image257.svg" /></td>
<td><img src="media/image262.svg" /></td>
<td><img src="media/image263.svg" /></td>
<td><img src="media/image264.svg" /></td>
<td><img src="media/image265.svg" /></td>
</tr>
<tr>
<td rowspan="2"><img src="media/image228.svg" /></td>
<td rowspan="2"><img src="media/image229.svg" /></td>
<td colspan="4"><img src="media/image230.svg" /></td>
</tr>
<tr>
<td>8</td>
<td>9</td>
<td>10</td>
<td>11</td>
</tr>
<tr>
<td><img src="media/image237.svg" /></td>
<td><img src="media/image257.svg" /></td>
<td><img src="media/image266.svg" /></td>
<td><img src="media/image267.svg" /></td>
<td><img src="media/image268.svg" /></td>
<td><img src="media/image269.svg" /></td>
</tr>
<tr>
<td rowspan="2"><img src="media/image228.svg" /></td>
<td rowspan="2"><img src="media/image229.svg" /></td>
<td colspan="4"><img src="media/image230.svg" /></td>
</tr>
<tr>
<td>12</td>
<td>13</td>
<td>14</td>
<td>15</td>
</tr>
<tr>
<td><img src="media/image237.svg" /></td>
<td><img src="media/image257.svg" /></td>
<td><img src="media/image270.svg" /></td>
<td><img src="media/image271.svg" /></td>
<td><img src="media/image272.svg" /></td>
<td><img src="media/image273.svg" /></td>
</tr>
<tr>
<td colspan="6">where <img src="media/image274.svg" />.</td>
</tr>
</tbody>
</table>
<p>Table 5.2.2.2.1-6: Codebook for 2-layer CSI reporting using antenna
ports 3000 to 2999+<em>P</em><sub>CSI-RS</sub></p>
<table>
<colgroup>
<col style="width: 29%" />
<col style="width: 27%" />
<col style="width: 9%" />
<col style="width: 32%" />
</colgroup>
<thead>
<tr>
<th colspan="4"><em>codebookMode</em> = 1</th>
</tr>
</thead>
<tbody>
<tr>
<td><img src="media/image228.svg" /></td>
<td><img src="media/image229.svg" /></td>
<td><img src="media/image230.svg" /></td>
<td></td>
</tr>
<tr>
<td><img src="media/image231.svg" /></td>
<td><img src="media/image232.svg" /></td>
<td><img src="media/image275.svg" /></td>
<td><img src="media/image276.svg" /></td>
</tr>
<tr>
<td colspan="4"><p>where <img src="media/image277.svg" />.</p>
<p>and the mapping from <img src="media/image170.svg" /> to <img
src="media/image171.svg" /> and <img src="media/image172.svg" /> is
given in Table 5.2.2.2.1-3.</p></td>
</tr>
</tbody>
</table>
<table>
<colgroup>
<col style="width: 17%" />
<col style="width: 18%" />
<col style="width: 31%" />
<col style="width: 31%" />
</colgroup>
<thead>
<tr>
<th colspan="4"><em>codebookMode =</em> 2, <img
src="media/image278.svg" /></th>
</tr>
</thead>
<tbody>
<tr>
<td rowspan="2"><img src="media/image279.svg" /></td>
<td rowspan="2"><img src="media/image280.svg" /></td>
<td colspan="2"><img src="media/image281.svg" /></td>
</tr>
<tr>
<td>0</td>
<td>1</td>
</tr>
<tr>
<td><img src="media/image282.svg" /></td>
<td><img src="media/image283.svg" /></td>
<td><img src="media/image284.svg" /></td>
<td><img src="media/image285.svg" /></td>
</tr>
<tr>
<td rowspan="2"><img src="media/image279.svg" /></td>
<td rowspan="2"><img src="media/image280.svg" /></td>
<td colspan="2"><img src="media/image281.svg" /></td>
</tr>
<tr>
<td>2</td>
<td>3</td>
</tr>
<tr>
<td><img src="media/image282.svg" /></td>
<td><img src="media/image283.svg" /></td>
<td><img src="media/image286.svg" /></td>
<td><img src="media/image287.svg" /></td>
</tr>
<tr>
<td rowspan="2"><img src="media/image279.svg" /></td>
<td rowspan="2"><img src="media/image280.svg" /></td>
<td colspan="2"><img src="media/image281.svg" /></td>
</tr>
<tr>
<td>4</td>
<td>5</td>
</tr>
<tr>
<td><img src="media/image282.svg" /></td>
<td><img src="media/image283.svg" /></td>
<td><img src="media/image288.svg" /></td>
<td><img src="media/image289.svg" /></td>
</tr>
<tr>
<td rowspan="2"><img src="media/image279.svg" /></td>
<td rowspan="2"><img src="media/image280.svg" /></td>
<td colspan="2"><img src="media/image281.svg" /></td>
</tr>
<tr>
<td>6</td>
<td>7</td>
</tr>
<tr>
<td><img src="media/image282.svg" /></td>
<td><img src="media/image283.svg" /></td>
<td><img src="media/image290.svg" /></td>
<td><img src="media/image291.svg" /></td>
</tr>
<tr>
<td colspan="4"><p>where <img src="media/image292.svg" />.</p>
<p>and the mapping from <img src="media/image170.svg" /> to <img
src="media/image171.svg" /> and <img src="media/image172.svg" /> is
given in Table 5.2.2.2.1-3.</p></td>
</tr>
</tbody>
</table>
<table style="width:100%;">
<colgroup>
<col style="width: 15%" />
<col style="width: 5%" />
<col style="width: 17%" />
<col style="width: 19%" />
<col style="width: 20%" />
<col style="width: 20%" />
</colgroup>
<thead>
<tr>
<th colspan="6"><em>codebookMode =</em> 2, <img
src="media/image293.svg" /></th>
</tr>
</thead>
<tbody>
<tr>
<td rowspan="2"><img src="media/image279.svg" /></td>
<td rowspan="2"><img src="media/image294.svg" /></td>
<td colspan="4"><img src="media/image230.svg" /></td>
</tr>
<tr>
<td>0</td>
<td>1</td>
<td>2</td>
<td>3</td>
</tr>
<tr>
<td><img src="media/image295.svg" /></td>
<td><img src="media/image296.svg" /></td>
<td><img src="media/image297.svg" /></td>
<td><img src="media/image298.svg" /></td>
<td><img src="media/image299.svg" /></td>
<td><img src="media/image300.svg" /></td>
</tr>
<tr>
<td rowspan="2"><img src="media/image279.svg" /></td>
<td rowspan="2"><img src="media/image301.svg" /></td>
<td colspan="4"><img src="media/image230.svg" /></td>
</tr>
<tr>
<td>4</td>
<td>5</td>
<td>6</td>
<td>7</td>
</tr>
<tr>
<td><img src="media/image295.svg" /></td>
<td><img src="media/image296.svg" /></td>
<td><img src="media/image302.svg" /></td>
<td><img src="media/image303.svg" /></td>
<td><img src="media/image304.svg" /></td>
<td><img src="media/image305.svg" /></td>
</tr>
<tr>
<td colspan="6"><p>where <img src="media/image306.svg" />.</p>
<p>and the mapping from <img src="media/image170.svg" /> to <img
src="media/image171.svg" /> is given in Table 5.2.2.2.1-3.</p></td>
</tr>
</tbody>
</table>
<p>Table 5.2.2.2.1-7: Codebook for 3-layer CSI reporting using antenna
ports 3000 to 2999+<em>P</em><sub>CSI-RS</sub></p>
<table>
<colgroup>
<col style="width: 27%" />
<col style="width: 29%" />
<col style="width: 9%" />
<col style="width: 32%" />
</colgroup>
<thead>
<tr>
<th colspan="4"><em>codebookMode =</em> 1-2, <img
src="media/image307.svg" /></th>
</tr>
</thead>
<tbody>
<tr>
<td><img src="media/image308.svg" /></td>
<td><img src="media/image309.svg" /></td>
<td><img src="media/image230.svg" /></td>
<td></td>
</tr>
<tr>
<td><img src="media/image310.svg" /></td>
<td><img src="media/image311.svg" /></td>
<td><img src="media/image312.svg" /></td>
<td><img src="media/image313.svg" /></td>
</tr>
<tr>
<td colspan="4"><p>where <img src="media/image314.svg" />.</p>
<p>and the mapping from <img src="media/image170.svg" /> to <img
src="media/image171.svg" /> and <img src="media/image172.svg" /> is
given in Table 5.2.2.2.1-4.</p></td>
</tr>
</tbody>
</table>
<table>
<colgroup>
<col style="width: 26%" />
<col style="width: 26%" />
<col style="width: 15%" />
<col style="width: 9%" />
<col style="width: 21%" />
</colgroup>
<thead>
<tr>
<th colspan="5"><em>codebookMode</em> = 1-2, <img
src="media/image315.svg" /></th>
</tr>
</thead>
<tbody>
<tr>
<td><img src="media/image308.svg" /></td>
<td><img src="media/image316.svg" /></td>
<td><img src="media/image317.svg" /></td>
<td><img src="media/image230.svg" /></td>
<td></td>
</tr>
<tr>
<td><img src="media/image318.svg" /></td>
<td><img src="media/image319.svg" /></td>
<td><img src="media/image320.svg" /></td>
<td><img src="media/image312.svg" /></td>
<td><img src="media/image321.svg" /></td>
</tr>
<tr>
<td colspan="5">where <img src="media/image322.svg" />.</td>
</tr>
</tbody>
</table>
<p>Table 5.2.2.2.1-8: Codebook for 4-layer CSI reporting using antenna
ports 3000 to 2999+<em>P</em><sub>CSI-RS</sub></p>
<table>
<colgroup>
<col style="width: 27%" />
<col style="width: 29%" />
<col style="width: 9%" />
<col style="width: 32%" />
</colgroup>
<thead>
<tr>
<th colspan="4"><em>codebookMode =</em> 1-2, <img
src="media/image307.svg" /></th>
</tr>
</thead>
<tbody>
<tr>
<td><img src="media/image308.svg" /></td>
<td><img src="media/image309.svg" /></td>
<td><img src="media/image230.svg" /></td>
<td></td>
</tr>
<tr>
<td><img src="media/image310.svg" /></td>
<td><img src="media/image311.svg" /></td>
<td><img src="media/image312.svg" /></td>
<td><img src="media/image323.svg" /></td>
</tr>
<tr>
<td colspan="4"><p>where <img src="media/image324.svg" />.</p>
<p>and the mapping from <img src="media/image170.svg" /> to <img
src="media/image171.svg" /> and <img src="media/image172.svg" /> is
given in Table 5.2.2.2.1-4.</p></td>
</tr>
</tbody>
</table>
<table>
<colgroup>
<col style="width: 26%" />
<col style="width: 26%" />
<col style="width: 15%" />
<col style="width: 9%" />
<col style="width: 21%" />
</colgroup>
<thead>
<tr>
<th colspan="5"><em>codebookMode</em> = 1-2, <img
src="media/image325.svg" /></th>
</tr>
</thead>
<tbody>
<tr>
<td><img src="media/image308.svg" /></td>
<td><img src="media/image316.svg" /></td>
<td><img src="media/image317.svg" /></td>
<td><img src="media/image230.svg" /></td>
<td></td>
</tr>
<tr>
<td><img src="media/image326.svg" /></td>
<td><img src="media/image319.svg" /></td>
<td><img src="media/image320.svg" /></td>
<td><img src="media/image312.svg" /></td>
<td><img src="media/image327.svg" /></td>
</tr>
<tr>
<td colspan="5">where <img src="media/image328.svg" />.</td>
</tr>
</tbody>
</table>
<p>Table 5.2.2.2.1-9: Codebook for 5-layer CSI reporting using antenna
ports 3000 to 2999+<em>P</em><sub>CSI-RS</sub></p>
<table>
<colgroup>
<col style="width: 19%" />
<col style="width: 19%" />
<col style="width: 19%" />
<col style="width: 7%" />
<col style="width: 34%" />
</colgroup>
<thead>
<tr>
<th colspan="5"><em>codebookMode</em> = 1-2</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td><img src="media/image308.svg" /></td>
<td><img src="media/image316.svg" /></td>
<td><img src="media/image230.svg" /></td>
<td></td>
</tr>
<tr>
<td><img src="media/image329.svg" /></td>
<td><img src="media/image330.svg" /></td>
<td><img src="media/image319.svg" /></td>
<td><img src="media/image331.svg" /></td>
<td><img src="media/image332.svg" /></td>
</tr>
<tr>
<td><img src="media/image333.svg" /></td>
<td><img src="media/image334.svg" /></td>
<td><img src="media/image335.svg" /></td>
<td><img src="media/image331.svg" /></td>
<td><img src="media/image336.svg" /></td>
</tr>
<tr>
<td colspan="5">where <img src="media/image337.svg" />.</td>
</tr>
</tbody>
</table>
<p>Table 5.2.2.2.1-10: Codebook for 6-layer CSI reporting using antenna
ports 3000 to 2999+<em>P</em><sub>CSI-RS</sub></p>
<table>
<colgroup>
<col style="width: 19%" />
<col style="width: 19%" />
<col style="width: 19%" />
<col style="width: 7%" />
<col style="width: 34%" />
</colgroup>
<thead>
<tr>
<th colspan="5"><em>codebookMode</em> = 1-2</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td><img src="media/image308.svg" /></td>
<td><img src="media/image316.svg" /></td>
<td><img src="media/image230.svg" /></td>
<td></td>
</tr>
<tr>
<td><img src="media/image329.svg" /></td>
<td><img src="media/image338.svg" /></td>
<td><img src="media/image319.svg" /></td>
<td><img src="media/image331.svg" /></td>
<td><img src="media/image339.svg" /></td>
</tr>
<tr>
<td><img src="media/image333.svg" /></td>
<td><img src="media/image340.svg" /></td>
<td><img src="media/image341.svg" /></td>
<td><img src="media/image331.svg" /></td>
<td><img src="media/image342.svg" /></td>
</tr>
<tr>
<td colspan="5">where <img src="media/image343.svg" />.</td>
</tr>
</tbody>
</table>
<p>Table 5.2.2.2.1-11: Codebook for 7-layer CSI reporting using antenna
ports 3000 to 2999+<em>P</em><sub>CSI-RS</sub></p>
<table>
<colgroup>
<col style="width: 19%" />
<col style="width: 17%" />
<col style="width: 19%" />
<col style="width: 6%" />
<col style="width: 37%" />
</colgroup>
<thead>
<tr>
<th colspan="5"><em>codebookMode</em> = 1-2</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td><img src="media/image308.svg" /></td>
<td><img src="media/image316.svg" /></td>
<td><img src="media/image230.svg" /></td>
<td></td>
</tr>
<tr>
<td><img src="media/image344.svg" /></td>
<td><img src="media/image345.svg" /></td>
<td><img src="media/image346.svg" /></td>
<td><img src="media/image331.svg" /></td>
<td><img src="media/image347.svg" /></td>
</tr>
<tr>
<td><img src="media/image348.svg" /></td>
<td><img src="media/image349.svg" /></td>
<td><img src="media/image346.svg" /></td>
<td><img src="media/image331.svg" /></td>
<td><img src="media/image350.svg" /></td>
</tr>
<tr>
<td><img src="media/image351.svg" /></td>
<td><img src="media/image352.svg" /></td>
<td><img src="media/image353.svg" /></td>
<td><img src="media/image331.svg" /></td>
<td><img src="media/image354.svg" /></td>
</tr>
<tr>
<td><img src="media/image355.svg" /></td>
<td><img src="media/image356.svg" /></td>
<td><img src="media/image357.svg" /></td>
<td><img src="media/image331.svg" /></td>
<td><img src="media/image354.svg" /></td>
</tr>
<tr>
<td><img src="media/image358.svg" /></td>
<td><img src="media/image359.svg" /></td>
<td><img src="media/image360.svg" /></td>
<td><img src="media/image331.svg" /></td>
<td><img src="media/image354.svg" /></td>
</tr>
<tr>
<td colspan="5">where <img src="media/image361.svg" />.</td>
</tr>
</tbody>
</table>
<p>Table 5.2.2.2.1-12: Codebook for 8-layer CSI reporting using antenna
ports 3000 to 2999+<em>P</em><sub>CSI-RS</sub></p>
<table>
<colgroup>
<col style="width: 19%" />
<col style="width: 17%" />
<col style="width: 19%" />
<col style="width: 6%" />
<col style="width: 37%" />
</colgroup>
<thead>
<tr>
<th colspan="5"><em>codebookMode</em> = 1-2</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td><img src="media/image308.svg" /></td>
<td><img src="media/image316.svg" /></td>
<td><img src="media/image230.svg" /></td>
<td></td>
</tr>
<tr>
<td><img src="media/image344.svg" /></td>
<td><img src="media/image362.svg" /></td>
<td><img src="media/image346.svg" /></td>
<td><img src="media/image331.svg" /></td>
<td><img src="media/image363.svg" /></td>
</tr>
<tr>
<td><img src="media/image348.svg" /></td>
<td><img src="media/image364.svg" /></td>
<td><img src="media/image346.svg" /></td>
<td><img src="media/image331.svg" /></td>
<td><img src="media/image365.svg" /></td>
</tr>
<tr>
<td><img src="media/image351.svg" /></td>
<td><img src="media/image366.svg" /></td>
<td><img src="media/image367.svg" /></td>
<td><img src="media/image331.svg" /></td>
<td><img src="media/image368.svg" /></td>
</tr>
<tr>
<td><img src="media/image355.svg" /></td>
<td><img src="media/image369.svg" /></td>
<td><img src="media/image370.svg" /></td>
<td><img src="media/image331.svg" /></td>
<td><img src="media/image368.svg" /></td>
</tr>
<tr>
<td><img src="media/image358.svg" /></td>
<td><img src="media/image371.svg" /></td>
<td><img src="media/image372.svg" /></td>
<td><img src="media/image331.svg" /></td>
<td><img src="media/image368.svg" /></td>
</tr>
<tr>
<td colspan="5">where <img src="media/image373.svg" />.</td>
</tr>
</tbody>
</table>
<h5 id="type-i-multi-panel-codebook">5.2.2.2.2 Type I Multi-Panel
Codebook</h5>
<p>For 8 antenna ports {3000, 3001, …, 3007}, 16 antenna ports {3000,
3001, …, 3015}, and 32 antenna ports {3000, 3001, …, 3031}, and the UE
configured with higher layer parameter <em>codebookType</em> set to
'typeI-MultiPanel',</p>
<p>- The values of <img src="media/image374.svg" />, <img
src="media/image180.svg" />and <img src="media/image375.svg" /> are
configured with the higher layer parameters <em>ng-n1-n2</em>. The
supported configurations of <img src="media/image376.svg" /> for a given
number of CSI-RS ports and the corresponding values of <img
src="media/image183.svg" /> are given in Table 5.2.2.2.2-1. The number
of CSI-RS ports, <img src="media/image184.svg" />, is <img
src="media/image377.svg" />.</p>
<p>- When <img src="media/image378.svg" />, <em>codebookMode</em> shall
be set to either '1' or '2'. When <img src="media/image379.svg" />,
<em>codebookMode</em> shall be set to '1'.</p>
<p>The bitmap parameter <em>ng-n1-n2</em> forms the bit sequence <img
src="media/image188.svg" /> where <img src="media/image150.svg" /> is
the LSB and <img src="media/image189.svg" /> is the MSB and where a bit
value of zero indicates that PMI reporting is not allowed to correspond
to any precoder associated with the bit. The number of bits is given by
<img src="media/image380.svg" />. Bit <img src="media/image192.svg" />
is associated with all precoders based on the quantity <img
src="media/image193.svg" />, <img src="media/image194.svg" />, <img
src="media/image195.svg" />, as defined below. The bitmap parameter
<em>ri‑Restriction</em> forms the bit sequence <img
src="media/image139.svg" /> where <img src="media/image134.svg" /> is
the LSB and <img src="media/image140.svg" /> is the MSB. When <img
src="media/image136.svg" /> is zero, <img src="media/image141.svg" />,
PMI and RI reporting are not allowed to correspond to any precoder
associated with <img src="media/image138.svg" /> layers.</p>
<p>Table 5.2.2.2.2-1: Supported configurations of <img
src="media/image381.svg" /> and <img src="media/image206.svg" /></p>
<table>
<colgroup>
<col style="width: 37%" />
<col style="width: 31%" />
<col style="width: 31%" />
</colgroup>
<tbody>
<tr>
<td rowspan="2">Number of<br />
CSI-RS antenna ports, <img src="media/image184.svg" /></td>
<td rowspan="2"><img src="media/image382.svg" /></td>
<td rowspan="2"><img src="media/image206.svg" /></td>
</tr>
<tr>
</tr>
<tr>
<td>8</td>
<td>(2,2,1)</td>
<td>(4,1)</td>
</tr>
<tr>
<td rowspan="3">16</td>
<td>(2,4,1)</td>
<td>(4,1)</td>
</tr>
<tr>
<td>(4,2,1)</td>
<td>(4,1)</td>
</tr>
<tr>
<td>(2,2,2)</td>
<td>(4,4)</td>
</tr>
<tr>
<td rowspan="4">32</td>
<td>(2,8,1)</td>
<td>(4,1)</td>
</tr>
<tr>
<td>(4,4,1)</td>
<td>(4,1)</td>
</tr>
<tr>
<td>(2,4,2)</td>
<td>(4,4)</td>
</tr>
<tr>
<td>(4,2,2)</td>
<td>(4,4)</td>
</tr>
</tbody>
</table>
<p>Each PMI value corresponds to the codebook indices <img
src="media/image383.svg" /> and <img src="media/image384.svg" />, where
<img src="media/image383.svg" /> is the vector</p>
<p><img src="media/image385.svg" /></p>
<p>and <img src="media/image162.svg" /> is the associated RI value. When
<em>codebookMode</em> is set to '1', <img src="media/image386.svg" />
is</p>
<p><img src="media/image387.svg" />.</p>
<p>When <em>codebookMode</em> is set to '2', <img
src="media/image386.svg" /> and <img src="media/image388.svg" /> are</p>
<p><img src="media/image389.svg" />.</p>
<p>The mapping from <img src="media/image170.svg" /> to <img
src="media/image171.svg" /> and <img src="media/image172.svg" /> for
2-layer reporting is given in Table 5.2.2.2.1-3. The mapping from <img
src="media/image170.svg" /> to <img src="media/image171.svg" /> and <img
src="media/image172.svg" /> for 3-layer and 4-layer reporting is given
in Table 5.2.2.2.2-2.</p>
<p>- UE shall only use <img src="media/image186.svg" /> and shall not
report <img src="media/image187.svg" /> if the value of
<em>N<sub>2</sub></em> is 1.</p>
<p>Table 5.2.2.2.2-2: Mapping of <img src="media/image207.svg" /> to
<img src="media/image208.svg" /> and <img src="media/image209.svg" />
for 3-layer and 4-layer CSI reporting</p>
<table>
<colgroup>
<col style="width: 6%" />
<col style="width: 8%" />
<col style="width: 9%" />
<col style="width: 10%" />
<col style="width: 7%" />
<col style="width: 10%" />
<col style="width: 7%" />
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 11%" />
<col style="width: 8%" />
</colgroup>
<thead>
<tr>
<th rowspan="2"><img src="media/image207.svg" /></th>
<th colspan="2"><img src="media/image212.svg" /></th>
<th colspan="2"><img src="media/image221.svg" /></th>
<th colspan="2"><img src="media/image390.svg" /></th>
<th colspan="2"><img src="media/image223.svg" /></th>
<th colspan="2"><img src="media/image391.svg" /></th>
</tr>
<tr>
<th><img src="media/image214.svg" /></th>
<th><img src="media/image215.svg" /></th>
<th><img src="media/image214.svg" /></th>
<th><img src="media/image215.svg" /></th>
<th><img src="media/image214.svg" /></th>
<th><img src="media/image215.svg" /></th>
<th><img src="media/image214.svg" /></th>
<th><img src="media/image215.svg" /></th>
<th><img src="media/image214.svg" /></th>
<th><img src="media/image215.svg" /></th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td><img src="media/image216.svg" /></td>
<td>0</td>
<td><img src="media/image216.svg" /></td>
<td>0</td>
<td><img src="media/image216.svg" /></td>
<td>0</td>
<td><img src="media/image216.svg" /></td>
<td>0</td>
<td><img src="media/image216.svg" /></td>
<td>0</td>
</tr>
<tr>
<td>1</td>
<td></td>
<td></td>
<td><img src="media/image225.svg" /></td>
<td>0</td>
<td><img src="media/image225.svg" /></td>
<td>0</td>
<td>0</td>
<td><img src="media/image217.svg" /></td>
<td>0</td>
<td><img src="media/image217.svg" /></td>
</tr>
<tr>
<td>2</td>
<td></td>
<td></td>
<td><img src="media/image226.svg" /></td>
<td>0</td>
<td><img src="media/image226.svg" /></td>
<td>0</td>
<td><img src="media/image216.svg" /></td>
<td><img src="media/image217.svg" /></td>
<td><img src="media/image216.svg" /></td>
<td><img src="media/image217.svg" /></td>
</tr>
<tr>
<td>3</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td><img src="media/image227.svg" /></td>
<td>0</td>
<td></td>
<td></td>
<td><img src="media/image225.svg" /></td>
<td>0</td>
</tr>
</tbody>
</table>
<p>Several quantities are used to define the codebook elements. The
quantities <img src="media/image174.svg" />, <img
src="media/image392.svg" />, <img src="media/image393.svg" />, <img
src="media/image176.svg" />, and <img src="media/image177.svg" /> are
given by</p>
<p><img src="media/image394.svg" /></p>
<p>Furthermore, the quantities <img src="media/image395.svg" /> and <img
src="media/image396.svg" /> (<img src="media/image397.svg" />) are given
by</p>
<p><img src="media/image398.svg" /></p>
<p>where</p>
<p><img src="media/image399.svg" />,</p>
<p>and the quantities <img src="media/image400.svg" /> and <img
src="media/image401.svg" /> (<img src="media/image402.svg" />) are given
by</p>
<p><img src="media/image403.svg" /></p>
<p>where</p>
<p><img src="media/image404.svg" />.</p>
<p>The codebooks for 1-4 layers are given respectively in Tables
5.2.2.2.2-3, 5.2.2.2.2-4, 5.2.2.2.2-5, and 5.2.2.2.2-6.</p>
<p>Table 5.2.2.2.2-3: Codebook for 1-layer CSI reporting using antenna
ports 3000 to 2999+<em>P</em><sub>CSI-RS</sub></p>
<table>
<colgroup>
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 31%" />
<col style="width: 11%" />
<col style="width: 16%" />
</colgroup>
<thead>
<tr>
<th colspan="5"><em>codebookMode</em> = 1, <img
src="media/image405.svg" /></th>
</tr>
</thead>
<tbody>
<tr>
<td><img src="media/image308.svg" /></td>
<td><img src="media/image316.svg" /></td>
<td><img src="media/image406.svg" />, <img
src="media/image407.svg" /></td>
<td><img src="media/image230.svg" /></td>
<td></td>
</tr>
<tr>
<td><img src="media/image338.svg" /></td>
<td><img src="media/image319.svg" /></td>
<td><img src="media/image408.svg" /></td>
<td><img src="media/image408.svg" /></td>
<td><img src="media/image409.svg" /></td>
</tr>
<tr>
<td colspan="5">where <img src="media/image410.svg" />.</td>
</tr>
</tbody>
</table>
<table>
<colgroup>
<col style="width: 19%" />
<col style="width: 19%" />
<col style="width: 17%" />
<col style="width: 11%" />
<col style="width: 17%" />
<col style="width: 15%" />
</colgroup>
<thead>
<tr>
<th colspan="6"><em>codebookMode</em> = 2, <img
src="media/image411.svg" /></th>
</tr>
</thead>
<tbody>
<tr>
<td><img src="media/image308.svg" /></td>
<td><img src="media/image316.svg" /></td>
<td><img src="media/image412.svg" /></td>
<td><img src="media/image413.svg" /></td>
<td><img src="media/image414.svg" /></td>
<td></td>
</tr>
<tr>
<td><img src="media/image338.svg" /></td>
<td><img src="media/image319.svg" /></td>
<td><img src="media/image408.svg" /></td>
<td><img src="media/image408.svg" /></td>
<td><img src="media/image415.svg" /></td>
<td><img src="media/image409.svg" /></td>
</tr>
<tr>
<td colspan="6">where <img src="media/image416.svg" />.</td>
</tr>
</tbody>
</table>
<p>Table 5.2.2.2.2-4: Codebook for 2-layer CSI reporting using antenna
ports 3000 to 2999+<em>P</em><sub>CSI-RS</sub></p>
<table>
<colgroup>
<col style="width: 18%" />
<col style="width: 18%" />
<col style="width: 28%" />
<col style="width: 6%" />
<col style="width: 26%" />
</colgroup>
<thead>
<tr>
<th colspan="5"><em>codebookMode</em> = 1, <img
src="media/image405.svg" /></th>
</tr>
</thead>
<tbody>
<tr>
<td><img src="media/image308.svg" /></td>
<td><img src="media/image316.svg" /></td>
<td><img src="media/image406.svg" />, <img
src="media/image407.svg" /></td>
<td><img src="media/image230.svg" /></td>
<td></td>
</tr>
<tr>
<td><img src="media/image338.svg" /></td>
<td><img src="media/image319.svg" /></td>
<td><img src="media/image408.svg" /></td>
<td><img src="media/image417.svg" /></td>
<td><img src="media/image418.svg" /></td>
</tr>
<tr>
<td colspan="5"><p>where <img src="media/image419.svg" /></p>
<p>and the mapping from <img src="media/image170.svg" /> to <img
src="media/image171.svg" /> and <img src="media/image172.svg" /> is
given in Table 5.2.2.2.1-3.</p></td>
</tr>
</tbody>
</table>
<table style="width:100%;">
<colgroup>
<col style="width: 18%" />
<col style="width: 18%" />
<col style="width: 16%" />
<col style="width: 18%" />
<col style="width: 26%" />
</colgroup>
<thead>
<tr>
<th colspan="5"><em>codebookMode</em> = 2, <img
src="media/image411.svg" /></th>
</tr>
</thead>
<tbody>
<tr>
<td><img src="media/image308.svg" /></td>
<td><img src="media/image316.svg" /></td>
<td><img src="media/image412.svg" /></td>
<td><img src="media/image420.svg" /></td>
<td></td>
</tr>
<tr>
<td><img src="media/image338.svg" /></td>
<td><img src="media/image319.svg" /></td>
<td><img src="media/image408.svg" /></td>
<td><img src="media/image417.svg" /></td>
<td><img src="media/image418.svg" /></td>
</tr>
<tr>
<td colspan="5"><p>where <img src="media/image421.svg" /></p>
<p>and the mapping from <img src="media/image170.svg" /> to <img
src="media/image171.svg" /> and <img src="media/image172.svg" /> is
given in Table 5.2.2.2.1-3.</p></td>
</tr>
</tbody>
</table>
<p>Table 5.2.2.2.2-5: Codebook for 3-layer CSI reporting using antenna
ports 3000 to 2999+<em>P</em><sub>CSI-RS</sub></p>
<table>
<colgroup>
<col style="width: 18%" />
<col style="width: 18%" />
<col style="width: 28%" />
<col style="width: 6%" />
<col style="width: 26%" />
</colgroup>
<thead>
<tr>
<th colspan="5"><em>codebookMode</em> = 1, <img
src="media/image405.svg" /></th>
</tr>
</thead>
<tbody>
<tr>
<td><img src="media/image308.svg" /></td>
<td><img src="media/image316.svg" /></td>
<td><img src="media/image406.svg" />, <img
src="media/image407.svg" /></td>
<td><img src="media/image230.svg" /></td>
<td></td>
</tr>
<tr>
<td><img src="media/image338.svg" /></td>
<td><img src="media/image319.svg" /></td>
<td><img src="media/image408.svg" /></td>
<td><img src="media/image417.svg" /></td>
<td><img src="media/image422.svg" /></td>
</tr>
<tr>
<td colspan="5"><p>where <img src="media/image423.svg" /></p>
<p>and the mapping from <img src="media/image170.svg" /> to <img
src="media/image171.svg" /> and <img src="media/image172.svg" /> is
given in Table 5.2.2.2.2-2.</p></td>
</tr>
</tbody>
</table>
<table style="width:100%;">
<colgroup>
<col style="width: 18%" />
<col style="width: 18%" />
<col style="width: 16%" />
<col style="width: 18%" />
<col style="width: 26%" />
</colgroup>
<thead>
<tr>
<th colspan="5"><em>codebookMode</em> = 2, <img
src="media/image411.svg" /></th>
</tr>
</thead>
<tbody>
<tr>
<td><img src="media/image308.svg" /></td>
<td><img src="media/image316.svg" /></td>
<td><img src="media/image412.svg" /></td>
<td><img src="media/image420.svg" /></td>
<td></td>
</tr>
<tr>
<td><img src="media/image338.svg" /></td>
<td><img src="media/image319.svg" /></td>
<td><img src="media/image408.svg" /></td>
<td><img src="media/image417.svg" /></td>
<td><img src="media/image422.svg" /></td>
</tr>
<tr>
<td colspan="5"><p>where <img src="media/image424.svg" /></p>
<p>and the mapping from <img src="media/image170.svg" /> to <img
src="media/image171.svg" /> and <img src="media/image172.svg" /> is
given in Table 5.2.2.2.2-2.</p></td>
</tr>
</tbody>
</table>
<p>Table 5.2.2.2.2-6: Codebook for 4-layer CSI reporting using antenna
ports 3000 to 2999+<em>P</em><sub>CSI-RS</sub></p>
<table>
<colgroup>
<col style="width: 18%" />
<col style="width: 18%" />
<col style="width: 28%" />
<col style="width: 6%" />
<col style="width: 26%" />
</colgroup>
<thead>
<tr>
<th colspan="5"><em>codebookMode</em> = 1, <img
src="media/image405.svg" /></th>
</tr>
</thead>
<tbody>
<tr>
<td><img src="media/image308.svg" /></td>
<td><img src="media/image316.svg" /></td>
<td><img src="media/image406.svg" />, <img
src="media/image407.svg" /></td>
<td><img src="media/image230.svg" /></td>
<td></td>
</tr>
<tr>
<td><img src="media/image338.svg" /></td>
<td><img src="media/image319.svg" /></td>
<td><img src="media/image408.svg" /></td>
<td><img src="media/image417.svg" /></td>
<td><img src="media/image425.svg" /></td>
</tr>
<tr>
<td colspan="5"><p>where <img src="media/image426.svg" /></p>
<p>and the mapping from <img src="media/image170.svg" /> to <img
src="media/image171.svg" /> and <img src="media/image172.svg" /> is
given in Table 5.2.2.2.2-2.</p></td>
</tr>
</tbody>
</table>
<table style="width:100%;">
<colgroup>
<col style="width: 18%" />
<col style="width: 18%" />
<col style="width: 16%" />
<col style="width: 18%" />
<col style="width: 26%" />
</colgroup>
<thead>
<tr>
<th colspan="5"><em>codebookMode</em> = 2, <img
src="media/image411.svg" /></th>
</tr>
</thead>
<tbody>
<tr>
<td><img src="media/image308.svg" /></td>
<td><img src="media/image316.svg" /></td>
<td><img src="media/image412.svg" /></td>
<td><img src="media/image420.svg" /></td>
<td></td>
</tr>
<tr>
<td><img src="media/image338.svg" /></td>
<td><img src="media/image319.svg" /></td>
<td><img src="media/image408.svg" /></td>
<td><img src="media/image417.svg" /></td>
<td><img src="media/image425.svg" /></td>
</tr>
<tr>
<td colspan="5"><p>where <img src="media/image427.svg" /></p>
<p>and the mapping from <img src="media/image170.svg" /> to <img
src="media/image171.svg" /> and <img src="media/image172.svg" /> is
given in Table 5.2.2.2.2-2.</p></td>
</tr>
</tbody>
</table>
<h5 id="type-ii-codebook">5.2.2.2.3 Type II Codebook</h5>
<p>For 4 antenna ports {3000, 3001, …, 3003}, 8 antenna ports {3000,
3001, …, 3007}, 12 antenna ports {3000, 3001, …, 3011}, 16 antenna ports
{3000, 3001, …, 3015}, 24 antenna ports {3000, 3001, …, 3023}, and 32
antenna ports {3000, 3001, …, 3031}, and the UE configured with higher
layer parameter <em>codebookType</em> set to 'typeII'</p>
<p>- The values of <img src="media/image180.svg" />and <img
src="media/image375.svg" /> are configured with the higher layer
parameter <em>n1-n2-codebookSubsetRestriction</em>. The supported
configurations of <img src="media/image182.svg" /> for a given number of
CSI-RS ports and the corresponding values of <img
src="media/image183.svg" /> are given in Table 5.2.2.2.1-2. The number
of CSI-RS ports, <img src="media/image184.svg" />, is <img
src="media/image185.svg" />.</p>
<p>- The value of <img src="media/image428.svg" /> is configured with
the higher layer parameter <em>numberOfBeams</em>, where <img
src="media/image429.svg" /> when <img src="media/image430.svg" /> and
<img src="media/image431.svg" /> when <img
src="media/image432.svg" />.</p>
<p>- The value of <img src="media/image433.svg" /> is configured with
the higher layer parameter <em>phaseAlphabetSize</em>, where <img
src="media/image434.svg" />.</p>
<p>- The UE is configured with the higher layer parameter
<em>subbandAmplitude</em> set to 'true' or 'false'.</p>
<p>- The UE shall not report RI &gt; 2.</p>
<p>When <img src="media/image435.svg" />, where <img
src="media/image162.svg" /> is the associated RI value, each PMI value
corresponds to the codebook indices <img src="media/image383.svg" /> and
<img src="media/image384.svg" /> where</p>
<p><img src="media/image436.svg" />..</p>
<p>The <img src="media/image437.svg" /> vectors combined by the codebook
are identified by the indices <img src="media/image438.svg" /> and <img
src="media/image439.svg" />, where</p>
<p><img src="media/image440.svg" /></p>
<p><img src="media/image441.svg" />.</p>
<p>Let</p>
<p><img src="media/image442.svg" /></p>
<p>and</p>
<p><img src="media/image443.svg" /> .</p>
<p>where the values of <img src="media/image444.svg" /> are given in
Table 5.2.2.2.3-1.</p>
<p>Then the elements of <img src="media/image445.svg" /> and <img
src="media/image446.svg" /> are found from <img
src="media/image447.svg" />using the algorithm:</p>
<blockquote>
<p><img src="media/image448.svg" /></p>
<p>for <img src="media/image449.svg" /></p>
<p>Find the largest <img src="media/image450.svg" /> in Table
5.2.2.2.3-1 such that <img src="media/image451.svg" /></p>
<p><img src="media/image452.svg" /></p>
<p><img src="media/image453.svg" /></p>
<p><img src="media/image454.svg" /></p>
<p><img src="media/image455.svg" /></p>
<p><img src="media/image456.svg" /></p>
</blockquote>
<p>When <img src="media/image445.svg" /> and <img
src="media/image446.svg" /> are known, <img src="media/image439.svg" />
is found using:</p>
<blockquote>
<p><img src="media/image457.svg" /> where the indices <img
src="media/image458.svg" /> are assigned such that <img
src="media/image459.svg" /> increases as <img
src="media/image460.svg" /> increases</p>
<p><img src="media/image461.svg" />, where <img
src="media/image444.svg" /> is given in Table 5.2.2.2.3-1.</p>
</blockquote>
<p>- If <img src="media/image462.svg" />, <img
src="media/image463.svg" /> and <img src="media/image464.svg" /> for
<img src="media/image465.svg" />, and <img src="media/image466.svg" />
is not reported.</p>
<p>- When <img src="media/image467.svg" />, <img
src="media/image468.svg" /> and <img src="media/image469.svg" />, and
<img src="media/image470.svg" /> is not reported.</p>
<p>- When <img src="media/image471.svg" /> and <img
src="media/image472.svg" />, <img src="media/image473.svg" /> and <img
src="media/image474.svg" />, and <img src="media/image470.svg" /> is not
reported.</p>
<p>- When <img src="media/image475.svg" /> and <img
src="media/image472.svg" />, <img src="media/image476.svg" /> and<img
src="media/image477.svg" />, and <img src="media/image470.svg" /> is not
reported.</p>
<p>Table 5.2.2.2.3-1: Combinatorial coefficients <img
src="media/image478.svg" /></p>
<table>
<colgroup>
<col style="width: 16%" />
<col style="width: 21%" />
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
</colgroup>
<thead>
<tr>
<th style="text-align: right;"><p><img src="media/image479.svg" /></p>
<p><img src="media/image480.svg" /></p></th>
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>2</td>
<td>2</td>
<td>1</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>3</td>
<td>3</td>
<td>3</td>
<td>1</td>
<td>0</td>
</tr>
<tr>
<td>4</td>
<td>4</td>
<td>6</td>
<td>4</td>
<td>1</td>
</tr>
<tr>
<td>5</td>
<td>5</td>
<td>10</td>
<td>10</td>
<td>5</td>
</tr>
<tr>
<td>6</td>
<td>6</td>
<td>15</td>
<td>20</td>
<td>15</td>
</tr>
<tr>
<td>7</td>
<td>7</td>
<td>21</td>
<td>35</td>
<td>35</td>
</tr>
<tr>
<td>8</td>
<td>8</td>
<td>28</td>
<td>56</td>
<td>70</td>
</tr>
<tr>
<td>9</td>
<td>9</td>
<td>36</td>
<td>84</td>
<td>126</td>
</tr>
<tr>
<td>10</td>
<td>10</td>
<td>45</td>
<td>120</td>
<td>210</td>
</tr>
<tr>
<td>11</td>
<td>11</td>
<td>55</td>
<td>165</td>
<td>330</td>
</tr>
<tr>
<td>12</td>
<td>12</td>
<td>66</td>
<td>220</td>
<td>495</td>
</tr>
<tr>
<td>13</td>
<td>13</td>
<td>78</td>
<td>286</td>
<td>715</td>
</tr>
<tr>
<td>14</td>
<td>14</td>
<td>91</td>
<td>364</td>
<td>1001</td>
</tr>
<tr>
<td>15</td>
<td>15</td>
<td>105</td>
<td>455</td>
<td>1365</td>
</tr>
</tbody>
</table>
<p>The strongest coefficient on layer <img src="media/image481.svg" />
is identified by <img src="media/image482.svg" />.</p>
<p>The amplitude coefficient indicators <img src="media/image483.svg" />
and <img src="media/image484.svg" /> are</p>
<p><img src="media/image485.svg" /></p>
<p>for <img src="media/image486.svg" />. The mapping from <img
src="media/image487.svg" /> to the amplitude coefficient <img
src="media/image488.svg" /> is given in Table 5.2.2.2.3-2 and the
mapping from <img src="media/image489.svg" /> to the amplitude
coefficient <img src="media/image490.svg" /> is given in Table
5.2.2.2.3-3. The amplitude coefficients are represented by</p>
<p><img src="media/image491.svg" /></p>
<p>for <img src="media/image486.svg" />.</p>
<p>Table 5.2.2.2.3-2: Mapping of elements of <img
src="media/image492.svg" />: <img src="media/image493.svg" /> to <img
src="media/image494.svg" /></p>
<table>
<colgroup>
<col style="width: 31%" />
<col style="width: 68%" />
</colgroup>
<tbody>
<tr>
<td rowspan="2"><img src="media/image495.svg" /></td>
<td rowspan="2"><img src="media/image496.svg" /></td>
</tr>
<tr>
</tr>
<tr>
<td>0</td>
<td><img src="media/image497.svg" /></td>
</tr>
<tr>
<td>1</td>
<td><img src="media/image498.svg" /></td>
</tr>
<tr>
<td>2</td>
<td><img src="media/image499.svg" /></td>
</tr>
<tr>
<td>3</td>
<td><img src="media/image500.svg" /></td>
</tr>
<tr>
<td>4</td>
<td><img src="media/image501.svg" /></td>
</tr>
<tr>
<td>5</td>
<td><img src="media/image502.svg" /></td>
</tr>
<tr>
<td>6</td>
<td><img src="media/image503.svg" /></td>
</tr>
<tr>
<td>7</td>
<td><img src="media/image504.svg" /></td>
</tr>
</tbody>
</table>
<p>Table 5.2.2.2.3-3: Mapping of elements of <img
src="media/image505.svg" />: <img src="media/image506.svg" /> to <img
src="media/image507.svg" /></p>
<table>
<colgroup>
<col style="width: 31%" />
<col style="width: 68%" />
</colgroup>
<tbody>
<tr>
<td rowspan="2"><img src="media/image508.svg" /></td>
<td rowspan="2"><img src="media/image509.svg" /></td>
</tr>
<tr>
</tr>
<tr>
<td>0</td>
<td><img src="media/image503.svg" /></td>
</tr>
<tr>
<td>1</td>
<td><img src="media/image504.svg" /></td>
</tr>
</tbody>
</table>
<p>The phase coefficient indicators are</p>
<p><img src="media/image510.svg" /></p>
<p>for <img src="media/image486.svg" />.</p>
<p>The amplitude and phase coefficient indicators are reported as
follows:</p>
<p>- The indicators <img src="media/image511.svg" />, <img
src="media/image512.svg" />, and <img src="media/image513.svg" /> (<img
src="media/image486.svg" />). <img src="media/image514.svg" />, <img
src="media/image515.svg" />, and <img src="media/image516.svg" /> are
not reported for <img src="media/image486.svg" />.</p>
<p>- The remaining <img src="media/image517.svg" /> elements of <img
src="media/image483.svg" /> (<img src="media/image486.svg" />) are
reported, where <img src="media/image518.svg" />. Let <img
src="media/image519.svg" /> (<img src="media/image520.svg" />) be the
number of elements of <img src="media/image483.svg" /> that satisfy <img
src="media/image521.svg" />.</p>
<p>- The remaining <img src="media/image517.svg" /> elements of <img
src="media/image522.svg" /> and <img src="media/image523.svg" /> (<img
src="media/image486.svg" />) are reported as follows:</p>
<p>- When <em>subbandAmplitude</em> is set to 'false',</p>
<p>- <img src="media/image524.svg" /> for <img
src="media/image525.svg" />, and <img src="media/image526.svg" />. <img
src="media/image523.svg" /> is not reported for <img
src="media/image486.svg" />.</p>
<p>- For <img src="media/image525.svg" />, the elements of <img
src="media/image527.svg" /> corresponding to the coefficients that
satisfy <img src="media/image528.svg" />, <img
src="media/image529.svg" />, as determined by the reported elements of
<img src="media/image530.svg" />, are reported, where <img
src="media/image531.svg" /> and the remaining <img
src="media/image532.svg" /> elements of <img src="media/image533.svg" />
are not reported and are set to <img src="media/image534.svg" />.</p>
<p>- When <em>subbandAmplitude</em> is set to 'true',</p>
<p>- For <img src="media/image525.svg" />, the elements of <img
src="media/image535.svg" /> and <img src="media/image527.svg" />
corresponding to the <img src="media/image536.svg" /> strongest
coefficients (excluding the strongest coefficient indicated by<img
src="media/image537.svg" />), as determined by the corresponding
reported elements of <img src="media/image538.svg" />, are reported,
where <img src="media/image539.svg" />and <img
src="media/image531.svg" />. The values of <img
src="media/image540.svg" /> are given in Table 5.2.2.2.3-4. The
remaining <img src="media/image541.svg" /> elements of <img
src="media/image542.svg" /> are not reported and are set to <img
src="media/image543.svg" />. The elements of <img
src="media/image527.svg" /> corresponding to the <img
src="media/image544.svg" /> weakest non-zero coefficients are reported,
where <img src="media/image545.svg" />. The remaining <img
src="media/image546.svg" /> elements of <img src="media/image547.svg" />
are not reported and are set to <img src="media/image548.svg" />.</p>
<p>- When two elements, <img src="media/image549.svg" /> and <img
src="media/image550.svg" />, of the reported elements of <img
src="media/image551.svg" /> are identical (<img
src="media/image552.svg" />), then element <img
src="media/image553.svg" /> is prioritized to be included in the set of
the <img src="media/image554.svg" /> strongest coefficients for <img
src="media/image555.svg" /> and <img src="media/image556.svg" /> (<img
src="media/image557.svg" />) reporting.</p>
<p>Table 5.2.2.2.3-4: Full resolution subband coefficients when
<em>subbandAmplitude</em> is set to 'true'</p>
<table>
<colgroup>
<col style="width: 20%" />
<col style="width: 79%" />
</colgroup>
<tbody>
<tr>
<td rowspan="2"><img src="media/image558.svg" /></td>
<td rowspan="2"><img src="media/image559.svg" /></td>
</tr>
<tr>
</tr>
<tr>
<td>2</td>
<td>4</td>
</tr>
<tr>
<td>3</td>
<td>4</td>
</tr>
<tr>
<td>4</td>
<td>6</td>
</tr>
</tbody>
</table>
<p>The codebooks for 1-2 layers are given in Table 5.2.2.2.3-5, where
the indices <img src="media/image560.svg" /> and <img
src="media/image561.svg" /> are given by</p>
<p><img src="media/image562.svg" /></p>
<p>for <img src="media/image563.svg" />, and the quantities <img
src="media/image564.svg" />, <img src="media/image176.svg" />, and <img
src="media/image177.svg" /> are given by</p>
<p><img src="media/image565.svg" />.</p>
<p>Table 5.2.2.2.3-5: Codebook for 1-layer and 2-layer CSI reporting
using antenna ports 3000 to 2999+<em>P</em><sub>CSI‑RS</sub></p>
<table>
<colgroup>
<col style="width: 10%" />
<col style="width: 89%" />
</colgroup>
<tbody>
<tr>
<td rowspan="2">Layers</td>
<td rowspan="2"></td>
</tr>
<tr>
</tr>
<tr>
<td><img src="media/image566.svg" /></td>
<td><img src="media/image567.svg" /></td>
</tr>
<tr>
<td><img src="media/image568.svg" /></td>
<td><img src="media/image569.svg" /></td>
</tr>
<tr>
<td colspan="2"><p>where <img src="media/image570.svg" />,</p>
<p>and the mappings from <img src="media/image571.svg" /> to <img
src="media/image572.svg" />, <img src="media/image573.svg" />, <img
src="media/image574.svg" />, <img src="media/image575.svg" />, <img
src="media/image576.svg" />, and <img src="media/image577.svg" /> , and
from<img src="media/image578.svg" /> to <img
src="media/image579.svg" />, <img src="media/image580.svg" />, <img
src="media/image581.svg" /> and <img src="media/image582.svg" /> are as
described above, including the ranges of the constituent indices of <img
src="media/image571.svg" /> and <img
src="media/image578.svg" />.</p></td>
</tr>
</tbody>
</table>
<p>When the UE is configured with higher layer parameter
<em>codebookType</em> set to 'typeII', thebitmap parameter
<em>typeII-RI‑Restriction</em> forms the bit sequence <img
src="media/image583.svg" /> where <img src="media/image134.svg" /> is
the LSB and <img src="media/image584.svg" /> is the MSB. When <img
src="media/image136.svg" /> is zero, <img src="media/image585.svg" />,
PMI and RI reporting are not allowed to correspond to any precoder
associated with <img src="media/image138.svg" /> layers. The bitmap
parameter <em>n1-n2‑codebookSubsetRestriction</em> forms the bit
sequence <img src="media/image586.svg" />where bit sequences <img
src="media/image587.svg" />, and <img src="media/image588.svg" />are
concatenated to form <img src="media/image589.svg" />. To define <img
src="media/image587.svg" /> and <img src="media/image588.svg" />, first
define the <img src="media/image590.svg" /> vector groups <img
src="media/image591.svg" /> as</p>
<p><img src="media/image592.svg" /></p>
<p>for</p>
<p><img src="media/image593.svg" />.</p>
<p>The UE shall be configured with restrictions for 4 vector groups
indicated by <img src="media/image594.svg" /> for <img
src="media/image595.svg" /> and identified by the group indices</p>
<p><img src="media/image596.svg" /></p>
<p>for <img src="media/image597.svg" />, where the indices are assigned
such that <img src="media/image598.svg" /> increases as <img
src="media/image599.svg" /> increases. The remaining vector groups are
not restricted.</p>
<p>- If <img src="media/image462.svg" />, <img
src="media/image600.svg" /> for <img src="media/image601.svg" />, and
<img src="media/image602.svg" /> is empty.</p>
<p>- If <img src="media/image603.svg" />, <img
src="media/image604.svg" /> is the binary representation of the integer
<img src="media/image605.svg" /> where <img src="media/image606.svg" />
is the MSB and <img src="media/image607.svg" /> is the LSB. <img
src="media/image605.svg" />is found using:</p>
<p><img src="media/image608.svg" />,</p>
<blockquote>
<p>where <img src="media/image609.svg" /> is defined in Table
5.2.2.2.3-1. The group indices <img src="media/image610.svg" /> and
indicators <img src="media/image611.svg" /> for <img
src="media/image612.svg" /> may be found from <img
src="media/image613.svg" /> using the algorithm:</p>
<p><img src="media/image448.svg" /></p>
<p>for <img src="media/image614.svg" /></p>
<p>Find the largest <img src="media/image615.svg" /> such that <img
src="media/image616.svg" /></p>
<p><img src="media/image617.svg" /></p>
<p><img src="media/image618.svg" /></p>
<p><img src="media/image619.svg" /></p>
<p><img src="media/image620.svg" /></p>
<p><img src="media/image621.svg" /></p>
</blockquote>
<p>The bit sequence <img src="media/image622.svg" /> is the
concatenation of the bit sequences <img src="media/image623.svg" /> for
<img src="media/image624.svg" />, corresponding to the group indices
<img src="media/image625.svg" />. The bit sequence <img
src="media/image626.svg" /> is defined as</p>
<p><img src="media/image627.svg" /></p>
<p>Bits <img src="media/image628.svg" /> indicate the maximum allowed
amplitude coefficient <img src="media/image629.svg" /> for the vector in
group <img src="media/image630.svg" /> indexed by <img
src="media/image631.svg" />, where the maximum amplitude coefficients
are given in Table 5.2.2.2.3-6. A UE that does not report parameter
<em>amplitudeSubsetRestriction</em> = 'supported' in its capability
signaling is not expected to be configured with <img
src="media/image628.svg" /> = 01 or 10.</p>
<p>Table 5.2.2.2.3-6: Maximum allowed amplitude coefficients for
restricted vectors</p>
<table>
<colgroup>
<col style="width: 62%" />
<col style="width: 37%" />
</colgroup>
<tbody>
<tr>
<td rowspan="2">Bits <img src="media/image632.svg" /></td>
<td rowspan="2">Maximum Amplitude Coefficient <img
src="media/image496.svg" /></td>
</tr>
<tr>
</tr>
<tr>
<td>00</td>
<td><img src="media/image497.svg" /></td>
</tr>
<tr>
<td>01</td>
<td><img src="media/image633.svg" /></td>
</tr>
<tr>
<td>10</td>
<td><img src="media/image634.svg" /></td>
</tr>
<tr>
<td>11</td>
<td><img src="media/image635.svg" /></td>
</tr>
</tbody>
</table>
<h5 id="type-ii-port-selection-codebook">5.2.2.2.4 Type II Port
Selection Codebook</h5>
<p>For 4 antenna ports {3000, 3001, …, 3003}, 8 antenna ports {3000,
3001, …, 3007}, 12 antenna ports {3000, 3001, …, 3011}, 16 antenna ports
{3000, 3001, …, 3015}, 24 antenna ports {3000, 3001, …, 3023}, and 32
antenna ports {3000, 3001, …, 3031}, and the UE configured with higher
layer parameter <em>codebookType</em> set to 'typeII-PortSelection'</p>
<p>- The number of CSI-RS ports is given by <img
src="media/image636.svg" />as configured by higher layer parameter
<em>nrofPorts</em>.</p>
<p>- The value of <img src="media/image428.svg" /> is configured with
the higher layer parameter <em>numberOfBeams</em> , where <img
src="media/image429.svg" /> when <img src="media/image430.svg" /> and
<img src="media/image431.svg" /> when <img
src="media/image432.svg" />.</p>
<p>- The value of <img src="media/image637.svg" /> is configured with
the higher layer parameter <em>portSelectionSamplingSize</em>, where
<img src="media/image638.svg" /> and <img
src="media/image639.svg" />.</p>
<p>- The value of <img src="media/image433.svg" /> is configured with
the higher layer parameter <em>phaseAlphabetSize</em>, where <img
src="media/image434.svg" />.</p>
<p>- The UE is configured with the higher layer parameter
<em>subbandAmplitude</em> set to 'true' or 'false'.</p>
<p>- The UE shall not report RI &gt; 2.</p>
<p>The UE is also configured with the higher layer parameter
<em>typeII-PortSelectionRI‑Restriction</em>. The bitmap parameter
<em>typeII-PortSelectionRI‑Restriction</em> forms the bit sequence <img
src="media/image583.svg" /> where <img src="media/image134.svg" /> is
the LSB and <img src="media/image584.svg" /> is the MSB. When <img
src="media/image136.svg" /> is zero, <img src="media/image585.svg" />,
PMI and RI reporting are not allowed to correspond to any precoder
associated with <img src="media/image138.svg" /> layers.</p>
<p>When <img src="media/image435.svg" />, where <img
src="media/image162.svg" /> is the associated RI value, each PMI value
corresponds to the codebook indices <img src="media/image383.svg" /> and
<img src="media/image384.svg" /> where</p>
<p><img src="media/image640.svg" />.</p>
<p>The <img src="media/image641.svg" /> antenna ports per polarization
are selected by the index <img src="media/image642.svg" />, where</p>
<p><img src="media/image643.svg" />.</p>
<p>The strongest coefficient on layer <img src="media/image481.svg" />
is identified by <img src="media/image482.svg" />.</p>
<p>The amplitude coefficient indicators <img src="media/image483.svg" />
and <img src="media/image484.svg" /> are</p>
<p><img src="media/image485.svg" /></p>
<p>for <img src="media/image486.svg" />. The mapping from <img
src="media/image487.svg" /> to the amplitude coefficient <img
src="media/image488.svg" /> is given in Table 5.2.2.2.3-2 and the
mapping from <img src="media/image489.svg" /> to the amplitude
coefficient <img src="media/image490.svg" /> is given in Table
5.2.2.2.3-3. The amplitude coefficients are represented by</p>
<p><img src="media/image491.svg" /></p>
<p>for <img src="media/image486.svg" />.</p>
<p>The phase coefficient indicators are</p>
<p><img src="media/image510.svg" /></p>
<p>for <img src="media/image486.svg" />.</p>
<p>The amplitude and phase coefficient indicators are reported as
follows:</p>
<p>- The indicators <img src="media/image511.svg" />, <img
src="media/image512.svg" />, and <img src="media/image513.svg" /> (<img
src="media/image486.svg" />). <img src="media/image514.svg" />, <img
src="media/image515.svg" />, and <img src="media/image516.svg" /> are
not reported for <img src="media/image486.svg" />.</p>
<p>- The remaining <img src="media/image517.svg" /> elements of <img
src="media/image644.svg" /> (<img src="media/image486.svg" />) are
reported, where <img src="media/image518.svg" />. Let <img
src="media/image519.svg" /> (<img src="media/image520.svg" />) be the
number of elements of <img src="media/image645.svg" />that satisfy <img
src="media/image521.svg" />.</p>
<p>- The remaining <img src="media/image517.svg" /> elements of <img
src="media/image522.svg" /> and <img src="media/image523.svg" /> (<img
src="media/image486.svg" />) are reported as follows:</p>
<p>- When <em>subbandAmplitude</em> is set to 'false',</p>
<p>- <img src="media/image524.svg" /> for <img
src="media/image525.svg" />, and <img src="media/image526.svg" />. <img
src="media/image523.svg" /> is not reported for <img
src="media/image486.svg" />.</p>
<p>- For <img src="media/image525.svg" />, the <img
src="media/image646.svg" /> elements of <img src="media/image527.svg" />
corresponding to the coefficients that satisfy <img
src="media/image528.svg" />, <img src="media/image529.svg" />, as
determined by the reported elements of <img src="media/image530.svg" />,
are reported, where <img src="media/image531.svg" /> and the remaining
<img src="media/image532.svg" /> elements of <img
src="media/image533.svg" /> are not reported and are set to <img
src="media/image534.svg" />.</p>
<p>- When <em>subbandAmplitude</em> is set to 'true',</p>
<p>- For <img src="media/image525.svg" />, the elements of <img
src="media/image535.svg" /> and <img src="media/image527.svg" />
corresponding to the <img src="media/image536.svg" /> strongest
coefficients (excluding the strongest coefficient indicated by<img
src="media/image537.svg" />), as determined by the corresponding
reported elements of <img src="media/image538.svg" />, are reported,
where <img src="media/image539.svg" />and <img
src="media/image531.svg" />. The values of <img
src="media/image540.svg" /> are given in Table 5.2.2.2.3-4. The
remaining <img src="media/image647.svg" /> elements of <img
src="media/image542.svg" /> are not reported and are set to <img
src="media/image543.svg" />. The elements of <img
src="media/image527.svg" /> corresponding to the <img
src="media/image544.svg" /> weakest non-zero coefficients are reported,
where <img src="media/image545.svg" />. The remaining <img
src="media/image648.svg" /> elements of <img src="media/image547.svg" />
are not reported and are set to <img src="media/image548.svg" />.</p>
<p>- When two elements, <img src="media/image549.svg" /> and <img
src="media/image550.svg" />, of the reported elements of <img
src="media/image551.svg" /> are identical (<img
src="media/image552.svg" />), then element <img
src="media/image553.svg" /> is prioritized to be included in the set of
the <img src="media/image554.svg" /> strongest coefficients for <img
src="media/image555.svg" /> and <img src="media/image556.svg" /> (<img
src="media/image557.svg" />) reporting.</p>
<p>The codebooks for 1-2 layers are given in Table 5.2.2.2.4-1, where
the quantity <img src="media/image564.svg" /> is given by</p>
<p><img src="media/image649.svg" /></p>
<p>and <img src="media/image650.svg" /> is a <img
src="media/image651.svg" />-element column vector containing a value of
1 in element <img src="media/image652.svg" /> and zeros elsewhere (where
the first element is element 0).</p>
<p>Table 5.2.2.2.4-1: Codebook for 1-layer and 2-layer CSI reporting
using antenna ports 3000 to 2999+<em>P</em><sub>CSI‑RS</sub></p>
<table>
<colgroup>
<col style="width: 13%" />
<col style="width: 86%" />
</colgroup>
<tbody>
<tr>
<td rowspan="2">Layers</td>
<td rowspan="2"></td>
</tr>
<tr>
</tr>
<tr>
<td><img src="media/image566.svg" /></td>
<td><img src="media/image653.svg" /></td>
</tr>
<tr>
<td><img src="media/image568.svg" /></td>
<td><img src="media/image654.svg" /></td>
</tr>
<tr>
<td colspan="2"><p>where <img src="media/image655.svg" />,</p>
<p>and the mappings from <img src="media/image571.svg" /> to <img
src="media/image656.svg" />, <img src="media/image576.svg" />, and <img
src="media/image657.svg" /> and from<img src="media/image578.svg" /> to
<img src="media/image579.svg" />, <img src="media/image580.svg" />, <img
src="media/image581.svg" />, and <img src="media/image582.svg" /> are as
described above, including the ranges of the constituent indices of <img
src="media/image571.svg" /> and <img
src="media/image578.svg" />.</p></td>
</tr>
</tbody>
</table>
<h5 id="enhanced-type-ii-codebook">5.2.2.2.5 Enhanced Type II
Codebook</h5>
<p>For 4 antenna ports {3000, 3001, …, 3003}, 8 antenna ports {3000,
3001, …, 3007}, 12 antenna ports {3000, 3001, …, 3011}, 16 antenna ports
{3000, 3001, …, 3015}, 24 antenna ports {3000, 3001, …, 3023}, and 32
antenna ports {3000, 3001, …, 3031}, and UE configured with higher layer
parameter <em>codebookType</em> set to ' typeII-r16'</p>
<p>- The values of <span class="math inline">\(N_{1}\)</span> and <span
class="math inline">\(N_{2}\)</span> are configured with the higher
layer parameter <em>n1-n2-codebookSubsetRestriction-r16</em>. The
supported configurations of <span class="math inline">\(\left(
N_{1},N_{2} \right)\)</span> for a given number of CSI-RS ports and the
corresponding values of <span class="math inline">\(\left( O_{1},O_{2}
\right)\)</span> are given in Table 5.2.2.2.1-2. The number of CSI-RS
ports, <span class="math inline">\(P_{CSI - RS}\)</span>, is <span
class="math inline">\(2N_{1}N_{2}\)</span>.</p>
<p>- The values of <span class="math inline">\(L\)</span>, <span
class="math inline">\(\beta\)</span> and <span
class="math inline">\(p_{\upsilon}\)</span> are determined by the higher
layer parameter <em>paramCombination-r16</em>, where the mapping is
given in Table 5.2.2.2.5-1.</p>
<p>- The UE is not expected to be configured with
<em>paramCombination-r16</em> equal to</p>
<p>- 3, 4, 5, 6, 7, or 8 when <span class="math inline">\(P_{CSI - RS} =
4\)</span>,</p>
<p>- 7 or 8 when <span class="math inline">\(P_{CSI - RS} &lt;
32\)</span></p>
<p>- 7 or 8 when higher layer parameter
t<em>ypeII-RI-Restriction-r16</em> is configured with <span
class="math inline">\(r_{i} = 1\)</span> for any <span
class="math inline">\(i &gt; 1\)</span>.</p>
<p>- 7 or 8 when <span class="math inline">\(R = 2\)</span>.</p>
<p>- The parameter <span class="math inline">\(R\)</span> is configured
with the higher-layer parameter
<em>numberOfPMI-SubbandsPerCQI-Subband</em>. This parameter controls the
total number of precoding matrices <span
class="math inline">\(N_{3}\)</span> indicated by the PMI as a function
of the number of configured subbands in <em>csi-ReportingBand</em>, the
subband size configured by the higher-level parameter
<em>subbandSize</em> and of the total number of PRBs in the bandwidth
part according to Table 5.2.1.4-2, as follows:</p>
<p>- When <span class="math inline">\(R = 1\)</span>:</p>
<p>- One precoding matrix is indicated by the PMI for each subband in
<em>csi-ReportingBand</em>.</p>
<p>- When <span class="math inline">\(R = 2\)</span>:</p>
<p>- For each subband in <em>csi-ReportingBand</em> that is not the
first or last subband of a BWP, two precoding matrices are indicated by
the PMI: the first precoding matrix corresponds to the first <span
class="math inline">\(N_{PRB}^{SB}/2\)</span> PRBs of the subband and
the second precoding matrix corresponds to the last <span
class="math inline">\(N_{PRB}^{SB}/2\)</span> PRBs of the subband.</p>
<p>- For each subband in <em>csi-ReportingBand</em> that is the first or
last subband of a BWP</p>
<p>- If <span class="math inline">\(\left( N_{BWP,i}^{start}\ mod\
N_{PRB}^{SB} \right) \geq \frac{N_{PRB}^{SB}}{2}\)</span>, one precoding
matrix is indicated by the PMI corresponding to the first subband. If
<span class="math inline">\(\left( N_{BWP,i}^{start}\ mod\ N_{PRB}^{SB}
\right) &lt; \frac{N_{PRB}^{SB}}{2}\)</span>, two precoding matrices are
indicated by the PMI corresponding to the first subband: the first
precoding matrix corresponds to the first <span
class="math inline">\(\frac{N_{PRB}^{SB}}{2} - \left( N_{BWP,i}^{start}\
mod\ N_{PRB}^{SB} \right)\)</span> PRBs of the first subband and the
second precoding matrix corresponds to the last <span
class="math inline">\(\frac{N_{PRB}^{SB}}{2}\)</span> PRBs of the first
subband.</p>
<p>- If <span class="math inline">\(1 + \left( N_{BWP,i}^{start} +
N_{BWP,i}^{size} - 1 \right){mod\ N}_{PRB}^{SB} \leq
\frac{N_{PRB}^{SB}}{2}\)</span>, one precoding matrix is indicated by
the PMI corresponding to the last subband. If <span
class="math inline">\(1 + \left( N_{BWP,i}^{start} + N_{BWP,i}^{size} -
1 \right){mod\ N}_{PRB}^{SB} &gt; \frac{N_{PRB}^{SB}}{2}\)</span>, two
precoding matrices are indicated by the PMI corresponding to the last
subband: the first precoding matrix corresponds to the first <span
class="math inline">\(\frac{N_{PRB}^{SB}}{2}\)</span> PRBs of the last
subband and the second precoding matrix corresponds to the last <span
class="math inline">\(1 + \left( N_{BWP,i}^{start} + N_{BWP,i}^{size} -
1 \right){mod\ N}_{PRB}^{SB} - \frac{N_{PRB}^{SB}}{2}\)</span> PRBs of
the last subband.</p>
<p>Table 5.2.2.2.5-1: Codebook parameter configurations for <span
class="math inline">\(\mathbf{L,\ }\)</span> <span
class="math inline">\(\mathbf{\beta}\)</span> and <span
class="math inline">\(\mathbf{p}_{\mathbf{\upsilon}}\)</span></p>
<table>
<colgroup>
<col style="width: 28%" />
<col style="width: 10%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 10%" />
</colgroup>
<thead>
<tr>
<th rowspan="2"
style="text-align: center;"><em>paramCombination-r16</em></th>
<th rowspan="2" style="text-align: center;"><span
class="math display">\[L\]</span></th>
<th colspan="2" style="text-align: center;"><span
class="math display">\[p_{\upsilon}\]</span></th>
<th rowspan="2" style="text-align: center;"><span
class="math display">\[\beta\]</span></th>
</tr>
<tr>
<th style="text-align: center;"><span
class="math display">\[\upsilon\  \in \left\{ 1,2 \right\}\]</span></th>
<th style="text-align: center;"><span
class="math display">\[\upsilon\  \in \left\{ 3,4 \right\}\]</span></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">1</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">¼</td>
<td style="text-align: center;">1/8</td>
<td style="text-align: center;">¼</td>
</tr>
<tr>
<td style="text-align: center;">2</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">¼</td>
<td style="text-align: center;">1/8</td>
<td style="text-align: center;">½</td>
</tr>
<tr>
<td style="text-align: center;">3</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">¼</td>
<td style="text-align: center;">1/8</td>
<td style="text-align: center;">¼</td>
</tr>
<tr>
<td style="text-align: center;">4</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">¼</td>
<td style="text-align: center;">1/8</td>
<td style="text-align: center;">½</td>
</tr>
<tr>
<td style="text-align: center;">5</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">¼</td>
<td style="text-align: center;">¼</td>
<td style="text-align: center;">¾</td>
</tr>
<tr>
<td style="text-align: center;">6</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">½</td>
<td style="text-align: center;">¼</td>
<td style="text-align: center;">½</td>
</tr>
<tr>
<td style="text-align: center;">7</td>
<td style="text-align: center;">6</td>
<td style="text-align: center;">¼</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">½</td>
</tr>
<tr>
<td style="text-align: center;">8</td>
<td style="text-align: center;">6</td>
<td style="text-align: center;">¼</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">¾</td>
</tr>
</tbody>
</table>
<p>- The UE shall report the RI value <span
class="math inline">\(\upsilon\)</span> according to the configured
higher layer parameter <em>typeII-RI-Restriction-r16</em>. The UE shall
not report <span class="math inline">\(\upsilon &gt; 4\)</span>.</p>
<p>The PMI value corresponds to the codebook indices of <img
src="media/image571.svg" /> and <img src="media/image578.svg" />
where</p>
<p><span class="math display">\[\begin{matrix}
i_{1} = \left\{ \begin{matrix}
\begin{matrix}
\begin{bmatrix}
\begin{matrix}
i_{1,1} &amp; i_{1,2} &amp; i_{1,5}
\end{matrix} &amp; \begin{matrix}
i_{1,6,1} &amp; i_{1,7,1} &amp; i_{1,8,1}
\end{matrix}
\end{bmatrix} &amp; \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \upsilon = 1 \\
\left\lbrack \begin{matrix}
i_{1,1} &amp; i_{1,2}
\end{matrix}\ \ \ \ \ \begin{matrix}
i_{1,5} &amp; i_{1,6,1} &amp; i_{1,7,1}
\end{matrix}\ \ \ \ \begin{matrix}
i_{1,8,1} &amp; i_{1,6,2}\ \ \ \ \ i_{1,7,2}\ \ \ \ \ i_{1,8,2}
\end{matrix} \right\rbrack &amp; \upsilon = 2
\end{matrix} \\
\begin{matrix}
\left\lbrack \begin{matrix}
i_{1,1} &amp; i_{1,2}
\end{matrix}\ \ \ \ \ \begin{matrix}
i_{1,5} &amp; i_{1,6,1} &amp; i_{1,7,1}
\end{matrix}\ \ \ \ \begin{matrix}
i_{1,8,1} &amp; i_{1,6,2}\ \ \ \ \ i_{1,7,2}\ \ \ \ \ i_{1,8,2}\ \ \ \ \
i_{1,6,3}
\end{matrix}\ \ \ \ \ i_{1,7,3}\ \ \ \ \ i_{1,8,3} \right\rbrack &amp; \
\ \ \upsilon = 3 \\
\left\lbrack \begin{matrix}
i_{1,1} &amp; i_{1,2}
\end{matrix}\ \ \ \ \ \begin{matrix}
i_{1,5} &amp; i_{1,6,1} &amp; i_{1,7,1}
\end{matrix}\ \ \ \ \begin{matrix}
i_{1,8,1} &amp; i_{1,6,2} &amp; i_{1,7,2}
\end{matrix}\ \ \ \ \ i_{1,8,2}\ \ \ \ \ \begin{matrix}
i_{1,6,3} &amp; i_{1,7,3} &amp; i_{1,8,3}\ \ \ \ \ \begin{matrix}
i_{1,6,4} &amp; i_{1,7,4}\ \ \ \ \ i_{1,8,4}
\end{matrix}
\end{matrix} \right\rbrack &amp; \upsilon = 4
\end{matrix}
\end{matrix} \right.\  \\
i_{2} = \left\{ \begin{matrix}
\begin{matrix}
\begin{bmatrix}
i_{2,3,1} &amp; i_{2,4,1} &amp; i_{2,5,1}
\end{bmatrix} &amp; \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \upsilon = 1 \\
\left\lbrack \begin{matrix}
i_{2,3,1} &amp; i_{2,4,1} &amp; i_{2,5,1}
\end{matrix}\ \ \ \ \begin{matrix}
i_{2,3,2} &amp; i_{2,4,2} &amp; i_{2,5,2}
\end{matrix} \right\rbrack &amp; \upsilon = 2
\end{matrix} \\
\begin{matrix}
\left\lbrack \begin{matrix}
i_{2,3,1} &amp; i_{2,4,1} &amp; i_{2,5,1}
\end{matrix}\ \ \ \ \begin{matrix}
i_{2,3,2} &amp; i_{2,4,2} &amp; i_{2,5,2}
\end{matrix}\ \ \ \ \begin{matrix}
i_{2,3,3} &amp; i_{2,4,3} &amp; i_{2,5,3}
\end{matrix} \right\rbrack &amp; \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \upsilon = 3 \\
\left\lbrack \begin{matrix}
i_{2,3,1} &amp; i_{2,4,1} &amp; i_{2,5,1}
\end{matrix}\ \ \ \ \begin{matrix}
i_{2,3,2} &amp; i_{2,4,2} &amp; i_{2,5,2}
\end{matrix}\ \ \ \ \begin{matrix}
i_{2,3,3} &amp; i_{2,4,3} &amp; i_{2,5,3}
\end{matrix}\ \ \ \ \ \begin{matrix}
i_{2,3,4} &amp; i_{2,4,4} &amp; i_{2,5,4}
\end{matrix} \right\rbrack &amp; \upsilon = 4
\end{matrix}
\end{matrix} \right.\
\end{matrix}\]</span></p>
<p>The precoding matrices indicated by the PMI are determined from <span
class="math inline">\(L + M_{\upsilon}\)</span> vectors.</p>
<p><span class="math inline">\(L\)</span> vectors, <span
class="math inline">\(v_{m_{1}^{(i)},m_{2}^{(i)}},i = 0,1,\ldots,L -
1\)</span>, are identified by the indices <span
class="math inline">\(q_{1},q_{2},\ n_{1}\)</span>, <span
class="math inline">\(n_{2}\)</span>, indicated by <span
class="math inline">\(i_{1,1}\)</span>, <span
class="math inline">\(i_{1,2}\)</span>, obtained as in 5.2.2.2.3, where
the values of <span class="math inline">\(C(x,y)\)</span> are given in
Table 5.2.2.2.5-4.</p>
<p><span class="math inline">\(M_{\upsilon} = \left\lceil
p_{\upsilon}\frac{N_{3}}{R} \right\rceil\)</span> vectors, <span
class="math inline">\(\left\lbrack
y_{0,l}^{(f)},y_{1,l}^{(f)},\ldots,y_{N_{3} - 1,l}^{(f)}
\right\rbrack^{T}\)</span>, <span class="math inline">\(f =
0,1,\ldots,M_{\upsilon} - 1\)</span>, are identified by <span
class="math inline">\(M_{initial}\)</span> (for <span
class="math inline">\(N_{3} &gt; 19\)</span>) and <span
class="math inline">\(n_{3,l}\ (l = 1,\ldots,\ \upsilon)\
\)</span>where</p>
<p><span class="math display">\[M_{initial} \in \left\{ - 2M_{\upsilon}
+ 1, - 2M_{\upsilon} + 2,\ldots,0 \right\}\]</span></p>
<p><span class="math display">\[n_{3,l} = \left\lbrack
n_{3,l}^{(0)},\ldots,n_{3,l}^{(M_{\upsilon} - 1)}
\right\rbrack\]</span></p>
<p><span class="math display">\[{\ n}_{3,l}^{(f)} \in \left\{
0,1,\ldots,N_{3} - 1 \right\}\]</span></p>
<p>which are indicated by means of the indices <span
class="math inline">\(i_{1,5}\)</span> (for <span
class="math inline">\(N_{3} &gt; 19\)</span>) and <span
class="math inline">\(i_{1,6,l}\)</span> <span
class="math inline">\(\left( for\ M_{\upsilon} &gt; 1\ and\ l =
1,\ldots,\ \upsilon \right)\)</span>, where</p>
<p><span class="math display">\[i_{1,5} \in \left\{
0,1,\ldots,2M_{\upsilon} - 1 \right\}\]</span></p>
<p><span class="math display">\[{\ i}_{1,6,l} \in \left\{ \begin{matrix}
\left\{ 0,1,\ldots,\begin{pmatrix}
N_{3} - 1 \\
M_{\upsilon} - 1
\end{pmatrix} - 1 \right\} &amp; N_{3} \leq 19 \\
\left\{ 0,1,\ldots,\begin{pmatrix}
2M_{\upsilon} - 1 \\
M_{\upsilon} - 1
\end{pmatrix} - 1 \right\} &amp; N_{3} &gt; 19
\end{matrix} \right.\ \]</span></p>
<p>The amplitude coefficient indicators <span
class="math inline">\(i_{2,3,l}\)</span> and <span
class="math inline">\(i_{2,4,l}\)</span> are</p>
<p><span class="math display">\[i_{2,3,l} = \begin{bmatrix}
k_{l,0}^{(1)} &amp; k_{l,1}^{(1)}
\end{bmatrix}\]</span></p>
<p><span class="math display">\[i_{2,4,l} = \left\lbrack
k_{l,0}^{(2)}\ldots k_{l,M_{\upsilon} - 1}^{(2)}
\right\rbrack\]</span></p>
<p><span class="math display">\[k_{l,f}^{(2)} = \left\lbrack
k_{l,0,f}^{(2)}\ldots k_{l,2L - 1,f}^{(2)} \right\rbrack\]</span></p>
<p><span class="math display">\[k_{l,p}^{(1)} \in \left\{ 1,\ldots,15
\right\}\]</span></p>
<p><span class="math display">\[k_{l,i,f}^{(2)} \in \left\{ 0,\ldots,7
\right\}\]</span></p>
<p>for <span class="math inline">\(l = 1,\ldots,\upsilon\)</span>.</p>
<p>The phase coefficient indicator <span
class="math inline">\(i_{2,5,l}\ \)</span>is</p>
<p><span class="math display">\[i_{2,5,l} = \left\lbrack c_{l,0}\ldots
c_{l,M_{\upsilon} - 1} \right\rbrack\]</span></p>
<p><span class="math display">\[c_{l,f} = \left\lbrack c_{l,0,f}\ldots
c_{l,2L - 1,f} \right\rbrack\]</span></p>
<p><span class="math display">\[c_{l,i,f} \in \left\{ 0,\ldots,15
\right\}\]</span></p>
<p>for <span class="math inline">\(l = 1,\ldots,\upsilon.\)</span></p>
<p>Let <span class="math inline">\(K_{0} = \left\lceil \beta 2LM_{1}
\right\rceil\)</span>. The bitmap whose nonzero bits identify which
coefficients in <span class="math inline">\(i_{2,4,l}\)</span> and <span
class="math inline">\(i_{2,5,l}\ \)</span>are reported, is indicated by
<span class="math inline">\(i_{1,7,l}\)</span></p>
<p><span class="math display">\[i_{1,7,l} = \left\lbrack
k_{l,0}^{(3)}\ldots k_{l,M_{\upsilon} - 1}^{(3)}
\right\rbrack\]</span></p>
<p><span class="math display">\[k_{l,f}^{(3)} = \left\lbrack
k_{l,0,f}^{(3)}\ldots k_{l,2L - 1,f}^{(3)} \right\rbrack\]</span></p>
<p><span class="math display">\[k_{l,i,f}^{(3)} \in \left\{ 0,1
\right\}\]</span></p>
<p>for <span class="math inline">\(l = 1,\ldots,\upsilon\)</span>, such
that <span class="math inline">\(K_{l}^{NZ} = \sum_{i = 0}^{2L -
1}{\sum_{f = 0}^{M_{\upsilon} - 1}k_{l,i,f}^{(3)}} \leq K_{0}\)</span>
is the number of nonzero coefficients for layer <span
class="math inline">\(l = 1,\ldots,\upsilon\)</span> and <span
class="math inline">\(K^{NZ} = \sum_{l = 1}^{\upsilon}K_{l}^{NZ} \leq
2K_{0}\)</span> is the total number of nonzero coefficients.</p>
<p>The indices of <span class="math inline">\(i_{2,4,l}\)</span>, <span
class="math inline">\(i_{2,5,l}\)</span> and <span
class="math inline">\(i_{1,7,l}\)</span> are associated to the <span
class="math inline">\(M_{\upsilon}\)</span> codebook indices in <span
class="math inline">\(n_{3,l}\)</span>.</p>
<p>The mapping from <span class="math inline">\(k_{l,p}^{(1)}\)</span>
to the amplitude coefficient <span
class="math inline">\(p_{l,p}^{(1)}\)</span> is given in Table
5.2.2.2.5-2 and the mapping from <span
class="math inline">\(k_{l,i,f}^{(2)}\)</span> to the amplitude
coefficient <span class="math inline">\(p_{l,i,f}^{(2)}\)</span> is
given in Table 5.2.2.2.5-3. The amplitude coefficients are represented
by</p>
<p><span class="math display">\[p_{l}^{(1)} = \begin{bmatrix}
p_{l,0}^{(1)} &amp; p_{l,1}^{(1)}
\end{bmatrix}\]</span></p>
<p><span class="math display">\[p_{l}^{(2)} = \left\lbrack
p_{l,0}^{(2)}\ldots p_{l,M_{\upsilon} - 1}^{(2)}
\right\rbrack\]</span></p>
<p><span class="math display">\[p_{l,f}^{(2)} = \left\lbrack
p_{l,0,f}^{(2)}\ldots p_{l,2L - 1,f}^{(2)} \right\rbrack\]</span></p>
<p>for<span class="math inline">\(\ l = 1,\ldots,\upsilon\)</span>.</p>
<p>Let <span class="math inline">\(f_{l}^{*} \in \left\{
0,1,\ldots,M_{\upsilon} - 1 \right\}\)</span> be the index of <span
class="math inline">\(i_{2,4,l}\)</span> and <span
class="math inline">\(i_{l}^{*} \in \left\{ 0,1,\ldots,2L - 1
\right\}\)</span> be the index of <span
class="math inline">\(k_{l,f_{l}^{*}}^{(2)}\)</span> which identify the
strongest coefficient of layer <span class="math inline">\(l\)</span>,
i.e., the element <span
class="math inline">\(k_{l,i_{l}^{*},f_{l}^{*}}^{(2)}\)</span> of <span
class="math inline">\(i_{2,4,l}\)</span>, for <span
class="math inline">\(\ l = 1,\ldots,\upsilon\)</span>. The codebook
indices of <span class="math inline">\(n_{3,l}\)</span><span
class="math inline">\(k_{m_{i}}\)</span> are remapped with respect to
<span class="math inline">\(n_{3,l}^{(f_{l}^{*})}\)</span> as <span
class="math inline">\(n_{3,l}^{(f)} = \left( n_{3,l}^{(f)} -
n_{3,l}^{(f_{l}^{*})} \right)mod\ N_{3}\)</span><span
class="math inline">\({\widetilde{k}}_{m_{i}^{*}} = 0\)</span>, such
that <span class="math inline">\(n_{3,l}^{(f_{l}^{*})} = 0\)</span>,
after remapping. The index <span class="math inline">\(f\)</span> is
remapped with respect to <span class="math inline">\(f_{l}^{*}\)</span>
as <span class="math inline">\(f = \left( f - f_{l}^{*} \right)mod\
M_{\upsilon}\)</span>, such that the index of the strongest coefficient
is <span class="math inline">\(f_{l}^{*} = 0\)</span> (<span
class="math inline">\(l = 1,\ldots,\upsilon\)</span>), after remapping.
The indices of <span class="math inline">\(i_{2,4,l}\)</span>, <span
class="math inline">\(i_{2,5,l}\)</span> and <span
class="math inline">\(i_{1,7,l}\)</span> indicate amplitude
coefficients, phase coefficients and bitmap after remapping.</p>
<p>The strongest coefficient of layer <span
class="math inline">\(l\)</span> is identified by <span
class="math inline">\(i_{1,8,l} \in \left\{ 0,1,\ldots,2L - 1
\right\}\)</span>, which is obtained as follows</p>
<p><span class="math inline">\(i_{1,8,l} = \left\{ \begin{matrix}
\sum_{i = 0}^{i_{1}^{*}}k_{1,i,0}^{(3)} - 1 &amp; \upsilon\mathbf{=}1 \\
i_{l}^{*} &amp; 1 &lt; \upsilon\mathbf{\leq}4
\end{matrix} \right.\ \ \)</span></p>
<p>for <span class="math inline">\(l = 1,\ldots,\ \upsilon\)</span>.</p>
<p>Table 5.2.2.2.5-2: Mapping of elements of <span
class="math inline">\(\mathbf{i}_{\mathbf{2,3,l}}\)</span>: <span
class="math inline">\(\mathbf{k}_{\mathbf{l,p}}^{\mathbf{(1)}}\)</span>
to <span
class="math inline">\(\mathbf{p}_{\mathbf{l,p}}^{\mathbf{(1)}}\)</span></p>
<table>
<colgroup>
<col style="width: 29%" />
<col style="width: 20%" />
<col style="width: 29%" />
<col style="width: 20%" />
</colgroup>
<thead>
<tr>
<th><table>
<colgroup>
<col style="width: 34%" />
<col style="width: 65%" />
</colgroup>
<thead>
<tr>
<th rowspan="2" style="text-align: center;"><span
class="math display">\[\mathbf{k}_{\mathbf{l,p}}^{\mathbf{(1)}}\]</span></th>
<th rowspan="2" style="text-align: center;"><span
class="math display">\[\mathbf{p}_{\mathbf{l,p}}^{\mathbf{(1)}}\]</span></th>
</tr>
<tr>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">0</td>
<td style="text-align: center;">Reserved</td>
</tr>
<tr>
<td style="text-align: center;">1</td>
<td style="text-align: center;"><span
class="math display">\[\frac{1}{\sqrt{128}}\]</span></td>
</tr>
<tr>
<td style="text-align: center;">2</td>
<td style="text-align: center;"><span class="math display">\[\left(
\frac{1}{8192} \right)^{1/4}\]</span></td>
</tr>
<tr>
<td style="text-align: center;">3</td>
<td style="text-align: center;"><span
class="math display">\[\frac{1}{8}\]</span></td>
</tr>
</tbody>
</table></th>
<th><table>
<colgroup>
<col style="width: 34%" />
<col style="width: 65%" />
</colgroup>
<thead>
<tr>
<th rowspan="2" style="text-align: center;"><span
class="math display">\[\mathbf{k}_{\mathbf{l,p}}^{\mathbf{(1)}}\]</span></th>
<th rowspan="2" style="text-align: center;"><span
class="math display">\[\mathbf{p}_{\mathbf{l,p}}^{\mathbf{(1)}}\]</span></th>
</tr>
<tr>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">4</td>
<td style="text-align: center;"><span class="math display">\[\left(
\frac{1}{2048} \right)^{1/4}\]</span></td>
</tr>
<tr>
<td style="text-align: center;">5</td>
<td style="text-align: center;"><span
class="math display">\[\frac{1}{2\sqrt{8}}\]</span></td>
</tr>
<tr>
<td style="text-align: center;">6</td>
<td style="text-align: center;"><span class="math display">\[\left(
\frac{1}{512} \right)^{1/4}\]</span></td>
</tr>
<tr>
<td style="text-align: center;">7</td>
<td style="text-align: center;"><span
class="math display">\[\frac{1}{4}\]</span></td>
</tr>
</tbody>
</table></th>
<th><table>
<colgroup>
<col style="width: 34%" />
<col style="width: 65%" />
</colgroup>
<thead>
<tr>
<th rowspan="2" style="text-align: center;"><span
class="math display">\[\mathbf{k}_{\mathbf{l,p}}^{\mathbf{(1)}}\]</span></th>
<th rowspan="2" style="text-align: center;"><span
class="math display">\[\mathbf{p}_{\mathbf{l,p}}^{\mathbf{(1)}}\]</span></th>
</tr>
<tr>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">8</td>
<td style="text-align: center;"><span class="math display">\[\left(
\frac{1}{128} \right)^{1/4}\]</span></td>
</tr>
<tr>
<td style="text-align: center;">9</td>
<td style="text-align: center;"><span
class="math display">\[\frac{1}{\sqrt{8}}\]</span></td>
</tr>
<tr>
<td style="text-align: center;">10</td>
<td style="text-align: center;"><span class="math display">\[\left(
\frac{1}{32} \right)^{1/4}\]</span></td>
</tr>
<tr>
<td style="text-align: center;">11</td>
<td style="text-align: center;"><span
class="math display">\[\frac{1}{2}\]</span></td>
</tr>
</tbody>
</table></th>
<th><table>
<colgroup>
<col style="width: 34%" />
<col style="width: 65%" />
</colgroup>
<thead>
<tr>
<th rowspan="2" style="text-align: center;"><span
class="math display">\[\mathbf{k}_{\mathbf{l,p}}^{\mathbf{(1)}}\]</span></th>
<th rowspan="2" style="text-align: center;"><span
class="math display">\[\mathbf{p}_{\mathbf{l,p}}^{\mathbf{(1)}}\]</span></th>
</tr>
<tr>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">12</td>
<td style="text-align: center;"><span class="math display">\[\left(
\frac{1}{8} \right)^{1/4}\]</span></td>
</tr>
<tr>
<td style="text-align: center;">13</td>
<td style="text-align: center;"><span
class="math display">\[\frac{1}{\sqrt{2}}\]</span></td>
</tr>
<tr>
<td style="text-align: center;">14</td>
<td style="text-align: center;"><span class="math display">\[\left(
\frac{1}{2} \right)^{1/4}\]</span></td>
</tr>
<tr>
<td style="text-align: center;">15</td>
<td style="text-align: center;">1</td>
</tr>
</tbody>
</table></th>
</tr>
</thead>
<tbody>
</tbody>
</table>
<p>The amplitude and phase coefficient indicators are reported as
follows:</p>
<p>- <span class="math inline">\(k_{l,\left\lfloor \frac{i_{l}^{*}}{L}
\right\rfloor}^{(1)} = 15\)</span>, <span
class="math inline">\(k_{l,i_{l}^{*},0}^{(2)} = 7\)</span>, <span
class="math inline">\(k_{l,i_{l}^{*},0}^{(3)} = 1\)</span> and <span
class="math inline">\(c_{l,i_{l}^{*},0} = 0\)</span> <span
class="math inline">\((l = 1,\ldots,\upsilon)\)</span>. The indicators
<span class="math inline">\(k_{l,\left\lfloor \frac{i_{l}^{*}}{L}
\right\rfloor}^{(1)}\)</span>, <span
class="math inline">\(k_{l,i_{l}^{*},0}^{(2)}\)</span> and <span
class="math inline">\(c_{l,i_{l}^{*},0}\)</span> are not reported for
<span class="math inline">\(l = 1,\ldots,\upsilon\)</span>.</p>
<p>- The indicator <span class="math inline">\(k_{l,\left( \left\lfloor
\frac{i_{l}^{*}}{L} \right\rfloor + 1 \right)\ mod\ 2}^{(1)}\)</span> is
reported for <span class="math inline">\(l =
1,\ldots,\upsilon\)</span>.</p>
<p>- The <span class="math inline">\(K^{NZ} - \upsilon\)</span>
indicators <span class="math inline">\(k_{l,i,f}^{(2)}\)</span> for
which <span class="math inline">\(k_{l,i,f}^{(3)} = 1\)</span>, <span
class="math inline">\(i \neq i_{l}^{*},\ f \neq 0\)</span> are
reported.</p>
<p>- The <span class="math inline">\(K^{NZ} - \upsilon\)</span>
indicators <span class="math inline">\(c_{l,i,f}\)</span> for which
<span class="math inline">\(k_{l,i,f}^{(3)} = 1\)</span>, <span
class="math inline">\(i \neq i_{l}^{*},\ f \neq 0\)</span> are
reported.</p>
<p>- The remaining <span class="math inline">\(2L \cdot M_{\nu} \cdot
\nu - K^{NZ}\)</span> indicators <span
class="math inline">\(k_{l,i,f}^{(2)}\)</span> are not reported.</p>
<p>- The remaining <span class="math inline">\(2L \cdot M_{\nu} \cdot
\nu - K^{NZ}\)</span> indicators <span
class="math inline">\(c_{l,i,f}\)</span> are not reported.</p>
<p>Table 5.2.2.2.5-3: Mapping of elements of <span
class="math inline">\(\mathbf{i}_{\mathbf{2,4,l}}\)</span>: <span
class="math inline">\(\mathbf{k}_{\mathbf{l,i,f}}^{\mathbf{(2)}}\)</span>
to <span
class="math inline">\(\mathbf{p}_{\mathbf{l,i,f}}^{\mathbf{(2)}}\)</span></p>
<table>
<colgroup>
<col style="width: 29%" />
<col style="width: 70%" />
</colgroup>
<thead>
<tr>
<th rowspan="2" style="text-align: center;"><span
class="math display">\[\mathbf{k}_{\mathbf{l,i,f}}^{\mathbf{(2)}}\]</span></th>
<th rowspan="2" style="text-align: center;"><span
class="math display">\[\mathbf{p}_{\mathbf{l,i,f}}^{\mathbf{(2)}}\]</span></th>
</tr>
<tr>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">0</td>
<td style="text-align: center;"><span
class="math display">\[\frac{1}{8\sqrt{2}}\]</span></td>
</tr>
<tr>
<td style="text-align: center;">1</td>
<td style="text-align: center;"><span
class="math display">\[\frac{1}{8}\]</span></td>
</tr>
<tr>
<td style="text-align: center;">2</td>
<td style="text-align: center;"><span
class="math display">\[\frac{1}{4\sqrt{2}}\]</span></td>
</tr>
<tr>
<td style="text-align: center;">3</td>
<td style="text-align: center;"><span
class="math display">\[\frac{1}{4}\]</span></td>
</tr>
<tr>
<td style="text-align: center;">4</td>
<td style="text-align: center;"><span
class="math display">\[\frac{1}{2\sqrt{2}}\]</span></td>
</tr>
<tr>
<td style="text-align: center;">5</td>
<td style="text-align: center;"><span
class="math display">\[\frac{1}{2}\]</span></td>
</tr>
<tr>
<td style="text-align: center;">6</td>
<td style="text-align: center;"><span
class="math display">\[\frac{1}{\sqrt{2}}\]</span></td>
</tr>
<tr>
<td style="text-align: center;">7</td>
<td style="text-align: center;">1</td>
</tr>
</tbody>
</table>
<p>The elements of <span class="math inline">\(n_{1}\)</span> and <span
class="math inline">\(n_{2}\)</span> are found from <span
class="math inline">\(i_{1,2}\ \)</span>using the algorithm described in
5.2.2.2.3, where the values of <span
class="math inline">\(C(x,y)\)</span> are given in Table
5.2.2.2.5-4.</p>
<p>For <span class="math inline">\(N_{3} &gt; 19\)</span>, <span
class="math inline">\(M_{initial}\)</span> is identified by <span
class="math inline">\(i_{1,5}\)</span>.</p>
<p>For all values of <span class="math inline">\(N_{3}\)</span>, <span
class="math inline">\(n_{3,l}^{(0)} = 0\)</span> for <span
class="math inline">\(l = 1,\ldots,\upsilon\)</span>. If <span
class="math inline">\(M_{\upsilon} &gt; 1\)</span>, the nonzero elements
of <span class="math inline">\(n_{3,l}\)</span>, identified by <span
class="math inline">\(n_{3,l}^{(1)},\ \ldots,\ n_{3,l}^{\left(
M_{\upsilon} - 1 \right)},\ \)</span>are found from <span
class="math inline">\(i_{1,6,l}\)</span> <span class="math inline">\((l
= 1,\ldots,\upsilon)\)</span>, for <span class="math inline">\(N_{3}
\leq 19\)</span>, and from <span
class="math inline">\(i_{1,6,l}\)</span> <span class="math inline">\((l
= 1,\ldots,\upsilon)\)</span> and <span
class="math inline">\(M_{initial}\)</span>, for <span
class="math inline">\(N_{3} &gt; 19\)</span>, using <span
class="math inline">\(C(x,y)\)</span> as defined in Table 5.2.2.2.5-4
and the algorithm:</p>
<p><span class="math inline">\(s_{0} = 0\)</span></p>
<p>for <span class="math inline">\(f = 1,\ldots,M_{\upsilon} -
1\)</span></p>
<p>Find the largest <span class="math inline">\(x^{*} \in \left\{
M_{\upsilon} - 1 - f,\ldots,N_{3} - 1 - f \right\}\)</span> in Table
5.2.2.2.5-4 such that</p>
<p><span class="math inline">\(i_{1,6,l}\  - s_{f - 1} \geq C\left(
x^{*},M_{\upsilon} - f \right)\)</span></p>
<p><span class="math inline">\(e_{f} = C\left( x^{*},M_{\upsilon} - f
\right)\)</span></p>
<p><span class="math inline">\(s_{f} = s_{f - 1} + e_{f}\)</span></p>
<p>if <span class="math inline">\(N_{3} \leq 19\)</span></p>
<p><span class="math inline">\(n_{3,l}^{(f)} = N_{3} - 1 -
x^{*}\)</span></p>
<p>else</p>
<p><span class="math inline">\(n_{l}^{(f)} = 2M_{\upsilon} - 1 -
x^{*}\)</span></p>
<p>if <span class="math inline">\(n_{l}^{(f)} \leq M_{initial} +
2M_{\upsilon} - 1\)</span></p>
<p><span class="math inline">\(n_{3,l}^{(f)} = n_{l}^{(f)}\)</span></p>
<p>else</p>
<p><span class="math inline">\(n_{3,l}^{(f)} = n_{l}^{(f)} + (N_{3} -
2M_{\upsilon})\)</span></p>
<p>end if</p>
<p>end if</p>
<p>Table 5.2.2.2.5-4: Combinatorial coefficients <span
class="math inline">\(\mathbf{C}\left( \mathbf{x}\mathbf{,y}
\right)\)</span></p>
<table>
<colgroup>
<col style="width: 7%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
</colgroup>
<thead>
<tr>
<th style="text-align: right;"><p><img src="media/image479.svg" /></p>
<p><img src="media/image480.svg" /></p></th>
<th style="text-align: center;"><strong>1</strong></th>
<th style="text-align: center;"><strong>2</strong></th>
<th style="text-align: center;"><strong>3</strong></th>
<th style="text-align: center;"><strong>4</strong></th>
<th style="text-align: center;"><strong>5</strong></th>
<th style="text-align: center;"><strong>6</strong></th>
<th style="text-align: center;"><strong>7</strong></th>
<th style="text-align: center;"><strong>8</strong></th>
<th style="text-align: center;"><strong>9</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
<tr>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
<tr>
<td style="text-align: center;">2</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
<tr>
<td style="text-align: center;">3</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
<tr>
<td style="text-align: center;">4</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">6</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
<tr>
<td style="text-align: center;">5</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">10</td>
<td style="text-align: center;">10</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
<tr>
<td style="text-align: center;">6</td>
<td style="text-align: center;">6</td>
<td style="text-align: center;">15</td>
<td style="text-align: center;">20</td>
<td style="text-align: center;">15</td>
<td style="text-align: center;">6</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
<tr>
<td style="text-align: center;">7</td>
<td style="text-align: center;">7</td>
<td style="text-align: center;">21</td>
<td style="text-align: center;">35</td>
<td style="text-align: center;">35</td>
<td style="text-align: center;">21</td>
<td style="text-align: center;">7</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
<tr>
<td style="text-align: center;">8</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">28</td>
<td style="text-align: center;">56</td>
<td style="text-align: center;">70</td>
<td style="text-align: center;">56</td>
<td style="text-align: center;">28</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
</tr>
<tr>
<td style="text-align: center;">9</td>
<td style="text-align: center;">9</td>
<td style="text-align: center;">36</td>
<td style="text-align: center;">84</td>
<td style="text-align: center;">126</td>
<td style="text-align: center;">126</td>
<td style="text-align: center;">84</td>
<td style="text-align: center;">36</td>
<td style="text-align: center;">9</td>
<td style="text-align: center;">1</td>
</tr>
<tr>
<td style="text-align: center;">10</td>
<td style="text-align: center;">10</td>
<td style="text-align: center;">45</td>
<td style="text-align: center;">120</td>
<td style="text-align: center;">210</td>
<td style="text-align: center;">252</td>
<td style="text-align: center;">210</td>
<td style="text-align: center;">120</td>
<td style="text-align: center;">45</td>
<td style="text-align: center;">10</td>
</tr>
<tr>
<td style="text-align: center;">11</td>
<td style="text-align: center;">11</td>
<td style="text-align: center;">55</td>
<td style="text-align: center;">165</td>
<td style="text-align: center;">330</td>
<td style="text-align: center;">462</td>
<td style="text-align: center;">462</td>
<td style="text-align: center;">330</td>
<td style="text-align: center;">165</td>
<td style="text-align: center;">55</td>
</tr>
<tr>
<td style="text-align: center;">12</td>
<td style="text-align: center;">12</td>
<td style="text-align: center;">66</td>
<td style="text-align: center;">220</td>
<td style="text-align: center;">495</td>
<td style="text-align: center;">792</td>
<td style="text-align: center;">924</td>
<td style="text-align: center;">792</td>
<td style="text-align: center;">495</td>
<td style="text-align: center;">220</td>
</tr>
<tr>
<td style="text-align: center;">13</td>
<td style="text-align: center;">13</td>
<td style="text-align: center;">78</td>
<td style="text-align: center;">286</td>
<td style="text-align: center;">715</td>
<td style="text-align: center;">1287</td>
<td style="text-align: center;">1716</td>
<td style="text-align: center;">1716</td>
<td style="text-align: center;">1287</td>
<td style="text-align: center;">715</td>
</tr>
<tr>
<td style="text-align: center;">14</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">91</td>
<td style="text-align: center;">364</td>
<td style="text-align: center;">1001</td>
<td style="text-align: center;">2002</td>
<td style="text-align: center;">3003</td>
<td style="text-align: center;">3432</td>
<td style="text-align: center;">3003</td>
<td style="text-align: center;">2002</td>
</tr>
<tr>
<td style="text-align: center;">15</td>
<td style="text-align: center;">15</td>
<td style="text-align: center;">105</td>
<td style="text-align: center;">455</td>
<td style="text-align: center;">1365</td>
<td style="text-align: center;">3003</td>
<td style="text-align: center;">5005</td>
<td style="text-align: center;">6435</td>
<td style="text-align: center;">6435</td>
<td style="text-align: center;">5005</td>
</tr>
<tr>
<td style="text-align: center;">16</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">120</td>
<td style="text-align: center;">560</td>
<td style="text-align: center;">1820</td>
<td style="text-align: center;">4368</td>
<td style="text-align: center;">8008</td>
<td style="text-align: center;">11440</td>
<td style="text-align: center;">12870</td>
<td style="text-align: center;">11440</td>
</tr>
<tr>
<td style="text-align: center;">17</td>
<td style="text-align: center;">17</td>
<td style="text-align: center;">136</td>
<td style="text-align: center;">680</td>
<td style="text-align: center;">2380</td>
<td style="text-align: center;">6188</td>
<td style="text-align: center;">12376</td>
<td style="text-align: center;">19448</td>
<td style="text-align: center;">24310</td>
<td style="text-align: center;">24310</td>
</tr>
<tr>
<td style="text-align: center;">18</td>
<td style="text-align: center;">18</td>
<td style="text-align: center;">153</td>
<td style="text-align: center;">816</td>
<td style="text-align: center;">3060</td>
<td style="text-align: center;">8568</td>
<td style="text-align: center;">18564</td>
<td style="text-align: center;">31824</td>
<td style="text-align: center;">43758</td>
<td style="text-align: center;">48620</td>
</tr>
</tbody>
</table>
<p>When <span class="math inline">\(n_{3,l}\)</span> and <span
class="math inline">\(M_{initial}\)</span> are known, <span
class="math inline">\(i_{1,5}\ \)</span>and <span
class="math inline">\(i_{1,6,l}\ (l = 1,\ldots,\upsilon)\)</span> are
found as follows:</p>
<p>- If <span class="math inline">\(N_{3} \leq 19\)</span>, <span
class="math inline">\(i_{1,5} = 0\)</span> and is not reported. If <span
class="math inline">\(M_{\nu} = 1\)</span>, <span
class="math inline">\(i_{1,6,l} = 0\)</span>, for <span
class="math inline">\(l = 1,\ldots,\nu\)</span>, and is not reported. If
<span class="math inline">\(M_{\nu} &gt; 1\)</span>, <span
class="math inline">\(i_{1,6,l} = \sum_{f = 1}^{M_{\upsilon} -
1}{C\left( N_{3} - 1 - n_{3,l}^{(f)},M_{\upsilon} - f \right)}\)</span>,
where <span class="math inline">\(C(x,y)\)</span> is given in Table
5.2.2.2.5-4 and where the indices <span class="math inline">\(f =
1,\ldots,M_{\upsilon} - 1\)</span> are assigned such that <span
class="math inline">\(n_{3,l}^{(f)}\)</span> increases as <span
class="math inline">\(f\)</span> increases.</p>
<p>- If <span class="math inline">\(N_{3} &gt; 19\)</span>, <span
class="math inline">\(M_{initial}\)</span> is indicated by <span
class="math inline">\(i_{1,5}\)</span>, which is reported and given
by</p>
<p><span class="math inline">\(i_{1,5} = \left\{ \begin{matrix}
M_{initial} &amp; M_{initial} = 0\  \\
M_{initial} + 2M_{\upsilon} &amp; M_{initial} &lt; 0
\end{matrix} \right.\ \)</span></p>
<p>Only the nonzero indices <span class="math inline">\(n_{3,l}^{(f)}
\in IntS\)</span>, where<span class="math inline">\(\ IntS = \{\left(
M_{initial} + i \right)\ mod\ N_{3},\ i = 0,1,\ldots,2M_{\upsilon} -
1\}\)</span>, are reported, where the indices <span
class="math inline">\(f = 1,\ldots,M_{\upsilon} - 1\)</span> are
assigned such that <span class="math inline">\(n_{3,l}^{(f)}\)</span>
increases as <span class="math inline">\(f\)</span> increases. Let</p>
<p><span class="math inline">\(n_{l}^{(f)} = \left\{ \begin{matrix}
n_{3,l}^{(f)} &amp; \ n_{3,l}^{(f)} \leq M_{initial} + 2M_{\upsilon} -
1\  \\
n_{3,l}^{(f)} - (N_{3} - 2M_{\upsilon}) &amp; n_{3,l}^{(f)} &gt;
M_{initial} + N_{3} - \ 1
\end{matrix} \right.\ ,\)</span></p>
<p>then <span class="math inline">\(i_{1,6,l} = \sum_{f =
1}^{M_{\upsilon} - 1}{C\left( 2M_{\upsilon} - 1 -
n_{l}^{(f)},M_{\upsilon} - f \right)}\)</span>, where <span
class="math inline">\(C(x,y)\)</span> is given in Table 5.2.2.2.5-4.</p>
<p>The codebooks for 1-4 layers are given in Table 5.2.2.2.5-5, where
<span class="math inline">\(m_{1}^{(i)}\)</span>, <span
class="math inline">\(m_{2}^{(i)}\)</span>, for <span
class="math inline">\(i = 0,1,\ldots,L - 1,\)</span> <span
class="math inline">\(v_{m_{1}^{(i)},m_{2}^{(i)}}\ \)</span> are
obtained as in clause 5.2.2.2.3, and the quantities <span
class="math inline">\(\varphi_{l,i,f}\)</span> and <span
class="math inline">\(y_{t,l}\ \)</span>are given by</p>
<p><span class="math display">\[\varphi_{l,i,f} = \ e^{j\frac{2\pi
c_{l,i,f}}{16}}\]</span></p>
<p><span class="math display">\[y_{t,l} = \left\lbrack y_{t,l}^{(0)}\ \
\ \ y_{t,l}^{(1)}\ \ \ \ldots\ \ \ \ y_{t,l}^{(M_{\upsilon} - 1)}
\right\rbrack\]</span></p>
<p>where <span class="math inline">\(t = \left\{ 0,1,\ldots,N_{3} - 1
\right\}\)</span>, is the index associated with the precoding matrix,
<span class="math inline">\(l = \left\{ 1,\ldots,\ \upsilon
\right\}\)</span>, and with</p>
<p><span class="math inline">\({y_{t,l}^{(f)} = e}^{j\frac{2\pi
tn_{3,l}^{(f)}}{N_{3}}}\ \ \ \)</span></p>
<p>for<span class="math inline">\(\ f = 0,1,\ldots,M_{\upsilon} -
1\)</span>.</p>
<p>Table 5.2.2.2.5-5: Codebook for 1-layer. 2-layer, 3-layer and 4-layer
CSI reporting using antenna ports 3000 to
2999+<em>P</em><sub>CSI‑RS</sub></p>
<table>
<colgroup>
<col style="width: 8%" />
<col style="width: 91%" />
</colgroup>
<thead>
<tr>
<th rowspan="2" style="text-align: center;"><strong>Layers</strong></th>
<th rowspan="2" style="text-align: center;"></th>
</tr>
<tr>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;"><span class="math display">\[
{\upsilon = 1}\]</span></td>
<td style="text-align: center;"><span
class="math display">\[W_{q_{1},q_{2},\ n_{1},\
n_{2},n_{3,1},p_{1}^{(1)},p_{1}^{(2)},i_{2,5,1},t}^{(1)} =
W_{q_{1},q_{2},\ n_{1},\
n_{2},n_{3,1},p_{1}^{(1)},p_{1}^{(2)},i_{2,5,1},t}^{1}\]</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="math display">\[
{\upsilon = 2}\]</span></td>
<td style="text-align: center;"><span
class="math display">\[W_{q_{1},q_{2},\ n_{1},\
n_{2},n_{3,1},p_{1}^{(1)},p_{1}^{(2)},i_{2,5,1},\
n_{3,2},p_{2}^{(1)},p_{2}^{(2)},i_{2,5,2},t}^{(2)} =
\frac{1}{\sqrt{2}}\left\lbrack W_{q_{1},q_{2},\ n_{1},\
n_{2},n_{3,1},p_{1}^{(1)},p_{1}^{(2)},i_{2,5,1},t}^{1}\ \
W_{q_{1},q_{2},\ n_{1},\
n_{2},n_{3,2},p_{2}^{(1)},p_{2}^{(2)},i_{2,5,2},t}^{2}
\right\rbrack\]</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="math display">\[\upsilon =
3\]</span></td>
<td style="text-align: center;"><span
class="math display">\[W_{q_{1},q_{2},\ n_{1},\
n_{2},n_{3,1},p_{1}^{(1)},p_{1}^{(2)},i_{2,5,1},n_{3,2},p_{2}^{(1)},p_{2}^{(2)},i_{2,5,2},n_{3,3},p_{3}^{(1)},p_{3}^{(2)},i_{2,5,3},t}^{(3)}
= \frac{1}{\sqrt{3}}\left\lbrack W_{q_{1},q_{2},\ n_{1},\
n_{2},n_{3,1},p_{1}^{(1)},p_{1}^{(2)},i_{2,5,1},t}^{1}\ \
W_{q_{1},q_{2},\ n_{1},\
n_{2},n_{3,2},p_{2}^{(1)},p_{2}^{(2)},i_{2,5,2},t}^{2}\ \
W_{q_{1},q_{2},\ n_{1},\
n_{2},n_{3,3},p_{3}^{(1)},p_{3}^{(2)},i_{2,5,3},t}^{3}
\right\rbrack\]</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="math display">\[\upsilon =
4\]</span></td>
<td style="text-align: center;"><span
class="math display">\[W_{q_{1},q_{2},\ n_{1},\
n_{2},n_{3,1},p_{1}^{(1)},p_{1}^{(2)},i_{2,5,1},n_{3,2},p_{2}^{(1)},p_{2}^{(2)},i_{2,5,2},n_{3,3},p_{3}^{(1)},p_{3}^{(2)},i_{2,5,3},{n_{3,4},p}_{4}^{(1)},p_{4}^{(2)},i_{2,5,4},t}^{(4)}
= \frac{1}{2}\left\lbrack W_{q_{1},q_{2},\ n_{1},\
n_{2},n_{3,1},p_{1}^{(1)},p_{1}^{(2)},i_{2,5,1},t}^{1}\ \
W_{q_{1},q_{2},\ n_{1},\
n_{2},n_{3,2},p_{2}^{(1)},p_{2}^{(2)},i_{2,5,2},t}^{2}\ \
W_{q_{1},q_{2},\ n_{1},\
n_{2},n_{3,3},p_{3}^{(1)},p_{3}^{(2)},i_{2,5,3},t}^{3}\ \
W_{q_{1},q_{2},\ n_{1},\
n_{2},n_{3,4},p_{4}^{(1)},p_{4}^{(2)},i_{2,5,4},t}^{4}
\right\rbrack\]</span></td>
</tr>
<tr>
<td colspan="2" style="text-align: center;"><p>Where <span
class="math inline">\(W_{q_{1},q_{2},\ n_{1},\
n_{2},n_{3,l},p_{l}^{(1)},p_{l}^{(2)},i_{2,5,l},t}^{l} =
\frac{1}{\sqrt{N_{1}N_{2}\gamma_{t,l}}}\begin{bmatrix}
\sum_{i = 0}^{L - 1}{v_{m_{1}^{(i)},m_{2}^{(i)}}p_{l,0}^{(1)}\sum_{f =
0}^{M_{\upsilon} - 1}{y_{t,l}^{(f)}p_{l,i,f}^{(2)}\varphi_{l,i,f}}} \\
\sum_{i = 0}^{L - 1}{v_{m_{1}^{(i)},m_{2}^{(i)}}p_{l,1}^{(1)}\sum_{f =
0}^{M_{\upsilon} - 1}{y_{t,l}^{(f)}p_{l,i + L,f}^{(2)}\varphi_{l,i +
L,f}}}
\end{bmatrix},\ l = 1,2,3,4,\)</span></p>
<p><span class="math display">\[\gamma_{t,l} = {\sum_{i = 0}^{2L -
1}{\left( p_{l,\left\lfloor \frac{i}{L} \right\rfloor}^{(1)}
\right)^{2}\left| \sum_{f = 0}^{M_{\upsilon} -
1}{y_{t,l}^{(f)}p_{l,i,f}^{(2)}\varphi_{l,i,f}}
\right|}}^{2}\]</span></p>
<p>and the mappings from <span class="math inline">\(i_{1}\)</span> to
<span class="math inline">\(q_{1}\)</span>, <span
class="math inline">\(q_{2}\)</span>, <span
class="math inline">\(n_{1}\)</span>, <span
class="math inline">\(n_{2}\)</span>, <span
class="math inline">\(n_{3,1}\)</span>, <span
class="math inline">\(n_{3,2}\)</span>, <span
class="math inline">\(n_{3,3}\)</span>, <span
class="math inline">\(n_{3,4}\)</span>, and from <span
class="math inline">\(i_{2}\)</span> to <span
class="math inline">\(i_{2,5,1}\)</span>, <span
class="math inline">\(i_{2,5,2}\)</span>, <span
class="math inline">\(i_{2,5,3}\)</span>,<span class="math inline">\(\
i_{2,5,4},\)</span> <span class="math inline">\(p_{1}^{(1)}\)</span>,
<span class="math inline">\(p_{2}^{(1)}\)</span>, <span
class="math inline">\(p_{3}^{(1)}\)</span>and <span
class="math inline">\(p_{4}^{(1)},\ \ p_{1}^{(2)}\)</span>, <span
class="math inline">\(p_{2}^{(2)}\)</span>, <span
class="math inline">\(p_{3}^{(2)}\)</span> and <span
class="math inline">\(p_{4}^{(2)}\)</span> are as described above,
including the ranges of the constituent indices of <span
class="math inline">\(i_{1}\)</span> and <span
class="math inline">\(i_{2}\)</span>.</p></td>
</tr>
</tbody>
</table>
<p>For coefficients with <span class="math inline">\(k_{l,i,f}^{(3)} =
0\)</span>, amplitude and phase are set to zero, i.e., <span
class="math inline">\(p_{l,i,f}^{(2)} = 0\)</span> and <span
class="math inline">\(\varphi_{l,i,f} = 0\)</span>.</p>
<p>The bitmap parameter <em>typeII-RI‑Restriction-r16</em> forms the bit
sequence <span class="math inline">\(r_{3},r_{2},r_{1},r_{0}\)</span>
where <span class="math inline">\(r_{0}\)</span> is the LSB and <span
class="math inline">\(r_{3}\)</span> is the MSB. When <span
class="math inline">\(r_{i}\)</span> is zero, <span
class="math inline">\(i \in \left\{ 0,1,\ldots,3 \right\}\)</span>, PMI
and RI reporting are not allowed to correspond to any precoder
associated with <span class="math inline">\(\upsilon = i + 1\)</span>
layers.</p>
<p>The bitmap parameter <em>n1-n2‑codebookSubsetRestriction-r16</em>
forms the bit sequence <span class="math inline">\(B =
B_{1}B_{2}\)</span> and configures the vector group indices <span
class="math inline">\(g^{(k)}\)</span> as in clause 5.2.2.2.3. Bits
<span class="math inline">\(b_{2}^{\left( k,{2(N}_{1}x_{2} + x_{1}
\right) + 1)}b_{2}^{\left( k,{2(N}_{1}x_{2} + x_{1} \right))}\)</span>
indicate the maximum allowed average amplitude, <span
class="math inline">\(\gamma_{i + pL}\)</span> (<span
class="math inline">\(p = 0,1\)</span>), with <span
class="math inline">\(i \in \{ 0,1,\ldots,L - 1\}\)</span>, of the
coefficients associated with the vector in group <span
class="math inline">\(g^{(k)}\)</span> indexed by <span
class="math inline">\(x_{1},x_{2}\)</span>, where the maximum amplitudes
are given in Table 5.2.2.2.5-6 and the average coefficient amplitude is
restricted as follows</p>
<p><span class="math inline">\(\sqrt{\frac{1}{\sum_{f = 0}^{M_{\upsilon}
- 1}k_{l,i + pL,f}^{(3)}}\sum_{f = 0}^{M_{\upsilon} - 1}{k_{l,i +
pL,f}^{(3)}\left( p_{l,p}^{(1)}p_{l,i + pL,f}^{(2)} \right)^{2}}} \leq
\gamma_{i + pL}\)</span></p>
<p>for <span class="math inline">\(l = 1,\ldots,\upsilon\)</span>, and
<span class="math inline">\(p = 0,1\)</span>. A UE that does not report
the parameter <em>amplitudeSubsetRestriction-r16</em> = 'supported' in
its capability signaling is not expected to be configured with <span
class="math inline">\(b_{2}^{\left( k,{2(N}_{1}x_{2} + x_{1} \right) +
1)}b_{2}^{\left( k,{2(N}_{1}x_{2} + x_{1} \right))} = 01\)</span> or
<span class="math inline">\(10\)</span>.</p>
<p>Table 5.2.2.2.5-6: Maximum allowed average coefficient amplitudes for
restricted vectors</p>
<table>
<colgroup>
<col style="width: 63%" />
<col style="width: 36%" />
</colgroup>
<thead>
<tr>
<th rowspan="2"><p>Bit</p>
<p><span class="math display">\[\mathbf{b}_{\mathbf{2}}^{\left(
\mathbf{k,}\mathbf{2(N}_{\mathbf{1}}\mathbf{x}_{\mathbf{2}}\mathbf{+}\mathbf{x}_{\mathbf{1}}
\right)\mathbf{+ 1)}}\mathbf{b}_{\mathbf{2}}^{\left(
\mathbf{k,}\mathbf{2(N}_{\mathbf{1}}\mathbf{x}_{\mathbf{2}}\mathbf{+}\mathbf{x}_{\mathbf{1}}
\right)\mathbf{)}}\]</span></p></th>
<th rowspan="2"><p>Maximum</p>
<p>Average Coefficient Amplitude <span
class="math inline">\(\mathbf{\gamma}_{\mathbf{i +
pL}}\)</span></p></th>
</tr>
<tr>
</tr>
</thead>
<tbody>
<tr>
<td>00</td>
<td>0</td>
</tr>
<tr>
<td>01</td>
<td><span class="math display">\[\sqrt{1/4}\]</span></td>
</tr>
<tr>
<td>10</td>
<td><span class="math display">\[\sqrt{1/2}\]</span></td>
</tr>
<tr>
<td>11</td>
<td>1</td>
</tr>
</tbody>
</table>
<h5 id="enhanced-type-ii-port-selection-codebook">5.2.2.2.6 Enhanced
Type II Port Selection Codebook</h5>
<p>For 4 antenna ports {3000, 3001, …, 3003}, 8 antenna ports {3000,
3001, …, 3007}, 12 antenna ports {3000, 3001, …, 3011}, 16 antenna ports
{3000, 3001, …, 3015}, 24 antenna ports {3000, 3001, …, 3023}, and 32
antenna ports {3000, 3001, …, 3031}, and the UE configured with higher
layer parameter <em>codebookType</em> set to ' typeII-PortSelection-r16
'</p>
<p>- The number of CSI-RS ports is configured as in Clause 5.2.2.2.4</p>
<p>- The value of <span class="math inline">\(d\)</span> is configured
with the higher layer parameter <em>portSelectionSamplingSize-r16</em>,
where <span class="math inline">\(d \in \left\{ 1,2,3,4
\right\}\)</span> and <span class="math inline">\(d \leq L\)</span>.</p>
<p>- The values <span class="math inline">\(L\)</span>, <span
class="math inline">\(\beta\)</span> and <span
class="math inline">\(p_{\upsilon}\)</span> are configured as in Clause
5.2.2.2.5, where the supported configurations are given in Table
5.2.2.2.6-1.</p>
<p>Table 5.2.2.2.6-1: Codebook parameter configurations for <span
class="math inline">\(\mathbf{L}\)</span>, <span
class="math inline">\(\mathbf{\beta}\)</span> and<span
class="math inline">\(\mathbf{p}_{\mathbf{\upsilon}}\)</span></p>
<table>
<colgroup>
<col style="width: 28%" />
<col style="width: 10%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 10%" />
</colgroup>
<thead>
<tr>
<th rowspan="2"
style="text-align: center;"><em>paramCombination-r16</em></th>
<th rowspan="2" style="text-align: center;"><span
class="math display">\[L\]</span></th>
<th colspan="2" style="text-align: center;"><span
class="math display">\[p_{\upsilon}\]</span></th>
<th rowspan="2" style="text-align: center;"><span
class="math display">\[\beta\]</span></th>
</tr>
<tr>
<th style="text-align: center;"><span
class="math display">\[\upsilon\  \in \left\{ 1,2 \right\}\]</span></th>
<th style="text-align: center;"><span
class="math display">\[\upsilon\  \in \left\{ 3,4 \right\}\]</span></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">1</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">¼</td>
<td style="text-align: center;">1/8</td>
<td style="text-align: center;">¼</td>
</tr>
<tr>
<td style="text-align: center;">2</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">¼</td>
<td style="text-align: center;">1/8</td>
<td style="text-align: center;">½</td>
</tr>
<tr>
<td style="text-align: center;">3</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">¼</td>
<td style="text-align: center;">1/8</td>
<td style="text-align: center;">¼</td>
</tr>
<tr>
<td style="text-align: center;">4</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">¼</td>
<td style="text-align: center;">1/8</td>
<td style="text-align: center;">½</td>
</tr>
<tr>
<td style="text-align: center;">5</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">¼</td>
<td style="text-align: center;">¼</td>
<td style="text-align: center;">¾</td>
</tr>
<tr>
<td style="text-align: center;">6</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">½</td>
<td style="text-align: center;">¼</td>
<td style="text-align: center;">½</td>
</tr>
</tbody>
</table>
<p>- The UE shall report the RI value <span
class="math inline">\(\upsilon\)</span> according to the configured
higher layer parameter <em>typeII-PortSelectionRI-Restriction-r16</em>.
The UE shall not report <span class="math inline">\(\upsilon &gt;
4\)</span>.</p>
<p>- The value of <span class="math inline">\(R\)</span> is configured
as in Clause 5.2.2.2.5.</p>
<p>The UE is also configured with the higher layer bitmap parameter
<em>typeII-PortSelectionRI-Restriction-r16</em>, which forms the bit
sequence <span class="math inline">\(r_{3},r_{2},r_{1},r_{0}\)</span>,
where <span class="math inline">\(r_{0}\ \)</span>is the LSB and <span
class="math inline">\(r_{3}\)</span> is the MSB. When <span
class="math inline">\(r_{i}\)</span> is zero, <span
class="math inline">\(i \in \left\{ 0,1,\ldots,\ 3 \right\}\)</span>,
PMI and RI reporting are not allowed to correspond to any precoder
associated with <span class="math inline">\(\upsilon = i + 1\)</span>
layers.</p>
<p>The PMI value corresponds to the codebook indices <span
class="math inline">\(i_{1}\)</span> and <span
class="math inline">\(i_{2}\)</span> where</p>
<p><span class="math display">\[\begin{matrix}
i_{1} = \left\{ \begin{matrix}
\begin{matrix}
\begin{bmatrix}
i_{1,1}\ \ \ \ \ i_{1,5} &amp; \begin{matrix}
i_{1,6,1} &amp; i_{1,7,1} &amp; i_{1,8,1}
\end{matrix}
\end{bmatrix} &amp; \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \upsilon =
1 \\
\left\lbrack \begin{matrix}
i_{1,1} &amp; i_{1,5}
\end{matrix}\ \ \ \ \ \begin{matrix}
i_{1,6,1} &amp; i_{1,7,1} &amp; i_{1,8,1}
\end{matrix}\ \ \ \ \begin{matrix}
i_{1,6,2} &amp; i_{1,7,2}\ \ \ \ \ i_{1,8,2}
\end{matrix} \right\rbrack &amp; \ \upsilon = 2
\end{matrix} \\
\begin{matrix}
\left\lbrack \begin{matrix}
i_{1,1} &amp; i_{1,5}
\end{matrix}\ \ \ \ \ \begin{matrix}
i_{1,6,1} &amp; i_{1,7,1} &amp; i_{1,8,1}
\end{matrix}\ \ \ \begin{matrix}
i_{1,6,2} &amp; i_{1,7,2}\ \ \ \ \ i_{1,8,2}\ \ \ \ \ i_{1,6,3}
\end{matrix}\ \ \ \ \ i_{1,7,3}\ \ \ \ \ i_{1,8,3} \right\rbrack &amp; \
\ \ \ \ \ \ \ \ \ \ \upsilon = 3 \\
\left\lbrack \begin{matrix}
i_{1,1} &amp; i_{1,5}
\end{matrix}\ \ \ \ \ \begin{matrix}
i_{1,6,1} &amp; i_{1,7,1} &amp; i_{1,8,1}
\end{matrix}\ \ \ \begin{matrix}
i_{1,6,2} &amp; i_{1,7,2} &amp; i_{1,8,2}
\end{matrix}\ \ \ \ \ \begin{matrix}
i_{1,6,3} &amp; \ i_{1,7,3} &amp; \ i_{1,8,3}\ \ \ \ \ \begin{matrix}
i_{1,6,4} &amp; i_{1,7,4}\ \ \ \ \ i_{1,8,4}
\end{matrix}
\end{matrix} \right\rbrack &amp; \upsilon = 4
\end{matrix}
\end{matrix} \right.\  \\
i_{2} = \left\{ \begin{matrix}
\begin{matrix}
\begin{bmatrix}
i_{2,3,1} &amp; i_{2,4,1} &amp; i_{2,5,1}
\end{bmatrix} &amp; \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \upsilon = 1 \\
\left\lbrack \begin{matrix}
i_{2,3,1} &amp; i_{2,4,1} &amp; i_{2,5,1}
\end{matrix}\ \ \ \ \begin{matrix}
i_{2,3,2} &amp; i_{2,4,2} &amp; i_{2,5,2}
\end{matrix} \right\rbrack &amp; \upsilon = 2
\end{matrix} \\
\begin{matrix}
\left\lbrack \begin{matrix}
i_{2,3,1} &amp; i_{2,4,1} &amp; i_{2,5,1}
\end{matrix}\ \ \ \ \begin{matrix}
i_{2,3,2} &amp; i_{2,4,2} &amp; i_{2,5,2}
\end{matrix}\ \ \ \ \begin{matrix}
i_{2,3,3} &amp; i_{2,4,3} &amp; i_{2,5,3}
\end{matrix} \right\rbrack &amp; \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \upsilon = 3 \\
\left\lbrack \begin{matrix}
i_{2,3,1} &amp; i_{2,4,1} &amp; i_{2,5,1}
\end{matrix}\ \ \ \ \begin{matrix}
i_{2,3,2} &amp; i_{2,4,2} &amp; i_{2,5,2}
\end{matrix}\ \ \ \ \begin{matrix}
i_{2,3,3} &amp; i_{2,4,3} &amp; i_{2,5,3}
\end{matrix}\ \ \ \ \ \begin{matrix}
i_{2,3,4} &amp; i_{2,4,4} &amp; i_{2,5,4}
\end{matrix} \right\rbrack &amp; \upsilon = 4
\end{matrix}
\end{matrix} \right.\
\end{matrix}\]</span></p>
<p>The <span class="math inline">\(2L\)</span> antenna ports are
selected by the index <span class="math inline">\(i_{1,1}\)</span> as in
clause 5.2.2.2.4.</p>
<p>Parameters <span class="math inline">\(N_{3},\ M_{\upsilon}\)</span>,
<span class="math inline">\(M_{initial}\)</span> (for <span
class="math inline">\(N_{3} &gt; 19\)</span>) and <span
class="math inline">\(K_{0}\)</span> are defined as in clause
5.2.2.2.5.</p>
<p>For layer <span class="math inline">\(l\)</span>, <span
class="math inline">\(l = 1,\ldots,\upsilon\)</span>, the strongest
coefficient <span class="math inline">\(i_{1,8,l},\)</span> the
amplitude coefficient indicators <span
class="math inline">\(i_{2,3,l}\)</span> and <span
class="math inline">\(i_{2,4,l}\)</span>, the phase coefficient
indicator <span class="math inline">\(i_{2,5,l}\)</span> and the bitmap
indicator <span class="math inline">\(i_{1,7,l}\)</span> are defined and
indicated as in clause 5.2.2.2.5, where the mapping from <span
class="math inline">\(k_{l,p}^{(1)}\)</span> to the amplitude
coefficient <span class="math inline">\(p_{l,p}^{(1)}\)</span> is given
in Table 5.2.2.2.5-2 and the mapping from <span
class="math inline">\(k_{l,i,f}^{(2)}\)</span> to the amplitude
coefficient <span class="math inline">\(p_{l,i,f}^{(2)}\)</span> is
given in Table 5.2.2.2.5-3.</p>
<p>The number of nonzero coefficients for layer <span
class="math inline">\(l\)</span>, <span
class="math inline">\(K_{l}^{NZ}\)</span>, and the total number of
nonzero coefficients <span class="math inline">\(K^{NZ}\)</span> are
defined as in Clause 5.2.2.2.5.</p>
<p>The amplitude coefficients <span
class="math inline">\(p_{l}^{(1)}\)</span> and <span
class="math inline">\(p_{l}^{(2)}\)</span> <span
class="math inline">\((l = 1,\ldots,\upsilon\ )\)</span> are represented
as in clause 5.2.2.2.5.</p>
<p>The amplitude and phase coefficient indicators are reported as in
clause 5.2.2.2.5.</p>
<p>Codebook indicators <span class="math inline">\(i_{1,5}\ \)</span>and
<span class="math inline">\(i_{1,6,l}\ (l = 1,\ldots,\upsilon)\)</span>
are found as in clause 5.2.2.2.5.</p>
<p>The codebooks for 1-4 layers are given in Table 5.2.2.2.6-2, where
<span class="math inline">\(v_{m}\)</span> is a <span
class="math inline">\(P_{CSI - RS}/2\ \)</span>-element column vector
containing a value of 1 in element <span class="math inline">\(\left( m\
mod\ P_{CSI - RS}/2\  \right)\)</span> and zeros elsewhere (where the
first element is element 0), and the quantities <span
class="math inline">\(\varphi_{l,i,f}\)</span> and <span
class="math inline">\(y_{t,l}\ \ \)</span>are defined as in clause
5.2.2.2.5.</p>
<p>Table 5.2.2.2.6-2: Codebook for 1-layer. 2-layer, 3-layer and 4-layer
CSI reporting using antenna ports 3000 to
2999+<em>P</em><sub>CSI‑RS</sub></p>
<table>
<colgroup>
<col style="width: 8%" />
<col style="width: 91%" />
</colgroup>
<thead>
<tr>
<th rowspan="2" style="text-align: center;"><strong>Layers</strong></th>
<th rowspan="2" style="text-align: center;"></th>
</tr>
<tr>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;"><span class="math display">\[
{\upsilon = 1}\]</span></td>
<td style="text-align: center;"><span
class="math display">\[W_{i_{1,1},n_{3,1},p_{1}^{(1)},p_{1}^{(2)},i_{2,5,1},t}^{(1)}
=
W_{i_{1,1},n_{3,1},p_{1}^{(1)},p_{1}^{(2)},i_{2,5,1},t}^{1}\]</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="math display">\[
{\upsilon = 2}\]</span></td>
<td style="text-align: center;"><span
class="math display">\[W_{i_{1,1},n_{3,1},p_{1}^{(1)},p_{1}^{(2)},i_{2,5,1},\
n_{3,2},p_{2}^{(1)},p_{2}^{(2)},i_{2,5,2},t}^{(2)} =
\frac{1}{\sqrt{2}}\left\lbrack
W_{i_{1,1},n_{3,1},p_{1}^{(1)},p_{1}^{(2)},i_{2,5,1},t}^{1}\ \
W_{i_{1,1},n_{3,2},p_{2}^{(1)},p_{2}^{(2)},i_{2,5,2},t}^{2}
\right\rbrack\]</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="math display">\[\upsilon =
3\]</span></td>
<td style="text-align: center;"><span
class="math display">\[W_{i_{1,1},n_{3,1},p_{1}^{(1)},p_{1}^{(2)},i_{2,5,1},n_{3,2},p_{2}^{(1)},p_{2}^{(2)},i_{2,5,2},n_{3,3},p_{3}^{(1)},p_{3}^{(2)},i_{2,5,3},t}^{(3)}
= \frac{1}{\sqrt{3}}\left\lbrack
W_{i_{1,1},n_{3,1},p_{1}^{(1)},p_{1}^{(2)},i_{2,5,1},t}^{1}\ \
W_{i_{1,1},n_{3,2},p_{2}^{(1)},p_{2}^{(2)},i_{2,5,2},t}^{2}\ \
W_{i_{1,1},n_{3,3},p_{3}^{(1)},p_{3}^{(2)},i_{2,5,3},t}^{3}
\right\rbrack\]</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="math display">\[\upsilon =
4\]</span></td>
<td style="text-align: center;"><span
class="math display">\[W_{i_{1,1},n_{3,1},p_{1}^{(1)},p_{1}^{(2)},i_{2,5,1},n_{3,2},p_{2}^{(1)},p_{2}^{(2)},i_{2,5,2},n_{3,3},p_{3}^{(1)},p_{3}^{(2)},i_{2,5,3},{n_{3,4},p}_{4}^{(1)},p_{4}^{(2)},i_{2,5,4},t}^{(4)}
= \frac{1}{2}\left\lbrack
W_{i_{1,1},n_{3,1},p_{1}^{(1)},p_{1}^{(2)},i_{2,5,1},t}^{1}\ \
W_{i_{1,1},n_{3,2},p_{2}^{(1)},p_{2}^{(2)},i_{2,5,2},t}^{2}\ \
W_{i_{1,1},n_{3,3},p_{3}^{(1)},p_{3}^{(2)},i_{2,5,3},t}^{3}\ \
W_{i_{1,1},n_{3,4},p_{4}^{(1)},p_{4}^{(2)},i_{2,5,4},t}^{4}
\right\rbrack\]</span></td>
</tr>
<tr>
<td colspan="2" style="text-align: center;"><p>Where <span
class="math inline">\(W_{i_{1,1},n_{3,l},p_{l}^{(1)},p_{l}^{(2)},i_{2,5,l},t}^{l}
= \frac{1}{\sqrt{\gamma_{t,l}}}\begin{bmatrix}
\sum_{i = 0}^{L - 1}{v_{i_{1,1}d + i}p_{l,0}^{(1)}\sum_{f =
0}^{M_{\upsilon} - 1}{y_{t,l}^{(f)}p_{l,i,f}^{(2)}\varphi_{l,i,f}}} \\
\sum_{i = 0}^{L - 1}{v_{i_{1,1}d + i}p_{l,1}^{(1)}\sum_{f =
0}^{M_{\upsilon} - 1}{y_{t,l}^{(f)}p_{l,i + L,f}^{(2)}\varphi_{l,i +
L,f}}}
\end{bmatrix},\ \ l = 1,2,3,4\)</span>,</p>
<p><span class="math display">\[\gamma_{t,l} = {\sum_{i = 0}^{2L -
1}{\left( p_{l,\left\lfloor \frac{i}{L} \right\rfloor}^{(1)}
\right)^{2}\left| \sum_{f = 0}^{M_{\upsilon} -
1}{y_{t,l}^{(f)}p_{l,i,f}^{(2)}\varphi_{l,i,f}}
\right|}}^{2}\]</span></p>
<p>and the mappings from <span class="math inline">\(i_{1}\)</span>
to<span class="math inline">\(\ i_{1,1}\)</span>, <span
class="math inline">\(n_{3,1}\)</span>, <span
class="math inline">\(n_{3,2}\)</span>, <span
class="math inline">\(n_{3,3}\)</span>, <span
class="math inline">\(n_{3,4}\)</span>, and from <span
class="math inline">\(i_{2}\)</span> to <span
class="math inline">\(i_{2,5,1}\)</span>, <span
class="math inline">\(i_{2,5,2}\)</span>, <span
class="math inline">\(i_{2,5,3}\)</span>,<span class="math inline">\(\
i_{2,5,4},\)</span> <span class="math inline">\(p_{1}^{(1)}\)</span>,
<span class="math inline">\(p_{2}^{(1)}\)</span>, <span
class="math inline">\(p_{3}^{(1)}\)</span>and <span
class="math inline">\(p_{4}^{(1)}\)</span>, <span
class="math inline">\(\ p_{1}^{(2)}\)</span>, <span
class="math inline">\(p_{2}^{(2)}\)</span>, <span
class="math inline">\(p_{3}^{(2)}\)</span> and <span
class="math inline">\(p_{4}^{(2)}\)</span> are as described above,
including the ranges of the constituent indices of <span
class="math inline">\(i_{1}\)</span> and <span
class="math inline">\(i_{2}\)</span>.</p></td>
</tr>
</tbody>
</table>
<p>For coefficients with <span class="math inline">\(k_{l,i,f}^{(3)} =
0\)</span>, amplitude and phase are set to zero, i.e., <span
class="math inline">\(p_{l,i,f}^{(2)} = 0\)</span> and <span
class="math inline">\(\varphi_{l,i,f} = 0\)</span>.</p>
<h5 id="further-enhanced-type-ii-port-selection-codebook">5.2.2.2.7
Further enhanced Type II port selection codebook</h5>
<p>For 4 antenna ports {3000, 3001, …, 3003}, 8 antenna ports {3000,
3001, …, 3007}, 12 antenna ports {3000, 3001, …, 3011}, 16 antenna ports
{3000, 3001, …, 3015}, 24 antenna ports {3000, 3001, …, 3023}, and 32
antenna ports {3000, 3001, …, 3031}, and the UE configured with higher
layer parameter <em>codebookType</em> set to ' typeII-PortSelection-r17
'</p>
<p>- The number of CSI-RS ports, <span class="math inline">\(P_{CSI -
RS}\)</span>, is configured as in clause 5.2.2.2.4.</p>
<p>- The values <span class="math inline">\(\alpha\)</span>, <span
class="math inline">\(M\)</span> and <span
class="math inline">\(\beta\)</span> are determined by the higher layer
parameter <em>paramCombination-r17</em>, where the mapping is given in
Table 5.2.2.2.7-1.</p>
<p>- The UE is not expected to be configured with
<em>paramCombination-r17</em> equal to</p>
<p>- 1 or 6 when <span class="math inline">\(P_{CSI - RS} \in \{
4,12\}\)</span>,</p>
<p>- 7 or 8 when <span class="math inline">\(P_{CSI - RS} =
32\)</span>,</p>
<p>- 5 when <span class="math inline">\(P_{CSI - RS} = 4\)</span> and
higher layer parameter t<em>ypeII-PortSelectionRI-Restriction-r17</em>
is configured with <span class="math inline">\(r_{i} = 1\)</span> for
any <span class="math inline">\(i &gt; 1\)</span>.</p>
<p>Table 5.2.2.2.7-1: Codebook parameter configurations for <span
class="math inline">\(\mathbf{\alpha}\)</span>, <span
class="math inline">\(\mathbf{M}\)</span> and <span
class="math inline">\(\mathbf{\beta}\)</span></p>
<table>
<colgroup>
<col style="width: 64%" />
<col style="width: 12%" />
<col style="width: 11%" />
<col style="width: 11%" />
</colgroup>
<thead>
<tr>
<th style="text-align: center;"><em>paramCombination-r17</em></th>
<th style="text-align: center;"><span
class="math display">\[M\]</span></th>
<th style="text-align: center;"><span
class="math display">\[\alpha\]</span></th>
<th style="text-align: center;"><span
class="math display">\[\beta\]</span></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">¾</td>
<td style="text-align: center;">½</td>
</tr>
<tr>
<td style="text-align: center;">2</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">½</td>
</tr>
<tr>
<td style="text-align: center;">3</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">¾</td>
</tr>
<tr>
<td style="text-align: center;">4</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
</tr>
<tr>
<td style="text-align: center;">5</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">½</td>
<td style="text-align: center;">½</td>
</tr>
<tr>
<td style="text-align: center;">6</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">¾</td>
<td style="text-align: center;">½</td>
</tr>
<tr>
<td style="text-align: center;">7</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">½</td>
</tr>
<tr>
<td style="text-align: center;">8</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">¾</td>
</tr>
</tbody>
</table>
<p>- The parameter <span class="math inline">\(N \in \{ 2,4\}\)</span>
is configured with the higher-layer parameter <em>valueOfN</em>, when
<span class="math inline">\(M = 2\)</span>.</p>
<p>- The parameter <span class="math inline">\(R \in \{ 1,2\}\)</span>
is configured with the higher-layer parameter
<em>numberOfPMI-SubbandsPerCQI-Subband-r17</em>, when <span
class="math inline">\(M = 2\)</span>, and <span class="math inline">\(R
= 1\)</span> when <span class="math inline">\(M = 1\)</span>, where
<span class="math inline">\(R\)</span> is defined as in clause
5.2.2.2.5.</p>
<p>- The UE shall report the RI value <span
class="math inline">\(\upsilon\)</span> according to the configured
higher layer parameter <em>typeII-PortSelectionRI-Restriction-r17</em>.
The UE shall not report <span class="math inline">\(\upsilon &gt;
4\)</span>. The bitmap parameter
<em>typeII-PortSelectionRI-Restriction-r17</em> forms the bit sequence
<span class="math inline">\(r_{3},r_{2},r_{1},r_{0}\)</span>, where
<span class="math inline">\(r_{0}\ \)</span>is the LSB and <span
class="math inline">\(r_{3}\)</span> is the MSB. When <span
class="math inline">\(r_{i}\)</span> is zero, <span
class="math inline">\(i \in \left\{ 0,1,\ldots,\ 3 \right\}\)</span>,
PMI and RI reporting are not allowed to correspond to any precoder
associated with <span class="math inline">\(\upsilon = i + 1\)</span>
layers.</p>
<p>The PMI value corresponds to the codebook indices <span
class="math inline">\(i_{1}\)</span> and <span
class="math inline">\(i_{2}\)</span> where</p>
<p><span class="math display">\[\begin{matrix}
i_{1} = \left\{ \begin{matrix}
\begin{matrix}
\begin{bmatrix}
i_{1,2} &amp; \begin{matrix}
i_{1,6} &amp; i_{1,7,1} &amp; i_{1,8,1}
\end{matrix}
\end{bmatrix} &amp; \upsilon = 1 \\
\begin{bmatrix}
i_{1,2} &amp; i_{1,6} &amp; i_{1,7,1} &amp; i_{1,8,1} &amp; i_{1,7,2}
&amp; i_{1,8,2}
\end{bmatrix} &amp; \upsilon = 2
\end{matrix} \\
\begin{matrix}
\begin{bmatrix}
i_{1,2} &amp; i_{1,6} &amp; i_{1,7,1} &amp; i_{1,8,1} &amp; i_{1,7,2}
&amp; i_{1,8,2} &amp; i_{1,7,3} &amp; i_{1,8,3}
\end{bmatrix} &amp; \upsilon = 3 \\
\begin{bmatrix}
i_{1,2} &amp; i_{1,6} &amp; i_{1,7,1} &amp; i_{1,8,1} &amp; i_{1,7,2}
&amp; i_{1,8,2} &amp; i_{1,7,3} &amp; i_{1,8,3} &amp; i_{1,7,4} &amp;
i_{1,8,4}
\end{bmatrix} &amp; \upsilon = 4
\end{matrix}
\end{matrix} \right.\  \\
i_{2} = \left\{ \begin{matrix}
\begin{matrix}
\begin{bmatrix}
i_{2,3,1} &amp; i_{2,4,1} &amp; i_{2,5,1}
\end{bmatrix} &amp; \upsilon = 1 \\
\left\lbrack \begin{matrix}
i_{2,3,1} &amp; i_{2,4,1} &amp; i_{2,5,1}
\end{matrix}\ \ \ \ \begin{matrix}
i_{2,3,2} &amp; i_{2,4,2} &amp; i_{2,5,2}
\end{matrix} \right\rbrack &amp; \upsilon = 2
\end{matrix} \\
\begin{matrix}
\left\lbrack \begin{matrix}
i_{2,3,1} &amp; i_{2,4,1} &amp; i_{2,5,1}
\end{matrix}\ \ \ \ \begin{matrix}
i_{2,3,2} &amp; i_{2,4,2} &amp; i_{2,5,2}
\end{matrix}\ \ \ \ \begin{matrix}
i_{2,3,3} &amp; i_{2,4,3} &amp; i_{2,5,3}
\end{matrix} \right\rbrack &amp; \upsilon = 3 \\
\left\lbrack \begin{matrix}
i_{2,3,1} &amp; i_{2,4,1} &amp; i_{2,5,1}
\end{matrix}\ \ \ \ \begin{matrix}
i_{2,3,2} &amp; i_{2,4,2} &amp; i_{2,5,2}
\end{matrix}\ \ \ \ \begin{matrix}
i_{2,3,3} &amp; i_{2,4,3} &amp; i_{2,5,3}
\end{matrix}\ \ \ \ \ \begin{matrix}
i_{2,3,4} &amp; i_{2,4,4} &amp; i_{2,5,4}
\end{matrix} \right\rbrack &amp; \upsilon = 4
\end{matrix}
\end{matrix} \right.\
\end{matrix}\]</span></p>
<p>The precoding matrices indicated by the PMI are determined from <span
class="math inline">\(L + M\)</span> vectors, where <span
class="math inline">\(L = K_{1}/2\)</span> and <span
class="math inline">\(K_{1} = \alpha P_{CSI - RS}\)</span>.</p>
<p><span class="math inline">\(K_{1}\)</span> ports are selected from
<span class="math inline">\(P_{CSI - RS}\)</span> ports based on <span
class="math inline">\(L\)</span> vectors, <span
class="math inline">\(v_{m^{(i)}},i = 0,1,\ldots,L - 1\)</span>, which
are identified by</p>
<p><span class="math display">\[m = \lbrack m^{(0)}\ldots m^{(L -
1)}\rbrack\]</span></p>
<p><span class="math display">\[m^{(i)} \in \left\{
0,1,\ldots,\frac{P_{CSI - RS}}{2} - 1 \right\}\]</span></p>
<p>which are indicated by the index <span
class="math inline">\(i_{1,2}\)</span>, where</p>
<p><span class="math display">\[i_{1,2} \in \left\{
0,1,\ldots,\begin{pmatrix}
P_{CSI - RS}/2 \\
L
\end{pmatrix} - 1 \right\}.\]</span></p>
<p>The elements of <span class="math inline">\(m\)</span> are found from
<span class="math inline">\(i_{1,2}\)</span> using <span
class="math inline">\(C(x,y)\)</span> as defined in Tables 5.2.2.2.5-4
and 5.2.2.2.7-2 and the algorithm:</p>
<p><span class="math inline">\(s_{- 1} = 0\)</span></p>
<p>for <span class="math inline">\(i = 0,\ldots,L - 1\)</span></p>
<p>Find the largest <span class="math inline">\(x^{*} \in \left\{ L - 1
- i,\ldots,\frac{P_{CSI - RS}}{2} - 1 - i \right\}\)</span> in Table
5.2.2.2.5-4, if <span class="math inline">\(L - i \leq 9\)</span>, or in
Table 5.2.2.2.7-2, if <span class="math inline">\(L - i &gt; 9\)</span>,
such that <span class="math inline">\(i_{1,2}\  - s_{i - 1} \geq C\left(
x^{*},L - i \right)\)</span></p>
<p><span class="math inline">\(e_{i} = C\left( x^{*},L - i
\right)\)</span></p>
<p><span class="math inline">\(s_{i} = s_{i - 1} + e_{i}\)</span></p>
<p><span class="math inline">\(m^{(i)} = \frac{P_{CSI - RS}}{2} - 1 -
x^{*}.\)</span></p>
<p>When <span class="math inline">\(m^{(i)}\)</span> are known, <span
class="math inline">\(i_{1,2}\)</span> is found using <span
class="math inline">\(i_{1,2} = \sum_{i = 0}^{L - 1}{C\left(
\frac{P_{CSI - RS}}{2} - 1 - m^{(i)},L - i \right)}\)</span>, where
<span class="math inline">\(C(x,y)\)</span> is given in Tables
5.2.2.2.5-4 and 5.2.2.2.7-2, and where the indices <span
class="math inline">\(i = 0,\ldots,L - 1\)</span> are assigned such that
<span class="math inline">\(m^{(i)}\)</span> increases as <span
class="math inline">\(i\)</span> increases.</p>
<p>- If <span class="math inline">\(\alpha = 1\)</span>, <span
class="math inline">\(m^{(i)} = i\)</span>, <span
class="math inline">\(i = 0,1,\ldots,\frac{P_{CSI - RS}}{2} -
1\)</span>, and <span class="math inline">\(i_{1,2}\)</span> is not
reported.</p>
<p>Table 5.2.2.2.7-2: Combinatorial coefficients <span
class="math inline">\(\mathbf{C}\left( \mathbf{x}\mathbf{,y}
\right)\)</span></p>
<table>
<colgroup>
<col style="width: 20%" />
<col style="width: 26%" />
<col style="width: 26%" />
<col style="width: 26%" />
</colgroup>
<thead>
<tr>
<th style="text-align: right;"><p><span
class="math display">\[y\]</span></p>
<p><span class="math display">\[x\]</span></p></th>
<th style="text-align: center;"><strong>10</strong></th>
<th style="text-align: center;"><strong>11</strong></th>
<th style="text-align: center;"><strong>12</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;"><strong>0</strong></td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
<tr>
<td style="text-align: center;"><strong>1</strong></td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
<tr>
<td style="text-align: center;"><strong>2</strong></td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
<tr>
<td style="text-align: center;"><strong>3</strong></td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
<tr>
<td style="text-align: center;"><strong>4</strong></td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
<tr>
<td style="text-align: center;"><strong>5</strong></td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
<tr>
<td style="text-align: center;"><strong>6</strong></td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
<tr>
<td style="text-align: center;"><strong>7</strong></td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
<tr>
<td style="text-align: center;"><strong>8</strong></td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
<tr>
<td style="text-align: center;"><strong>9</strong></td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
<tr>
<td style="text-align: center;"><strong>10</strong></td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
<tr>
<td style="text-align: center;"><strong>11</strong></td>
<td style="text-align: center;">11</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
</tr>
<tr>
<td style="text-align: center;"><strong>12</strong></td>
<td style="text-align: center;">66</td>
<td style="text-align: center;">12</td>
<td style="text-align: center;">1</td>
</tr>
<tr>
<td style="text-align: center;"><strong>13</strong></td>
<td style="text-align: center;">286</td>
<td style="text-align: center;">78</td>
<td style="text-align: center;">13</td>
</tr>
<tr>
<td style="text-align: center;"><strong>14</strong></td>
<td style="text-align: center;">1001</td>
<td style="text-align: center;">364</td>
<td style="text-align: center;">91</td>
</tr>
<tr>
<td style="text-align: center;"><strong>15</strong></td>
<td style="text-align: center;">3003</td>
<td style="text-align: center;">1365</td>
<td style="text-align: center;">455</td>
</tr>
</tbody>
</table>
<p><span class="math inline">\(M\)</span> vectors, <span
class="math inline">\(\left\lbrack
y_{0}^{(f)},y_{1}^{(f)},\ldots,y_{N_{3} - 1}^{(f)}
\right\rbrack^{T}\)</span>, <span class="math inline">\(f \in \{
0,\ldots,M - 1\}\)</span>, are identified by <span
class="math inline">\(n_{3}\)</span>, where <span
class="math inline">\(N_{3}\)</span> is defined as in clause 5.2.2.2.5,
and where</p>
<p><span class="math display">\[n_{3} = \left\lbrack n_{3}^{(0)}\ldots\
n_{3}^{(M - 1)} \right\rbrack\]</span></p>
<p><span class="math display">\[n_{3}^{(f)} \in \left\{ \begin{matrix}
\{ 0\} &amp; M = 1 \\
\left\{ 0,1,\ldots,min(N,N_{3}) - 1 \right\} &amp; M = 2
\end{matrix} \right.\ .\]</span></p>
<p>with the indices <span class="math inline">\(f \in \{ 0,\ldots,M -
1\}\)</span> assigned such that <span
class="math inline">\(n_{3}^{(f)}\)</span> increases with <span
class="math inline">\(f\)</span>. <span
class="math inline">\(n_{3}\)</span> is indicated by the index <span
class="math inline">\(i_{1,6}\)</span>, when <span
class="math inline">\(M = 2\)</span> and <span class="math inline">\(N =
4\)</span>, where</p>
<p><span class="math display">\[i_{1,6} \in \left\{ 0,1,2
\right\}.\]</span></p>
<p>- If <span class="math inline">\(M = 1\)</span>, or <span
class="math inline">\(M = 2\)</span> and <span class="math inline">\(N =
2\)</span>, <span class="math inline">\(i_{1,6}\)</span> is not
reported.</p>
<p>- If <span class="math inline">\(M = 2\)</span> and <span
class="math inline">\(N = 4\)</span>, the nonzero offset between <span
class="math inline">\(n_{3}^{(0)}\)</span> and <span
class="math inline">\(n_{3}^{(1)}\)</span> is reported with <span
class="math inline">\(i_{1,6}\)</span> assuming that <span
class="math inline">\(n_{3}^{(0)}\)</span> (reference for the offset) is
0. The nonzero offset values are mapped to the index values of <span
class="math inline">\(i_{1,6}\)</span> in increasing order with offset
value 1 mapped to index value '0'.</p>
<p>The amplitude coefficient indicators <span
class="math inline">\(i_{2,3,l}\)</span> and <span
class="math inline">\(i_{2,4,l}\)</span>, for <span
class="math inline">\(l = 1,\ldots,\upsilon\)</span>, are</p>
<p><span class="math display">\[i_{2,3,l} = \begin{bmatrix}
k_{l,0}^{(1)} &amp; k_{l,1}^{(1)}
\end{bmatrix}\]</span></p>
<p><span class="math display">\[i_{2,4,l} = \left\lbrack
k_{l,0}^{(2)}\ldots k_{l,M - 1}^{(2)} \right\rbrack\]</span></p>
<p><span class="math display">\[k_{l,f}^{(2)} = \left\lbrack
k_{l,0,f}^{(2)}\ldots k_{l,K_{1} - 1,f}^{(2)} \right\rbrack\]</span></p>
<p><span class="math display">\[k_{l,p}^{(1)} \in \left\{ 1,\ldots,15
\right\}\]</span></p>
<p><span class="math display">\[k_{l,i,f}^{(2)} \in \left\{ 0,\ldots,7
\right\}.\]</span></p>
<p>The phase coefficient indicator <span
class="math inline">\(i_{2,5,l}\)</span>, for <span
class="math inline">\(l = 1,\ldots,\nu\)</span>, is</p>
<p><span class="math display">\[i_{2,5,l} = \left\lbrack c_{l,0}\ldots
c_{l,M - 1} \right\rbrack\]</span></p>
<p><span class="math display">\[c_{l,f} = \left\lbrack c_{l,0,f}\ldots
c_{l,K_{1} - 1,f} \right\rbrack\]</span></p>
<p><span class="math display">\[c_{l,i,f} \in \left\{ 0,\ldots,15
\right\}.\]</span></p>
<p>Let <span class="math inline">\(K_{0} = \left\lceil \beta K_{1}M
\right\rceil\)</span>. The bitmap whose nonzero bits identify which
coefficients in <span class="math inline">\(i_{2,4,l}\)</span> and <span
class="math inline">\(i_{2,5,l}\ \)</span>are reported, is indicated by
<span class="math inline">\(i_{1,7,l}\)</span>, for <span
class="math inline">\(l = 1,\ldots,\nu\)</span></p>
<p><span class="math display">\[i_{1,7,l} = \left\lbrack
k_{l,0}^{(3)}\ldots k_{l,M - 1}^{(3)} \right\rbrack\]</span></p>
<p><span class="math display">\[k_{l,f}^{(3)} = \left\lbrack
k_{l,0,f}^{(3)}\ldots k_{l,K_{1} - 1,f}^{(3)} \right\rbrack\]</span></p>
<p><span class="math display">\[k_{l,i,f}^{(3)} \in \left\{ 0,1
\right\}\]</span></p>
<p>such that <span class="math inline">\(K_{l}^{NZ} = \sum_{i =
0}^{K_{1} - 1}{\sum_{f = 0}^{M - 1}k_{l,i,f}^{(3)}} \leq K_{0}\)</span>
is the number of nonzero coefficients for layer <span
class="math inline">\(l = 1,\ldots,\upsilon\)</span> and <span
class="math inline">\(K^{NZ} = \sum_{l = 1}^{\upsilon}K_{l}^{NZ} \leq
2K_{0}\)</span> is the total number of nonzero coefficients.</p>
<p>- If <span class="math inline">\(\nu \leq 2\)</span> and <span
class="math inline">\(K^{NZ} = K_{1}M\nu\)</span>, <span
class="math inline">\(i_{1,7,l}\)</span> is not reported, for <span
class="math inline">\(l = 1,\ldots,\nu\)</span>.</p>
<p>The indices of <span class="math inline">\(i_{2,4,l}\)</span>, <span
class="math inline">\(i_{2,5,l}\)</span> and <span
class="math inline">\(i_{1,7,l}\)</span> are associated to the <span
class="math inline">\(M\)</span> codebook indices in <span
class="math inline">\(n_{3}\)</span>.</p>
<p>The mapping from <span class="math inline">\(k_{l,p}^{(1)}\)</span>
to the amplitude coefficient <span
class="math inline">\(p_{l,p}^{(1)}\)</span> is given in Table
5.2.2.2.5-2 and the mapping from <span
class="math inline">\(k_{l,i,f}^{(2)}\)</span> to the amplitude
coefficient <span class="math inline">\(p_{l,i,f}^{(2)}\)</span> is
given in Table 5.2.2.2.5-3. The amplitude coefficients are represented
by</p>
<p><span class="math display">\[p_{l}^{(1)} = \begin{bmatrix}
p_{l,0}^{(1)} &amp; p_{l,1}^{(1)}
\end{bmatrix}\]</span></p>
<p><span class="math display">\[p_{l}^{(2)} = \left\lbrack
p_{l,0}^{(2)}\ldots p_{l,M - 1}^{(2)} \right\rbrack\]</span></p>
<p><span class="math display">\[p_{l,f}^{(2)} = \left\lbrack
p_{l,0,f}^{(2)}\ldots p_{l,K_{1} - 1,f}^{(2)}
\right\rbrack.\]</span></p>
<p>Let <span class="math inline">\(f_{l}^{*} \in \left\{ 0,\ldots,M - 1
\right\}\)</span> be the index of <span
class="math inline">\(i_{2,4,l}\)</span> and <span
class="math inline">\(i_{l}^{*} \in \left\{ 0,1,\ldots,K_{1} - 1
\right\}\)</span> be the index of <span
class="math inline">\(k_{l,f_{l}^{*}}^{(2)}\)</span> which identify the
strongest coefficient of layer <span class="math inline">\(l\)</span>,
i.e., the element <span
class="math inline">\(k_{l,i_{l}^{*},f_{l}^{*}}^{(2)}\)</span> of <span
class="math inline">\(i_{2,4,l}\)</span>, for <span
class="math inline">\(\ l = 1,\ldots,\upsilon\)</span>. The strongest
coefficient of layer <span class="math inline">\(l =
1,\ldots,\nu\)</span> is identified by the index</p>
<p><span class="math display">\[i_{1,8,l} \in \left\{ 0,1,\ldots,K_{1}M
- 1 \right\}\]</span></p>
<p>which is found from</p>
<p><span class="math display">\[i_{1,8,l} = K_{1}f_{l}^{*} +
i_{l}^{*}.\]</span></p>
<p>The amplitude and phase coefficient indicators are reported as
follows:</p>
<p>- <span class="math inline">\(k_{l,\left\lfloor \frac{i_{l}^{*}}{L}
\right\rfloor}^{(1)} = 15\)</span>, <span
class="math inline">\(k_{l,i_{l}^{*},f_{l}^{*}}^{(2)} = 7\)</span>,
<span class="math inline">\(k_{l,i_{l}^{*},f_{l}^{*}}^{(3)} = 1\)</span>
and <span class="math inline">\(c_{l,i_{l}^{*},f_{l}^{*}} = 0\)</span>
<span class="math inline">\((l = 1,\ldots,\upsilon)\)</span>. The
elements <span class="math inline">\(k_{l,\left\lfloor
\frac{i_{l}^{*}}{L} \right\rfloor}^{(1)}\)</span>, <span
class="math inline">\(k_{l,i_{l}^{*},f_{l}^{*}}^{(2)}\)</span> and <span
class="math inline">\(c_{l,i_{l}^{*},f_{l}^{*}}\)</span> are not
reported for <span class="math inline">\(l =
1,\ldots,\upsilon\)</span>.</p>
<p>- The element <span class="math inline">\(k_{l,\left( \left\lfloor
\frac{i_{l}^{*}}{L} \right\rfloor + 1 \right)\ mod\ 2}^{(1)}\)</span> is
reported for <span class="math inline">\(l =
1,\ldots,\upsilon\)</span>.</p>
<p>- The <span class="math inline">\(K^{NZ} - \upsilon\)</span> elements
<span class="math inline">\(k_{l,i,f}^{(2)}\)</span> for which <span
class="math inline">\(k_{l,i,f}^{(3)} = 1\)</span>, <span
class="math inline">\(i \neq i_{l}^{*},\ f \neq f_{l}^{*}\)</span> are
reported.</p>
<p>- The <span class="math inline">\(K^{NZ} - \upsilon\)</span> elements
<span class="math inline">\(c_{l,i,f}\)</span> for which <span
class="math inline">\(k_{l,i,f}^{(3)} = 1\)</span>, <span
class="math inline">\(i \neq i_{l}^{*},\ f \neq f_{l}^{*}\)</span> are
reported.</p>
<p>- The remaining <span class="math inline">\(K_{1}M\nu -
K^{NZ}\)</span> elements <span
class="math inline">\(k_{l,i,f}^{(2)}\)</span> are not reported.</p>
<p>- The remaining <span class="math inline">\(K_{1}M\nu -
K^{NZ}\)</span> elements <span class="math inline">\(c_{l,i,f}\)</span>
are not reported.</p>
<p>The codebooks for 1-4 layers are given in Table 5.2.2.2.7-3, where
<span class="math inline">\(v_{m^{(i)}}\)</span> is a <span
class="math inline">\(P_{CSI - RS}/2\ \)</span>-element column vector
containing a value of 1 in the element of index <span
class="math inline">\(m^{(i)}\)</span> and zeros elsewhere (where the
first element is the element of index 0), the quantities <span
class="math inline">\(y_{t}\ \)</span>are given by</p>
<p><span class="math display">\[y_{t} = \left\lbrack y_{t}^{(0)}\ldots\
y_{t}^{(M - 1)} \right\rbrack\]</span></p>
<p>where <span class="math inline">\(t = \left\{ 0,1,\ldots,N_{3} - 1
\right\}\)</span>, is the index associated with the precoding matrix and
where</p>
<p><span class="math display">\[{y_{t}^{(f)} = e}^{j\frac{2\pi
tn_{3}^{(f)}}{N_{3}}}\]</span></p>
<p>for <span class="math inline">\(f = 0,\ldots,M - 1\)</span>, and the
quantities <span class="math inline">\(\varphi_{l,i,f}\)</span> are
given by</p>
<p><span class="math display">\[\varphi_{l,i,f} = \ e^{j\frac{2\pi
c_{l,i,f}}{16}}.\]</span></p>
<p>Table 5.2.2.2.7-3: Codebook for 1-layer. 2-layer, 3-layer and 4-layer
CSI reporting using antenna ports 3000 to
2999+<em>P</em><sub>CSI‑RS</sub></p>
<table>
<colgroup>
<col style="width: 8%" />
<col style="width: 91%" />
</colgroup>
<thead>
<tr>
<th rowspan="2" style="text-align: center;"><strong>Layers</strong></th>
<th rowspan="2" style="text-align: center;"></th>
</tr>
<tr>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;"><span class="math display">\[
{\upsilon = 1}\]</span></td>
<td style="text-align: center;"><span
class="math display">\[W_{m,n_{3},p_{1}^{(1)},p_{1}^{(2)},i_{2,5,1},t}^{(1)}
= W_{m,n_{3},p_{1}^{(1)},p_{1}^{(2)},i_{2,5,1},t}^{1}\]</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="math display">\[
{\upsilon = 2}\]</span></td>
<td style="text-align: center;"><span
class="math display">\[W_{m,n_{3},p_{1}^{(1)},p_{1}^{(2)},i_{2,5,1},p_{2}^{(1)},p_{2}^{(2)},i_{2,5,2},t}^{(2)}
= \frac{1}{\sqrt{2}}\left\lbrack
W_{m,n_{3},p_{1}^{(1)},p_{1}^{(2)},i_{2,5,1},t}^{1}\ \
W_{m,n_{3},p_{2}^{(1)},p_{2}^{(2)},i_{2,5,2},t}^{2}
\right\rbrack\]</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="math display">\[\upsilon =
3\]</span></td>
<td style="text-align: center;"><span
class="math display">\[W_{m,n_{3},p_{1}^{(1)},p_{1}^{(2)},i_{2,5,1},p_{2}^{(1)},p_{2}^{(2)},i_{2,5,2},p_{3}^{(1)},p_{3}^{(2)},i_{2,5,3},t}^{(3)}
= \frac{1}{\sqrt{3}}\left\lbrack
W_{m,n_{3},p_{1}^{(1)},p_{1}^{(2)},i_{2,5,1},t}^{1}\ \
W_{m,n_{3},p_{2}^{(1)},p_{2}^{(2)},i_{2,5,2},t}^{2}\ \
W_{m,n_{3},p_{3}^{(1)},p_{3}^{(2)},i_{2,5,3},t}^{3}
\right\rbrack\]</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="math display">\[\upsilon =
4\]</span></td>
<td style="text-align: center;"><span
class="math display">\[W_{m,n_{3},p_{1}^{(1)},p_{1}^{(2)},i_{2,5,1},p_{2}^{(1)},p_{2}^{(2)},i_{2,5,2},p_{3}^{(1)},p_{3}^{(2)},i_{2,5,3},p_{4}^{(1)},p_{4}^{(2)},i_{2,5,4},t}^{(4)}
= \frac{1}{2}\left\lbrack
W_{m,n_{3},p_{1}^{(1)},p_{1}^{(2)},i_{2,5,1},t}^{1}\ \
W_{m,n_{3},p_{2}^{(1)},p_{2}^{(2)},i_{2,5,2},t}^{2}\ \
W_{m,n_{3},p_{3}^{(1)},p_{3}^{(2)},i_{2,5,3},t}^{3}\ \
W_{m,n_{3},p_{4}^{(1)},p_{4}^{(2)},i_{2,5,4},t}^{4}
\right\rbrack\]</span></td>
</tr>
<tr>
<td colspan="2" style="text-align: center;"><p>Where <span
class="math inline">\(W_{m,n_{3},p_{l}^{(1)},p_{l}^{(2)},i_{2,5,l},t}^{l}
= \frac{1}{\sqrt{\gamma_{t,l}}}\begin{bmatrix}
\sum_{i = 0}^{L - 1}{v_{m^{(i)}}p_{l,0}^{(1)}\sum_{f = 0}^{M -
1}{y_{t}^{(f)}p_{l,i,f}^{(2)}\varphi_{l,i,f}}} \\
\sum_{i = 0}^{L - 1}{v_{m^{(i)}}p_{l,1}^{(1)}\sum_{f = 0}^{M -
1}{y_{t}^{(f)}p_{l,i + L,f}^{(2)}\varphi_{l,i + L,f}}}
\end{bmatrix},\ \ l = 1,2,3,4\)</span>,</p>
<p><span class="math display">\[\gamma_{t,l} = {\sum_{i = 0}^{2L -
1}{\left( p_{l,\left\lfloor \frac{i}{L} \right\rfloor}^{(1)}
\right)^{2}\left| \sum_{f = 0}^{M -
1}{y_{t}^{(f)}p_{l,i,f}^{(2)}\varphi_{l,i,f}} \right|}}^{2}\]</span></p>
<p>and the mappings from <span class="math inline">\(i_{1}\)</span>
to<span class="math inline">\(\ m\)</span>, <span
class="math inline">\(n_{3}\)</span>, and from <span
class="math inline">\(i_{2}\)</span> to <span
class="math inline">\(i_{2,5,1}\)</span>, <span
class="math inline">\(i_{2,5,2}\)</span>, <span
class="math inline">\(i_{2,5,3}\)</span>,<span class="math inline">\(\
i_{2,5,4},\)</span> <span class="math inline">\(p_{1}^{(1)}\)</span>,
<span class="math inline">\(p_{2}^{(1)}\)</span>, <span
class="math inline">\(p_{3}^{(1)}\)</span>, <span
class="math inline">\(p_{4}^{(1)}\)</span>, <span
class="math inline">\(\ p_{1}^{(2)}\)</span>, <span
class="math inline">\(p_{2}^{(2)}\)</span>, <span
class="math inline">\(p_{3}^{(2)}\)</span>, <span
class="math inline">\(p_{4}^{(2)}\)</span> are as described above,
including the ranges of the constituent indices of <span
class="math inline">\(i_{1}\)</span> and <span
class="math inline">\(i_{2}\)</span>.</p></td>
</tr>
</tbody>
</table>
<p>For coefficients with <span class="math inline">\(k_{l,i,f}^{(3)} =
0\)</span>, amplitude and phase are set to zero, i.e., <span
class="math inline">\(p_{l,i,f}^{(2)} = 0\)</span> and <span
class="math inline">\(\varphi_{l,i,f} = 0\)</span>.</p>
<h4 id="reference-signal-csi-rs">5.2.2.3 Reference signal (CSI-RS) </h4>
<h5 id="nzp-csi-rs">5.2.2.3.1 NZP CSI-RS</h5>
<p>The UE can be configured with one or more NZP CSI-RS resource set
configuration(s) as indicated by the higher layer parameters
<em>CSI-ResourceConfig,</em> and <em>NZP-CSI-RS-ResourceSet.</em> Each
NZP CSI-RS resource set consists of <em>K</em>≥1 NZP CSI-RS
resource(s).</p>
<p>The following parameters for which the UE shall assume non-zero
transmission power for CSI-RS resource are configured via the higher
layer parameter <em>NZP-CSI-RS-Resource, CSI-ResourceConfig</em> and
<em>NZP-CSI-RS-ResourceSet</em> for each CSI-RS resource
configuration:</p>
<p>- <em>nzp-CSI-RS-ResourceId</em> determines CSI-RS resource
configuration identity.</p>
<p>- <em>periodicityAndOffset</em> defines the CSI-RS periodicity and
slot offset for periodic/semi-persistent CSI-RS. All the CSI-RS
resources within one set are configured with the same periodicity, while
the slot offset can be same or different for different CSI-RS
resources.</p>
<p>- <em>resourceMapping</em> defines the number of ports, CDM-type, and
OFDM symbol and subcarrier occupancy of the CSI-RS resource within a
slot that are given in Clause 7.4.1.5 of [4, TS 38.211].</p>
<p>- <em>nrofPorts</em> in <em>resourceMapping</em> defines the number
of CSI-RS ports, where the allowable values are given in Clause 7.4.1.5
of [4, TS 38.211].</p>
<p>- <em>density</em> in <em>resourceMapping</em> defines CSI-RS
frequency density of each CSI-RS port per PRB, and CSI-RS PRB offset in
case of the density value of 1/2, where the allowable values are given
in Clause 7.4.1.5 of [4, TS 38.211]. For density 1/2, the odd/even PRB
allocation indicated in <em>density</em> is with respect to the common
resource block grid.</p>
<p>- <em>cdm-Type</em> in <em>resourceMapping</em> defines CDM values
and pattern, where the allowable values are given in Clause 7.4.1.5 of
[4, TS 38.211].</p>
<p><em>- powerControlOffset</em>: which is the assumed ratio of PDSCH
EPRE to NZP CSI-RS EPRE when UE derives CSI feedback and takes values in
the range of [-8, 15] dB with 1 dB step size. For CQI calculation based
on a pair of NZP CSI-RS resources, <em>powerControlOffset</em> of each
NZP CSI-RS resource in the pair of NZP CSI-RS resources for channel
measurement is the assumed ratio of EPRE when UE derives CSI feedback
and takes values in the range of [-8, 15] dB with 1 dB step size.</p>
<p><em>- powerControlOffsetSS</em>: which is the assumed ratio of NZP
CSI-RS EPRE to SS/PBCH block EPRE.</p>
<p>- <em>scramblingID</em> defines scrambling ID of CSI-RS with length
of 10 bits.</p>
<p>- <em>BWP-Id</em> in <em>CSI-ResourceConfig</em> defines which
bandwidth part the configured CSI-RS is located in.</p>
<p>- <em>repetition</em> in <em>NZP-CSI-RS-ResourceSet</em> is
associated with a CSI-RS resource set and defines whether UE can assume
the CSI-RS resources within the NZP CSI-RS Resource Set are transmitted
with the same downlink spatial domain transmission filter or not as
described in Clause 5.1.6.1.2. and can be configured only when the
higher layer parameter <em>reportQuantity</em> associated with all the
reporting settings linked with the CSI-RS resource set is set to
'cri-RSRP', 'cri-SINR', 'cri-RSRP- Index', 'cri-SINR- Index' or
'none'.</p>
<p>- <em>qcl-InfoPeriodicCSI-RS</em> contains a reference to a
<em>TCI-State</em> indicating QCL source RS(s) and QCL type(s). If the
<em>TCI-State</em> is configured with a reference to an RS configured
with <em>qcl-Type</em> set to 'typeD' association, that RS may be an
SS/PBCH block located in the same or different CC/DL BWP or a CSI-RS
resource configured as periodic located in the same or different CC/DL
BWP. The reference RS may additionally be an SS/PBCH block associated
with a PCI different from the PCI of the serving cell.</p>
<p>- <em>trs-Info</em> in <em>NZP-CSI-RS-ResourceSet</em> is associated
with a CSI-RS resource set and for which the UE can assume that the
antenna port with the same port index of the configured NZP CSI-RS
resources in the <em>NZP-CSI-RS-ResourceSet</em> is the same as
described in Clause 5.1.6.1.1 and can be configured when reporting
setting is not configured or when the higher layer parameter
<em>reportQuantity</em> associated with all the reporting settings
linked with the CSI-RS resource set is set to 'none'.</p>
<p>All CSI-RS resources within one set are configured with same
<em>density</em> and same <em>nrofPorts</em>, except for the NZP CSI-RS
resources used for interference measurement.</p>
<p>The UE expects that all the CSI-RS resources of a resource set are
configured with the same starting RB and number of RBs and the same
<em>cdm-type</em>.</p>
<p>For a CSI-RS Resource Set for channel measurement configured with two
Resource Groups and <span class="math inline">\(N\)</span> Resource
Pairs, the slot offsets of the two resources in a Resource Pair are
configured within <span class="math inline">\(\ X \in \{ 1,2\}\
\)</span> slots, without DL/UL switching in between the two resources,
where <span class="math inline">\(X = 1\)</span> implies that the two
resources are configured in the same slot, and <span
class="math inline">\(X = 2\)</span> implies that the two resources are
configured within two adjacent slots.</p>
<p>The bandwidth and initial common resource block (CRB) index of a
CSI-RS resource within a BWP, as defined in Clause 7.4.1.5 of [4, TS
38.211], are determined based on the higher layer parameters
<em>nrofRBs</em> and <em>startingRB</em>, respectively, within the
CSI-FrequencyOccupation IE configured by the higher layer parameter
<em>freqBand</em> within the <em>CSI-RS-ResourceMapping</em> IE. Both
<em>nrofRBs</em> and <em>startingRB</em> are configured as integer
multiples of 4 RBs, and the reference point for <em>startingRB</em> is
CRB 0 on the common resource block grid. If <span
class="math inline">\(startingRB &lt; N_{BWP}^{start},\)</span> the UE
shall assume that the initial CRB index of the CSI-RS resource is <span
class="math inline">\(N_{initial\ RB} = N_{BWP}^{start}\)</span>,
otherwise <span class="math inline">\(N_{initial\ RB} =
startingRB\)</span>. If <span class="math inline">\(nrofRBs &gt;
N_{BWP}^{size} + N_{BWP}^{start} - N_{initial\ RB}\)</span>, the UE
shall assume that the bandwidth of the CSI-RS resource is <span
class="math inline">\(N_{CSI - RS}^{BW} = N_{BWP}^{size} +
N_{BWP}^{start} - N_{initial\ RB}\)</span>, otherwise <span
class="math inline">\(N_{CSI - RS}^{BW} = nrofRBs\)</span>. In all
cases, the UE shall expect that <span class="math inline">\(N_{CSI -
RS}^{BW} \geq min(24,\ N_{BWP}^{size})\)</span>.</p>
<h4
id="channel-state-information-interference-measurement-csi-im">5.2.2.4
Channel State Information – Interference Measurement (CSI-IM) </h4>
<p>The UE can be configured with one or more CSI-IM resource set
configuration(s) as indicated by the higher layer parameter
<em>CSI-IM-ResourceSet</em>. Each CSI-IM resource set consists of
<em>K</em>≥1 CSI-IM resource(s).</p>
<p>The following parameters are configured via higher layer parameter
<em>CSI-IM-Resource</em> for each CSI-IM resource configuration:</p>
<p><em>- csi-IM-ResourceId</em> determines CSI-IM resource configuration
identity</p>
<p><em>- subcarrierLocation-p0</em> or <em>subcarrierLocation-p1</em>
defines subcarrier occupancy of the CSI-IM resource within a slot for
<em>csi-IM-ResourceElementPattern</em> set to 'pattern0' or 'pattern1',
respectively.</p>
<p><em>- symbolLocation-p0</em> or <em>symbolLocation-p1</em> defines
OFDM symbol location of the CSI-IM resource within a slot for
<em>csi-IM-ResourceElementPattern</em> set to 'pattern0' or 'pattern1',
respectively.</p>
<p><em>- periodicityAndOffset</em> defines the CSI-IM periodicity and
slot offset for periodic/semi-persistent CSI-IM.</p>
<p><em>-</em> f<em>reqBand</em> includes parameters to enable
configuration of frequency-occupancy of CSI-IM</p>
<p>In each of the PRBs configured by f<em>reqBand,</em> the UE shall
assume each CSI-IM resource is located in,</p>
<p>- resource elements <img src="media/image658.svg" />, <img
src="media/image659.svg" />, <img src="media/image660.svg" /> and <img
src="media/image661.svg" />, if <em>csi-IM-ResourceElementPattern</em>
is set to 'pattern0',</p>
<p>- resource elements <img src="media/image658.svg" />, <img
src="media/image660.svg" />, <img src="media/image662.svg" /> and <img
src="media/image663.svg" /> if <em>csi-IM-ResourceElementPattern</em> is
set to 'pattern1',</p>
<p>where <img src="media/image664.svg" />and <img
src="media/image665.svg" /> are the configured frequency-domain location
and time-domain location, respectively, given by the higher layer
parameters in the above list.</p>
<h4 id="csi-reference-resource-definition">5.2.2.5 CSI reference
resource definition</h4>
<p>The CSI reference resource for a serving cell is defined as
follows:</p>
<p>- In the frequency domain, the CSI reference resource is defined by
the group of downlink physical resource blocks corresponding to the band
to which the derived CSI relates.</p>
<p>- In the time domain, the CSI reference resource for a CSI reporting
in uplink slot <em>n'</em> is defined by a single downlink slot <span
class="math inline">\(n - n_{CSI\_ ref} - K_{offset} \cdot
\frac{2^{\mu_{DL}}}{2^{\mu_{K_{offset}}}}\)</span><em>,</em> where <span
class="math inline">\(K_{offset}\)</span> is a parameter configured by
higher layer as specified in clause 4.2 of [6 TS 38.213], and where
<span class="math inline">\(\mu_{K_{offset}}\)</span>is the subcarrier
spacing configuration for <span
class="math inline">\(K_{offset}\)</span> with a value of 0 for
frequency range 1,</p>
<p>- where <img src="media/image666.svg" /> <span
class="math inline">\(+ \left\lfloor \left(
\frac{N_{slot,offset,UL}^{CA}}{2^{\mu_{offset,UL}}} -
\frac{N_{slot,offset,DL}^{CA}}{2^{\mu_{offset,DL}}} \right) \bullet
2^{\mu_{DL}} \right\rfloor\ \)</span>and <img
src="media/image667.svg" />and <img src="media/image668.svg" /> are the
subcarrier spacing configurations for DL and UL, respectively, and <span
class="math inline">\(N_{\text{slot, offset}}^{\text{CA}}\)</span> and
<img src="media/image15.svg" /> are determined by higher-layer
configured ca-SlotOffset for the cells transmitting the uplink and
downlink, as defined in clause 4.5 of [4, TS 38.211]</p>
<p>- where for periodic and semi-persistent CSI reporting</p>
<p>- if a single CSI-RS/SSB resource is configured for channel
measurement <em>n<sub>CSI_ref</sub></em> is the smallest value greater
than or equal to <span class="math inline">\(4 \cdot
2^{µ_{DL}}\)</span>, such that it corresponds to a valid downlink slot,
or</p>
<p>- if multiple CSI-RS/SSB resources are configured for channel
measurement <em>n<sub>CSI_ref</sub></em> is the smallest value greater
than or equal to <img src="media/image669.svg" />, such that it
corresponds to a valid downlink slot.</p>
<p>- where for aperiodic CSI reporting, if the UE is indicated by the
DCI to report CSI in the same slot as the CSI request,
<em>n<sub>CSI_ref</sub></em> is such that the reference resource is in
the same valid downlink slot as the corresponding CSI request, otherwise
<em>n<sub>CSI_ref</sub></em> is the smallest value greater than or equal
to <img src="media/image670.svg" />, such that slot <em>n</em>-
<em>n<sub>CSI_ref</sub></em> corresponds to a valid downlink slot, where
<em>Z'</em> corresponds to the delay requirement as defined in Clause
5.4.</p>
<p>- when periodic or semi-persistent CSI-RS/CSI-IM or SSB is used for
channel/interference measurements, the UE is not expected to measure
channel/interference on the CSI-RS/CSI-IM/SSB whose last OFDM symbol is
received up to <em>Z'</em> symbols before transmission time of the first
OFDM symbol of the aperiodic CSI reporting.</p>
<p>A slot in a serving cell shall be considered to be a valid downlink
slot if:</p>
<p>- it comprises at least one higher layer configured downlink or
flexible symbol, and</p>
<p>- it does not fall within a configured measurement gap for that
UE</p>
<p>If there is no valid downlink slot for the CSI reference resource
corresponding to a CSI Report Setting in a serving cell, CSI reporting
is omitted for the serving cell in uplink slot <em>n'</em>.</p>
<p>For a CSI report with <em>reportQuantity</em> not set to
'ssb-Index-RSRP', 'ssb-Index-SINR', 'ssb-Index-RSRP-Index' or
'ssb-Index-SINR-Index', after the CSI report (re)configuration, serving
cell activation, BWP change, or activation of SP-CSI, the UE reports a
CSI report only after receiving at least one CSI-RS transmission
occasion for channel measurement and CSI-RS and/or CSI-IM occasion for
interference measurement no later than CSI reference resource and drops
the report otherwise.</p>
<p>For a CSI-ReportConfig configured with two Resource Groups and <span
class="math inline">\(N\)</span> Resource Pairs for channel measurement
in the corresponding CSI-RS Resource Set, as described in clause
5.2.1.4.1, after the CSI report (re)configuration, serving cell
activation, BWP change, or activation of SP-CSI, the UE reports a CSI
report only after receiving at least one CSI-RS transmission occasion
for each of the CSI-RS resources in the corresponding CSI-RS Resource
Set for channel measurement and one CSI-IM occasion for each of the
CSI-IM resources in the corresponding Resource Set for interference
measurement no later than the CSI reference resource and within the same
DRX Active Time when DRX is configured, and drops the report
otherwise.</p>
<p>When DRX is configured, the UE reports a CSI report with the
<em>reportQuantity</em> not set to 'ssb-Index-RSRP', 'ssb-Index-SINR',
'ssb-Index-RSRP-Index' or 'ssb-Index-SINR-Index' only if receiving at
least one CSI-RS transmission occasion for channel measurement and
CSI-RS and/or CSI-IM occasion for interference measurement in DRX Active
Time no later than CSI reference resource and drops the report
otherwise. When the UE is configured to monitor DCI format 2_6 and if
the UE configured by higher layer parameter
<em>ps-TransmitOtherPeriodicCSI</em> to report CSI with the higher layer
parameter <em>reportConfigType</em> set to 'periodic' and
<em>reportQuantity</em> set to quantities other than 'cri-RSRP',
'ssb-Index-RSRP', 'cri-RSRP-Index', and 'ssb-Index-RSRP-Index ' when
<em>drx-onDurationTimer</em> is not started, the UE shall report CSI
with the <em>reportQuantity</em> not set to 'ssb-Index-SINR' or
'ssb-Index-SINR-Index' during the time duration indicated by
<em>drx-onDurationTimer</em> in <em>DRX-Config</em> also outside active
time according to the procedure described in Clause 5.2.1.4 if receiving
at least one CSI-RS transmission occasion for channel measurement and
CSI-RS and/or CSI-IM occasion for interference measurement during the
time duration indicated by <em>drx-onDurationTimer</em> in
<em>DRX-Config</em> outside DRX active time or in DRX Active Time no
later than CSI reference resource and drops the report otherwise. When
the UE is configured to monitor DCI format 2_6 and if the UE configured
by higher layer parameter <em>ps-TransmitPeriodicL1-RSRP</em> to report
L1-RSRP with the higher layer parameter <em>reportConfigType</em> set to
'periodic' and <em>reportQuantity</em> set to 'cri-RSRP',
'ssb-Index-RSRP', 'cri-RSRP- Index', or 'ssb-Index-RSRP- Index' when
<em>drx-onDurationTimer</em> is not started, the UE shall report L1-RSRP
during the time duration indicated by <em>drx-onDurationTimer</em> in
<em>DRX-Config</em> also outside active time according to the procedure
described in clause 5.2.1.4 and when <em>reportQuantity</em> set to
'<em>cri-RSRP'</em> or <em>'cri-RSRP</em>- <em>Index'</em> if receiving
at least one CSI-RS transmission occasion for channel measurement during
the time duration indicated by <em>drx-onDurationTimer</em> in
<em>DRX-Config</em> outside DRX active time or in DRX Active Time no
later than CSI reference resource and drops the report otherwise.</p>
<p>When deriving CSI feedback, the UE is not expected that a NZP CSI -RS
resource for channel measurement overlaps with CSI-IM resource for
interference measurement or NZP CSI -RS resource for interference
measurement.</p>
<p>If configured to report CQI index, in the CSI reference resource, the
UE shall assume the following for the purpose of deriving the CQI index,
and if also configured, for deriving PMI and RI:</p>
<p>- The first 2 OFDM symbols are occupied by control signaling.</p>
<p>- The number of PDSCH and DM-RS symbols is equal to 12.</p>
<p>- The same bandwidth part subcarrier spacing configured as for the
PDSCH reception</p>
<p>- The bandwidth as configured for the corresponding CQI report.</p>
<p>- The IAB-MT shall only assume the frequency resources as indicated
by the DL TX power adjustment MAC CE, if indicated for the slot of the
CSI reference resource by DL Tx Power Adjustment MAC CE as described in
[10, TS 38.321].</p>
<p>- The reference resource uses the CP length and subcarrier spacing
configured for PDSCH reception</p>
<p>- No resource elements used by primary or secondary synchronization
signals or PBCH.</p>
<p>- Redundancy Version 0.</p>
<p>- The ratio of PDSCH EPRE to CSI-RS EPRE is as given in Clause
5.2.2.3.1.</p>
<p>- In addition, the IAB-MT shall apply the provided DL TX power
adjustment, if indicated for the slot of the CSI reference resource by
DL Tx Power Adjustment MAC CE as described in [10, TS 38.321].</p>
<p>- Assume no REs allocated for NZP CSI-RS and ZP CSI-RS.</p>
<p>- Assume the same number of front-loaded DM-RS symbols as the maximum
front-loaded symbols configured by the higher layer parameter
<em>maxLength</em> in <em>DMRS-DownlinkConfig.</em></p>
<p>- Assume the same number of additional DM-RS symbols as the
additional symbols configured by the higher layer parameter
<em>dmrs-AdditionalPosition</em>.</p>
<p>- Assume the PDSCH symbols are not containing DM-RS.</p>
<p>- Assume PRB bundling size of 2 PRBs.</p>
<p>- The PDSCH transmission scheme where the UE may assume that PDSCH
transmission would be performed with up to 8 transmission layers as
defined in Clause 7.3.1.4 of [4, TS 38.211]. For CQI calculation, the UE
should assume that PDSCH signals on antenna ports in the set [1000,…,
1000+ν-1] for ν layers would result in signals equivalent to
corresponding symbols transmitted on antenna ports [3000,…,
3000+<em>P</em>-1], as given by</p>
<p><span class="math inline">\(\left\lbrack \begin{array}{r}
y^{(3000)}(i) \\
\cdots \\
y^{(3000 + P - 1)}(i)
\end{array} \right\rbrack = W(i)\left\lbrack \begin{array}{r}
x^{(0)}(i) \\
\cdots \\
x^{(\nu - 1)}(i)
\end{array} \right\rbrack\)</span></p>
<p>where <img src="media/image671.svg" /> is a vector of PDSCH symbols
from the layer mapping defined in Clause 7.3.1.4 of [4, TS 38.211], <img
src="media/image672.svg" /> is the number of CSI-RS ports. If only one
CSI-RS port is configured, <em>W(i)</em> is 1. If the higher layer
parameter <em>reportQuantity</em> in <em>CSI-ReportConfig</em> for which
the CQI is reported is set to either 'cri-RI-PMI-CQI' or
'cri-RI-LI-PMI-CQI', <em>W(i)</em> is the precoding matrix corresponding
to the reported PMI applicable to <em>x(i)</em>. If the higher layer
parameter <em>reportQuantity</em> in <em>CSI-ReportConfig</em> for which
the CQI is reported is set to 'cri-RI-CQI', <em>W(i)</em> is the
precoding matrix corresponding to the procedure described in Clause
5.2.1.4.2. If the higher layer parameter <em>reportQuantity</em> in
<em>CSI-ReportConfig</em> for which the CQI is reported is set to
'cri-RI-i1-CQI', <em>W(i)</em> is the precoding matrix corresponding to
the reported i1 according to the procedure described in Clause
5.2.1.4.2. The corresponding PDSCH signals transmitted on antenna ports
[3000,…,3000 + <em>P</em> - 1] would have a ratio of EPRE to CSI-RS EPRE
equal to the ratio given in Clause 5.2.2.3.1. If the higher layer
parameter <em>reportQuantity</em> in <em>CSI-ReportConfig</em> for which
the CQI is reported is set to either 'cri-RI-PMI-CQI' or
'cri-RI-LI-PMI-CQI', the corresponding CSI-RS Resource Set for channel
measurement is configured with two Resource Groups and <span
class="math inline">\(N\)</span> Resource Pairs, as described in clause
5.2.1.4.1, the reported CRI corresponds to an entry of the <span
class="math inline">\(N\)</span> Resource Pairs, and the reported rank
combination is <span class="math inline">\(\{\nu_{1},\nu_{2}\}\)</span>,
as described in clause 5.2.1.4.2, for CQI calculation, the UE should
assume that</p>
<p>- PDSCH signals on antenna ports in the set <span
class="math inline">\(\lbrack 1000,\ldots,1000 + \nu_{1} -
1\rbrack\)</span> for <span class="math inline">\(\nu_{1}\)</span>
layers would result in signals equivalent to corresponding symbols
transmitted on antenna ports <span class="math inline">\(\lbrack
3000,\ldots,3000 + P - 1\rbrack\)</span> of the Group 1 CSI-RS resource
in the Resource Pair indicated by the CRI, and PDSCH signals on antenna
ports in the set <span class="math inline">\(\lbrack 1000 +
\nu_{1},\ldots,1000 + \nu_{1} + \nu_{2} - 1\rbrack\)</span> for <span
class="math inline">\(\nu_{2}\)</span> layers would result in signals
equivalent to corresponding symbols transmitted on antenna ports <span
class="math inline">\(\lbrack 3000,\ldots,3000 + P - 1\rbrack\)</span>
of the Group 2 CSI-RS resource in the Resource Pair indicated by the
CRI, as given by</p>
<p><span class="math inline">\(\left\lbrack \begin{array}{r}
y_{j}^{(3000)}(i) \\
\cdots \\
y_{j}^{(3000 + P - 1)}(i)
\end{array} \right\rbrack = W_{j}(i)\left\lbrack \begin{array}{r}
x^{\left( (j - 1) \cdot \nu_{1} \right)}(i) \\
\cdots \\
x^{\left( \nu_{1} + (j - 1) \cdot \nu_{2} - 1 \right)}(i)
\end{array} \right\rbrack\)</span></p>
<p>where <span class="math inline">\(W_{j}(i)\)</span>, <span
class="math inline">\(j = 1,2\)</span> are the two precoding matrices
corresponding to the two reported PMIs applicable to <span
class="math inline">\(x(i)\)</span>, as described in clause 5.2.1.4.2;
and the indices <span class="math inline">\(j = 1,2\)</span> are
associated to the two Resource Groups configured in the corresponding
CSI-RS Resource Set for channel measurement; that the signals <span
class="math inline">\(y_{j}\)</span>, <span class="math inline">\(j =
1,2\)</span>, fully overlap in time and frequency, and that, for the
calculation of RI, PMI and LI (if configured) of <span
class="math inline">\(\nu_{j}\)</span> layers, <span
class="math inline">\(j = 1,2\)</span>, the interference from the other
<span class="math inline">\(\nu_{(j\ mod\ 2) + 1}\)</span> layers is
derived from channel measurement and precoding matrix corresponding to
the other <span class="math inline">\(\nu_{(j\ mod\ 2) + 1}\)</span>
layers.</p>
<p>- The UE shall assume that the corresponding PDSCH signals for <span
class="math inline">\(\nu_{j}\)</span> layers transmitted on the <span
class="math inline">\(P\)</span> antenna ports of the CSI-RS resource in
Group <span class="math inline">\(j\)</span> would have a ratio of EPRE
to CSI-RS EPRE equal to the <em>powerControlOffset</em> of the
respective CSI-RS resource, for <span class="math inline">\(j =
1,2\)</span>.</p>
<h3 id="csi-reporting-using-pusch">5.2.3 CSI reporting using PUSCH</h3>
<p>A UE shall perform aperiodic CSI reporting using PUSCH on serving
cell c upon successful decoding of a DCI format 0_1 or DCI format 0_2
which triggers an aperiodic CSI trigger state.</p>
<p>When a DCI format 0_1 schedules two PUSCH allocations, the aperiodic
CSI report is carried on the second scheduled PUSCH. When a DCI format
0_1 schedules more than two PUSCH allocations, the aperiodic CSI report
is carried on the penultimate scheduled PUSCH.</p>
<p>An aperiodic CSI report carried on the PUSCH supports wideband, and
sub-band frequency granularities. An aperiodic CSI report carried on the
PUSCH supports Type I, Type II, Enhanced Type II and Further Enhanced
Type II Port Selection CSI.</p>
<p>A UE shall perform semi-persistent CSI reporting on the PUSCH upon
successful decoding of a DCI format 0_1 or DCI format 0_2 which
activates a semi-persistent CSI trigger state. DCI format 0_1 and DCI
format 0_2 contains a CSI request field which indicates the
semi-persistent CSI trigger state to activate or deactivate.
Semi-persistent CSI reporting on the PUSCH supports Type I, Type II with
wideband, and sub-band frequency granularities, Enhanced Type II and
Further Enhanced Type II Port Selection CSI. The PUSCH resources and MCS
shall be allocated semi-persistently by an uplink DCI.</p>
<p>CSI reporting on PUSCH can be multiplexed with uplink data on PUSCH
except that semi-persistent CSI reporting on PUSCH activated by a DCI
format is not expected to be multiplexed with uplink data on the PUSCH.
CSI reporting on PUSCH can also be performed without any multiplexing
with uplink data from the UE.</p>
<p>Type I CSI feedback is supported for CSI Reporting on PUSCH. Type I
wideband and sub-band CSI is supported for CSI Reporting on the PUSCH.
Type II CSI is supported for CSI Reporting on the PUSCH.</p>
<p>For Type I, Type II, Enhanced Type II and Further Enhanced Type II
Port Selection CSI feedback on PUSCH, a CSI report comprises of two
parts. Part 1 has a fixed payload size and is used to identify the
number of information bits in Part 2. Part 1 shall be transmitted in its
entirety before Part 2.</p>
<p>- For Type I CSI feedback, Part 1 contains RI (if reported), CRI (if
reported), CQI for the first codeword (if reported). Part 2 contains PMI
(if reported), LI (if reported) and contains the CQI for the second
codeword (if reported) when RI is larger than 4. For a
<em>CSI-ReportConfig</em> configured with <em>codebookType</em> set to
'typeI-SinglePanel' and the corresponding CSI-RS Resource Set for
channel measurement configured with two Resource Groups and <span
class="math inline">\(N\)</span> Resource Pairs, Part 1 contains RI(s),
CRI(s), CQI(s) for the first codeword and is zero padded to a fixed
payload size (if needed). Part 2 contains the CQI(s) for the second
codeword (if reported) when RI is larger than 4, LIs (if reported) and
PMI(s).</p>
<p>- For Type II CSI feedback, Part 1 contains RI (if reported), CQI,
and an indication of the number of non-zero wideband amplitude
coefficients per layer for the Type II CSI (see Clause 5.2.2.2.3). The
fields of Part 1 – RI (if reported), CQI, and the indication of the
number of non-zero wideband amplitude coefficients for each layer – are
separately encoded. Part 2 contains the PMI and LI (if reported) of the
Type II CSI. The elements of <span
class="math inline">\(i_{1,1}\)</span> are reported in the increasing
order of their indices, where the element of the lowest index is mapped
to the most significant bits and the element of the highest index is
mapped to the least significant bits. The elements of <span
class="math inline">\(i_{1,4,l}\)</span>, <span
class="math inline">\(i_{2,1,l}\)</span> (if reported) and <span
class="math inline">\(i_{2,2,l}\)</span> (if reported) are reported in
the increasing order of their indices, <span class="math inline">\(i =
0,1,\ldots,\ 2L - 1\)</span>, where the element of the lowest index is
mapped to the most significant bits and the element of the highest index
is mapped to the least significant bits. Part 1 and 2 are separately
encoded.</p>
<p>- For Enhanced Type II CSI feedback (see Clause 5.2.2.2.5) and
Further Enhanced Type II Port Selection CSI feedback (see Clause
5.2.2.2.7), Part 1 contains RI (if reported), CQI, and an indication of
the overall number of non-zero amplitude coefficients across layers. The
fields of Part 1 – RI (if reported), CQI, and the indication of the
overall number of non-zero amplitude coefficients across layers – are
separately encoded. Part 2 contains the PMI of the Enhanced Type II or
Further Enhanced Type II Port Selection CSI. Part 1 and 2 are separately
encoded.</p>
<p>A Type II CSI report that is carried on the PUSCH shall be computed
independently from any Type II CSI report that is carried on the PUCCH
formats 3 or 4 (see Clause 5.2.4 and 5.2.2).</p>
<p>When the higher layer parameter <em>reportQuantity</em> is configured
with one of the values 'cri-RSRP', 'ssb-Index-RSRP', 'cri-SINR' or
'ssb-Index-SINR', or 'cri-RSRP- Index', 'ssb-Index-RSRP- Index ',
'cri-SINR- Index ', 'ssb-Index-SINR- Index ',the CSI feedback consists
of a single part.</p>
<p>For both Type I and Type II reports configured for PUCCH but
transmitted on PUSCH, the determination of the payload for CSI part 1
and CSI part 2 follows that of PUCCH as described in Clause 5.2.4.</p>
<p>When CSI reporting on PUSCH comprises two parts, the UE may omit a
portion of the Part 2 CSI. Omission of Part 2 CSI is according to the
priority order shown in Table 5.2.3-1, where <img
src="media/image673.svg" /> is the number of CSI reports configured to
be carried on the PUSCH. Priority 0 is the highest priority and priority
<img src="media/image674.svg" /> is the lowest priority and the CSI
report <em>n</em> corresponds to the CSI report with the <em>n</em>th
smallest Pri<sub>i,CSI</sub>(<em>y,k,c,s</em>) value among the <img
src="media/image673.svg" /> CSI reports as defined in Clause 5.2.5. The
subbands for a given CSI report <em>n</em> indicated by the higher layer
parameter <em>csi-ReportingBand</em> with value '1' are numbered
continuously in increasing order with the lowest subband of
<em>csi-ReportingBand</em> with value set to '1' as subband 0. When
omitting Part 2 CSI information for a particular priority level, the UE
shall omit all of the information at that priority level.</p>
<p>- For Enhanced Type II reports, for a given CSI report <span
class="math inline">\(n\)</span>, each reported element of indices <span
class="math inline">\(i_{2,4,l}\)</span> <span
class="math inline">\(i_{2,5,l}\ \)</span>and <span
class="math inline">\(i_{1,7,l}\)</span>, indexed by <span
class="math inline">\(l,i\)</span> and <span
class="math inline">\(f\)</span>, is associated with a priority value
<span class="math inline">\(Pri(l,i,f) = 2 \cdot L \cdot \upsilon \cdot
\pi(f) + \upsilon \cdot i + l\)</span>, with <span
class="math inline">\(\pi(f) = min(2 \cdot n_{3,l}^{(f)},2 \cdot \left(
N_{3} - n_{3,l}^{(f)} \right) - 1)\)</span> with <span
class="math inline">\(l = 1,2,\ldots,\upsilon\)</span>, <span
class="math inline">\(i = 0,1,\ldots,2L - 1\)</span>, and <span
class="math inline">\(f = 0,1,\ldots,M_{\upsilon} - 1\)</span>, and
where <span class="math inline">\(n_{3,l}^{(f)}\)</span> is defined in
Clause 5.2.2.2.5. The element with the highest priority has the lowest
associated value <span class="math inline">\(Pri(l,i,f)\)</span>.
Omission of Part 2 CSI is according to the priority order shown in Table
5.2.3-1, where</p>
<p>- Group 0 includes indices <span
class="math inline">\(i_{1,1}\)</span> (if reported), <span
class="math inline">\(i_{1,2}\)</span> (if reported) and <span
class="math inline">\(i_{1,8,l}\)</span> (<span class="math inline">\(l
= 1,\ldots,\upsilon\)</span>).</p>
<p>- Group 1 includes indices <span
class="math inline">\(i_{1,5}\)</span> (if reported), <span
class="math inline">\(i_{1,6,l}\)</span> (if reported), the <span
class="math inline">\(\upsilon 2LM_{\upsilon} - \left\lfloor K^{NZ}/2
\right\rfloor\)</span> highest priority elements of <span
class="math inline">\(i_{1,7,l}\)</span>, <span
class="math inline">\(i_{2,3,l}\)</span>, the <span
class="math inline">\(\max\left( 0,\left\lceil \frac{K^{NZ}}{2}
\right\rceil - \upsilon \right)\)</span> highest priority elements of
<span class="math inline">\(i_{2,4,l}\)</span> and the <span
class="math inline">\(\max\left( 0,\left\lceil \frac{K^{NZ}}{2}
\right\rceil - \upsilon \right)\)</span> highest priority elements of
<span class="math inline">\(i_{2,5,l}\)</span> (<span
class="math inline">\(l = 1,\ldots,\upsilon\)</span>).</p>
<p>- Group 2 includes the <span class="math inline">\(\left\lfloor
K^{NZ}/2 \right\rfloor\)</span> lowest priority elements of <span
class="math inline">\(i_{1,7,l}\)</span>, the <span
class="math inline">\(\min\left( K^{NZ} - \nu,\left\lfloor
\frac{K^{NZ}}{2} \right\rfloor \right)\)</span> lowest priority elements
of <span class="math inline">\(i_{2,4,l}\)</span> and the <span
class="math inline">\(\min\left( K^{NZ} - \nu,\left\lfloor
\frac{K^{NZ}}{2} \right\rfloor \right)\)</span> lowest priority elements
of <span class="math inline">\(i_{2,5,l}\)</span> (<span
class="math inline">\(l = 1,\ldots,\upsilon\)</span>).</p>
<p>- For Further Enhanced Type II Port Selection reports, for a given
CSI report <span class="math inline">\(n\)</span>, each reported element
of <span class="math inline">\(i_{2,4,l}\)</span> <span
class="math inline">\(i_{2,5,l}\ \)</span>and <span
class="math inline">\(i_{1,7,l}\)</span>, indexed by <span
class="math inline">\(l\)</span>, <span class="math inline">\(i\)</span>
and <span class="math inline">\(f\)</span>, is associated with a
priority value <span class="math inline">\(Pri(l,i,f) = K_{1} \cdot
\upsilon \cdot f + \upsilon \cdot i + l\)</span>, with <span
class="math inline">\(l = 1,2,\ldots,\nu\)</span>, <span
class="math inline">\(i = 0,1,\ldots,K_{1} - 1\)</span> and <span
class="math inline">\(f = 0,\ldots,M - 1\)</span>. The element with the
highest priority has the lowest associated value <span
class="math inline">\(Pri(l,i,f)\)</span>. Omission of Part 2 CSI is
according to the priority order shown in Table 5.2.3-1, where:</p>
<p>- Group 0 includes <span class="math inline">\(i_{1,2}\)</span> (if
reported), <span class="math inline">\(i_{1,8,l}\)</span> (<span
class="math inline">\(l = 1,\ldots,\upsilon\)</span>) and <span
class="math inline">\(i_{1,6}\)</span> (if reported).</p>
<p>- Group 1 includes the <span class="math inline">\(\upsilon K_{1}M -
\left\lfloor K^{NZ}/2 \right\rfloor\)</span> highest priority elements
of <span class="math inline">\(i_{1,7,l}\)</span> (if reported), <span
class="math inline">\(i_{2,3,l}\)</span>, the <span
class="math inline">\(\max\left( 0,\left\lceil \frac{K^{NZ}}{2}
\right\rceil - \upsilon \right)\)</span> highest priority elements of
<span class="math inline">\(i_{2,4,l}\)</span> and the <span
class="math inline">\(\max\left( 0,\left\lceil \frac{K^{NZ}}{2}
\right\rceil - \upsilon \right)\)</span> highest priority elements of
<span class="math inline">\(i_{2,5,l}\)</span> (<span
class="math inline">\(l = 1,\ldots,\upsilon\)</span>).</p>
<p>- Group 2 includes the <span class="math inline">\(\left\lfloor
K^{NZ}/2 \right\rfloor\)</span> lowest priority elements of <span
class="math inline">\(i_{1,7,l}\)</span> (if reported), the <span
class="math inline">\(\min\left( K^{NZ} - \nu,\left\lfloor
\frac{K^{NZ}}{2} \right\rfloor \right)\)</span> lowest priority elements
of <span class="math inline">\(i_{2,4,l}\)</span> and the <span
class="math inline">\(\min\left( K^{NZ} - \nu,\left\lfloor
\frac{K^{NZ}}{2} \right\rfloor \right)\)</span> lowest priority elements
of <span class="math inline">\(i_{2,5,l}\)</span> (<span
class="math inline">\(l = 1,\ldots,\upsilon\)</span>).</p>
<p>Table 5.2.3-1: Priority reporting levels for Part 2 CSI</p>
<table>
<colgroup>
<col style="width: 100%" />
</colgroup>
<thead>
<tr>
<th style="text-align: center;"><p>Priority 0:</p>
<p>For CSI reports 1 to <span class="math inline">\(N_{Rep}\)</span>,
Group 0 CSI for CSI reports configured as 'typeII-r16',
'typeII-PortSelection-r16' or 'typeII-PortSelection-r17'; Part 2
wideband CSI for CSI reports configured otherwise</p></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;"><p>Priority 1:</p>
<p>Group 1 CSI for CSI report 1, if configured as 'typeII-r16',
'typeII-PortSelection-r16' or 'typeII-PortSelection-r17'; Part 2 subband
CSI of even subbands for CSI report 1, if configured otherwise</p></td>
</tr>
<tr>
<td style="text-align: center;"><p>Priority 2:</p>
<p>Group 2 CSI for CSI report 1, if configured as 'typeII-r16',
'typeII-PortSelection-r16' or 'typeII-PortSelection-r17'; Part 2 subband
CSI of odd subbands for CSI report 1, if configured otherwise</p></td>
</tr>
<tr>
<td style="text-align: center;"><p>Priority 3:</p>
<p>Group 1 CSI for CSI report 2, if configured as 'typeII-r16',
'typeII-PortSelection-r16' or 'typeII-PortSelection-r17'; Part 2 subband
CSI of even subbands for CSI report 2, if configured otherwise</p></td>
</tr>
<tr>
<td style="text-align: center;"><p>Priority 4:</p>
<p>Group 2 CSI for CSI report 2, if configured as 'typeII-r16',
'typeII-PortSelection-r16' or 'typeII-PortSelection-r17'. Part 2 subband
CSI of odd subbands for CSI report 2, if configured otherwise</p></td>
</tr>
<tr>
<td style="text-align: center;">⁞</td>
</tr>
<tr>
<td style="text-align: center;"><p>Priority <span
class="math inline">\(2N_{Rep} - 1\)</span>:</p>
<p>Group 1 CSI for CSI report <span
class="math inline">\(N_{Rep}\)</span>, if configured as 'typeII-r16',
'typeII-PortSelection-r16' or 'typeII-PortSelection-r17'; Part 2 subband
CSI of even subbands for CSI report <span
class="math inline">\(N_{Rep}\)</span>, if configured otherwise</p></td>
</tr>
<tr>
<td style="text-align: center;"><p>Priority <span
class="math inline">\(2N_{Rep}\)</span>:</p>
<p>Group 2 CSI for CSI report <span
class="math inline">\(N_{Rep}\)</span>, if configured as 'typeII-r16',
'typeII-PortSelection-r16' or 'typeII-PortSelection-r17'; Part 2 subband
CSI of odd subbands for CSI report <span
class="math inline">\(N_{Rep}\)</span>, if configured otherwise</p></td>
</tr>
</tbody>
</table>
<p>When the UE is scheduled to transmit a transport block on PUSCH not
using repetition type B multiplexed with a CSI report(s) and if
<em>numberOfSlotsTBoMS</em> is not present in the resource allocation
table, or if <em>numberOfSlotsTBoMS</em> is present in the resource
allocation table and the value of <em>numberOfSlotsTBoMS</em> in the row
indicated by the Time domain resource assignment field in DCI is equal
to 1, Part 2 CSI is omitted only when <img src="media/image675.svg"
style="width:2.85069in;height:0.46736in" /> is larger than <span
class="math inline">\(\left\lceil \alpha \bullet \sum_{l =
0}^{N_{\text{symb,all}}^{\text{PUSCH}} -
1}{M_{\text{sc}}^{\text{UCI}}(l)} \right\rceil - Q_{ACK/CG - UCI}&#39; -
Q_{\text{CSI-1}}&#39;\)</span>, where parameters <img
src="media/image676.svg" style="width:0.38958in;height:0.25347in" />,
<img src="media/image677.svg" style="width:0.325in;height:0.23403in" />,
<img src="media/image678.svg"
style="width:0.49375in;height:0.24653in" />, <img
src="media/image679.svg" style="width:0.42847in;height:0.25347in" />,
<img src="media/image680.svg"
style="width:0.50625in;height:0.25347in" />, <img
src="media/image681.svg" style="width:0.51944in;height:0.25347in" />,
<img src="media/image682.svg"
style="width:0.22708in;height:0.25347in" />, <img
src="media/image683.svg" style="width:0.44167in;height:0.25347in" />,
<span class="math inline">\(Q_{ACK/CG - UCI}&#39;\)</span> and <img
src="media/image684.svg" style="width:0.15556in;height:0.13611in" />are
defined in Clause 6.3.2.4 of [5, TS 38.212].</p>
<p>Part 2 CSI is omitted level by level, beginning with the lowest
priority level until the lowest priority level is reached which causes
the <img src="media/image675.svg"
style="width:2.85069in;height:0.46736in" /> to be less than or equal to
<span class="math inline">\(\left\lceil \alpha \bullet \sum_{l =
0}^{N_{\text{symb,all}}^{\text{PUSCH}} -
1}{M_{\text{sc}}^{\text{UCI}}(l)} \right\rceil - Q_{ACK/CG - UCI}&#39; -
Q_{\text{CSI-1}}&#39;\)</span>.</p>
<p>When the UE is scheduled to transmit a transport block on PUSCH not
using repetition type B multiplexed with a CSI report(s) and if
<em>numberOfSlotsTBoMS</em> is present in the resource allocation table
and the value of <em>numberOfSlotsTBoMS</em> in the row indicated by the
Time domain resource assignment field in DCI is larger than 1, Part 2
CSI is omitted only when <span class="math inline">\(\left\lceil
\frac{\left( O_{CSI - 2} + L_{CSI - 2} \right) \bullet
\beta_{offset}^{PUSCH} \bullet \sum_{l = 0}^{N_{symb,all}^{PUSCH} -
1}{M_{sc}^{UCI}(l)}}{\frac{1}{N_{s}}\sum_{r = 0}^{C_{UL - SCH} -
1}K_{r}} \right\rceil\)</span> is larger than <span
class="math inline">\(\left\lceil \alpha \bullet \sum_{l =
0}^{N_{\text{symb,all}}^{\text{PUSCH}} -
1}{M_{\text{sc}}^{\text{UCI}}(l)} \right\rceil - Q_{ACK/CG - UCI}&#39; -
Q_{\text{CSI-1}}&#39;\)</span>, where parameters <img
src="media/image676.svg" style="width:0.38958in;height:0.25347in" />,
<img src="media/image677.svg" style="width:0.325in;height:0.23403in" />,
<img src="media/image678.svg"
style="width:0.49375in;height:0.24653in" />, <img
src="media/image679.svg" style="width:0.42847in;height:0.25347in" />,
<img src="media/image680.svg"
style="width:0.50625in;height:0.25347in" />, <img
src="media/image681.svg" style="width:0.51944in;height:0.25347in" />,
<img src="media/image682.svg"
style="width:0.22708in;height:0.25347in" />, <span
class="math inline">\(N_{s}\ \)</span>,<img src="media/image683.svg"
style="width:0.44167in;height:0.25347in" />, <span
class="math inline">\(Q_{ACK/CG - UCI}&#39;\)</span> and <img
src="media/image684.svg" style="width:0.15556in;height:0.13611in" />are
defined in Clause 6.3.2.4 of [5, TS 38.212].</p>
<p>Part 2 CSI is omitted level by level, beginning with the lowest
priority level until the lowest priority level is reached which causes
the <span class="math inline">\(\left\lceil \frac{\left( O_{CSI - 2} +
L_{CSI - 2} \right) \bullet \beta_{offset}^{PUSCH} \bullet \sum_{l =
0}^{N_{symb,all}^{PUSCH} - 1}{M_{sc}^{UCI}(l)}}{\frac{1}{N_{s}}\sum_{r =
0}^{C_{UL - SCH} - 1}K_{r}} \right\rceil\ \)</span>to be less than or
equal to <span class="math inline">\(\left\lceil \alpha \bullet \sum_{l
= 0}^{N_{\text{symb,all}}^{\text{PUSCH}} -
1}{M_{\text{sc}}^{\text{UCI}}(l)} \right\rceil - Q_{ACK/CG - UCI}&#39; -
Q_{\text{CSI-1}}&#39;\)</span>.</p>
<p>When the UE is scheduled to transmit a transport block on PUSCH using
repetition type B multiplexed with a CSI report(s), Part 2 CSI is
omitted only when</p>
<p><span class="math display">\[\left\lceil \frac{\left(
O_{\text{CSI-2}} + L_{\text{CSI-2}} \right) \bullet
\beta_{\text{offset}}^{\text{PUSCH}} \bullet \sum_{l =
0}^{N_{\text{symb,nominal}}^{\text{PUSCH}} -
1}{M_{\text{sc,nominal}}^{\text{UCI}}(l)}}{\sum_{r =
0}^{C_{\text{UL-SCH}} - 1}K_{r}} \right\rceil\]</span></p>
<p>is larger than</p>
<p><span class="math inline">\(\min\left\{ \begin{array}{r}
\left\lceil \alpha \bullet \sum_{l =
0}^{N_{\text{symb,nominal}}^{\text{PUSCH}} -
1}{M_{\text{sc,nominal}}^{\text{UCI}}(l)} \right\rceil - Q_{ACK/CG -
UCI}&#39; - Q_{\text{CSI-1}}&#39;\ ,\ \  \\
\sum_{l = 0}^{N_{\text{symb,actual}}^{\text{PUSCH}} -
1}{M_{\text{sc,actual}}^{\text{UCI}}(l)} - Q_{ACK/CG - UCI}&#39; -
Q_{\text{CSI-1}}&#39;
\end{array} \right\}\)</span>,</p>
<p>where parameters <img src="media/image676.svg"
style="width:0.38958in;height:0.25347in" />, <img
src="media/image677.svg" style="width:0.325in;height:0.23403in" />, <img
src="media/image678.svg" style="width:0.49375in;height:0.24653in" />,
<span class="math inline">\(N_{symb\text{,nominal}}^{PUSCH}\)</span>,
<span class="math inline">\(N_{symb\text{,actual}}^{PUSCH}\)</span>,
<span class="math inline">\(M_{sc\text{,nominal}}^{UCI}(l)\)</span>,
<span class="math inline">\(M_{sc\text{,actual}}^{UCI}(l)\)</span>, <img
src="media/image681.svg" style="width:0.51944in;height:0.25347in" />,
<img src="media/image682.svg"
style="width:0.22708in;height:0.25347in" />, <span
class="math inline">\(Q_{ACK/CG - UCI}&#39;\)</span>, <img
src="media/image683.svg" style="width:0.44167in;height:0.25347in" />,
and <img src="media/image684.svg"
style="width:0.15556in;height:0.13611in" />are defined in Clause 6.3.2.4
of [5, TS 38.212].</p>
<p>Part 2 CSI is omitted level by level, beginning with the lowest
priority level until the lowest priority level is reached which
causes</p>
<p><span class="math display">\[\left\lceil \frac{\left(
O_{\text{CSI-2}} + L_{\text{CSI-2}} \right) \bullet
\beta_{\text{offset}}^{\text{PUSCH}} \bullet \sum_{l =
0}^{N_{\text{symb,nominal}}^{\text{PUSCH}} -
1}{M_{\text{sc,nominal}}^{\text{UCI}}(l)}}{\sum_{r =
0}^{C_{\text{UL-SCH}} - 1}K_{r}} \right\rceil\]</span></p>
<p>to be less than or equal to</p>
<p><span class="math inline">\(\min\left\{ \begin{array}{r}
\left\lceil \alpha \bullet \sum_{l =
0}^{N_{\text{symb,nominal}}^{\text{PUSCH}} -
1}{M_{\text{sc,nominal}}^{\text{UCI}}(l)} \right\rceil - Q_{ACK/CG -
UCI}&#39; - Q_{\text{CSI-1}}&#39;\ ,\ \  \\
\sum_{l = 0}^{N_{\text{symb,actual}}^{\text{PUSCH}} -
1}{M_{\text{sc,actual}}^{\text{UCI}}(l)} - Q_{ACK/CG - UCI}&#39; -
Q_{\text{CSI-1}}&#39;
\end{array} \right\}\)</span>.</p>
<p>When part 2 CSI is transmitted on PUSCH with no transport block,
lower priority bits are omitted until Part 2 CSI code rate, which is
given by <span class="math inline">\(\left( O_{\text{CSI-2}} +
L_{\text{CSI-2}} \right)/(N_{L} \cdot Q&#39;_{\text{CSI,2}} \cdot
Q_{m})\)</span> where <span
class="math inline">\(O_{\text{CSI-2}}\)</span>, <span
class="math inline">\(L_{\text{CSI-2}}\)</span>, <span
class="math inline">\(N_{L},Q&#39;_{\text{CSI,2}},Q_{m}\)</span> are
given in clause 6.3.2.4 of [5, 38.212] before HARQ-ACK puncturing part 2
CSI if any, is below a threshold code rate <img
src="media/image685.svg" />lower than one, where</p>
<p><img src="media/image686.svg" /></p>
<p>- <img src="media/image687.svg" />is the CSI offset value from Table
9.3-2 of [6, TS 38.213]</p>
<p>- <em>R</em> is signaled code rate in DCI</p>
<p>If the UE is in an active semi-persistent CSI reporting configuration
on PUSCH, the CSI reporting is deactivated when either the downlink BWP
or the uplink BWP is changed. Another activation command is required to
enable the semi-persistent CSI reporting.</p>
<h3 id="csi-reporting-using-pucch">5.2.4 CSI reporting using PUCCH</h3>
<p>A UE is semi-statically configured by higher layers to perform
periodic CSI Reporting on the PUCCH. A UE can be configured by higher
layers for multiple periodic CSI Reports corresponding to multiple
higher layer configured CSI Reporting Settings, where the associated CSI
Resource Settings are higher layer configured. Periodic CSI reporting on
PUCCH formats 2, 3, 4 supports Type I CSI with wideband granularity.</p>
<p>A UE shall perform semi-persistent CSI reporting on the PUCCH applied
starting from the first slot that is after slot <span
class="math inline">\(n + {3N}_{slot}^{subframe,µ}\)</span> when the UE
would transmit a PUCCH with HARQ-ACK information in slot <em>n</em>
corresponding to the PDSCH carrying the activation command described in
clause 6.1.3.16 of [10, TS 38.321] where <em>μ</em> is the SCS
configuration for the PUCCH. The activation command will contain one or
more Reporting Settings where the associated CSI Resource Settings are
configured. Semi-persistent CSI reporting on the PUCCH supports Type I
CSI. Semi-persistent CSI reporting on the PUCCH format 2 supports Type I
CSI with wideband frequency granularity. Semi-persistent CSI reporting
on PUCCH formats 3 or 4 supports Type I CSI with wideband and sub-band
frequency granularities and Type II CSI Part 1.</p>
<p>When the PUCCH carry Type I CSI with wideband frequency granularity,
the CSI payload carried by the PUCCH format 2 and PUCCH formats 3, or 4
are identical and the same irrespective of RI (if reported), CRI (if
reported). A CSI-ReportConfig with <em>codebookType</em> set to
'typeI-SinglePanel' and the corresponding CSI-RS Resource Set for
channel measurement configured with two Resource Groups and <span
class="math inline">\(N\)</span> Resource Pairs can be configured with
wideband frequency granularity only with <em>csi-ReportMode</em> set to
'Mode1' and <em>numberOfSingleTRP-CSI-Mode1</em> set to <span
class="math inline">\(X = 0\)</span>. For type I CSI sub-band reporting
on PUCCH formats 3, or 4, the payload is split into two parts. The first
part contains RI (if reported), CRI (if reported), CQI for the first
codeword. The second part contains PMI (if reported), LI (if reported)
and contains the CQI for the second codeword (if reported) when RI &gt;
4. For a <em>CSI-ReportConfig</em> configured with subband reporting,
<em>codebookType</em> set to 'typeI-SinglePanel' and the corresponding
CSI-RS Resource Set for channel measurement configured with two Resource
Groups and <span class="math inline">\(N\)</span> Resource Pairs, Part 1
contains RI(s), CRI(s), CQI(s) for the first codeword and is zero padded
to a fixed payload size (if needed). Part 2 contains the CQI(s) for the
second codeword (if reported) when RI is larger than 4, LIs (if
reported) and PMI(s).</p>
<p>A semi-persistent report carried on the PUCCH formats 3 or 4 supports
Type II CSI feedback, but only Part 1 of Type II CSI feedback (See
Clause 5.2.2 and 5.2.3). Supporting Type II CSI reporting on the PUCCH
formats 3 or 4 is a UE capability
<em>type2-SP-CSI-Feedback-LongPUCCH</em>. A Type II CSI report (Part 1
only) carried on PUCCH formats 3 or 4 shall be calculated independently
of any Type II CSI reports carried on the PUSCH (see Clause 5.2.3).</p>
<p>When the UE is configured with CSI Reporting on PUCCH formats 2, 3 or
4, each PUCCH resource is configured for each candidate UL BWP.</p>
<p>If the UE is in an active semi-persistent CSI reporting configuration
on PUCCH and has not received a deactivation command, the CSI reporting
takes place when the BWP in which the reporting is configured to take
place is the active BWP, otherwise the CSI reporting is suspended.</p>
<p>A UE is not expected to report CSI with a total number of UCI bits
and CRC bits larger than 115 bits when configured with PUCCH format 4.
For CSI reports transmitted on a PUCCH, if all CSI reports consist of
one part, the UE may omit a portion of CSI reports. Omission of CSI is
according to the priority order determined from the
Pri<sub>i,CSI</sub>(<em>y,k,c,s</em>) value as defined in Clause 5.2.5.
CSI report is omitted beginning with the lowest priority level until the
CSI report code rate is less or equal to the one configured by the
higher layer parameter <em>maxCodeRate</em>.</p>
<p>If any of the CSI reports consist of two parts, the UE may omit a
portion of Part 2 CSI. Omission of Part 2 CSI is according to the
priority order shown in Table 5.2.3-1. Part 2 CSI is omitted beginning
with the lowest priority level until the Part 2 CSI code rate is less or
equal to the one configured by higher layer parameter
<em>maxCodeRate</em>.</p>
<h3 id="priority-rules-for-csi-reports">5.2.5 Priority rules for CSI
reports</h3>
<p>For two overlapping PUSCHs, the priority rules in this clause are
applied for physical channels with same priority index according to
clause 9 in [6, TS 38.213].</p>
<p>CSI reports are associated with a priority value <span
class="math inline">\({Pri}_{iCSI}(y,k,c,s) = 2 \bullet N_{cells}
\bullet M_{s} \bullet y + N_{cells} \bullet M_{s} \bullet k + M_{s}
\bullet c + s\)</span> where</p>
<p>- <img src="media/image688.svg" /> for aperiodic CSI reports to be
carried on PUSCH <img src="media/image689.svg" /> for semi-persistent
CSI reports to be carried on PUSCH, <img src="media/image690.svg" /> for
semi-persistent CSI reports to be carried on PUCCH and <img
src="media/image691.svg" /> for periodic CSI reports to be carried on
PUCCH;</p>
<p>- <img src="media/image692.svg" /> for CSI reports carrying L1-RSRP
or L1-SINR and <img src="media/image693.svg" /> for CSI reports not
carrying L1-RSRP or L1-SINR;</p>
<p>- <em>c</em> is the serving cell index and <span
class="math inline">\(N_{cells}\)</span> is the value of the higher
layer parameter <em>maxNrofServingCells</em>;</p>
<blockquote>
<p>- <em>s</em> is the <em>reportConfigID</em> and <img
src="media/image694.svg" />is the value of the higher layer parameter
<em>maxNrofCSI-ReportConfigurations.</em></p>
</blockquote>
<p>A first CSI report is said to have priority over second CSI report if
the associated <img src="media/image695.svg" /> value is lower for the
first report than for the second report.</p>
<p>Two CSI reports are said to collide if the time occupancy of the
physical channels scheduled to carry the CSI reports overlap in at least
one OFDM symbol and are transmitted on the same carrier. When a UE is
configured to transmit two colliding CSI reports,</p>
<p>- if <em>y</em> values are different between the two CSI reports, the
following rules apply except for the case when one of the <em>y</em>
value is 2 and the other <em>y</em> value is 3 (for CSI reports
transmitted on PUSCH, as described in Clause 5.2.3; for CSI reports
transmitted on PUCCH, as described in Clause 5.2.4):</p>
<p>- The CSI report with higher <img src="media/image696.svg" /> value
shall not be sent by the UE.</p>
<p>- otherwise, the two CSI reports are multiplexed or either is dropped
based on the priority values, as described in Clause 9.2.5.2 in [6, TS
38.213].</p>
<p>If a semi-persistent CSI report to be carried on PUSCH overlaps in
time with PUSCH data transmission in one or more symbols on the same
carrier, and if the earliest symbol of these PUSCH channels starts no
earlier than N<sub>2</sub>+d<sub>2,1</sub> symbols after the last symbol
of the DCI scheduling the PUSCH where d<sub>2,1</sub> is the maximum of
the d<sub>2,1</sub> associated with the PUSCH carrying semi-persistent
CSI report and the PUSCH with data transmission, the CSI report shall
not be transmitted by the UE. Otherwise, if the timeline requirement is
not satisfied this is an error case.</p>
<p>If a UE would transmit a first PUSCH that includes semi-persistent
CSI reports and a second PUSCH that includes an UL-SCH on the same
carrier, and the first PUSCH transmission would overlap in time with the
second PUSCH transmission, the UE does not transmit the first PUSCH and
transmits the second PUSCH. The UE expects that the first and second
PUSCH transmissions satisfy the above timing conditions for PUSCH
transmissions that overlap in time when at least one of the first or
second PUSCH transmissions is in response to a DCI format detection by
the UE.</p>
<h2 id="ue-pdsch-processing-procedure-time">5.3 UE PDSCH processing
procedure time</h2>
<p>If the first uplink symbol of the PUCCH which carries the HARQ-ACK
information, as defined by the assigned HARQ-ACK timing <em>K<sub>1
</sub></em>and K<sub>offset</sub>, if configured, and the PUCCH resource
to be used and including the effect of the timing advance, starts no
earlier than at symbol <em>L<sub>1</sub></em>, where
<em>L<sub>1</sub></em> is defined as the next uplink symbol with its CP
starting after <img src="media/image697.svg" /> after the end of the
last symbol of the PDSCH carrying the TB being acknowledged, then the UE
shall provide a valid HARQ-ACK message. For a PDSCH with disabled
HARQ-ACK feedback,<span class="math inline">\(\ T_{proc,1} = (N_{1} +
d_{1,1} + d_{2})(2048 + 144) \cdot \kappa 2^{- \mu} \cdot T_{C} +
T_{ext}\)</span>.</p>
<p><em>- N<sub>1</sub></em> is based on <em>µ</em> of table 5.3-1 and
table 5.3-2 for UE processing capability 1 and 2 respectively, where
<em>µ</em> corresponds to the one of (<em>µ<sub>PDCCH</sub></em>,
<em>µ<sub>PDSCH</sub></em>, <em>µ<sub>UL</sub></em>) resulting with the
largest <em>T<sub>proc,1</sub></em>, where the
<em>µ<sub>PDCCH</sub></em> corresponds to the subcarrier spacing of the
PDCCH scheduling the PDSCH, the <em>µ<sub>PDSCH</sub></em> corresponds
to the subcarrier spacing of the scheduled PDSCH, and
<em>µ<sub>UL</sub></em> corresponds to the subcarrier spacing of the
uplink channel with which the HARQ-ACK is assumed to be transmitted, for
PDSCH with or without disabled HARQ-ACK feedback, and κ is defined in
clause 4.1 of [4, TS 38.211].</p>
<p><em>-</em> For operation with shared spectrum channel access in FR1,
<img src="media/image698.svg" />is calculated according to [4, TS
38.211], otherwise <img src="media/image698.svg" />=0.</p>
<p><em>-</em> If the PDSCH DM-RS position <span
class="math inline">\(l_{1}\)</span> for the additional DM-RS in Table
7.4.1.1.2-3 in clause 7.4.1.1.2 of [4, TS 38.211] is <span
class="math inline">\(l_{1} = 12\)</span> then
<em>N<sub>1,0</sub>=14</em> in Table 5.3-1<em>,</em> otherwise
<em>N<sub>1,0</sub>=13.</em></p>
<p>- If the UE is configured with multiple active component carriers,
the first uplink symbol which carries the HARQ-ACK information further
includes the effect of timing difference between the component carriers
as given in [11, TS 38.133].</p>
<p>- For the PDSCH mapping type A as given in clause 7.4.1.1 of [4, TS
38.211]: if the last symbol of PDSCH is on the <em>i-</em>th symbol of
the slot where <em>i</em> &lt; 7, then <em>d<sub>1,1</sub> = 7 - i</em>,
otherwise <em>d<sub>1,1</sub> = 0</em></p>
<p>- If a PUCCH of a larger priority index would overlap with a PUCCH of
a smaller priority index, or with a PUSCH of a smaller priority index
and the PUCCH of a larger priority index and the PUSCH of a smaller
priority index are not simultaneously transmitted and the UE is not
provided <em>uci-MuxWithDiffPrio</em> for the primary PUCCH group or
<em>uci-MuxWithDiffPrioSecondaryPUCCHgroup</em> for the secondary PUCCH
group, <em>d<sub>2</sub></em> for the PUCCH of a larger priority is set
as reported by the UE; otherwise <em>d<sub>2</sub> = 0.</em></p>
<p>- For UE processing capability 1: If the PDSCH is mapping type B as
given in clause 7.4.1.1 of [4, TS 38.211], and</p>
<p>- if the number of PDSCH symbols allocated is <em>L</em> ≥ 7, then
<em>d<sub>1,1</sub></em> = 0,</p>
<p>- if the number of PDSCH symbols allocated is <em>L</em> ≥ 4 and
<em>L</em> ≤ 6, then <em>d<sub>1,1</sub></em> = 7- <em>L.</em></p>
<p>- if the number of PDSCH symbols allocated is <em>L</em> = <em>3</em>
then <em>d<sub>1,1</sub> = 3 +</em> min <em>(d,1)</em>, where <em>d</em>
is the number of overlapping symbols of the scheduling PDCCH and the
scheduled PDSCH.</p>
<p>- if the number of PDSCH symbols allocated is 2, then
<em>d<sub>1,1</sub></em> = 3<em>+d</em>, where <em>d</em> is the number
of overlapping symbols of the scheduling PDCCH and the scheduled
PDSCH.</p>
<p>- For UE processing capability 2: If the PDSCH is mapping type B as
given in clause 7.4.1.1 of [4, TS 38.211],</p>
<p>- if the number of PDSCH symbols allocated is <em>L</em> ≥ 7, then
<em>d<sub>1,1</sub></em> = 0,</p>
<p>- if the number of PDSCH symbols allocated is <em>L</em> ≥ 3 and
<em>L</em> ≤ 6, then <em>d<sub>1,1</sub></em> is the number of
overlapping symbols of the scheduling PDCCH and the scheduled PDSCH,</p>
<p>- if the number of PDSCH symbols allocated is 2,</p>
<p>- if the scheduling PDCCH was in a 3-symbol CORESET and the CORESET
and the PDSCH had the same starting symbol, then
<em>d<sub>1,1</sub></em> = 3,</p>
<p>- otherwise <em>d<sub>1,1</sub></em> is the number of overlapping
symbols of the scheduling PDCCH and the scheduled PDSCH.</p>
<p>- For UE processing capability 2 with scheduling limitation when
<em>µ<sub>PDSCH</sub></em> = 1, if the scheduled RB allocation exceeds
136 RBs, the UE defaults to capability 1 processing time. The UE may
skip decoding a number of PDSCHs with last symbol within 10 symbols
before the start of a PDSCH that is scheduled to follow Capability 2, if
any of those PDSCHs are scheduled with more than 136 RBs with 30kHz SCS
and following Capability 1 processing time.</p>
<p>- For a UE that supports capability 2 on a given cell, the processing
time according to UE processing capability 2 is applied if the high
layer parameter <em>processingType2Enabled</em> in
<em>PDSCH-ServingCellConfig</em> is configured for the cell and set to
'enable'.</p>
<p>- PDSCH processing capability 2 is not applied to PDSCH scheduled by
PDCCH with DCI format 4_0, 4_1, or 4_2.</p>
<p>- If this PUCCH resource is overlapping with another PUCCH or PUSCH
resource, then HARQ-ACK is multiplexed following the procedure in clause
9.2.5 of [6, TS 38.213], otherwise the HARQ-ACK message is transmitted
on PUCCH.</p>
<p>- UE is not expected to be scheduled to transmit PUCCH carrying the
HARQ-ACK information for PDSCH scheduled by a PDCCH if uplink switching
gap is triggered for the PUCCH as defined in clause 6.1.6 and the first
uplink symbol of the PUCCH starts earlier than the duration of {<span
class="math inline">\(T_{switch}\)</span> + <span
class="math inline">\(T_{proc,1}\)</span>} from the last symbol of the
PDCCH, where <span class="math inline">\(T_{switch}\)</span> equals to
the switching gap duration.</p>
<p>Otherwise the UE may not provide a valid HARQ-ACK corresponding to
the scheduled PDSCH. The value of <em>T<sub>proc,1</sub></em> is used
both in the case of normal and extended cyclic prefix.</p>
<p>For a PDSCH that consists of two PDSCH transmission occasions in time
domain in one slot, <em>d<sub>1,1</sub></em> is calculated based on the
first PDSCH transmission occasion in the slot, and as described
above.</p>
<p>For PDSCH with mapping Type B, if PDSCH is scheduled by a PDCCH
reception that includes two PDCCH candidates from two respective search
space sets, as described in clause 10.1 of [6, TS 38.213],
<em>d<sub>1,1</sub></em> for PDSCH processing time is determined by
considering the PDCCH candidate that results in larger d<sub>1,1</sub>
value.</p>
<p>Table 5.3-1: PDSCH processing time for PDSCH processing capability
1</p>
<table>
<colgroup>
<col style="width: 9%" />
<col style="width: 45%" />
<col style="width: 45%" />
</colgroup>
<thead>
<tr>
<th rowspan="2"><img src="media/image699.svg" /></th>
<th colspan="2">PDSCH decoding time <em>N<sub>1</sub></em>
[symbols]</th>
</tr>
<tr>
<th><em>dmrs-AdditionalPosition</em> = 'pos0' in<br />
<em>DMRS-DownlinkConfig</em> in<br />
<em>dmrs-DownlinkForPDSCH-MappingTypeA</em> and
<em>dmrs-DownlinkForPDSCH-MappingTypeB</em> if either higher layer
parameter is configured, and in
<em>dmrs-DownlinkForPDSCH-MappingTypeA-DCI-1-2</em> and
<em>dmrs-DownlinkForPDSCH-MappingTypeB-DCI-1-2</em> if either higher
layer parameter is configured</th>
<th><p><em>dmrs-AdditionalPosition</em> ≠ 'pos0' in<br />
<em>DMRS-DownlinkConfig</em> in any of<br />
<em>dmrs-DownlinkForPDSCH-MappingTypeA</em>,
<em>dmrs-DownlinkForPDSCH-MappingTypeB,
dmrs-DownlinkForPDSCH-MappingTypeA-DCI-1-2,
dmrs-DownlinkForPDSCH-MappingTypeB-DCI-1-2,</em></p>
<p>or if none of the higher layer parameters is configured</p></th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>8</td>
<td><em>N<sub>1,0</sub></em></td>
</tr>
<tr>
<td>1</td>
<td>10</td>
<td>13</td>
</tr>
<tr>
<td>2</td>
<td>17</td>
<td>20</td>
</tr>
<tr>
<td>3</td>
<td>20</td>
<td>24</td>
</tr>
<tr>
<td>5</td>
<td>80</td>
<td>96</td>
</tr>
<tr>
<td>6</td>
<td>160</td>
<td>192</td>
</tr>
</tbody>
</table>
<p>Table 5.3-2: PDSCH processing time for PDSCH processing capability
2</p>
<table>
<colgroup>
<col style="width: 7%" />
<col style="width: 92%" />
</colgroup>
<thead>
<tr>
<th rowspan="2"><img src="media/image699.svg" /></th>
<th>PDSCH decoding time <em>N<sub>1</sub></em> [symbols]</th>
</tr>
<tr>
<th><em>dmrs-AdditionalPosition</em> = 'pos0' in<br />
<em>DMRS-DownlinkConfig</em> in<br />
<em>dmrs-DownlinkForPDSCH-MappingTypeA</em> and
<em>dmrs-DownlinkForPDSCH-MappingTypeB</em> if either higher layer
parameter is configured, and in
<em>dmrs-DownlinkForPDSCH-MappingTypeA-DCI-1-2</em> and
<em>dmrs-DownlinkForPDSCH-MappingTypeB-DCI-1-2</em> if either higher
layer parameter is configured</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>3</td>
</tr>
<tr>
<td>1</td>
<td>4.5</td>
</tr>
<tr>
<td>2</td>
<td>9 for frequency range 1</td>
</tr>
</tbody>
</table>
<h3
id="application-delay-of-the-minimum-scheduling-offset-restriction">5.3.1
Application delay of the minimum scheduling offset restriction</h3>
<p>When the UE is scheduled with DCI format 0_1 or 1_1 with a
'<em>Minimum applicable scheduling offset indicator</em>' field in slot
<em>n</em>, it shall determine the <em>K</em><sub>0min</sub> and
<em>K</em><sub>2min</sub> values, if configured respectively, to be
applied, while the previously applied <em>K</em><sub>0min</sub> and/or
<em>K</em><sub>2min</sub> values are applied until the new values take
effect. If the DCI in slot <em>n</em> also indicates an active DL (UL)
BWP change for a serving cell, the indicated <em>K</em><sub>0min</sub>
(<em>K</em><sub>2min</sub>) value in the new active DL (UL) BWP, if
configured, is applied from the slot indicated by the slot offset value
of the time domain resource assignment field in the DCI. Otherwise,
change of applied minimum scheduling offset restriction indication
carried by DCI in slot <em>n</em>, shall be applied in slot
<em>n</em>+<em>X</em> of the scheduling cell. The UE does not expect to
be scheduled with DCI format 0_1 or 1_1 with '<em>Minimum applicable
scheduling offset indicator</em>' field indicating another change to
<em>K</em><sub>0min</sub> or <em>K</em><sub>2min</sub> for the same
active BWP of the scheduled cell before slot <em>n+X</em> of the
scheduling cell.</p>
<p>When the DCI format 0_1 or 1_1 with '<em>Minimum applicable
scheduling offset indicator</em>' field indicating a change to the
applied <em>K</em><sub>0min</sub> or <em>K</em><sub>2min</sub> is
contained within the first three symbols of slot <em>n</em>, the value
of application delay <em>X</em> is determined by, <span
class="math inline">\(X = \max\left( \left\lceil K_{0minOld} \bullet
\frac{2^{\mu_{PDCCH}}}{2^{\mu_{PDSCH}}} \right\rceil,Z_{\mu} \right)\
\)</span>where <em>K</em><sub>0minOld</sub> is the currently applied
<em>K</em><sub>0min</sub> value of the active DL BWP in the scheduled
cell and is zero, if <em>minimumSchedulingOffsetK0</em> is not
configured for the active DL BWP in the scheduled cell,
<em>Z<sub>µ</sub></em> is determined by the subcarrier spacing of the
active DL BWP in the scheduling cell in slot <em>n</em>, and given in
Table 5.3.1-1, and <em>µ</em><sub>PDCCH</sub> and
<em>µ</em><sub>PDSCH</sub> are the sub-carrier spacing configurations
for PDCCH of the active DL BWP in the scheduling cell and PDSCH of the
active DL BWP in the scheduled cell, respectively, in slot <em>n</em>.
After indication of a change to the applied <em>K</em><sub>0min</sub> or
<em>K</em><sub>2min</sub> of the scheduled cell in slot <em>n</em> of
the scheduling cell, if there is an active DL BWP change in the
scheduling cell before slot <em>n+X</em>, the new
<em>K</em><sub>0min</sub> and/or <em>K</em><sub>2min</sub> values are
applied from the first slot no earlier than the start of slot
<em>n+X</em> based on the sub-carrier spacing configuration of the
active DL BWP in the scheduling cell in slot <em>n</em>.</p>
<p>When the DCI format 0_1 or 1_1 with '<em>Minimum applicable
scheduling offset indicator</em>' field is received outside the first
three symbols of the slot, value of <em>Z<sub>µ</sub></em> from Table
5.3.1-1 is incremented by one before determining the application delay
<em>X</em>. When the PDCCH reception includes two PDCCH candidates from
two respective search space sets, as described in clause 10.1 of [6, TS
38.213], for the purpose of determining '<em>Minimum applicable
scheduling offset indicator</em>' field is received outside the first
three symbols of the slot, the PDCCH candidate that ends later in time
is used.</p>
<p>Table 5.3.1-1: Definition of <em>Z<sub>µ</sub></em></p>
<table>
<colgroup>
<col style="width: 49%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr>
<th><em>µ</em></th>
<th><em>Z<sub>µ</sub></em></th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>1</td>
</tr>
<tr>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>2</td>
<td>2</td>
</tr>
<tr>
<td>3</td>
<td>2</td>
</tr>
<tr>
<td>5</td>
<td>8</td>
</tr>
<tr>
<td>6</td>
<td>16</td>
</tr>
</tbody>
</table>
<h2 id="ue-csi-computation-time">5.4 UE CSI computation time</h2>
<p>When the <em>CSI request</em> field on a DCI triggers a CSI report(s)
on PUSCH, the UE shall provide a valid CSI report for the <em>n</em>-th
triggered report,</p>
<p>- if the first uplink symbol to carry the corresponding CSI report(s)
including the effect of the timing advance, starts no earlier than at
symbol <em>Z<sub>ref</sub></em>, and</p>
<p>- if the first uplink symbol to carry the <em>n</em>-th CSI report
including the effect of the timing advance, starts no earlier than at
symbol <em>Z'<sub>ref</sub>(n),</em></p>
<p>where <em>Z<sub>ref</sub></em> is defined as the next uplink symbol
with its CP starting <img src="media/image700.svg" /> after the end of
the last symbol of the PDCCH triggering the CSI report(s), and where
<em>Z'<sub>ref</sub>(n),</em> is defined as the next uplink symbol with
its CP starting <img src="media/image701.svg" />after the end of the
last symbol in time of the latest of: aperiodic CSI-RS resource for
channel measurements, aperiodic CSI-IM used for interference
measurements, and aperiodic NZP CSI-RS for interference measurement,
when aperiodic CSI-RS is used for channel measurement for the
<em>n</em>-th triggered CSI report, and where
<em>T<sub>switch</sub></em> is defined in clause 6.4 and is applied only
if <span class="math inline">\(Z_{1}\)</span> of table 5.4-1 is
applied.</p>
<p>If the PUSCH indicated by the DCI is overlapping with another PUCCH
or PUSCH, then the CSI report(s) are multiplexed following the procedure
in clause 9.2.5 of [6, TS 38.213] and clause 5.2.5 when applicable,
otherwise the CSI report(s) are transmitted on the PUSCH indicated by
the DCI.</p>
<p>When the <em>CSI request</em> field on a DCI triggers a CSI report(s)
on PUSCH, if the first uplink symbol to carry the corresponding CSI
report(s) including the effect of the timing advance, starts earlier
than at symbol <em>Z<sub>ref</sub></em>,</p>
<p>- the UE may ignore the scheduling DCI if no HARQ-ACK or transport
block is multiplexed on the PUSCH.</p>
<p>When the <em>CSI request</em> field on a DCI triggers a CSI report(s)
on PUSCH, if the first uplink symbol to carry the <em>n</em>-th CSI
report including the effect of the timing advance, starts earlier than
at symbol <em>Z'<sub>ref</sub>(n),</em></p>
<p>- the UE may ignore the scheduling DCI if the number of triggered
reports is one and no HARQ-ACK or transport block is multiplexed on the
PUSCH</p>
<p>- Otherwise, the UE is not required to update the CSI for the
<em>n</em>-th triggered CSI report.</p>
<p>When the PDCCH reception includes two PDCCH candidates from two
respective search space sets, as described in clause 10.1 of [6, TS
38.213], for the purpose of determining the last symbol of the PDCCH
triggering the CSI report(s), the PDCCH candidate that ends later in
time is used.</p>
<p><em>Z,</em> <em>Z'</em> and <em>µ</em> are defined as:</p>
<p><span class="math inline">\(Z = \max_{m = 0,\ldots,M -
1}{(Z(m))}\)</span> and <span class="math inline">\(Z&#39; = \max_{m =
0,\ldots,M - 1}{(Z&#39;(m))}\)</span>, where <em>M</em> is the number of
updated CSI report(s) according to Clause 5.2.1.6, <span
class="math inline">\((Z(m),Z&#39;(m))\)</span> corresponds to the
<em>m</em>-th updated CSI report and is defined as</p>
<p>- <span class="math inline">\((Z_{1},Z_{1}&#39;)\)</span> of the
table 5.4-1 if max{ <em>µ<sub>PDCCH</sub></em>, <em>µ<sub>CSI-RS</sub>,
µ<sub>UL</sub></em>} ≤ 3 and if the CSI is triggered without a PUSCH
with either transport block or HARQ-ACK or both when <em>L</em> = 0 CPUs
are occupied (according to Clause 5.2.1.6) and the CSI to be transmitted
is a single CSI and corresponds to wideband frequency-granularity where
the CSI corresponds to at most 4 CSI-RS ports in a single resource
without CRI report and where <em>CodebookType</em> is set to
'typeI-SinglePanel' or where <em>reportQuantity</em> is set to
'cri-RI-CQI', or</p>
<p>- <span class="math inline">\((Z_{1},Z_{1}&#39;)\)</span> of the
table 5.4-2 if the CSI to be transmitted corresponds to wideband
frequency-granularity where the CSI corresponds to at most 4 CSI-RS
ports in a single resource without CRI report and where
<em>CodebookType</em> is set to 'typeI-SinglePanel' or where
<em>reportQuantity</em> is set to 'cri-RI-CQI', or</p>
<p>- <span class="math inline">\((Z_{1},Z_{1}&#39;)\)</span> of the
table 5.4-2 if the CSI to be transmitted corresponds to wideband
frequency-granularity where the <em>reportQuantity</em> is set to
'ssb-Index-SINR', 'cri-SINR', 'ssb-Index-SINR- Index ', or 'cri-SINR-
Index ', or</p>
<p>- <span class="math inline">\((Z_{3},Z_{3}&#39;)\)</span> of the
table 5.4-2 if <em>reportQuantity</em> is set to 'cri-RSRP',
'ssb-Index-RSRP', 'cri-RSRP- Index' or 'ssb-Index-RSRP- Index ', <span
class="math inline">\(\ where\ Xµ\ \)</span>is according to UE reported
capability <em>beamReportTiming</em> and <em>KB<sub>l</sub></em> is
according to UE reported capability <em>beamSwitchTiming</em> as defined
in [13, TS 38.306], or</p>
<p>- <span class="math inline">\((Z_{2},Z_{2}&#39;)\)</span> of table
5.4-2 otherwise.</p>
<p><em>- µ</em> of table 5.4-1 and table 5.4-2 corresponds to the min
(<em>µ<sub>PDCCH</sub></em>, <em>µ<sub>CSI-RS</sub>,
µ<sub>UL</sub></em>) where the <em>µ<sub>PDCCH</sub></em> corresponds to
the subcarrier spacing of the PDCCH with which the DCI was transmitted
and <em>µ<sub>UL</sub></em> corresponds to the subcarrier spacing of the
PUSCH with which the CSI report is to be transmitted and
<em>µ<sub>CSI-RS</sub></em> corresponds to the minimum subcarrier
spacing of the aperiodic CSI-RS triggered by the DCI</p>
<p>Table 5.4-1: CSI computation delay requirement 1</p>
<table>
<colgroup>
<col style="width: 14%" />
<col style="width: 43%" />
<col style="width: 41%" />
</colgroup>
<thead>
<tr>
<th rowspan="2"><img src="media/image702.svg" /></th>
<th colspan="2"><em>Z<sub>1</sub></em> [symbols]</th>
</tr>
<tr>
<th><em>Z<sub>1</sub></em></th>
<th><em>Z'<sub>1</sub></em></th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>10</td>
<td>8</td>
</tr>
<tr>
<td>1</td>
<td>13</td>
<td>11</td>
</tr>
<tr>
<td>2</td>
<td>25</td>
<td>21</td>
</tr>
<tr>
<td>3</td>
<td>43</td>
<td>36</td>
</tr>
</tbody>
</table>
<p>Table 5.4-2: CSI computation delay requirement 2</p>
<table>
<colgroup>
<col style="width: 6%" />
<col style="width: 12%" />
<col style="width: 12%" />
<col style="width: 13%" />
<col style="width: 15%" />
<col style="width: 18%" />
<col style="width: 21%" />
</colgroup>
<thead>
<tr>
<th rowspan="2"><img src="media/image702.svg" /></th>
<th colspan="2"><em>Z<sub>1</sub></em> [symbols]</th>
<th colspan="2"><em>Z<sub>2</sub></em> [symbols]</th>
<th colspan="2"><em>Z<sub>3</sub></em> [symbols]</th>
</tr>
<tr>
<th><em>Z<sub>1</sub></em></th>
<th><em>Z'<sub>1</sub></em></th>
<th><em>Z<sub>2</sub></em></th>
<th><em>Z'<sub>2</sub></em></th>
<th><em>Z<sub>3</sub></em></th>
<th><em>Z'<sub>3</sub></em></th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>22</td>
<td>16</td>
<td>40</td>
<td>37</td>
<td>22</td>
<td><em>X</em><sub>0</sub></td>
</tr>
<tr>
<td>1</td>
<td>33</td>
<td>30</td>
<td>72</td>
<td>69</td>
<td>33</td>
<td><em>X</em><sub>1</sub></td>
</tr>
<tr>
<td>2</td>
<td>44</td>
<td>42</td>
<td>141</td>
<td>140</td>
<td><u>min(44,</u><span class="math inline">\({\
X}_{3}\)</span><u><em>X</em><sub>2</sub>+ KB<sub>1</sub>)</u></td>
<td><em>X</em><sub>2</sub></td>
</tr>
<tr>
<td>3</td>
<td>97</td>
<td>85</td>
<td>152</td>
<td>140</td>
<td><u>min(97, <em>X</em><sub>3</sub>+ KB<sub>2</sub>)</u></td>
<td><em>X</em><sub>3</sub></td>
</tr>
<tr>
<td>5</td>
<td>388</td>
<td>340</td>
<td>608</td>
<td>560</td>
<td><u>min(388, X5+ KB3) </u></td>
<td><em>X5 </em></td>
</tr>
<tr>
<td>6</td>
<td>776</td>
<td>680</td>
<td>1216</td>
<td>1120</td>
<td><u>min(776, X6+ KB4) </u></td>
<td><em>X6 </em></td>
</tr>
</tbody>
</table>
<h2
id="ue-pdsch-reception-preparation-time-with-cross-carrier-scheduling-with-different-subcarrier-spacings-for-pdcch-and-pdsch">5.5
UE PDSCH reception preparation time with cross carrier scheduling with
different subcarrier spacings for PDCCH and PDSCH</h2>
<p>This clause applies only if the PDCCH carrying the scheduling DCI is
received on one carrier with one OFDM subcarrier spacing
(µ<sub>PDCCH</sub>), and the PDSCH scheduled to be received by the DCI
is on another carrier with another OFDM subcarrier spacing
(µ<sub>PDSCH</sub>).</p>
<p>If the µ<sub>PDCCH</sub> &lt; µ<sub>PDSCH</sub>, the UE is expected
to receive the scheduled PDSCH, if the first symbol in the PDSCH
allocation, including the DM-RS, as defined by the slot offset
<em>K<sub>0</sub></em> and the start and length indicator <em>SLIV</em>
of the scheduling DCI starts no earlier than the first symbol of the
slot of the PDSCH reception starting at least <em>N<sub>pdsch</sub></em>
PDCCH symbols after the end of the PDCCH scheduling the PDSCH, not
taking into account the effect of receive timing difference between the
scheduling cell and the scheduled cell.</p>
<p>If the µ<sub>PDCCH</sub> &gt; µ<sub>PDSCH</sub>, the UE is expected
to receive the scheduled PDSCH, if the first symbol in the PDSCH
allocation, including the DM-RS, as defined by the slot offset
<em>K<sub>0</sub></em> and the start and length indicator <em>SLIV</em>
of the scheduling DCI starts no earlier than <em>N<sub>pdsch</sub></em>
PDCCH symbols after the end of the PDCCH scheduling the PDSCH, not
taking into account the effect of receive timing difference between the
scheduling cell and the scheduled cell.</p>
<p>When the PDCCH reception includes two PDCCH candidates from two
respective search space sets, as described in clause 10.1 of [6, TS
38.213], for the purpose of determining <em>N<sub>pdsch</sub></em>, the
PDCCH candidate that ends later in time is used.</p>
<p>Table 5.5-1: <em>N<sub>pdsch</sub></em> as a function of the
subcarrier spacing of the scheduling PDCCH</p>
<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr>
<th><em><strong>µ<sub>PDCCH</sub></strong></em></th>
<th><strong><em>N<sub>pdsch</sub></em> [symbols]</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>4</td>
</tr>
<tr>
<td>1</td>
<td>5</td>
</tr>
<tr>
<td>2</td>
<td>10</td>
</tr>
<tr>
<td>3</td>
<td>14</td>
</tr>
<tr>
<td>5</td>
<td>56</td>
</tr>
<tr>
<td>6</td>
<td>112</td>
</tr>
</tbody>
</table>
<h1 id="physical-uplink-shared-channel-related-procedure">6 Physical
uplink shared channel related procedure</h1>
<h2
id="ue-procedure-for-transmitting-the-physical-uplink-shared-channel">6.1
UE procedure for transmitting the physical uplink shared channel</h2>
<p>PUSCH transmission(s) can be dynamically scheduled by an UL grant in
a DCI, or the transmission can correspond to a configured grant Type 1
or Type 2. The configured grant Type 1 PUSCH transmission is
semi-statically configured to operate upon the reception of higher layer
parameter of <em>configuredGrantConfig</em> including
<em>rrc-ConfiguredUplinkGrant</em> without the detection of an UL grant
in a DCI. The configured grant Type 2 PUSCH transmission is
semi-persistently scheduled by an UL grant in a valid activation DCI
according to clause 10.2 of [6, TS 38.213] after the reception of higher
layer parameter <em>configuredGrantConfig</em> not including
<em>rrc-ConfiguredUplinkGrant</em>. If
<em>configuredGrantConfigToAddModList</em> is configured, more than one
configured grant configuration of configured grant Type 1 and/or
configured grant Type 2 may be active at the same time on an active BWP
of a serving cell.</p>
<p>The UE can be configured with a list of up to 64
<em>TCI-UL-State</em> configurations within the higher layer parameter
<em>BWP-UplinkDedicated.</em> Each <em>TCI-UL-State</em> configuration
contains a parameter for configuring one reference signal, if
applicable, for determining UL TX spatial filter for dynamic-grant and
configured-grant based PUSCH and PUCCH resource in a CC, and SRS.</p>
<p>For the PUSCH transmission corresponding to a Type 1 configured grant
or a Type 2 configured grant activated by DCI format 0_0 or 0_1, the
parameters applied for the transmission are provided by
<em>configuredGrantConfig</em> except for
<em>dataScramblingIdentityPUSCH</em>, <em>txConfig</em>,
<em>codebookSubset</em>, <em>maxRank</em>, <em>scaling</em> of
<em>UCI-OnPUSCH,</em> which are provided by <em>pusch-Config</em>. For
the PUSCH transmission corresponding to a Type 2 configured grant
activated by DCI format 0_2, the parameters applied for the transmission
are provided by <em>configuredGrantConfig</em> except for
<em>dataScramblingIdentityPUSCH</em>, <em>txConfig</em>,
<em>codebookSubsetDCI-0-2</em>, <em>maxRankDCI-0-2</em>,
<em>scaling</em> of <em>UCI-OnPUSCH</em>,
<em>resourceAllocationType1GranularityDCI-0-2</em> provided by
<em>pusch-Config</em>. If the UE is provided with
<em>transformPrecoder</em> in <em>configuredGrantConfig</em>, the UE
applies the higher layer parameter <em>tp-pi2BPSK</em>, if provided in
<em>pusch-Config</em>, according to the procedure described in clause
6.1.4 for the PUSCH transmission corresponding to a configured grant.
When the UE is configured <em>dl-OrJointTCI-StateList</em> or
<em>ul-TCI-StateList</em>, the UE shall perform PUSCH transmission
corresponding to a Type 1 configured grant or a Type 2 configured grant
or a dynamic grant according to the spatial relation, if applicable,
with a reference to the RS for determining UL Tx spatial filter. The RS
is determined based on an RS configured with <em>qcl-Type</em> set to
'typeD' of the indicated <em>TCI-State</em> or an RS in the indicated
<em>TCI-UL-State</em>. The reference RS in the indicated
<em>TCI-State</em> can be a CSI-RS resource in a
<em>NZP-CSI-RS-ResourceSet</em> configured with higher layer parameter
<em>repetition</em>, or a CSI-RS resource in an
<em>NZP-CSI-RS-ResourceSet</em> configured with higher layer parameter
<em>trs-Info.</em> The reference RS in the indicated
<em>TCI-UL-State</em> can be a CSI-RS resource in a
<em>NZP-CSI-RS-ResourceSet</em> configured with higher layer parameter
<em>repetition</em>, a CSI-RS resource in an
<em>NZP-CSI-RS-ResourceSet</em> configured with higher layer parameter
<em>trs-Info</em>, an SRS resource in an SRS resource set with the
higher layer parameter <em>usage</em> set to 'beamManagement', or
SS/PBCH block associated with the same or different PCI from the PCI of
the serving cell.</p>
<p>For the PUSCH retransmission scheduled by a PDCCH with CRC scrambled
by CS-RNTI with NDI=1, the parameters in <em>pusch-Config</em> are
applied for the PUSCH transmission except for
<em>p0-NominalWithoutGrant, p0-PUSCH-Alpha, powerControlLoopToUse,</em>
<em>pathlossReferenceIndex</em> described in clause 7.1 of [6, TS
38.213], <em>mcs-Table, mcs-TableTransformPrecoder</em> described in
clause 6.1.4.1 and <em>transformPrecoder</em> described in clause
6.1.3.</p>
<p>For a UE configured with two uplinks in a serving cell, PUSCH
retransmission for a TB on the serving cell is not expected to be on a
different uplink than the uplink used for the PUSCH initial transmission
of that TB.</p>
<p>A UE shall upon detection of a PDCCH with a configured DCI format
0_0, 0_1 or 0_2 transmit the corresponding PUSCH as indicated by that
DCI unless the UE does not generate a transport block as described in
[10, TS38.321]. Upon detection of a DCI format 0_1 or 0_2 with
'<em>UL-SCH indicator</em>' set to '0' and with a non-zero '<em>CSI
request</em>' where the associated <em>reportQuantity</em> in
<em>CSI-ReportConfig</em> set to '<em>none</em>' for all CSI report(s)
triggered by '<em>CSI request</em>' in this DCI format 0_1 or 0_2, the
UE ignores all fields in this DCI except the '<em>CSI request</em>' and
the UE shall not transmit the corresponding PUSCH as indicated by this
DCI format 0_1 or 0_2. When the UE is scheduled with multiple PUSCHs by
a DCI, HARQ process ID indicated by this DCI applies to the first PUSCH
not overlapping with a DL symbol indicated by
<em>tdd-UL-DL-ConfigurationCommon</em> or
<em>tdd-UL-DL-ConfigurationDedicated</em> if provided, or a symbol of an
SS/PBCH block with index provided by <em>ssb-PositionsInBurst</em>, HARQ
process ID is then incremented by 1 for each subsequent PUSCH(s) in the
scheduled order, with modulo operation of
<em>nrofHARQ-ProcessesForPUSCH</em> applied if
<em>nrofHARQ-ProcessesForPUSCH</em> is provided, or with modulo
operation of <em>nrofHARQ-ProcessesForPUSCH-r17</em> applied if
<em>nrofHARQ-ProcessesForPUSCH-r17</em> is provided, or with modulo
operation of 16 applied, otherwise. HARQ process ID is not incremented
for PUSCH(s) not transmitted if at least one of the symbols indicated by
the indexed row of the used resource allocation table in the slot
overlaps with a DL symbol indicated by
<em>tdd-UL-DL-ConfigurationCommon</em> or
<em>tdd-UL-DL-ConfigurationDedicated</em> if provided, or a symbol of an
SS/PBCH block with index provided by <em>ssb-PositionsInBurst</em>. For
any HARQ process ID(s) in a given scheduled cell, the UE is not expected
to transmit a PUSCH that overlaps in time with another PUSCH. Except for
the case when a UE is configured by higher layer parameter
<em>PDCCH-Config</em> that contains two different values of
<em>coresetPoolIndex</em> in <em>ControlResourceSet</em> for the active
BWP of a serving cell and PDCCHs that schedule two non-overlapping in
time domain PUSCHs are associated to different
<em>ControlResourceSets</em> having different values of
<em>coresetPoolIndex,</em> for any two HARQ process IDs in a given
scheduled cell, if the UE is scheduled to start a first PUSCH
transmission starting in symbol <em>j</em> by a PDCCH ending in symbol
<em>i</em> on a scheduling cell,, the UE is not expected to be scheduled
to transmit a PUSCH starting earlier than the end of the first PUSCH by
a PDCCH that ends later than symbol <em>i</em> of the scheduling cell.
When the PDCCH reception includes two PDCCH candidates from two
respective search space sets, as described in clause 10.1 of [6, TS
38.213], for the purpose of determining the PDCCH ending in symbol
<em>i</em>, the PDCCH candidate that ends later in time is used. The UE
is not expected to be scheduled to transmit another PUSCH by a DCI
format 0_0 with CRC scrambled by TC-RNTI, for a given HARQ process with
the DCI received before the end of the expected transmission of the last
PUSCH for that HARQ process if the latter is scheduled by a DCI format
0_0 with CRC scrambled by TC-RNTI or by an UL grant in RA Response. The
UE is not expected to be scheduled to transmit another PUSCH by DCI
format 0_0, 0_1 or 0_2 scrambled by C-RNTI, CS-RNTI or MCS-C-RNTI for a
given HARQ process with the DCI received before the end of the expected
transmission of the last PUSCH for that HARQ process if the latter is
scheduled by a DCI with CRC scrambled by C-RNTI, CS-RNTI or
MCS-C-RNTI.</p>
<p>If a UE is configured by higher layer parameter <em>PDCCH-Config</em>
that contains two different values of <em>coresetPoolIndex</em> in
<em>ControlResourceSet</em> for the active BWP of a serving cell and
PDCCHs that schedule two non-overlapping in time domain PUSCHs are
associated to different <em>ControlResourceSets</em> having different
values of <em>coresetPoolIndex,</em> for any two HARQ process IDs in a
given scheduled cell, if the UE is scheduled to start a first PUSCH
transmission starting in symbol <em>j</em> by a PDCCH associated with a
value of <em>coresetPoolIndex</em> ending in symbol <em>i</em>, the UE
can be scheduled to transmit a PUSCH starting earlier than the end of
the first PUSCH by a PDCCH associated with a different value of
<em>coresetPoolIndex</em> that ends later than symbol <em>i</em>.</p>
<p>A UE is not expected to be scheduled by a PDCCH ending in symbol
<span class="math inline">\(i\)</span> to transmit a PUSCH on a given
serving cell overlapping in time with a transmission occasion, where the
UE is allowed to transmit a PUSCH with configured grant according to
[10, TS38.321], starting in a symbol <span
class="math inline">\(j\)</span> on the same serving cell if the end of
symbol <span class="math inline">\(i\)</span> is not at least <span
class="math inline">\(N_{2}\)</span> symbols before the beginning of
symbol <span class="math inline">\(j\)</span>, if the UE is not provided
<em>prioLowDG-HighCG</em> or <em>prioHighDG-LowCG</em>, or the UE is
provided <em>prioLowDG-HighCG</em> or <em>prioHighDG-LowCG</em> and the
two PUSCHs have the same priority index as described in Clause 9 of [6,
TS 38.213]. The value <span class="math inline">\(N_{2}\)</span> in
symbols is determined according to the UE processing capability defined
in Clause 6.4, and <span class="math inline">\(N_{2}\ \)</span>and the
symbol duration are based on the minimum of the subcarrier spacing
corresponding to the PUSCH with configured grant and the subcarrier
spacing of the PDCCH scheduling the PUSCH.</p>
<p>If a UE receives an ACK for a given HARQ process in CG-DFI in a PDCCH
ending in symbol <em>i</em> to terminate a transport block repetition in
a PUSCH transmission with a configured grant on a given serving cell
with the same HARQ process after symbol <em>i</em>, the UE is expected
to terminate the repetition of the transport block in a PUSCH
transmission starting from a symbol <em>j</em> if the gap between the
end of PDCCH of symbol <em>i</em> and the start of the PUSCH
transmission in symbol <em>j</em> is equal to or more than <em>N2</em>
symbols. The value <em>N2</em> in symbols is determined according to the
UE processing capability defined in Clause 6.4, and <em>N2</em> and the
symbol duration are based on the minimum of the subcarrier spacing
corresponding to the PUSCH and the subcarrier spacing of the PDCCH
indicating CG-DFI. A UE is not expected to be scheduled by a PDCCH
ending in symbol <span class="math inline">\(i\)</span> to transmit a
PUSCH on a given serving cell for a given HARQ process, if there is a
transmission occasion where the UE is allowed to transmit a PUSCH with
configured grant according to [10, TS38.321] with the same HARQ process
on the same serving cell starting in a symbol <span
class="math inline">\(j\)</span> after symbol <span
class="math inline">\(i\)</span>, and if the gap between the end of
PDCCH and the beginning of symbol <span class="math inline">\(j\)</span>
is less than <span class="math inline">\(N_{2}\)</span> symbols. The
value <span class="math inline">\(N_{2}\)</span> in symbols is
determined according to the UE processing capability defined in clause
6.4, and <span class="math inline">\(N_{2}\ \)</span>and the symbol
duration are based on the minimum of the subcarrier spacing
corresponding to the PUSCH with configured grant and the subcarrier
spacing of the PDCCH scheduling the PUSCH.</p>
<p>For PUSCH scheduled by DCI format 0_0 on a cell, the UE shall
transmit PUSCH according to the spatial relation, if applicable,
corresponding to the dedicated PUCCH resource with the lowest ID within
the active UL BWP of the cell, as described in Clause 9.2.1 of [6, TS
38.213]. If the dedicated PUCCH resource with the lowest ID within the
active UL BWP of the cell corresponds to two spatial relations, the UE
shall transmit the PUSCH according to the spatial relation with the
lower ID.</p>
<p>For PUSCH scheduled by DCI format 0_0 on a cell and if the higher
layer parameter <em>enableDefaultBeamPL-ForPUSCH0-0</em> is set
'enabled', the UE is not configured with PUCCH resources on the active
UL BWP and the UE is in RRC connected mode, the UE shall transmit PUSCH
according to the spatial relation, if applicable, with a reference to
the RS configured with <em>qcl-Type</em> set to 'typeD' corresponding to
the QCL assumption of the CORESET with the lowest ID on the active DL
BWP of the cell. If the CORESET is indicated with two TCI states,
<em>sfnSchemePdcch</em> is configured and the UE supports
<em>sfn-DefaultUL-BeamSetup-r17</em>, the UE shall use the first TCI
state as the QCL assumption.</p>
<p>For PUSCH scheduled by DCI format 0_0 on a cell and if the higher
layer parameter <em>enableDefaultBeamPL-ForPUSCH0-0</em> is set
'enabled', the UE is configured with PUCCH resources on the active UL
BWP where all the PUCCH resource(s) are not configured with any spatial
relation and the UE is in RRC connected mode, the UE shall transmit
PUSCH according to the spatial relation, if applicable, with a reference
to the RS configured with <em>qcl-Type</em> set to 'typeD' corresponding
to the QCL assumption of the CORESET with the lowest ID on the active DL
BWP of the cell in case CORESET(s) are configured on the cell. If the
CORESET is indicated with two TCI states, <em>sfnSchemePdcch</em> is
configured and the UE supports <em>sfn-DefaultUL-BeamSetup-r17</em>, the
UE shall use the first TCI state as the QCL assumption.</p>
<p>For uplink, 16 HARQ processes per cell are supported by the UE, or
subject to UE capability, a maximum of 32 HARQ processes per cell as
defined in [13, TS 38.306]. The number of processes the UE may assume
will at most be used for the uplink is configured to the UE for each
cell separately by higher layer parameter
<em>nrofHARQ-ProcessesForPUSCH</em>, or
<em>nrofHARQ-ProcessesForPUSCH-r17,</em> and when no configuration is
provided the UE may assume a default number of 16 processes.</p>
<h3 id="transmission-schemes-1">6.1.1 Transmission schemes</h3>
<p>Two transmission schemes are supported for PUSCH: codebook based
transmission and non-codebook based transmission. The UE is configured
with codebook based transmission when the higher layer parameter
<em>txConfig</em> in <em>pusch-Config</em> is set to 'codebook', the UE
is configured non-codebook based transmission when the higher layer
parameter <em>txConfig</em> is set to 'nonCodebook'. If the higher layer
parameter <em>txConfig</em> is not configured, the UE is not expected to
be scheduled by DCI format 0_1 or 0_2. If PUSCH is scheduled by DCI
format 0_0, the PUSCH transmission is based on a single antenna port.
Except if the higher layer parameter
<em>enableDefaultBeamPL-ForPUSCH0-0</em> is set 'enabled', the UE shall
not expect PUSCH scheduled by DCI format 0_0 in a BWP without configured
PUCCH resource with <em>PUCCH-SpatialRelationInfo</em> in frequency
range 2 in RRC connected mode.</p>
<h4 id="codebook-based-ul-transmission">6.1.1.1 Codebook based UL
transmission</h4>
<p>For codebook based transmission, PUSCH can be scheduled by DCI format
0_0, DCI format 0_1, DCI format 0_2 or semi-statically configured to
operate according to Clause 6.1.2.3. If this PUSCH is scheduled by DCI
format 0_1, DCI format 0_2, or semi-statically configured to operate
according to Clause 6.1.2.3, the UE determines its PUSCH transmission
precoder(s) based on SRI(s), TPMI(s) and the transmission rank, where
the SRI(s), TPMI(s) and the transmission rank are given by DCI fields of
one or two SRS resource indicators and one or two Precoding information
and number of layers in clause 7.3.1.1.2 and 7.3.1.1.3 of [5, TS 38.212]
for DCI format 0_1 and 0_2 or given by <em>srs-ResourceIndicator</em>
and <em>precodingAndNumberOfLayers</em> according to clause 6.1.2.3 or
given by <em>srs-ResourceIndicator, srs-ResourceIndicator2,</em>
<em>precodingAndNumberOfLayers, and precodingAndNumberOfLayers2</em>
according to clause 6.1.2.3. The <em>SRS-ResourceSet(s)</em> applicable
for PUSCH scheduled by DCI format 0_1 and DCI format 0_2 are defined by
the entries of the higher layer parameter
<em>srs-ResourceSetToAddModList</em> and
<em>srs-ResourceSetToAddModListDCI-0-2</em> in <em>SRS-config</em>,
respectively. Only one or two SRS resource sets can be configured in
<em>srs-ResourceSetToAddModList</em> with higher layer parameter
<em>usage</em> in <em>SRS-ResourceSet</em> set to 'codebook', and only
one or two SRS resource sets can be configured in
<em>srs-ResourceSetToAddModListDCI-0-2</em> with higher layer parameter
<em>usage</em> in <em>SRS-ResourceSet</em> set to 'codebook'.</p>
<p>When only one SRS resource set is configured in
<em>srs-ResourceSetToAddModList</em> or
<em>srs-ResourceSetToAddModListDCI-0-2</em> with higher layer parameter
<em>usage</em> in <em>SRS-ResourceSet</em> set to 'codebook', SRI and
TPMI are given by the DCI fields of one SRS resource indicator and one
Precoding information and number of layers in clause 7.3.1.1.2 and
7.3.1.1.3 of [5, TS 38.212] for DCI format 0_1 and 0_2 or given by
<em>srs-ResourceIndicator</em> and <em>precodingAndNumberOfLayers</em>
according to clause 6.1.2.3. The TPMI is used to indicate the precoder
to be applied over the layers {0…<em>ν</em>-1} and that corresponds to
the SRS resource selected by the SRI when multiple SRS resources are
configured, or if a single SRS resource is configured TPMI is used to
indicate the precoder to be applied over the layers {0…<em>ν</em>-1} and
that corresponds to the SRS resource. The transmission precoder is
selected from the uplink codebook that has a number of antenna ports
equal to higher layer parameter <em>nrofSRS-Ports</em> in SRS-Config, as
defined in Clause 6.3.1.5 of [4, TS 38.211]. When the UE is configured
with the higher layer parameter <em>txConfig</em> set to 'codebook', the
UE is configured with at least one SRS resource. The indicated SRI in
slot <em>n</em> is associated with the most recent transmission of SRS
resource identified by the SRI, where the SRS resource is prior to the
PDCCH carrying the SRI.</p>
<p>When two SRS resource sets are configured in
<em>srs-ResourceSetToAddModList</em> or
<em>srs-ResourceSetToAddModListDCI-0-2</em> with higher layer parameter
<em>usage</em> in <em>SRS-ResourceSet</em> set to 'codebook', one or two
SRI(s), and one or two TPMI(s) are given by the DCI fields of two SRS
resource indicator and two Precoding information and number of layers in
clause 7.3.1.1.2 and 7.3.1.1.3 of [5, TS 38.212] for DCI format 0_1 and
0_2. The UE applies the indicated SRI(s) and TPMI(s) to one or more
PUSCH repetitions according to the associated SRS resource set of a
PUSCH repetition according to clause 6.1.2.1. Each TPMI, based on
indicated codepoint of <em>SRS Resource Set</em> <em>indicator</em>, is
used to indicate the precoder to be applied over the layers
{0…<em>ν</em>-1} and that corresponds to the SRS resource selected by
the corresponding SRI when multiple SRS resources are configured for the
applicable SRS resource set, or if a single SRS resource is configured
for the applicable SRS resource set TPMI is used to indicate the
precoder to be applied over the layers {0…<em>ν</em>-1} and that
corresponds to the SRS resource. For one or two TPMI(s), the
transmission precoder is selected from the uplink codebook that has a
number of antenna ports equal to the higher layer parameter
<em>nrofSRS-Ports</em> in SRS-Config for the indicated SRI(s), as
defined in Clause 6.3.1.5 of [4, TS 38.211]. When two SRIs are
indicated, the UE shall expect the <em>nrofSRS-Ports</em> for the two
indicated SRS resources to be the same. When the UE is configured with
the higher layer parameter <em>txConfig</em> set to 'codebook', the UE
is configured with at least one SRS resource. Each of the indicated one
or two SRI(s) in slot <em>n</em> is associated with the most recent
transmission of SRS resource of associated SRS resource set identified
by the SRI, where the SRS resource is prior to the PDCCH carrying the
SRI. When two SRS resource sets are configured in
<em>srs-ResourceSetToAddModList</em> or
<em>srs-ResourceSetToAddModListDCI-0-2</em> with higher layer parameter
<em>usage</em> in <em>SRS-ResourceSet</em> set to 'codebook', the UE is
not expected to be configured with different number of SRS resources in
the two SRS resource sets.</p>
<p>When the PDCCH reception includes two PDCCH candidates from two
respective search space sets, as described in clause 10.1 of [6, TS
38.213], for the purpose of determining the most recent transmission of
SRS resource identified by the SRI, the PDCCH candidate that starts
earlier in time is used.</p>
<p>For codebook based transmission, the UE determines its codebook
subsets based on TPMI(s) and upon the reception of higher layer
parameter <em>codebookSubset</em> in <em>pusch-Config</em> for PUSCH
associated with DCI format 0_1 and <em>codebookSubsetDCI-0-2</em> in
<em>pusch-Config</em> for PUSCH associated with DCI format 0_2 which may
be configured with <em>'</em>fullyAndPartialAndNonCoherent<em>'</em>, or
<em>'</em>partialAndNonCoherent<em>'</em>, or 'nonCoherent' depending on
the UE capability. When higher layer parameter
<em>ul-FullPowerTransmission</em> is set to '<em>fullpowerMode2'</em>
and the higher layer parameter <em>codebookSubset</em> or the higher
layer parameter <em>codebookSubsetDCI-0-2</em> is set to
<em>'</em>partialAndNonCoherent', and when the SRS-resourceSet with
usage set to "codebook" includes at least one SRS resource with 4 ports
and one SRS resource with 2 ports, the codebookSubset associated with
the 2-port SRS resource is 'nonCoherent'. The maximum transmission rank
may be configured by the higher layer parameter <em>maxRank</em> in
<em>pusch-Config</em> for PUSCH scheduled with DCI format 0_1 and
<em>maxRankDCI-0-2</em> for PUSCH scheduled with DCI format
0_2<em>.</em></p>
<p>A UE reporting its UE capability of 'partialAndNonCoherent'
transmission shall not expect to be configured by either
<em>codebookSubset</em> or <em>codebookSubsetDCI-0-2</em> with
'fullyAndPartialAndNonCoherent<em>'</em>.</p>
<p>A UE reporting its UE capability of 'nonCoherent' transmission shall
not expect to be configured by either <em>codebookSubset</em> or
<em>codebookSubsetDCI-0-2</em> with
<em>'</em>fullyAndPartialAndNonCoherent<em>'</em> or with
<em>'</em>partialAndNonCoherent'.</p>
<p>A UE shall not expect to be configured with the higher layer
parameter <em>codebookSubset</em> or the higher layer parameter
<em>codebookSubsetDCI-0-2</em> set to <em>'</em>partialAndNonCoherent'
when higher layer parameter <em>nrofSRS-Ports</em> in an
<em>SRS-ResourceSet</em> with <em>usage</em> set to 'codebook' indicates
that the maximum number of the configured SRS antenna ports in the
<em>SRS-ResourceSet</em> is two.</p>
<p>For codebook based transmission, only one SRS resource can be
indicated based on the SRI from within the SRS resource set. Except when
higher layer parameter <em>ul-FullPowerTransmission</em> is set to
'fullpowerMode2', the maximum number of configured SRS resources for
codebook based transmission is 2. If aperiodic SRS is configured for a
UE, the SRS request field in DCI triggers the transmission of aperiodic
SRS resources.</p>
<p>A UE shall not expect to be configured with higher layer parameter
<em>ul-FullPowerTransmission</em> set to 'fullpowerMode1<em>'</em> and
<em>codebookSubset</em> or <em>codebookSubsetDCI-0-2</em> set to
<em>'</em>fullAndPartialAndNonCoherent<em>'</em> simultaneously.</p>
<p>The UE shall transmit PUSCH using the same antenna port(s) as the SRS
port(s) in the SRS resource indicated by the DCI format 0_1 or 0_2 or by
<em>configuredGrantConfig</em> according to clause 6.1.2.3.</p>
<p>The DM-RS antenna ports <img src="media/image703.svg"
style="width:0.64792in;height:0.21736in" /> in Clause 6.4.1.1.3 of [4,
TS38.211] are determined according to the ordering of DM-RS port(s)
given by Tables 7.3.1.1.2-6 to 7.3.1.1.2-23 in Clause 7.3.1.1.2 of [5,
TS 38.212].</p>
<p>Except when higher layer parameter <em>ul-FullPowerTransmission</em>
is set to 'fullpowerMode2', when multiple SRS resources are configured
by <em>SRS-ResourceSet</em> with <em>usage</em> set to 'codebook', the
UE shall expect that higher layer parameters <em>nrofSRS-Ports</em> in
<em>SRS-Resource</em> in <em>SRS-ResourceSet</em> shall be configured
with the same value for all these SRS resources.</p>
<p>When higher layer parameter <em>ul-FullPowerTransmission</em> is set
to 'fullpowerMode2',</p>
<p>- the UE can be configured with one SRS resource or multiple SRS
resources with same or different number of SRS ports within an SRS
resource set with <em>usage</em> set to 'codebook'.</p>
<p>- up to 2 different spatial relations can be configured for all SRS
resources in the SRS resource set with <em>usage</em> set to 'codebook'
when multiple SRS resources are configured in the SRS resource set.</p>
<p>- subject to UE capability, a maximum of 2 or 4 SRS resources are
supported in an SRS resource set with <em>usage</em> set to
'codebook'.</p>
<h4 id="non-codebook-based-ul-transmission">6.1.1.2 Non-Codebook based
UL transmission</h4>
<p>For non-codebook based transmission, PUSCH can be scheduled by DCI
format 0_0, DCI format 0_1, DCI format 0_2 or semi-statically configured
to operate according to Clause 6.1.2.3. If this PUSCH is scheduled by
DCI format 0_1, DCI format 0_2, or semi-statically configured to operate
according to Clause 6.1.2.3, the UE can determine its PUSCH precoder(s)
and transmission rank based on the SRI(s) when multiple SRS resources
are configured, where the SRI(s) is given by one or two SRS resource
indicator(s) in DCI according to clause 7.3.1.1.2 and 7.3.1.1.3 of [5,
38.212] for DCI format 0_1 and DCI format 0_2, or the SRI is given by
<em>srs-ResourceIndicator</em> according to clause 6.1.2.3, or SRIs
given by <em>srs-ResourceIndicator</em> and
<em>srs-ResourceIndicator2</em> according to clause 6.1.2.3.. The
<em>SRS-ResourceSet(s)</em> applicable for PUSCH scheduled by DCI format
0_1 and DCI format 0_2 are defined by the entries of the higher layer
parameter <em>srs-ResourceSetToAddModList</em> and
<em>srs-ResourceSetToAddModListDCI-0-2</em> in <em>SRS-config</em>,
respectively. The UE shall use one or multiple SRS resources for SRS
transmission, where, in a SRS resource set, the maximum number of SRS
resources which can be configured to the UE for simultaneous
transmission in the same symbol and the maximum number of SRS resources
are UE capabilities. The SRS resources transmitted simultaneously occupy
the same RBs. For a given CC, multiple SRS resources in a set with usage
"nonCodebook" are not expected to be partially overlapped in time. Only
one SRS port for each SRS resource is configured. Only one or two SRS
resource sets can be configured in <em>srs-ResourceSetToAddModList</em>
with higher layer parameter <em>usage</em> in <em>SRS-ResourceSet</em>
set to 'nonCodebook', and only one or two SRS resource sets can be
configured in <em>srs-ResourceSetToAddModListDCI-0-2</em> with higher
layer parameter <em>usage</em> in <em>SRS-ResourceSet</em> set to
'nonCodebook'. When two SRS resource sets are configured in
<em>srs-ResourceSetToAddModList</em> or
<em>srs-ResourceSetToAddModListDCI-0-2</em> with higher layer parameter
<em>usage</em> in <em>SRS-ResourceSet</em> set to 'nonCodebook', SRIs
are given by the DCI fields of two SRS resource indicators in clause
7.3.1.1.2 and 7.3.1.1.3 of [5, TS 38.212] for DCI format 0_1 and 0_2.
The UE applies the indicated SRI(s) to one or more PUSCH repetitions
according to the associated SRS resource set of a PUSCH repetition
according to clause 6.1.2.1. The maximum number of SRS resources per SRS
resource set that can be configured for non-codebook based uplink
transmission is 4. Each of the indicated SRIs in slot <em>n</em> is
associated with the most recent transmission of SRS resource(s) of
associated SRS resource set identified by the SRI, where the SRS
transmission is prior to the PDCCH carrying the SRI. When two SRS
resource sets are configured in <em>srs-ResourceSetToAddModList</em> or
<em>srs-ResourceSetToAddModListDCI-0-2</em> with higher layer parameter
<em>usage</em> in <em>SRS-ResourceSet</em> set to 'nonCodebook', the UE
is not expected to be configured with different number of SRS resources
in the two SRS resource sets.</p>
<p>When the PDCCH reception includes two PDCCH candidates from two
respective search space sets, as described in clause 10.1 of [6, TS
38.213], for the purpose of determining the most recent transmission of
SRS resource(s) identified by the SRI, the PDCCH candidate that starts
earlier in time is used.</p>
<p>For non-codebook based transmission, the UE can calculate the
precoder used for the transmission of SRS based on measurement of an
associated NZP CSI-RS resource. A UE can be configured with only one NZP
CSI-RS resource for each of the SRS resource set(s) with higher layer
parameter usage in <em>SRS-ResourceSet</em> set to 'nonCodebook' if
configured.</p>
<p>- If aperiodic SRS resource set is configured, the associated
NZP-CSI-RS is indicated via SRS request field in DCI format 0_1 and 1_1,
as well as DCI format 0_2 (if SRS request field is present) and DCI
format 1_2 (if SRS request field is present), where
<em>AperiodicSRS-ResourceTrigger</em> and
<em>AperiodicSRS-ResourceTriggerList</em> (indicating the association
between aperiodic SRS triggering state(s) and SRS resource sets),
triggered SRS resource(s) <em>srs-ResourceSetId</em>, <em>csi-RS</em>
(indicating the associated <em>NZP-CSI-RS-ResourceId</em>) are higher
layer configured in <em>SRS-ResourceSet</em>. The
<em>SRS-ResourceSet(s)</em> associated with the SRS request by DCI
format 0_1 and 1_1 are defined by the entries of the higher layer
parameter <em>srs-ResourceSetToAddModList</em> and the
<em>SRS-ResourceSet(s)</em> associated with the SRS request by DCI
format 0_2 and 1_2 are defined by the entries of the higher layer
parameter <em>srs-ResourceSetToAddModListDCI-0-2</em>. A UE is not
expected to update the SRS precoding information if the gap from the
last symbol of the reception of the aperiodic NZP-CSI-RS resource and
the first symbol of the aperiodic SRS transmission is less than 42<span
class="math inline">\(\bullet 2^{max(0,\mu - 3)}\)</span> OFDM symbols,
where the SCS configuration <em>μ</em> is the smallest SCS configuration
between the NZP-CSI-RS resource and the SRS transmission.</p>
<p>- If the UE configured with aperiodic SRS associated with aperiodic
NZP CSI-RS resource, the presence of the associated CSI-RS is indicated
by the SRS request field if the value of the SRS request field is not
'00' as in Table 7.3.1.1.2-24 of [5, TS 38.212] and if the scheduling
DCI is not used for cross carrier or cross bandwidth part scheduling. If
UE is configured with <em>minimumSchedulingOffsetK0</em> in the active
DL BWP and the currently applicable minimum scheduling offset
restriction <em>K<sub>0,min</sub></em> is larger than 0, the UE does not
expected to receive the scheduling DCI with the SRS request field value
other than '00'. The CSI-RS is located in the same slot as the SRS
request field. If the UE configured with aperiodic SRS associated with
aperiodic NZP CSI-RS resource, any of the TCI states configured in the
scheduled CC shall not be configured with <em>qcl-Type</em> set to
'typeD'.</p>
<p>- If periodic or semi-persistent SRS resource set is configured, the
<em>NZP-CSI-RS-ResourceId</em> for measurement is indicated via higher
layer parameter <em>associatedCSI-RS</em> in
<em>SRS-ResourceSet</em>.</p>
<p>The UE shall perform one-to-one mapping from the indicated SRI(s) to
the indicated DM-RS ports(s) and their corresponding PUSCH layers {0 …
ν-1} given by DCI format 0_1 or 0_2 or by <em>configuredGrantConfig</em>
according to clause 6.1.2.3 in increasing order.</p>
<p>The UE shall transmit PUSCH using the same antenna ports as the SRS
port(s) in the SRS resource(s) indicated by SRI(s) given by DCI format
0_1 or 0_2 or by <em>configuredGrantConfig</em> according to clause
6.1.2.3, where the SRS port in (<em>i</em>+1)-th SRS resource in the SRS
resource set is indexed as <img src="media/image704.svg" />.</p>
<p>The DM-RS antenna ports <img src="media/image703.svg"
style="width:0.64792in;height:0.21736in" /> in Clause 6.4.1.1.3 of [4,
TS 38.211] are determined according to the ordering of DM-RS port(s)
given by Tables 7.3.1.1.2-6 to 7.3.1.1.2-23 in Clause 7.3.1.1.2 of [5,
TS 38.212].</p>
<p>For non-codebook based transmission, the UE does not expect to be
configured with both <em>spatialRelationInfo</em> for SRS resource and
<em>associatedCSI-RS</em> in <em>SRS-ResourceSet</em> for SRS resource
set.</p>
<p>For non-codebook based transmission, the UE can be scheduled with DCI
format 0_1 or 0_2 when at least one SRS resource is configured in
<em>SRS-ResourceSet</em> with <em>usage</em> set to 'nonCodebook'.</p>
<h3 id="resource-allocation-1">6.1.2 Resource allocation </h3>
<h4 id="resource-allocation-in-time-domain-1">6.1.2.1 Resource
allocation in time domain</h4>
<p>When the UE is scheduled to transmit a transport block and no CSI
report by a DCI or by a RAR UL grant or fallbackRAR UL grant, or the UE
is scheduled to transmit a transport block and a CSI report(s) on PUSCH
by a DCI, the '<em>Time domain resource assignment'</em> field value
<em>m</em> of the DCI or the <em>PUSCH time resource allocation</em>
field value <em>m</em> of the RAR UL grant or of the fallbackRAR UL
grant provides a row index <em>m</em> + 1 to an allocated table. The
determination of the used resource allocation table is defined in Clause
6.1.2.1.1. The indexed row defines the slot offset
<em>K<sub>2</sub></em>, the start and length indicator <em>SLIV</em>, or
directly the start symbol <em>S</em> and the allocation length
<em>L</em>, the PUSCH mapping type, the number of slots used for TBS
determination (if <em>numberOfSlotsTBoMS</em> is present in the resource
allocation table), and the number of repetitions (if
<em>numberOfRepetitions</em> is present in the resource allocation
table) to be applied in the PUSCH transmission.</p>
<p>When the UE is scheduled to transmit a PUSCH with no transport block
and with a CSI report(s) by a '<em>CSI request'</em> field on a DCI, the
'<em>Time domain resource assignment'</em> field value <em>m</em> of the
DCI provides a row index <em>m</em> + 1 to the allocated table as
defined in Clause 6.1.2.1.1. The indexed row defines the start and
length indicator SLIV, or directly the start symbol <em>S</em> and the
allocation length <em>L</em>, and the PUSCH mapping type to be applied
in the PUSCH transmission and the <em>K<sub>2</sub></em> value is
determined as <img src="media/image705.svg" />, where <img
src="media/image706.svg" /> are the corresponding list entries of the
higher layer parameter</p>
<p>- <em>reportSlotOffsetListDCI-0-2</em> or
<em>reportSlotOffsetListDCI-0-2-r17</em>, if PUSCH is scheduled by DCI
format 0_2 and <em>reportSlotOffsetListDCI-0-2</em> or
<em>reportSlotOffsetListDCI-0-2-r17</em> is configured;</p>
<p>- <em>reportSlotOffsetListDCI-0-1</em> or
<em>reportSlotOffsetListDCI-0-1-r17</em>, if PUSCH is scheduled by DCI
format 0_1 and <em>reportSlotOffsetListDCI-0-1</em> or
<em>reportSlotOffsetListDCI-0-1-r17</em> is configured;</p>
<p>- <em>reportSlotOffsetList</em> or <em>reportSlotOffsetList-r17</em>,
otherwise;</p>
<p>in <em>CSI-ReportConfig</em> for the <img src="media/image707.svg" />
triggered CSI Reporting Settings and <img src="media/image708.svg" /> is
the <em>(m+1)</em>th entry of <img src="media/image709.svg" /> including
the omitted CSI Reporting Settings triggered for non-active DL BWPs,
where the UE does not expect that <em>(m+1)</em> is larger than 16.</p>
<p>- The slot <em>K<sub>s</sub></em> where the UE shall transmit the
PUSCH is determined by <em>K<sub>2</sub></em> as <em>K<sub>s
</sub></em>=<img src="media/image710.svg" />, if UE is configured with
<em>ca-SlotOffset</em> for at least one of the scheduled and scheduling
cell, <span class="math inline">\(K_{s} = \left\lfloor n \cdot
\frac{2^{\mu_{PUSCH}}}{2^{\mu_{PDCCH}}} \right\rfloor + K_{2} +
K_{offset} \cdot \frac{2^{\mu_{PUSCH}}}{2^{\mu_{K_{offset}}}}\)</span>,
otherwise, where <span class="math inline">\(K_{offset}\)</span> is a
parameter configured by higher layer as specified in clause 4.2 of [6 TS
38.213], and where <span
class="math inline">\(\mu_{K_{offset}}\)</span>is the subcarrier spacing
configuration for <span class="math inline">\(K_{offset}\)</span> with a
value of 0 for frequency range 1, <em>n</em> is the slot with the
scheduling DCI, K<em><sub>2</sub></em> is based on the numerology of
PUSCH, <img src="media/image711.svg" /> and <img
src="media/image14.svg" /> are the subcarrier spacing configurations for
PUSCH and PDCCH, respectively, and the scheduling DCI is other than DCI
format 0_0 with CRC scrambled by TC-RNTI.</p>
<p>- <span class="math inline">\(N_{\text{slot, offset,
PDCCH}}^{\text{CA}}\)</span> and <span
class="math inline">\(\mu_{\text{offset,PDCCH}}\ \)</span>are the<span
class="math inline">\({\ N}_{\text{slot, offset}}^{\text{CA}}\)</span>
and the<img src="media/image15.svg" />, respectively, which are
determined by higher-layer configured <em>ca-SlotOffset</em> for the
cell receiving the PDCCH,<span class="math inline">\(\ N_{\text{slot,
offset, PUSCH}}^{\text{CA}}\)</span> and<span class="math inline">\(\
\mu_{\text{offset,PUSCH}}\)</span> are the <span
class="math inline">\(N_{\text{slot, offset}}^{\text{CA}}\)</span> and
the<img src="media/image15.svg" />,respectively, which are determined by
higher-layer configured <em>ca-SlotOffset</em> for the cell transmitting
the PUSCH, as defined in clause 4.5 of [4, TS 38.211], and</p>
<p>- for PUSCH scheduled by DCI format 0_1, if
<em>pusch-RepTypeIndicatorDCI-0-1</em> is set to 'pusch-RepTypeB', the
UE applies PUSCH repetition Type B procedure when determining the time
domain resource allocation. For PUSCH scheduled by DCI format 0_2, if
<em>pusch-RepTypeIndicatorDCI-0-2</em> is set to 'pusch-RepTypeB', the
UE applies PUSCH repetition Type B procedure when determining the time
domain resource allocation. Otherwise, the UE applies PUSCH repetition
Type A procedure when determining the time domain resource allocation
for PUSCH scheduled by PDCCH, by RAR UL grant, or by fallbackRAR UL
grant.</p>
<p>- for PUSCH scheduled by DCI format 0_1 or DCI format 0_2, if
<em>numberOfSlotsTBoMS</em> is present and larger than 1, the UE applies
TB processing over multiple slots procedure when determining the time
domain resource allocation.</p>
<p>- For PUSCH repetition Type A and TB processing over multiple slots,
the starting symbol <em>S</em> relative to the start of the slot, and
the number of consecutive symbols <em>L</em> counting from the symbol
<em>S</em> allocated for the PUSCH are determined from the start and
length indicator <em>SLIV</em> of the indexed row:</p>
<blockquote>
<p>if <img src="media/image712.svg" /> then</p>
<p><img src="media/image713.svg" /></p>
<p>else</p>
<p><img src="media/image714.svg" /></p>
<p>where<img src="media/image715.svg" />, and</p>
</blockquote>
<p>- For PUSCH repetition Type B, the starting symbol <em>S</em>
relative to the start of the slot, and the number of consecutive symbols
<em>L</em> counting from the symbol <em>S</em> allocated for the PUSCH
are provided by <em>startSymbol</em> and <em>length</em> of the indexed
row of the resource allocation table, respectively.</p>
<p>- For PUSCH repetition Type A and TB processing over multiple slots,
the PUSCH mapping type is set to Type A or Type B as defined in Clause
6.4.1.1.3 of [4, TS 38.211] as given by the indexed row.</p>
<p>- For PUSCH repetition Type B, the PUSCH mapping type is set to Type
B.</p>
<p>The UE shall consider the <em>S</em> and <em>L</em> combinations
defined in table 6.1.2.1-1 as valid PUSCH allocations</p>
<p>Table 6.1.2.1-1: Valid <em>S</em> and <em>L</em> combinations</p>
<table>
<colgroup>
<col style="width: 16%" />
<col style="width: 11%" />
<col style="width: 11%" />
<col style="width: 17%" />
<col style="width: 11%" />
<col style="width: 11%" />
<col style="width: 19%" />
</colgroup>
<thead>
<tr>
<th rowspan="2">PUSCH mapping type</th>
<th colspan="3">Normal cyclic prefix</th>
<th colspan="3">Extended cyclic prefix</th>
</tr>
<tr>
<th><em>S</em></th>
<th><em>L</em></th>
<th><em>S+L</em></th>
<th><em>S</em></th>
<th><em>L</em></th>
<th><em>S+L</em></th>
</tr>
</thead>
<tbody>
<tr>
<td>Type A (repetition Type A only)</td>
<td>0</td>
<td>{4,…,14}</td>
<td>{4,…,14}</td>
<td>0</td>
<td>{4,…,12}</td>
<td>{4,…,12}</td>
</tr>
<tr>
<td>Type B</td>
<td>{0,…,13}</td>
<td>{1,…,14}</td>
<td>{1,…,14} for repetition Type A, {1,…,27} for repetition Type B</td>
<td>{0,…, 11}</td>
<td>{1,…,12}</td>
<td>{1,…,12} for repetition Type A, {1,…,23} for repetition Type B</td>
</tr>
</tbody>
</table>
<p>For TB processing over multiple slots, when transmitting PUSCH
scheduled by DCI format 0_1 or 0_2 in PDCCH with CRC scrambled with
C-RNTI, MCS-C-RNTI, or CS-RNTI with NDI=1,</p>
<blockquote>
<p>- the number of slots used for TBS determination <em>N</em> is
indicated by <em>numberOfSlotsTBoMS.</em></p>
<p>- the number of repetitions <em>K</em> of the number of slots
<em>N</em> used for TBS determination is determined as</p>
<p>- if <em>numberOfRepetitions</em> is present in the resource
allocation table, the number of repetitions <em>K</em> is equal to
<em>numberOfRepetitions</em>;</p>
<p>- otherwise, <em>K=1</em>.</p>
<p>- when the UE supports repetition of TB processing over multiple
slots, the UE does not expect that <span class="math inline">\(N \bullet
K\)</span> is larger than 32.</p>
</blockquote>
<p>When configured with μ= 5 or 6 the UE does not expect to be scheduled
with more than one PUSCH in a slot, by a single DCI or multiple DCIs<u>,
where multiple DCIs are not associated with CORESETs having different
<em>coresetpoolIndex</em></u>.</p>
<p>For PUSCH repetition Type A, when transmitting PUSCH scheduled by DCI
format 0_1 or 0_2 in PDCCH with CRC scrambled with C-RNTI, MCS-C-RNTI,
or CS-RNTI with NDI=1, the number of repetitions <em>K</em> is
determined as</p>
<p>- if <em>numberOfRepetitions</em> is present in the resource
allocation table, the number of repetitions K is equal to
<em>numberOfRepetitions</em>;</p>
<p>- elseif the UE is configured with <em>pusch-AggregationFactor</em>,
the number of repetitions <em>K</em> is equal to
<em>pusch-AggregationFactor</em>;</p>
<p>- otherwise <em>K=1</em>.</p>
<p>- the number of slots used for TBS determination <em>N</em> is equal
to 1.</p>
<p>For PUSCH repetition type A, when transmitting PUSCH scheduled by RAR
UL grant, the 2 MSBs of the MCS information field of the RAR UL grant
provide a codepoint to determine the number of repetitions <em>K</em>
according to Table 6.1.2.1-1A, based on whether or not the higher layer
parameter <em>numberOfMsg3-RepetitionsList</em> is configured. The
number of slots used for TBS determination N is equal to 1.</p>
<p>For PUSCH repetition type A, when transmitting PUSCH scheduled by DCI
format 0_0 with CRC scrambled by TC-RNTI, the 2 MSBs of the MCS
information field of the DCI format 0_0 with CRC scrambled by TC-RNTI
provide a codepoint to determine the number of repetitions <em>K</em>
according to Table 6.1.2.1-1A, based on whether or not the higher layer
parameter <em>numberOfMsg3-RepetitionsList</em> is configured. The
number of slots used for TBS determination N is equal to 1.</p>
<p>Table 6.1.2.1-1A: Number of repetition <em>K</em> as a function of 2
MSBs of MCS information field</p>
<table>
<colgroup>
<col style="width: 24%" />
<col style="width: 24%" />
<col style="width: 3%" />
<col style="width: 23%" />
<col style="width: 23%" />
</colgroup>
<thead>
<tr>
<th colspan="2"><em>numberOfMsg3-RepetitionsList is configured</em></th>
<th></th>
<th colspan="2"><em>numberOfMsg3-RepetitionsList is not
configured</em></th>
</tr>
</thead>
<tbody>
<tr>
<td><em>Codepoint</em></td>
<td><em>K</em></td>
<td></td>
<td>Codepoint</td>
<td><em>K</em></td>
</tr>
<tr>
<td>00</td>
<td>First value of <em>numberOfMsg3-RepetitionsList</em></td>
<td></td>
<td>00</td>
<td>1</td>
</tr>
<tr>
<td>01</td>
<td>Second value of <em>numberOfMsg3-RepetitionsList</em></td>
<td></td>
<td>01</td>
<td>2</td>
</tr>
<tr>
<td>10</td>
<td>Third value of <em>numberOfMsg3-RepetitionsList</em></td>
<td></td>
<td>10</td>
<td>3</td>
</tr>
<tr>
<td>11</td>
<td>Fourth value of <em>numberOfMsg3-RepetitionsList</em></td>
<td></td>
<td>11</td>
<td>4</td>
</tr>
</tbody>
</table>
<p>If a UE is configured with higher layer parameter
<em>pusch-TimeDomainAllocationListForMultiPUSCH</em>, the UE does not
expect to be configured with <em>pusch-AggregationFactor</em>.</p>
<p>If a UE is configured with <em>extendedK2</em> in
<em>pusch-TimeDomainAllocationListForMultiPUSCH</em> in which one or
more rows contain multiple SLIVs for PUSCH on a UL BWP of a serving
cell, the UE does not apply <em>pusch-AggregationFactor,</em> if
configured, to DCI format 0_1 on the UL BWP of the serving cell and the
UE does not expect to be configured with <em>numberOfRepetitions</em> in
<em>pusch-TimeDomainAllocationListForMultiPUSCH</em>.</p>
<p>If a UE is configured with <em>extendedK2</em> in
<em>pusch-TimeDomainAllocationListForMultiPUSCH</em> in which one or
more rows contain multiple <em>SLIV</em>s for PUSCH on a UL BWP of a
serving cell, when any two UL DCIs end in the same symbol and at least
one of the DCIs scheduling multiple PUSCHs, the UE does not expect that
the any scheduled multiple PUSCHs have overlapping spans, where the span
associated with a DCI is defined from the beginning of the first
scheduled PUSCH till the end of the last scheduled PUSCH.</p>
<p>For unpaired spectrum:</p>
<p>- When <em>AvailableSlotCounting</em> is enabled, and in case
<em>K&gt;1,</em> the UE determines <span class="math inline">\(N \bullet
K\)</span> slots for a PUSCH transmission of a PUSCH repetition type A
scheduled by DCI format 0_1 or 0_2, based on
<em>tdd-UL-DL-ConfigurationCommon</em>,
<em>tdd-UL-DL-ConfigurationDedicated</em> <em>and
ssb-PositionsInBurst</em>, and the TDRA information field value in the
DCI format 0_1 or 0_2.</p>
<p>- A slot is not counted in the number of <span
class="math inline">\(N \bullet K\)</span> slots for PUSCH transmission
of a PUSCH repetition Type A scheduled by DCI format 0_1 or 0_2 if at
least one of the symbols indicated by the indexed row of the used
resource allocation table in the slot overlaps with a DL symbol
indicated by <em>tdd-UL-DL-ConfigurationCommon</em> or
<em>tdd-UL-DL-ConfigurationDedicated</em> if provided, or a symbol of an
SS/PBCH block with index provided by <em>ssb-PositionsInBurst</em>.</p>
<p>- Otherwise, the UE determines <span class="math inline">\(N \bullet
K\)</span> consecutive slots for a PUSCH transmission of a PUSCH
repetition type A scheduled by DCI format 0_1 or 0_2, based on the TDRA
information field value in the DCI format 0_1 or 0_2.</p>
<p>- The UE determines <span class="math inline">\(N \bullet K\)</span>
slots for a PUSCH transmission of TB processing over multiple slots
scheduled by DCI format 0_1 or 0_2, based on
<em>tdd-UL-DL-ConfigurationCommon</em>,
<em>tdd-UL-DL-ConfigurationDedicated</em> and
<em>ssb-PositionsInBurst</em>, and the TDRA information field value in
the DCI format 0_1 or 0_2.</p>
<p>- A slot is not counted in the number of <span
class="math inline">\(N \bullet K\)</span> slots for a PUSCH
transmission of TB processing over multiple slots if at least one of the
symbols indicated by the indexed row of the used resource allocation
table in the slot overlaps with a DL symbol indicated by
<em>tdd-UL-DL-ConfigurationCommon</em> or
<em>tdd-UL-DL-ConfigurationDedicated</em> if provided, or a symbol of an
SS/PBCH block with index provided by <em>ssb-PositionsInBurst</em>.</p>
<p>- The UE determines <span class="math inline">\(N \bullet K\)</span>
slots for a PUSCH transmission of a PUSCH repetition Type A scheduled by
RAR UL grant, based on <em>tdd-UL-DL-ConfigurationCommon</em> and
<em>ssb-PositionsInBurst,</em> and the TDRA information field value in
the RAR UL grant.</p>
<p>- A slot is not counted in the number of <span
class="math inline">\(N \bullet K\)</span> slots for a PUSCH
transmission of a PUSCH repetition Type A scheduled by RAR UL grant, if
at least one of the symbols indicated by the indexed row of the used
resource allocation table in the slot overlaps with a DL symbol
indicated by <em>tdd-UL-DL-ConfigurationCommon</em> if provided, or a
symbol of an SS/PBCH block with index provided by
<em>ssb-PositionsInBurst</em>.</p>
<p>- The UE determines <span class="math inline">\(N \bullet K\)</span>
slots for a PUSCH transmission of a PUSCH repetition Type A scheduled by
DCI format 0_0 with CRC scrambled by TC-RNTI, based on
<em>tdd-UL-DL-ConfigurationCommon</em> and <em>ssb-PositionsInBurst</em>
and the TDRA information field value in the DCI scheduling the
PUSCH.</p>
<p>- A slot is not counted in the number of <span
class="math inline">\(N \bullet K\)</span> slots for a PUSCH
transmission of a PUSCH repetition Type A scheduled by DCI format 0_0
scrambled by TC-RNTI, if at least one of the symbols indicated by the
indexed row of the used resource allocation table in the slot overlaps
with a DL symbol indicated by <em>tdd-UL-DL-ConfigurationCommon</em> if
provided, or a symbol of an SS/PBCH block with index provided by
<em>ssb-PositionsInBurst</em>.</p>
<p>For paired spectrum and SUL band:</p>
<p>- The UE determines <span class="math inline">\(N \bullet K\)</span>
consecutive slots for a PUSCH transmission of a PUSCH repetition type A
scheduled by DCI format 0_1 or 0_2, or for a PUSCH transmission of TB
processing over multiple slots scheduled by DCI format 0_1 or 0_2, based
on the TDRA information field value in the DCI format 0_1 or 0_2.</p>
<p>- For the case of a reduced capability half-duplex UE, the UE
determines <span class="math inline">\(N \bullet K\)</span> slots for a
PUSCH transmission of a PUSCH repetition type A scheduled by DCI format
0_1 or 0_2 when <em>AvailableSlotCounting</em> is enabled and K&gt;1, or
for a PUSCH transmission of TB processing over multiple slots scheduled
by DCI format 0_1 or 0_2, based on the TDRA information field value in
the DCI format 0_1 or 0_2. A slot is not counted in the number of <span
class="math inline">\(N \bullet K\)</span> slots if at least one of the
symbols indicated by the indexed row of the used resource allocation
table in the slot does not start or end at least <span
class="math inline">\(N_{\text{Rx-Tx}} \cdot T_{\text{c}}\)</span> or
<span class="math inline">\(N_{\text{Tx-Rx}} \cdot
T_{\text{c}}\)</span>, respectively, from the last or first symbol of an
SS/PBCH block with index provided by <em>ssb-PositionsInBurst</em>.</p>
<p>- The UE determines <span class="math inline">\(N \bullet K\)</span>
consecutive slots for a PUSCH transmission of a PUSCH repetition Type A
scheduled by RAR UL grant, based on the TDRA information field value in
the RAR UL grant.</p>
<p>- The UE determines <span class="math inline">\(N \bullet K\)</span>
consecutive slots for a PUSCH transmission of a PUSCH repetition Type A
scheduled by DCI format 0_0 with CRC scrambled by TC-RNTI, based on the
TDRA information field value in the DCI scheduling the PUSCH.</p>
<p>If a UE would transmit a PUSCH of PUSCH repetition Type A when
<em>AvailableSlotCounting</em> is enabled and K&gt;1 or a TB processing
over multiple slots over <span class="math inline">\(N \bullet
K\)</span> slots, and the UE does not transmit the PUSCH of a TB
processing over multiple slots or the PUSCH repetition Type A in a slot
from the <span class="math inline">\(N \bullet K\)</span> slots,
according to Clause 9, Clause 11.1, Clause 11.2A, Clause 15 and Clause
17.2 of [6, TS 38.213], the UE counts the slots in the number of <span
class="math inline">\(N \bullet K\)</span> slots.</p>
<p>For PUSCH repetition Type A, in case <em>K&gt;1</em>,</p>
<p>- If the PUSCH is scheduled by DCI format 0_1 or 0_2</p>
<p>- if <em>AvailableSlotCounting</em> is enabled, the same symbol
allocation is applied across the <span class="math inline">\(N \bullet
K\)</span> slots determined for the PUSCH transmission and the PUSCH is
limited to a single transmission layer. The UE shall repeat the TB
across the <span class="math inline">\(N \bullet K\)</span> slots
determined for the PUSCH transmission, applying the same symbol
allocation in each slot.</p>
<p>- Otherwise, the same symbol allocation is applied across the <span
class="math inline">\(N \bullet K\)</span> consecutive slots and the
PUSCH is limited to a single transmission layer. The UE shall repeat the
TB across the <span class="math inline">\(N \bullet K\)</span>
consecutive slots applying the same symbol allocation in each slot.</p>
<p>- Else if the PUSCH is scheduled by RAR UL grant or by DCI format 0_0
with CRC scrambled by TC-RNTI, the same symbol allocation is applied
across the <span class="math inline">\(N \bullet K\)</span> slots
determined for the PUSCH transmission and the PUSCH is limited to a
single transmission layer. The UE shall repeat the TB across the <span
class="math inline">\(N \bullet K\)</span> slots determined for the
PUSCH transmission, applying the same symbol allocation in each
slot.</p>
<p>For PUSCH repetition Type B:</p>
<p>- If <em>pusch-DMRS-Bundling</em> is enabled, the PUSCH is limited to
a single transmission layer.</p>
<p>For TB processing over multiple slots:</p>
<p>- For unpaired spectrum, the same symbol allocation is applied across
the <span class="math inline">\(N \bullet K\)</span> slots determined
for the PUSCH transmission and the PUSCH is limited to a single
transmission layer. The UE shall transmit the TB across the <span
class="math inline">\(N \bullet K\)</span> slots determined for the
PUSCH transmission, applying the same symbol allocation in each
slot.</p>
<p>- For paired spectrum or supplementary uplink band, the same symbol
allocation is applied across the <span class="math inline">\(\ N \bullet
K\)</span> consecutive slots and the PUSCH is limited to a single
transmission layer. The UE shall transmit the TB across the <span
class="math inline">\(N \bullet K\)</span> consecutive slots applying
the same symbol allocation in each slot.</p>
<p>- For the case of reduced capability half-duplex UE, the same symbol
allocation is applied across the <span class="math inline">\(N \bullet
K\)</span> slots determined for the PUSCH transmission and the PUSCH is
limited to a single transmission layer. The UE shall transmit the TB
across the <span class="math inline">\(N \bullet K\)</span> slots
determined for the PUSCH transmission, applying the same symbol
allocation in each slot.</p>
<p>For a PUSCH transmission scheduled by DCI format 0_1, or 0_2, or 0_0
with CRC scrambled by TC-RNTI, the redundancy version to be applied on
the <em>n</em>th transmission occasion of the TB, where n = 0, 1, …
<span class="math inline">\(N \bullet K\)</span> -1, is determined
according to table 6.1.2.1-2.</p>
<p>For a PUSCH transmission of a PUSCH repetition Type A scheduled by
RAR UL grant, the redundancy version to be applied on the <em>n</em>th
transmission occasion of the TB, where n = 0, 1, … <span
class="math inline">\(N \bullet K\)</span> -1, is determined according
to the first row of Table 6.1.2.1-2.</p>
<p>Table 6.1.2.1-2: Redundancy version for PUSCH transmission</p>
<table>
<colgroup>
<col style="width: 24%" />
<col style="width: 18%" />
<col style="width: 18%" />
<col style="width: 18%" />
<col style="width: 18%" />
</colgroup>
<thead>
<tr>
<th rowspan="2"><em>rv<sub>id </sub></em>indicated by the DCI scheduling
the PUSCH</th>
<th colspan="4"><em>rv<sub>id</sub></em> to be applied to
<em>n</em><sup>th</sup> transmission occasion (repetition Type A) or TB
processing over multiple slots) or <em>n</em><sup>th</sup> actual
repetition (repetition Type B)</th>
</tr>
<tr>
<th><em>((n-(n mod N))/N)</em> mod 4 = 0</th>
<th><em>((n-(n mod N))/N)</em> mod 4 = 1</th>
<th><em>((n-(n mod N))/N)</em> mod 4 = 2</th>
<th><em>((n-(n mod N))/N)</em> mod 4 = 3</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>0</td>
<td>2</td>
<td>3</td>
<td>1</td>
</tr>
<tr>
<td>2</td>
<td>2</td>
<td>3</td>
<td>1</td>
<td>0</td>
</tr>
<tr>
<td>3</td>
<td>3</td>
<td>1</td>
<td>0</td>
<td>2</td>
</tr>
<tr>
<td>1</td>
<td>1</td>
<td>0</td>
<td>2</td>
<td>3</td>
</tr>
</tbody>
</table>
<p>When transmitting MsgA PUSCH on a non-initial UL BWP, if the UE is
configured with <em>startSymbolAndLengthMsgA-PO</em>, the UE shall
determine the <em>S</em> and <em>L</em> from
<em>startSymbolAndLengthMsgA-PO</em>.</p>
<p>When transmitting MsgA PUSCH, if the UE is not configured with
<em>startSymbolAndLengthMsgA-PO</em>, and if the TDRA list
<em>PUSCH-TimeDomainResourceAllocationList</em> is provided in
<em>PUSCH-ConfigCommon</em>, the UE shall use
<em>msgA-PUSCH-TimeDomainAllocation</em> to indicate which values are
used in the list. If <em>PUSCH-TimeDomainResourceAllocationList</em> is
not provided in <em>PUSCH-ConfigCommon</em>, the UE shall use parameters
<em>S</em> and <em>L</em> from table 6.1.2.1.1-2 or table 6.1.2.1.1-3
where <em>msgA-PUSCH-TimeDomainAllocation</em> indicates which values
are used in the list. The time offset for PUSCH transmission is
described in [6, TS 38.213].</p>
<p>For PUSCH repetition Type A and TB processing over multiple slots, a
PUSCH transmission in a slot of a multi-slot PUSCH transmission is
omitted according to the conditions in Clause 9, Clause 11.1, Clause
11.2A, Clause 15 and Clause 17.2 of [6, TS 38.213].</p>
<p>For PUSCH repetition Type B, except for PUSCH transmitting CSI
report(s) with no transport block, the number of nominal repetitions is
given by <em>numberOfRepetitions</em>. For the <em>n</em>-th nominal
repetition, <em>n</em> = <em>0</em>, …, <em>numberOfRepetitions</em> -
1,</p>
<p>- The slot where the nominal repetition starts is given by <img
src="media/image716.svg" />, and the starting symbol relative to the
start of the slot is given by <img src="media/image717.svg" />.</p>
<p>- The slot where the nominal repetition ends is given by <img
src="media/image718.svg" />, and the ending symbol relative to the start
of the slot is given by <img src="media/image719.svg" />.</p>
<p>Here <img src="media/image720.svg" />is the slot where the PUSCH
transmission starts, and <img src="media/image721.svg" />is the number
of symbols per slot as defined in Clause 4.3.2 of [4, TS38.211].</p>
<p>For PUSCH repetition Type B, the UE determines invalid symbol(s) for
PUSCH repetition Type B transmission as follows:</p>
<p>- A symbol that is indicated as downlink by
<em>tdd-UL-DL-ConfigurationCommon</em> or
<em>tdd-UL-DL-ConfigurationDedicated</em> is considered as an invalid
symbol for PUSCH repetition Type B transmission.</p>
<p>- For operation in unpaired spectrum, symbols indicated by
<em>ssb-PositionsInBurst</em> in SIB1 or <em>ssb-PositionsInBurst</em>
in <em>ServingCellConfigCommon</em> for reception of SS/PBCH blocks are
considered as invalid symbols for PUSCH repetition Type B
transmission.</p>
<p>- For a reduced capability half-duplex UE in paired spectrum, symbols
that do not start or end at least <span
class="math inline">\(N_{\text{Rx-Tx}} \cdot T_{\text{c}}\)</span> or
<span class="math inline">\(N_{\text{Tx-Rx}} \cdot
T_{\text{c}}\)</span>, respectively, from the last or first symbol of an
SS/PBCH block with index indicated by <em>ssb-PositionsInBurst</em> in
SIB1 or by <em>ssb-PositionsInBurst</em> in
<em>ServingCellConfigCommon</em> or by <em>NonCellDefiningSSB</em>, or
by <em>ssb-PositionsInBurst</em> in <em>SSB-MTC-AdditionalPCI</em>
associated to physical cell ID with active TCI states for PDCCH or
PDSCH, or for a set of symbols of a slot corresponding to SS/PBCH blocks
configured for L1 beam measurement/reporting for reception of SS/PBCH
blocks are considered as invalid symbols for PUSCH repetition Type B
transmission.</p>
<p>- For operation in unpaired spectrum, symbol(s) indicated by
<em>pdcch-ConfigSIB1</em> in <em>MIB</em> for a CORESET for Type0-PDCCH
CSS set are considered as invalid symbol(s) for PUSCH repetition Type B
transmission.</p>
<p>- For operation in unpaired spectrum, if
<em>numberOfInvalidSymbolsForDL-UL-Switching</em> is configured,
<em>numberOfInvalidSymbolsForDL-UL-Switching</em> symbol(s) after the
last symbol that is indicated as downlink in each consecutive set of all
symbols that are indicated as downlink by
<em>tdd-UL-DL-ConfigurationCommon</em> or
<em>tdd-UL-DL-ConfigurationDedicated</em> are considered as invalid
symbol(s) for PUSCH repetition Type B transmission. The symbol(s) given
by <em>numberOfInvalidSymbolsForDL-UL-Switching</em> are defined using
the reference SCS configuration <em>referenceSubcarrierSpacing</em>
provided in <em>tdd-UL-DL-ConfigurationCommon</em>.</p>
<p>- For operation with shared spectrum channel access with semi-static
channel occupancy, symbols in an idle duration associated with a
periodic channel occupancy as described in Clause 4.3.1.1 of [16,
37.213], or in an idle duration in a period associated with an initiated
channel occupancy as described in Clause 4.3.2. of [16, TS 37.213] are
considered as invalid symbol(s) for PUSCH repetition Type B
transmission.</p>
<p>- The UE may be configured with the higher layer parameter
<em>invalidSymbolPattern</em>, which provides a symbol level bitmap
spanning one or two slots (higher layer parameter <em>symbols</em> given
by <em>invalidSymbolPattern</em>). A bit value equal to 1 in the symbol
level bitmap <em>symbols</em> indicates that the corresponding symbol is
an invalid symbol for PUSCH repetition Type B transmission. The UE may
be additionally configured with a time-domain pattern (higher layer
parameter <em>periodicityAndPattern</em> given by
<em>invalidSymbolPattern</em>), where each bit of
<em>periodicityAndPattern</em> corresponds to a unit equal to a duration
of the symbol level bitmap <em>symbols</em>, and a bit value equal to 1
indicates that the symbol level bitmap <em>symbols</em> is present in
the unit. The <em>periodicityAndPattern</em> can be {1, 2, 4, 5, 8, 10,
20 or 40} units long, but maximum of 40 msec. The first symbol of
<em>periodicityAndPattern</em> every 40 msec/P periods is a first symbol
in frame 𝑛𝑓 mod 4 = 0, where P is the duration of
<em>periodicityAndPattern-r16</em> in units of msec. When
<em>periodicityAndPattern</em> is not configured, for a symbol level
bitmap spanning two slots, the bits of the first and second slots
correspond respectively to even and odd slots of a radio frame, and for
a symbol level bitmap spanning one slot, the bits of the slot correspond
to every slot of a radio frame. If <em>invalidSymbolPattern</em> is
configured, when the UE applies the invalid symbol pattern is determined
as follows:</p>
<p>- if the PUSCH is scheduled by DCI format 0_1, or corresponds to a
Type 2 configured grant activated by DCI format 0_1, and if
<em>invalidSymbolPatternIndicatorDCI-0-1</em> is configured,</p>
<p>- if invalid symbol pattern indicator field is set 1, the UE applies
the invalid symbol pattern;</p>
<p>- otherwise, the UE does not apply the invalid symbol pattern;</p>
<p>- if the PUSCH is scheduled by DCI format 0_2, or corresponds to a
Type 2 configured grant activated by DCI format 0_2, and if
<em>invalidSymbolPatternIndicatorDCI-0-2</em> is configured,</p>
<p>- if invalid symbol pattern indicator field is set 1, the UE applies
the invalid symbol pattern;</p>
<p>- otherwise, the UE does not apply the invalid symbol pattern;</p>
<p>- otherwise, the UE applies the invalid symbol pattern.</p>
<p>- If the UE</p>
<p>- is configured with multiple serving cells within a cell group and
is provided with <em>directionalCollisionHandling-r16</em> = 'enabled'
for a set of serving cell(s) among the multiple serving cells, and</p>
<p>- indicates support of <em>half-DuplexTDD-CA-SameSCS-r16</em>
capability, and</p>
<p>- is not configured to monitor PDCCH for detection of DCI format 2-0
on any of the multiple serving cells,</p>
<p>- a symbol indicated to the UE for reception of SS/PBCH blocks in a
first cell of the multiple serving cells by
<em>ssb-PositionsInBurst</em> in <em>SIB1</em> or by
<em>ssb-PositionsInBurst</em> in <em>ServingCellConfigCommon</em>, or by
<em>ssb-PositionsInBurst</em> in <em>SSB-MTC-AdditionalPCI</em>
associated to physical cell ID with active TCI states for PDCCH or
PDSCH, or for a set of symbols of a slot corresponding to SS/PBCH blocks
configured for L1 beam measurement/reporting is considered as an invalid
symbol for PUSCH repetition Type B transmission in</p>
<p>- any of the multiple serving cells if the UE is not capable of
simultaneous transmission and reception as indicated by
<em>simultaneousRxTxInterBandCA</em> among the multiple serving cells,
and</p>
<p>- any one of the cells corresponding to the same band as the first
cell, irrespective of any capability indicated by
<em>simultaneousRxTxInterBandCA</em></p>
<p>and</p>
<p>- a symbol is considered as an invalid symbol in another cell among
the set of serving cell(s) provided with
<em>directionalCollisionHandling-r16</em> for PUSCH repetition Type B
transmission with Type 1 or Type 2 configured grant except for the first
Type 2 PUSCH transmission (including all repetitions) after activation
if the symbol is indicated as downlink by
<em>tdd-UL-DL-ConfigurationCommon</em> or
<em>tdd-UL-DL-ConfigurationDedicated</em> on the reference cell as
defined in Clause 11.1 of [6, TS 38.213], or the UE is configured by
higher layers to receive PDCCH, PDSCH, or CSI-RS on the reference cell
in the symbol.</p>
<p>For PUSCH repetition Type B, after determining the invalid symbol(s)
for PUSCH repetition type B transmission for each of the <em>K</em>
nominal repetitions, the remaining symbols are considered as potentially
valid symbols for PUSCH repetition Type B transmission. If the number of
potentially valid symbols for PUSCH repetition type B transmission is
greater than zero for a nominal repetition, the nominal repetition
consists of one or more actual repetitions, where each actual repetition
consists of a consecutive set of all potentially valid symbols that can
be used for PUSCH repetition Type B transmission within a slot. An
actual repetition with a single symbol is omitted except for the case of
<em>L</em>=1. An actual repetition is omitted according to the
conditions in Clause 9, Clause 11.1, Clause 11.2A, Clause 15 and Clause
17.2 of [6, TS 38.213]. The UE shall repeat the TB across actual
repetitions. The redundancy version to be applied on the <em>n</em>th
actual repetition (with the counting including the actual repetitions
that are omitted) is determined according to table 6.1.2.1-2, where
<em>N</em>=1.</p>
<p>For PUSCH repetition Type B, when a UE receives a DCI that schedules
aperiodic CSI report(s) or activates semi-persistent CSI report(s) on
PUSCH with no transport block by a '<em>CSI request'</em> field on a
DCI, the number of nominal repetitions is always assumed to be 1,
regardless of the value of <em>numberOfRepetitions</em>. When the UE is
scheduled to transmit a PUSCH repetition Type B with no transport block
and with aperiodic or semi-persistent CSI report(s) by a '<em>CSI
request'</em> field on a DCI, the first nominal repetition is expected
to be the same as the first actual repetition. For PUSCH repetition Type
B carrying semi-persistent CSI report(s) without a corresponding PDCCH
after being activated on PUSCH by a '<em>CSI request'</em> field on a
DCI, if the first nominal repetition is not the same as the first actual
repetition, the first nominal repetition is omitted; otherwise, the
first nominal repetition is omitted according to the conditions in
Clause 9, Clause 11.1, Clause 11.2A, Clause 15 and Clause 17.2 of [6, TS
38.213].</p>
<p>For PUSCH repetition Type B, when a UE is scheduled to transmit a
transport block and aperiodic CSI report(s) on PUSCH by a '<em>CSI
request'</em> field on a DCI, the CSI report(s) is multiplexed only on
the first actual repetition. The UE does not expect that the first
actual repetition has a single symbol duration.</p>
<p>For <em>pusch-TimeDomainAllocationListForMultiPUSCH</em> in
<em>pusch-Config</em>, if a row indicates resource allocation for two to
eight contiguous PUSCHs and <em>extendedK2</em> is not configured,
<em>K<sub>2</sub></em> given by <em>k2-r16</em> indicates the slot where
UE shall transmit the first PUSCH of the multiple PUSCHs. Each PUSCH has
a separate SLIV and mapping type. The number of scheduled PUSCHs is
signalled by the number of indicated valid SLIVs in the row of the
<em>pusch-TimeDomainAllocationListForMultiPUSCH</em> signalled in DCI
format 0_1.</p>
<p>For <em>pusch-TimeDomainAllocationListForMultiPUSCH</em> in
<em>pusch-Config,</em> if a row indicates resource allocation of more
than one PUSCH and <em>extendedK2</em> is configured, each PUSCH has a
separate SLIV, mapping type and <em>K<sub>2 </sub></em>given by
<em>extendedK2</em>. If a row indicates resource allocation of a single
PUSCH, the PUSCH has a single SLIV, mapping type, and
<em>K<sub>2</sub></em>, where <em>K<sub>2</sub></em> is given by
<em>extendedK2</em>, if configured, otherwise <em>K<sub>2</sub></em> is
given by <em>k2-r16</em>. The number of scheduled PUSCHs is signalled by
the number of indicated SLIVs in the row of the
<em>pusch-TimeDomainAllocationListForMultiPUSCH</em> signalled in DCI
format 0_1.</p>
<p>If a UE is configured with <em>extendedK2</em> in
<em>pusch-TimeDomainAllocationListForMultiPUSCH</em> in which one or
more rows contain multiple <em>SLIV</em>s for PUSCH on a UL BWP of a
serving cell, and the UE is indicated re-transmission of PUSCH by DCI
format 0_1, where the PUSCH is correspond to a configured grant Type 1
or Type 2, the UE does not expect that the number of indicated
<em>SLIV</em>s in the row of the
<em>pusch-TimeDomainAllocationListForMultiPUSCH</em> by the DCI is more
than one.</p>
<p>If a UE is configured with
<em>pusch-TimeDomainAllocationListForMultiPUSCH</em> in which one or
more rows contain multiple <em>SLIV</em>s for PUSCH on a UL BWP of a
serving cell, the UE does not expect to be scheduled with one or
multiple PUSCH transmissions by a single DCI format 0_1, where each
PUSCH transmission overlaps with a DL symbol indicated by
<em>tdd-UL-DL-ConfigurationCommon</em> or
<em>tdd-UL-DL-ConfigurationDedicated</em> if provided, or a symbol of an
SS/PBCH block with index provided by <em>ssb-PositionsInBurst</em>.</p>
<p>When the UE is configured with <em>minimumSchedulingOffsetK2</em> in
an active UL BWP it applies a minimum scheduling offset restriction
indicated by the '<em>Minimum applicable scheduling offset
indicator</em>' field in DCI format 0_1 or DCI format 1_1 if the same
field is available. When the UE is configured with
<em>minimumSchedulingOffsetK2</em> in an active UL BWP and it has not
received '<em>Minimum applicable scheduling offset indicator</em>' field
in DCI format 0_1 or 1_1, the UE shall apply a minimum scheduling offset
restriction indicated based on '<em>Minimum applicable scheduling offset
indicator</em>' value '0'. When the minimum scheduling offset
restriction is applied the UE is not expected to be scheduled with a DCI
in slot <em>n</em> to transmit a PUSCH scheduled with C-RNTI, CS-RNTI,
MCS-C-RNTI or SP-CSI-RNTI with <em>K</em><sub>2</sub> smaller than <span
class="math inline">\(\left\lceil K_{2min} \cdot
\frac{2^{\mu&#39;}}{2^{\mu}} \right\rceil\)</span>, where
<em>K</em><sub>2min</sub> and <span class="math inline">\(\mu\)</span>
are the applied minimum scheduling offset restriction and the numerology
of the active UL BWP of the scheduled cell when receiving the DCI in
slot <em>n</em>, respectively, and <span
class="math inline">\(\mu&#39;\)</span> is the numerology of the new
active UL BWP in case of active UL BWP change in the scheduled cell and
is equal to <span class="math inline">\(\mu\)</span>, otherwise. The
minimum scheduling offset restriction is not applied when PUSCH
transmission is scheduled by RAR UL grant or fallbackRAR UL grant for
RACH procedure, or when PUSCH is scheduled with TC-RNTI. The application
delay of the change of the minimum scheduling offset restriction is
determined in Clause 5.3.1.</p>
<p>When two SRS resource sets are configured in
<em>srs-ResourceSetToAddModList</em> or
<em>srs-ResourceSetToAddModListDCI-0-2</em> with higher layer parameter
<em>usage</em> in <em>SRS-ResourceSet</em> set to 'codebook' or
'noncodebook', for PUSCH repetition Type A, in case <em>K&gt;1,</em> the
same symbol allocation is applied across the <em>K</em> consecutive
slots and the PUSCH is limited to a single transmission layer. The UE
shall repeat the TB across the <em>K</em> consecutive slots applying the
same symbol allocation in each slot, and the association of the first
and second SRS resource set in <em>srs-ResourceSetToAddModList</em> or
<em>srs-ResourceSetToAddModListDCI-0-2</em> to each slot is determined
as follows:</p>
<p>- if a DCI format 0_1 or DCI format 0_2 indicates codepoint "00" for
the <em>SRS resource set indicator</em>, the first SRS resource set is
associated with all K consecutive slots,</p>
<p>- if a DCI format 0_1 or DCI format 0_2 indicates codepoint "01" for
the <em>SRS resource set indicator</em>, the second SRS resource set is
associated with all K consecutive slots,</p>
<p>- if a DCI format 0_1 or DCI format 0_2 indicates codepoint "10" for
the <em>SRS resource set indicator</em>, the first and second SRS
resource set association to K consecutive slots is determined as
follows:</p>
<p>- When K = 2, the first and second SRS resource sets are applied to
the first and second slot of 2 consecutive slots, respectively.</p>
<p>- When K &gt; 2 and <em>cyclicMapping</em> in <em>PUSCH-Config</em>
is enabled, the first and second SRS resource sets are applied to the
first and second slot of K consecutive slots, respectively, and the same
SRS resource set mapping pattern continues to the remaining slots of K
consecutive slots.</p>
<p>- When K &gt; 2 and <em>sequentialMapping</em> in
<em>PUSCH-Config</em> is enabled, first SRS resource set is applied to
the first and second slots of K consecutive slots, and the second SRS
resource set is applied to the third and fourth slot of K consecutive
slots, and the same SRS resource set mapping pattern continues to the
remaining slots of K consecutive slots.</p>
<p>- Otherwise, a DCI format 0_1 or DCI format 0_2 indicates codepoint
"11" for the <em>SRS resource set indicator</em>, and the first and
second SRS resource set association to K consecutive slots is determined
as follows,</p>
<p>- When K = 2, the second and first SRS resource set are applied to
the first and second slot of 2 consecutive slots, respectively.</p>
<p>- When K &gt; 2 and <em>cyclicMapping</em> in <em>PUSCH-Config</em>
is enabled, the second and first SRS resource sets are applied to the
first and second slot of K consecutive slots, respectively, and the same
SRS resource set mapping pattern continues to the remaining slots of the
K consecutive slots.</p>
<p>- When K &gt; 2 and <em>sequentialMapping</em> in
<em>PUSCH-Config</em> is enabled, the second SRS resource set is applied
to the first and second slot of K consecutive slots, and the first SRS
resource set is applied to the third and fourth slot of K consecutive
slots, and the same SRS resource set mapping pattern continues to the
remaining slots of the K consecutive slots.</p>
<p>For PUSCH repetition Type B, when two SRS resource sets are
configured in <em>srs-ResourceSetToAddModList</em> or
<em>srs-ResourceSetToAddModListDCI-0-2</em> with higher layer parameter
<em>usage</em> in <em>SRS-ResourceSet</em> set to 'codebook' or
'noncodebook', the SRS resource set association to nominal PUSCH
repetitions follows the same method as SRS resource set association to
slots in PUSCH Type A repetition by considering nominal repetitions
instead of slots.</p>
<p>For both PUSCH repetition Type A and PUSCH repetition Type B, when a
DCI format 0_1 or DCI format 0_2 indicates codepoint "10" or "11" for
the <em>SRS resource set indicator</em>, the redundancy version to be
applied on the <em>n</em>th transmission occasion (for PUSCH repetition
Type A) of the TB, where n = 0, 1, … <em>K</em>-1, or <em>n</em>th
actual repetition (for PUSCH repetition Type B, with the counting
including the actual repetitions that are omitted) is determined
according to Table 6.1.2.1-2 and Table 6.1.2.1-3. For all PUSCH
repetitions associated with the SRS resource set of the first
transmission occasion or actual repetition, the redundancy version to be
applied is derived according to Table 6.1.2.1-2, where n is counted only
considering PUSCH transmission occasions or actual repetitions
associated with the same SRS resource set as the first transmission
occasion or actual repetition. The redundancy version for PUSCH
transmission occasions or actual repetitions that are associated with an
SRS resource set other than the SRS resource set of the first
transmission occasion or actual repetition is derived according to Table
6.1.2.1-3, where additional shifting operation for each redundancy
version <span class="math inline">\({rv}_{s}\ \)</span>is configured by
higher layer parameter <em>sequenceOffsetforRV</em> in
<em>PUSCH-Config</em> and <span class="math inline">\(n\)</span> is
counted only considering PUSCH transmission occasions or actual
repetitions that are not associated with the SRS resource set of the
first transmission occasion or actual repetition.</p>
<p>Table 6.1.2.1-3: Applied redundancy version for the other SRS
resource set (SRS resource set not associated with the first
transmission occasion or actual repetition) when
<em>sequenceOffsetforRV</em> is present</p>
<table>
<colgroup>
<col style="width: 24%" />
<col style="width: 18%" />
<col style="width: 18%" />
<col style="width: 18%" />
<col style="width: 18%" />
</colgroup>
<thead>
<tr>
<th rowspan="2"><em>rv<sub>id </sub></em>indicated by the DCI scheduling
the PUSCH</th>
<th colspan="4"><em>rv<sub>id</sub></em> to be applied to
<em>n</em><sup>th</sup> transmission occasion (repetition Type A) or
<em>n</em><sup>th</sup> actual repetition (repetition Type B)</th>
</tr>
<tr>
<th><em>n</em> mod 4 = 0</th>
<th><em>n</em> mod 4 = 1</th>
<th><em>n</em> mod 4 = 2</th>
<th><em>n</em> mod 4 = 3</th>
</tr>
</thead>
<tbody>
<tr>
<td><span class="math display">\[0\]</span></td>
<td><span class="math display">\[(0 + \ {rv}_{s})\ mod\ 4\]</span></td>
<td><span class="math display">\[(2 + \ {rv}_{s})\ mod\ 4\]</span></td>
<td><span class="math display">\[(3 + \ {rv}_{s})\ mod\ 4\]</span></td>
<td><span class="math display">\[(1 + \ {rv}_{s})\ mod\ 4\]</span></td>
</tr>
<tr>
<td><span class="math display">\[2\]</span></td>
<td><span class="math display">\[(2 + \ {rv}_{s})\ mod\ 4\]</span></td>
<td><span class="math display">\[(3 + \ {rv}_{s})\ mod\ 4\]</span></td>
<td><span class="math display">\[(1 + \ {rv}_{s})\ mod\ 4\]</span></td>
<td><span class="math display">\[(0 + \ {rv}_{s})\ mod\ 4\]</span></td>
</tr>
<tr>
<td><span class="math display">\[3\]</span></td>
<td><span class="math display">\[(3 + \ {rv}_{s})\ mod\ 4\]</span></td>
<td><span class="math display">\[(1 + \ {rv}_{s})\ mod\ 4\]</span></td>
<td><span class="math display">\[(0 + \ {rv}_{s})\ mod\ 4\]</span></td>
<td><span class="math display">\[(2 + \ {rv}_{s})\ mod\ 4\]</span></td>
</tr>
<tr>
<td><span class="math display">\[1\]</span></td>
<td><span class="math display">\[(1 + \ {rv}_{s})\ mod\ 4\]</span></td>
<td><span class="math display">\[(0 + \ {rv}_{s})\ mod\ 4\]</span></td>
<td><span class="math display">\[(2 + \ {rv}_{s})\ mod\ 4\]</span></td>
<td><span class="math display">\[(3 + \ {rv}_{s})\ mod\ 4\]</span></td>
</tr>
</tbody>
</table>
<p>For PUSCH repetition Type A, when a DCI format 0_1 and DCI format 0_2
indicate codepoint "10" or "11" for the <em>SRS resource set
indicator</em> and schedule aperiodic CSI report(s) on PUSCH with
transport block by a '<em>CSI request'</em> field on a DCI, the CSI
report(s) multiplexing is determined as follows</p>
<p>- if higher layer parameter <em>ap-CSI-MultiplexingMode</em> in
<em>CSI-AperiodicTriggerState</em> is enabled and UCI other than CSI
report(s) are not multiplexed on PUSCH, the CSI report(s) is transmitted
separately only on the first transmission occasion associated with the
first SRS resource set and the first transmission occasion associated
with the second SRS resource set.</p>
<p>- otherwise, the CSI report(s) is transmitted only on the first
transmission occasion.</p>
<p>For PUSCH transmissions of TB processing over multiple slots, when a
DCI format 0_1 and DCI format 0_2 schedule aperiodic CSI report(s) on
PUSCH with transport block by a 'CSI request' field on a DCI, the CSI
report(s) is transmitted only on the first slot of the 𝑁 ∙ 𝐾 slots
determined for the PUSCH transmission.</p>
<p>For PUSCH repetition Type B, when a DCI format 0_1 and DCI format 0_2
indicate codepoint "10" or "11" for the <em>SRS resource set
indicator</em> and schedule aperiodic CSI report(s) on PUSCH with
transport block by a '<em>CSI request'</em> field on a DCI, CSI
report(s) multiplexing is determined as follows</p>
<p>- if higher layer parameter <em>ap-CSI-MultiplexingMode</em> in
<em>CSI-AperiodicTriggerState</em> is enabled and the first actual
repetition associated with the first SRS resource set and the first
actual repetition associated with the second SRS resource set have the
same number of symbols and UCI other than CSI report(s) are not
multiplexed on PUSCH, the CSI report(s) is multiplexed separately only
on the first actual repetition associated with the first SRS resource
set and first actual repetition associated with the second SRS resource
set.</p>
<p>- otherwise, the CSI report(s) is multiplexed only on the first
actual repetition.</p>
<p>The UE does not expect a different number of actual PT-RS ports for
the two actual repetitions when the CSI report(s) is transmitted
separately on two actual repetitions.</p>
<p>For PUSCH repetition Type A, when a DCI format 0_1 and DCI format 0_2
indicate codepoint "10" or "11" for the <em>SRS resource set
indicator</em> and schedule aperiodic CSI report(s) on PUSCH with no
transport block by a '<em>CSI request'</em> field on a DCI, the number
of repetitions is assumed to be 2 regardless of the value of
<em>numberOfRepetitions</em> or <em>pusch-AggregationFactor</em> (if
<em>numberOfRepetitions</em> is not present in the time domain resource
allocation table), and transmission of CSI report(s) is determined as
follows</p>
<p>- if higher layer parameter <em>ap-CSI-MultiplexingMode</em> in
<em>CSI-AperiodicTriggerState</em> is enabled and UCI other than CSI
report(s) are not multiplexed on PUSCH, the CSI report(s) is transmitted
separately on the first transmission occasion and the second
transmission occasion</p>
<p>- otherwise, the CSI report(s) is transmitted only on the first
transmission occasion.</p>
<p>For PUSCH repetition Type B, when a DCI format 0_1 and DCI format 0_2
indicate codepoint "10" or "11" for the <em>SRS resource set
indicator</em> and schedule aperiodic CSI report(s) or activates
semi-persistent CSI report(s) on PUSCH with no transport block by a
'<em>CSI request'</em> field on a DCI, the number of nominal repetitions
is always assumed to be 2 regardless of the value of
<em>numberOfRepetitions</em>, and the first and second nominal
repetitions are expected to be the same as the first and second actual
repetitions, and transmission of CSI report(s) is determined as
follows:</p>
<p>- if higher layer parameter <em>ap-CSI-MultiplexingMode</em> in
<em>CSI-AperiodicTriggerState</em> is enabled for aperiodic CSI
report(s) or higher layer paremeter <em>SP-CSI-MultiplexingMode</em> in
<em>CSI-SemiPersistentOnPUSCH-TriggerState</em> is enabled for
semi-persistent CSI report(s) and UCI other than CSI report(s) are not
multiplexed on PUSCH, the CSI report(s) is transmitted separately on the
first actual repetition and the second actual repetition</p>
<p>- otherwise, the CSI report(s) is transmitted only on the first
actual repetition.</p>
<p>The UE does not expect a different number of actual PT-RS ports for
the two actual repetitions when the CSI report(s) is transmitted
separately on two actual repetitions.</p>
<p>For PUSCH repetition Type A, when a DCI format 0_1 and DCI format 0_2
indicate codepoint "10" or "11" for the <em>SRS resource set
indicator</em> and activate semi-persistent CSI report(s) on PUSCH with
no transport block by a '<em>CSI request'</em> field on a DCI, or
indicate the PUSCH repetition Type A carrying semi-persistent CSI
report(s) without a corresponding PDCCH after being activated on PUSCH
by a 'CSI request' field on a DCI, the number of repetitions is always
assumed to be 2 regardless of the value of <em>numberOfRepetitions</em>
or <em>pusch-AggregationFactor</em> (if <em>numberOfRepetitions</em> is
not present in the time domain resource allocation table), and
transmission of CSI report(s) is determined as follows</p>
<p>- if higher layer parameter <em>SP-CSI-MultiplexingMode</em> in
<em>CSI-SemiPersistentOnPUSCH-TriggerState</em> is enabled and UCI other
than CSI report(s) are not multiplexed on PUSCH, the CSI report(s) is
transmitted separately on the first transmission occasion and the second
transmission occasion</p>
<p>- otherwise, the CSI report(s) is transmitted only on the first
transmission occasion.</p>
<p>For PUSCH repetition Type B, when a DCI format 0_1 and DCI format 0_2
indicate codepoint "10" or "11" for the <em>SRS resource set
indicator</em> and the PUSCH repetition Type B carrying semi-persistent
CSI report(s) without a corresponding PDCCH after being activated on
PUSCH by a '<em>CSI request'</em> field on a DCI, the number of nominal
repetitions is always assumed to be 2 regardless of the value of
<em>numberOfRepetitions</em>, and transmission of CSI report(s) is
determined as follows</p>
<p>- if higher layer parameter <em>SP-CSI-MultiplexingMode</em> in
<em>CSI-SemiPersistentOnPUSCH-TriggerState</em> is enabled and one of
the first or second nominal repetition is the same as corresponding
first or second actual repetition, the nominal repetition that is not
having same actual repetition is omitted and the CSI report(s) is
transmitted on the actual repetition that is not omitted.</p>
<p>- if higher layer parameter <em>SP-CSI-MultiplexingMode</em> in
<em>CSI-SemiPersistentOnPUSCH-TriggerState</em> is enabled and the first
and second nominal repetitions are the same as the first and second
actual repetitions and the UCI other than CSI report(s) are not
multiplexed on PUSCH, the CSI report(s) is transmitted separately on the
first actual repetition and the second actual repetition</p>
<p>- otherwise, the CSI report(s) is transmitted only on the first
actual repetition.</p>
<h5
id="determination-of-the-resource-allocation-table-to-be-used-for-pusch">6.1.2.1.1
Determination of the resource allocation table to be used for PUSCH</h5>
<p>Table 6.1.2.1.1-1, Table 6.1.2.1.1-1A and Table 6.1.2.1.1-1B define
which PUSCH time domain resource allocation configuration to apply.</p>
<p>Table 6.1.2.1.1-4 defines the subcarrier spacing specific values
<em>j</em>. <em>j</em> is used in determination of
<em>K<sub>2</sub></em> in conjunction to table 6.1.2.1.1-2, for normal
CP or table 6.1.2.1.1.-3 for extended CP, where <span
class="math inline">\(µ_{PUSCH}\)</span> is the subcarrier spacing
configurations for PUSCH.</p>
<p>Table 6.1.2.1.1-5 defines the additional subcarrier spacing specific
slot delay value for the first transmission of PUSCH scheduled by the
RAR or by the fallbackRAR. When the UE transmits a PUSCH scheduled by
RAR or by the fallbackRAR, the <em>Δ</em> value specific to the PUSCH
subcarrier spacing <em>µ<sub>PUSCH</sub></em> is applied in addition to
the <em>K<sub>2</sub></em> value.</p>
<p>Table 6.1.2.1.1-1: Applicable PUSCH time domain resource allocation
for common search space and DCI format 0_0 in UE specific search
space</p>
<table>
<colgroup>
<col style="width: 9%" />
<col style="width: 13%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 26%" />
</colgroup>
<thead>
<tr>
<th>RNTI</th>
<th>PDCCH search space</th>
<th><em>pusch-ConfigCommon</em> includes
<em>pusch-TimeDomainAllocationList</em></th>
<th><em>pusch-Config</em> includes
<em>pusch-TimeDomainAllocationList</em></th>
<th>PUSCH time domain resource allocation to apply</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="2" rowspan="2">PUSCH scheduled by MAC RAR as described in
clause 8.2 of [6, TS 38.213] or MAC fallbackRAR as described in clause
8.2A of [6, 38.213] or for MsgA PUSCH transmission</td>
<td>No</td>
<td>-</td>
<td>Default A</td>
</tr>
<tr>
<td>Yes</td>
<td></td>
<td><em>pusch-TimeDomainAllocationList</em> provided in
<em>pusch-ConfigCommon</em></td>
</tr>
<tr>
<td rowspan="2">C-RNTI, MCS-C-RNTI, TC-RNTI, CS-RNTI</td>
<td rowspan="2">Any common search space associated with CORESET 0</td>
<td>No</td>
<td>-</td>
<td>Default A</td>
</tr>
<tr>
<td>Yes</td>
<td></td>
<td><em>pusch-TimeDomainAllocationList</em> provided in
<em>pusch-ConfigCommon</em></td>
</tr>
<tr>
<td rowspan="3">C-RNTI, MCS-C-RNTI, TC-RNTI, CS-RNTI</td>
<td rowspan="3"><p>Any common search space not associated with CORESET
0,</p>
<p>DCI format 0_0 in</p>
<p>UE specific search space</p></td>
<td>No</td>
<td>No</td>
<td>Default A</td>
</tr>
<tr>
<td>Yes</td>
<td>No</td>
<td><em>pusch-TimeDomainAllocationList</em> provided in
<em>pusch-ConfigCommon</em></td>
</tr>
<tr>
<td>No/Yes</td>
<td>Yes</td>
<td><em>pusch-TimeDomainAllocationList</em> provided in
<em>pusch-Config</em></td>
</tr>
</tbody>
</table>
<p>Table 6.1.2.1.1-1A: Applicable PUSCH time domain resource allocation
for DCI format 0_1 in UE specific search space scrambled with C-RNTI,
MCS-C-RNTI, CS-RNTI or SP-CSI-RNTI</p>
<table>
<colgroup>
<col style="width: 16%" />
<col style="width: 16%" />
<col style="width: 18%" />
<col style="width: 24%" />
<col style="width: 23%" />
</colgroup>
<thead>
<tr>
<th><em>pusch-ConfigCommon</em> includes
<em>pusch-TimeDomainAllocationList</em></th>
<th><em>pusch-Config</em> includes
<em>pusch-TimeDomainAllocationList</em></th>
<th><em>pusch-Config</em> includes
<em>pusch-TimeDomainAllocationListDCI-0-1</em></th>
<th><em>pusch-Config</em> includes
<em>pusch-TimeDomainAllocationListForMultiPUSCH</em></th>
<th>PUSCH time domain resource allocation to apply</th>
</tr>
</thead>
<tbody>
<tr>
<td>No</td>
<td>No</td>
<td>No</td>
<td>No</td>
<td>Default A</td>
</tr>
<tr>
<td>Yes</td>
<td>No</td>
<td>No</td>
<td>No</td>
<td><em>pusch-TimeDomainAllocationList</em> provided in
<em>pusch-ConfigCommon</em></td>
</tr>
<tr>
<td>No/Yes</td>
<td>Yes</td>
<td>No</td>
<td>No</td>
<td><em>pusch-TimeDomainAllocationList</em> provided in
<em>pusch-Config</em></td>
</tr>
<tr>
<td>No/Yes</td>
<td>No</td>
<td>Yes</td>
<td>-</td>
<td><em>pusch-TimeDomainAllocationListDCI-0-1</em> provided in
<em>pusch-Config</em></td>
</tr>
<tr>
<td>No/Yes</td>
<td>No</td>
<td>-</td>
<td>Yes</td>
<td><em>pusch-TimeDomainAllocationListForMultiPUSCH</em> provided in
<em>pusch-Config</em></td>
</tr>
</tbody>
</table>
<p>Table 6.1.2.1.1-1B: Applicable PUSCH time domain resource allocation
for DCI format 0_2 in UE specific search space scrambled with C-RNTI,
MCS-C-RNTI, CS-RNTI or SP-CSI-RNTI</p>
<table>
<colgroup>
<col style="width: 23%" />
<col style="width: 23%" />
<col style="width: 27%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr>
<th><em>pusch-ConfigCommon</em> includes
<em>pusch-TimeDomainAllocationList</em></th>
<th><em>pusch-Config</em> includes
<em>pusch-TimeDomainAllocationList</em></th>
<th><em>pusch-Config</em> includes
<em>pusch-TimeDomainAllocationListDCI-0-2</em></th>
<th>PUSCH time domain resource allocation to apply</th>
</tr>
</thead>
<tbody>
<tr>
<td>No</td>
<td>No</td>
<td>No</td>
<td>Default A</td>
</tr>
<tr>
<td>Yes</td>
<td>No</td>
<td>No</td>
<td><em>pusch-TimeDomainAllocationList</em> provided in
<em>pusch-ConfigCommon</em></td>
</tr>
<tr>
<td>No/Yes</td>
<td>Yes</td>
<td>No</td>
<td><em>pusch-TimeDomainAllocationList</em> provided in
<em>pusch-Config</em></td>
</tr>
<tr>
<td>No/Yes</td>
<td>No</td>
<td>Yes</td>
<td><em>pusch-TimeDomainAllocationListDCI-0-2</em> provided in
<em>pusch-Config</em></td>
</tr>
</tbody>
</table>
<p>Table 6.1.2.1.1-2: Default PUSCH time domain resource allocation A
for normal CP</p>
<table>
<colgroup>
<col style="width: 19%" />
<col style="width: 20%" />
<col style="width: 19%" />
<col style="width: 20%" />
<col style="width: 20%" />
</colgroup>
<thead>
<tr>
<th>Row index</th>
<th>PUSCH mapping type</th>
<th><em>K<sub>2</sub></em></th>
<th><em>S</em></th>
<th><em>L</em></th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>Type A</td>
<td><em>j</em></td>
<td>0</td>
<td>14</td>
</tr>
<tr>
<td>2</td>
<td>Type A</td>
<td><em>j</em></td>
<td>0</td>
<td>12</td>
</tr>
<tr>
<td>3</td>
<td>Type A</td>
<td><em>j</em></td>
<td>0</td>
<td>10</td>
</tr>
<tr>
<td>4</td>
<td>Type B</td>
<td><em>j</em></td>
<td>2</td>
<td>10</td>
</tr>
<tr>
<td>5</td>
<td>Type B</td>
<td><em>j</em></td>
<td>4</td>
<td>10</td>
</tr>
<tr>
<td>6</td>
<td>Type B</td>
<td><em>j</em></td>
<td>4</td>
<td>8</td>
</tr>
<tr>
<td>7</td>
<td>Type B</td>
<td><em>j</em></td>
<td>4</td>
<td>6</td>
</tr>
<tr>
<td>8</td>
<td>Type A</td>
<td><em>j</em>+1</td>
<td>0</td>
<td>14</td>
</tr>
<tr>
<td>9</td>
<td>Type A</td>
<td><em>j</em>+1</td>
<td>0</td>
<td>12</td>
</tr>
<tr>
<td>10</td>
<td>Type A</td>
<td><em>j</em>+1</td>
<td>0</td>
<td>10</td>
</tr>
<tr>
<td>11</td>
<td>Type A</td>
<td><em>j</em>+2</td>
<td>0</td>
<td>14</td>
</tr>
<tr>
<td>12</td>
<td>Type A</td>
<td><em>j</em>+2</td>
<td>0</td>
<td>12</td>
</tr>
<tr>
<td>13</td>
<td>Type A</td>
<td><em>j</em>+2</td>
<td>0</td>
<td>10</td>
</tr>
<tr>
<td>14</td>
<td>Type B</td>
<td><em>j</em></td>
<td>8</td>
<td>6</td>
</tr>
<tr>
<td>15</td>
<td>Type A</td>
<td><em>j</em>+3</td>
<td>0</td>
<td>14</td>
</tr>
<tr>
<td>16</td>
<td>Type A</td>
<td><em>j</em>+3</td>
<td>0</td>
<td>10</td>
</tr>
</tbody>
</table>
<p>Table 6.1.2.1.1-3: Default PUSCH time domain resource allocation A
for extended CP</p>
<table>
<colgroup>
<col style="width: 19%" />
<col style="width: 20%" />
<col style="width: 19%" />
<col style="width: 20%" />
<col style="width: 20%" />
</colgroup>
<thead>
<tr>
<th>Row index</th>
<th>PUSCH mapping type</th>
<th><em>K<sub>2</sub></em></th>
<th><em>S</em></th>
<th><em>L</em></th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>Type A</td>
<td><em>j</em></td>
<td>0</td>
<td>8</td>
</tr>
<tr>
<td>2</td>
<td>Type A</td>
<td><em>j</em></td>
<td>0</td>
<td>12</td>
</tr>
<tr>
<td>3</td>
<td>Type A</td>
<td><em>j</em></td>
<td>0</td>
<td>10</td>
</tr>
<tr>
<td>4</td>
<td>Type B</td>
<td><em>j</em></td>
<td>2</td>
<td>10</td>
</tr>
<tr>
<td>5</td>
<td>Type B</td>
<td><em>j</em></td>
<td>4</td>
<td>4</td>
</tr>
<tr>
<td>6</td>
<td>Type B</td>
<td><em>j</em></td>
<td>4</td>
<td>8</td>
</tr>
<tr>
<td>7</td>
<td>Type B</td>
<td><em>j</em></td>
<td>4</td>
<td>6</td>
</tr>
<tr>
<td>8</td>
<td>Type A</td>
<td><em>j</em>+1</td>
<td>0</td>
<td>8</td>
</tr>
<tr>
<td>9</td>
<td>Type A</td>
<td><em>j</em>+1</td>
<td>0</td>
<td>12</td>
</tr>
<tr>
<td>10</td>
<td>Type A</td>
<td><em>j</em>+1</td>
<td>0</td>
<td>10</td>
</tr>
<tr>
<td>11</td>
<td>Type A</td>
<td><em>j</em>+2</td>
<td>0</td>
<td>6</td>
</tr>
<tr>
<td>12</td>
<td>Type A</td>
<td><em>j</em>+2</td>
<td>0</td>
<td>12</td>
</tr>
<tr>
<td>13</td>
<td>Type A</td>
<td><em>j</em>+2</td>
<td>0</td>
<td>10</td>
</tr>
<tr>
<td>14</td>
<td>Type B</td>
<td><em>j</em></td>
<td>8</td>
<td>4</td>
</tr>
<tr>
<td>15</td>
<td>Type A</td>
<td><em>j</em>+3</td>
<td>0</td>
<td>8</td>
</tr>
<tr>
<td>16</td>
<td>Type A</td>
<td><em>j</em>+3</td>
<td>0</td>
<td>10</td>
</tr>
</tbody>
</table>
<p>Table 6.1.2.1.1-4: Definition of value <em>j</em></p>
<table>
<colgroup>
<col style="width: 44%" />
<col style="width: 55%" />
</colgroup>
<thead>
<tr>
<th><em>µ<sub>PUSCH</sub></em></th>
<th><em>j</em></th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>1</td>
</tr>
<tr>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>2</td>
<td>2</td>
</tr>
<tr>
<td>3</td>
<td>3</td>
</tr>
<tr>
<td>5</td>
<td>11</td>
</tr>
<tr>
<td>6</td>
<td>21</td>
</tr>
</tbody>
</table>
<p>Table 6.1.2.1.1-5: Definition of value <em>Δ</em></p>
<table>
<colgroup>
<col style="width: 44%" />
<col style="width: 55%" />
</colgroup>
<thead>
<tr>
<th><em>µ<sub>PUSCH</sub></em></th>
<th><em>Δ</em></th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>2</td>
</tr>
<tr>
<td>1</td>
<td>3</td>
</tr>
<tr>
<td>2</td>
<td>4</td>
</tr>
<tr>
<td>3</td>
<td>6</td>
</tr>
<tr>
<td>5</td>
<td>24</td>
</tr>
<tr>
<td>6</td>
<td>48</td>
</tr>
</tbody>
</table>
<h4 id="resource-allocation-in-frequency-domain-1">6.1.2.2 Resource
allocation in frequency domain</h4>
<p>The UE shall determine the resource block assignment in frequency
domain using the resource allocation field in the detected PDCCH DCI
except for a PUSCH transmission scheduled by a RAR UL grant or
fallbackRAR UL grant, in which case the frequency domain resource
allocation is determined according to clause 8.3 of [6, 38.213] or a
MsgA PUSCH transmission with frequency domain resource allocation
determined according to clause 8.1A of [6, 38.213]. Three uplink
resource allocation schemes type 0, type 1 and type 2 are supported.
Uplink resource allocation scheme type 0 is supported for PUSCH only
when transform precoding is disabled. Uplink resource allocation scheme
type 1 and type 2 are supported for PUSCH for both cases when transform
precoding is enabled or disabled.</p>
<p>If the scheduling DCI is configured to indicate the uplink resource
allocation type as part of the '<em>Frequency domain resource'</em>
assignment field by setting a higher layer parameter
r<em>esourceAllocation</em> in <em>pusch-Config</em> to 'dynamicSwitch',
for DCI format 0_1 or setting a higher layer parameter
<em>resourceAllocationDCI-0-2</em> in <em>pusch-Config</em> to
'dynamicSwitch' for DCI format 0_2, the UE shall use uplink resource
allocation type 0 or type 1 as defined by this DCI field. Otherwise the
UE shall use the uplink frequency resource allocation type as defined by
the higher layer parameter <em>resourceAllocation</em> for DCI format
0_1 or the higher layer parameter <em>resourceAllocationDCI-0-2</em> for
DCI format 0_2. The UE shall assume that when the scheduling PDCCH is
received with DCI format 0_1 and <em>useInterlacePUCCH-PUSCH</em> in
<em>BWP-UplinkDedicated</em> is configured, uplink type 2 resource
allocation is used.</p>
<p>The UE shall assume that when the scheduling PDCCH is received with
DCI format 0_0, then uplink resource allocation type 1 is used, except
when any of the higher layer parameters <em>useInterlacePUCCH-PUSCH</em>
in <em>BWP-UplinkCommon</em> and <em>useInterlacePUCCH-PUSCH</em> in
<em>BWP-UplinkDedicated</em> is configured in which case uplink resource
allocation type 2 is used.</p>
<p>The UE expects that either none or both of
<em>useInterlacePUCCH-PUSCH</em> in <em>BWP-UplinkCommon</em> and
<em>useInterlacePUCCH-PUSCH</em> in <em>BWP-UplinkDedicated</em> is
configured.</p>
<p>If a bandwidth part indicator field is not configured in the
scheduling DCI or the UE does not support active bandwidth part change
via DCI, the RB indexing for uplink type 0, type 1 and type 2 resource
allocation is determined within the UE's active bandwidth part. If a
bandwidth part indicator field is configured in the scheduling DCI and
the UE supports active bandwidh part change via DCI, the RB indexing for
uplink type 0, type 1, type 2 resource allocation is determined within
the UE's bandwidth part indicated by bandwidth part indicator field
value in the DCI. The UE shall upon detection of PDCCH intended for the
UE determine first the uplink bandwidth part and then the resource
allocation within the bandwidth part. RB numbering starts from the
lowest RB in the determined uplink bandwidth part.</p>
<h5 id="uplink-resource-allocation-type-0">6.1.2.2.1 Uplink resource
allocation type 0</h5>
<p>In uplink resource allocation of type 0, the resource block
assignment information includes a bitmap indicating the Resource Block
Groups (RBGs) that are allocated to the scheduled UE where a RBG is a
set of consecutive virtual resource blocks defined by higher layer
parameter <em>rbg-Size</em> configured in <em>pusch-Config</em> and the
size of the bandwidth part as defined in Table 6.1.2.2.1-1.</p>
<p>Table 6.1.2.2.1-1: Nominal RBG size <em>P</em></p>
<table>
<colgroup>
<col style="width: 37%" />
<col style="width: 31%" />
<col style="width: 31%" />
</colgroup>
<thead>
<tr>
<th>Bandwidth Part Size</th>
<th>Configuration 1</th>
<th>Configuration 2</th>
</tr>
</thead>
<tbody>
<tr>
<td>1 – 36</td>
<td><em>2</em></td>
<td>4</td>
</tr>
<tr>
<td>37 – 72</td>
<td>4</td>
<td>8</td>
</tr>
<tr>
<td>73 – 144</td>
<td>8</td>
<td>16</td>
</tr>
<tr>
<td>145 – 275</td>
<td>16</td>
<td>16</td>
</tr>
</tbody>
</table>
<p>The total number of RBGs (<img src="media/image722.svg" />) for a
uplink bandwidth part <em>i</em> of size<img
src="media/image723.svg" />PRBs is given by <img
src="media/image724.svg" /> where</p>
<p>- the size of the first RBG is <img src="media/image725.svg" />,</p>
<p>- the size of the last RBG is <img src="media/image726.svg" />if <img
src="media/image727.svg" />and <em>P</em> otherwise.</p>
<p>- the size of all other RBG is <em>P</em>.</p>
<p>The bitmap is of size <img src="media/image22.svg" />bits with one
bitmap bit per RBG such that each RBG is addressable. The RBGs shall be
indexed in the order of increasing frequency of the bandwidth part and
starting at the lowest frequency. The order of RBG bitmap is such that
RBG 0 to RBG<img src="media/image728.svg" /> are mapped from MSB to LSB
of the bitmap. The RBG is allocated to the UE if the corresponding bit
value in the bitmap is 1, the RBG is not allocated to the UE
otherwise.</p>
<p>In frequency range 1, only 'almost contiguous allocation' defined in
[8, TS 38.101-1] is allowed as non-contiguous allocation per component
carrier for UL RB allocation for CP-OFDM.</p>
<p>In frequency range 2, non-contiguous allocation per component carrier
for UL RB allocation for CP-OFDM is not supported.</p>
<h5 id="uplink-resource-allocation-type-1">6.1.2.2.2 Uplink resource
allocation type 1</h5>
<p>In uplink resource allocation of type 1, the resource block
assignment information indicates to a scheduled UE a set of contiguously
allocated non-interleaved virtual resource blocks within the active
bandwidth part of size <img src="media/image729.svg" /> PRBs except for
the case when DCI format 0_0 is decoded in any common search space in
which case the size of the initial UL bandwidth part <img
src="media/image730.svg" /> shall be used.</p>
<p>An uplink type 1 resource allocation field consists of a resource
indication value (<em>RIV</em>) corresponding to a starting virtual
resource block (<img src="media/image731.svg" />) and a length in terms
of contiguously allocated resource blocks<img
src="media/image732.svg" />. The resource indication value is defined
by</p>
<p>if <img src="media/image733.svg" /> then</p>
<blockquote>
<p><img src="media/image734.svg" /></p>
</blockquote>
<p>else</p>
<blockquote>
<p><img src="media/image735.svg" /></p>
</blockquote>
<p>where<img src="media/image736.svg" />≥ 1 and shall not exceed<img
src="media/image737.svg" />.</p>
<p>When the DCI size for DCI format 0_0 in USS is derived from the
initial UL BWP with size <img src="media/image738.svg" /> but applied to
another active BWP with size of <img src="media/image32.svg" />, an
uplink type 1 resource block assignment field consists of a resource
indication value (<em>RIV</em>) corresponding to a starting resource
block <img src="media/image33.svg" />and a length in terms of virtually
contiguously allocated resource blocks <img
src="media/image34.svg" />.</p>
<p>The resource indication value is defined by</p>
<p>if <img src="media/image36.svg" /> then</p>
<p><img src="media/image37.svg" /></p>
<p>else</p>
<p><img src="media/image38.svg" /></p>
<p>where<img src="media/image39.svg" />, <img
src="media/image40.svg" />and where <img src="media/image41.svg" />shall
not exceed <img src="media/image42.svg" />.</p>
<p>If <img src="media/image43.svg" />, <em>K</em> is the maximum value
from set {1, 2, 4, 8} which satisfies <img src="media/image44.svg" />;
otherwise <em>K</em> = 1.</p>
<p>When the scheduling grant is received with DCI format 0_2, an uplink
type 1 resource allocation field consists of a resource indication value
(<em>RIV</em>) corresponding to a starting resource block group
<em>RBG<sub>start</sub></em>=0, 1, …, <em>N<sub>RBG</sub></em>-1 and a
length in terms of virtually contiguously allocated resource block
groups <em>L<sub>RBGs</sub></em>=1, …, <em>N<sub>RBG</sub></em>, where
the resource block groups are defined as in 6.1.2.2.1 with <em>P</em>
defined by <em>resourceAllocationType1GranularityDCI-0-2</em> if the UE
is configured with higher layer parameter
<em>resourceAllocationType1GranularityDCI-0-2</em>, and <em>P</em>=1
otherwise<em>.</em> The resource indication value is defined by</p>
<p>if <img src="media/image45.svg" /> then</p>
<p><img src="media/image46.svg" /></p>
<p>else</p>
<p><img src="media/image47.svg" /></p>
<p>where<img src="media/image48.svg" />≥ 1 and shall not exceed <img
src="media/image49.svg" />.</p>
<h5 id="uplink-resource-allocation-type-2">6.1.2.2.3 Uplink resource
allocation type 2</h5>
<p>In uplink resource allocation of type 2, the resource block
assignment information defined in [5, TS 38.212] indicates to a UE a set
of up to <em>M</em> interlace indices, and for DCI 0_0 monitored in a
UE-specific search space and DCI 0_1 a set of up to <span
class="math inline">\(\ N_{RB\text{-}set,UL}^{BWP}\)</span> contiguous
RB sets, where <em>M</em> and interlace indexing are defined in Clause
4.4.4.6 in [4, TS 38.211]. Within the active UL BWP, the assigned
physical resource block <span class="math inline">\(n\)</span> is mapped
to virtual resource block <span class="math inline">\(n.\)</span> For
DCI 0_0 monitored in a UE-specific search space and DCI 0_1, the UE
shall determine the resource allocation in frequency domain as an
intersection of the resource blocks of the indicated interlaces and the
union of the indicated set of RB sets and intra-cell guard bands defined
in Clause 7 between the indicated RB sets, if any. For DCI 0_0 monitored
in a common search space, the UE shall determine the resource allocation
in frequency domain as an intersection of the resource blocks of the
indicated interlaces and a single uplink RB set of the active UL BWP.
For DCI 0_0 monitored in a CSS with CRC scrambled by an RNTI other than
TC-RNTI, the uplink RB set is the lowest indexed one amongst uplink RB
set(s) that intersects the lowest-indexed CCE of the PDCCH in which the
UE detects the DCI 0_0 in the active downlink BWP. When the PDCCH
reception includes two PDCCH candidates from two respective search space
sets, as described in clause 10.1 of [6, TS 38.213], for the purpose of
determining the uplink RB set of a PUSCH when scheduled by DCI 0_0
monitored in a CSS with CRC scrambled by an RNTI other than TC-RNTI, the
CORESET with lower ID among two CORESETs associated with two PDCCH
candidates is used. If there is no intersection, the uplink RB set is RB
set 0 in the active uplink BWP. For DCI 0_0 with CRC scrambled by
TC-RNTI, the uplink RB set is the same one in which the UE transmits the
PRACH associated with the RAR UL grant, in which case the UE assumes
that the uplink RB set is defined as when the UE is not configured with
<em>intraCellGuardBandsUL-List</em> (see Clause 7).</p>
<p>For µ=0, the X=6 MSBs of the resource block assignment information
indicates to a UE a set of allocated interlace indices <span
class="math inline">\(m_{0} + l\)</span>, where the indication consists
of a resource indication value (<em>RIV</em>). For <span
class="math inline">\(0 \leq RIV &lt; M(M + 1)/2\)</span> , <span
class="math inline">\(l = 0,1,\cdots L - 1\)</span> the resource
indication value corresponds to the starting interlace index
<em>m<sub>0</sub></em> and the number of contiguous interlace indices
<img src="media/image739.svg" />(<img src="media/image740.svg" />). The
resource indication value is defined by:</p>
<p>if <span class="math inline">\((L - 1) \leq \left\lfloor M/2
\right\rfloor\)</span> then</p>
<p><span class="math display">\[RIV = M(L - 1) + m_{0}\]</span></p>
<p>else</p>
<p><span class="math display">\[RIV = M(M - L + 1) + (M - 1 -
m_{0})\]</span></p>
<p>For <span class="math inline">\(RIV \geq M(M + 1)/2\)</span> , the
resource indication value corresponds to the starting interlace index
<em>m<sub>0</sub></em> and the set of values <img
src="media/image741.svg" /> according to Table 6.1.2.2.3-1.</p>
<p>Table 6.1.2.2.3-1: <em>m<sub>0</sub></em> and <img
src="media/image741.svg" /> for <span class="math inline">\(\mathbf{RIV
\geq M(M + 1)/2}\)</span>.</p>
<table>
<colgroup>
<col style="width: 52%" />
<col style="width: 17%" />
<col style="width: 30%" />
</colgroup>
<thead>
<tr>
<th><span class="math display">\[\mathbf{RIV - M(M + 1)/2}\]</span></th>
<th><em>m<sub>0</sub></em></th>
<th><img src="media/image741.svg" /></th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>0</td>
<td>{0, 5}</td>
</tr>
<tr>
<td>1</td>
<td>0</td>
<td>{0, 1, 5, 6}</td>
</tr>
<tr>
<td>2</td>
<td>1</td>
<td>{0, 5}</td>
</tr>
<tr>
<td>3</td>
<td>1</td>
<td>{0, 1, 2, 3, 5, 6, 7, 8}</td>
</tr>
<tr>
<td>4</td>
<td>2</td>
<td>{0, 5}</td>
</tr>
<tr>
<td>5</td>
<td>2</td>
<td>{0, 1, 2, 5, 6, 7}</td>
</tr>
<tr>
<td>6</td>
<td>3</td>
<td>{0, 5}</td>
</tr>
<tr>
<td>7</td>
<td>4</td>
<td>{0, 5}</td>
</tr>
</tbody>
</table>
<p>For µ=1, the X=5 MSBs of the resource block assignment information
comprise a bitmap indicating the interlaces that are allocated to the
scheduled UE. The bitmap is of size <em>M</em> bits with one bitmap bit
per interlace such that each interlace is addressable, where <em>M</em>
and interlace indexing is defined in Clause 4.4.4.6 in [4, TS 38.211].
The order of interlace bitmap is such that interlace 0 to interlace
<span class="math inline">\(M - 1\)</span> are mapped from MSB to LSB of
the bitmap. An interlace is allocated to the UE if the corresponding bit
value in the bitmap is 1; otherwise the interlace is not allocated to
the UE.</p>
<p>For DCI 0_0 monitored in a UE-specific search space and DC 0_1 for
both µ=0 and µ=1, the <span class="math inline">\(Y = \left\lceil
\text{log}_{2}\frac{N_{RB\text{-}set,UL}^{BWP}\left(
N_{RB\text{-}set,UL}^{BWP} + 1 \right)}{2} \right\rceil LSBs\ of\
\)</span> the resource block assignment information indicate to a UE a
set of contiguously allocated RB sets for PUSCH scheduled by DCI 0_0
monitored in a UE-specific search space, DCI 0_1 and Type 1 and Type 2
configured grant. The resource allocation field consists of a resource
indication value (<span class="math inline">\({RIV}_{RB -
set}\)</span>). For <span class="math inline">\(0 \leq {RIV}_{RB - set}
&lt; N_{RB\text{-}set,UL}^{BWP}(N_{RB\text{-}set,UL}^{BWP} +
1)/2\)</span> , <span class="math inline">\(l = 0,1,\cdots L_{RBset} -
1\)</span> the resource indication value corresponds to the starting RB
set index <span
class="math inline">\(N_{\text{RB-set,UL}}^{\text{start}}\)</span> and
the number of contiguous RB sets <span class="math inline">\(\ L_{RB -
set}\ \)</span>. The resource indication value is defined by;</p>
<p>if <span class="math inline">\((L_{RB - set} - 1) \leq \left\lfloor
N_{RB\text{-}set,UL}^{BWP}/2 \right\rfloor\)</span> then</p>
<p><span class="math inline">\({RIV}_{RB - set} =
N_{RB\text{-}set,UL}^{BWP}(L_{RB - set} - 1) +
N_{\text{RB-set,UL}}^{\text{start}}\)</span></p>
<p>else</p>
<p><span class="math inline">\({RIV}_{RB - set} =
N_{RB\text{-}set,UL}^{BWP}(N_{RB\text{-}set,UL}^{BWP} - L_{RB - set} +
1) + (N_{RB\text{-}set,UL}^{BWP} - 1 -
N_{\text{RB-set,UL}}^{\text{start}})\)</span></p>
<p>where <span class="math inline">\(\
N_{\text{RB-set,UL}}^{\text{start}} = 0,1,\cdots
N_{RB\text{-}set,UL}^{BWP} - 1\)</span>, <span
class="math inline">\(L_{RB - set} \geq 1\)</span> and shall not exceed
<span class="math inline">\(N_{RB\text{-}set,UL}^{BWP} -
N_{\text{RB-set,UL}}^{\text{start}}\)</span></p>
<p>If transform precoding is enabled according to the procedure in
Clause 6.1.3, then the UE transmits PUSCH on the lowest-indexed <span
class="math inline">\(M_{RB}^{PUSCH}\)</span> PRBs amongst the PRBs
indicated by the frequency domain resource assignment information. <span
class="math inline">\(M_{RB}^{PUSCH}\)</span> is the largest integer not
greater than the number of RBs indicated by the frequency domain
resource assignment information that fulfils the conditions in Clause
6.3.1.4 of [4, TS 38.211].</p>
<h4
id="resource-allocation-for-uplink-transmission-with-configured-grant">6.1.2.3
Resource allocation for uplink transmission with configured grant</h4>
<p>When PUSCH resource allocation is semi-statically configured by
higher layer parameter <em>configuredGrantConfig</em> in
<em>BWP-UplinkDedicated</em> information element, and the PUSCH
transmission corresponding to a configured grant, the following higher
layer parameters are applied in the transmission:</p>
<p>- For Type 1 PUSCH transmissions with a configured grant, the
following parameters are given in <em>configuredGrantConfig</em> unless
mentioned otherwise:</p>
<p>- For the determination of the PUSCH repetition type, if the higher
layer parameter <em>pusch-RepTypeIndicator</em> in
<em>rrc-ConfiguredUplinkGrant</em> is configured and set to
'pusch-RepTypeB', PUSCH repetition type B is applied; otherwise, PUSCH
repetition type A is applied;</p>
<p>- For PUSCH repetition type A, the selection of the time domain
resource allocation table follows the rules for DCI format 0_0 on UE
specific search space, as defined in Clause 6.1.2.1.1.</p>
<p>- For PUSCH repetition type B, the selection of the time domain
resource allocation table is as follows:</p>
<p>- If <em>pusch-RepTypeIndicatorDCI-0-1</em> in <em>pusch-Config</em>
is configured and set to <em>'</em>pusch-RepTypeB<em>'</em>,
<em>pusch-TimeDomainAllocationListDCI-0-1</em> in <em>pusch-Config</em>
is used;</p>
<p>- Otherwise, <em>pusch-TimeDomainAllocationListDCI-0-2</em> in
<em>pusch-Config</em> is used.</p>
<p>- It is not expected that <em>pusch-RepTypeIndicator</em> in
<em>rrc-ConfiguredUplinkGrant</em> is configured with
<em>'</em>pusch-RepTypeB<em>'</em> when none of
<em>pusch-RepTypeIndicatorDCI-0-1</em> and
<em>pusch-RepTypeIndicatorDCI-0-2</em> in <em>pusch-Config</em> is set
to <em>'</em>pusch-RepTypeB<em>'</em>.</p>
<p>- The higher layer parameter <em>timeDomainAllocation</em> value
<em>m</em> provides a row index <em>m</em>+1 pointing to the determined
time domain resource allocation table, where the start symbol and length
are determined following the procedure defined in Clause 6.1.2.1;</p>
<p>- Frequency domain resource allocation is determined by the
<em>N</em> LSB bits in the higher layer parameter
<em>frequencyDomainAllocation</em>, forming a bit sequence <span
class="math inline">\(f_{17},\ \ldots,\ f_{1},\ f_{0}\)</span>, where
<span class="math inline">\(f_{0}\)</span> is the LSB, according to the
procedure in Clause 6.1.2.2 and <em>N</em> is determined as the size of
frequency domain resource assignment field in DCI format 0_1 for a given
resource allocation type indicated by <em>resourceAllocation,</em>
except if <em>useInterlacePUCCH-PUSCH</em> in
<em>BWP-UplinkDedicated</em> is configured, in which case uplink type 2
resource allocation is used wherein the UE interprets the LSB bits in
the higher layer parameter <em>frequencyDomainAllocation</em> as for the
frequency domain resource assignment field of DCI 0_1 according to the
procedure in Clause 6.1.2.2.3<em>;</em></p>
<p>- The <em>I<sub>MCS</sub></em> is provided by higher layer parameter
<em>mcsAndTBS;</em></p>
<p>- Number of DM-RS CDM groups, DM-RS ports, SRS resource indication
and DM-RS sequence initialization are determined as in Clause 7.3.1.1.2
of [5, TS 38.212], and the antenna port value, the bit value for DM-RS
sequence initialization, precoding information and number of layers, SRS
resource indicator are provided by <em>antennaPort,
dmrs-SeqInitialization, precodingAndNumberOfLayers</em>, and
<em>srs-ResourceIndicator</em> respectively; When two SRS resource sets
are configured in <em>srs-ResourceSetToAddModList</em> or
<em>srs-ResourceSetToAddModListDCI-0-2,</em> precoding information and
number of layers (applicable when higher layer parameter <em>usage</em>
in <em>SRS-ResourceSet</em> set to 'codebook') associated with the first
and second SRS resource set is provided by
<em>precodingAndNumberOfLayers and precodingAndNumberOfLayers2,</em>
respectively, and SRS resource indicators associated with the first and
second SRS resource sets are provided by <em>srs-ResourceIndicator</em>
and <em>srs-ResourceIndicator2,</em> respectively. When both
<em>srs-ResourceSetToAddModList</em> and
<em>srs-ResourceSetToAddModListDCI-0-2</em> are configured with two SRS
resource sets, the two SRS resource sets configured by
<em>srs-ResourceSetToAddModList</em> is used to determine the SRS
resource indications by <em>srs-ResourceIndicator</em> and
<em>srs-ResourceIndicator2.</em></p>
<p>- If two SRS resource sets with usage set to 'codebook' or
'noncodebook' are configured in <em>srs-ResourceSetToAddModList</em>,
the two SRS resource sets are used to determine the SRS resource
indications by <em>srs-ResourceIndicator</em> and
<em>srs-ResourceIndicator2</em>.</p>
<p>- otherwise, the two SRS resource sets with usage set to 'codebook'
or 'noncodebook' configured in
<em>srs-ResourceSetToAddModListDCI-0-2</em> are used to determine the
SRS resource indications by <em>srs-ResourceIndicator</em> and
<em>srs-ResourceIndicator2</em>.</p>
<p>- When frequency hopping is enabled, the frequency offset between two
frequency hops can be configured by higher layer parameter
<em>frequencyHoppingOffset.</em></p>
<p>- For Type 2 PUSCH transmissions with a configured grant: the
resource allocation follows the higher layer configuration according to
[10, TS 38.321], and UL grant received on the DCI.</p>
<p>- The PUSCH repetition type and the time domain resource allocation
table are determined by the PUSCH repetition type and the time domain
resource allocation table associated with the UL grant received on the
DCI, respectively, as defined in Clause 6.1.2.1. The value of
K<sub>offset</sub>, if configured, is applied when determining the first
transmission opportunity.</p>
<p>For PUSCH transmissions with a Type 1 or Type 2 configured grant, the
number of (nominal) repetitions <em>K</em> to be applied to the
transmitted transport block is provided by the indexed row in the time
domain resource allocation table if <em>numberOfRepetitions</em> is
present in the table; otherwise <em>K</em> is provided by the higher
layer configured parameters <em>repK.</em></p>
<p>For PUSCH transmissions with a Type 2 configured grant, when two SRS
resource sets are configured in srs-<em>ResourceSetToAddModList</em> or
<em>srs-ResourceSetToAddModListDCI-0-2</em>, the SRS resource set
association to (nominal) repetitions follows <em>MappingPattern</em> in
<em>ConfiguredGrantConfig</em> as defined in Clause 6.1.2.1 for PUSCH
scheduled by DCI format 0_1 and 0_2. For PUSCH transmissions with a Type
1 configured grant, when two SRS resource sets with usage set to
'codebook' or 'noncodebook' are configured in
<em>srs-ResourceSetToAddModList</em> or
<em>srs-ResourceSetToAddModListDCI-0-2</em>, if <em>p0-PUSCH-Alpha2</em>
is provided, the SRS resource set association to (nominal) repetitions
is determined as follows. When K = 2, the first and second SRS resource
sets are applied to the first and second (nominal) repetitions,
respectively.</p>
<p>- When K &gt; 2 and <em>cyclicMapping</em> in
<em>ConfiguredGrantConfig</em> is enabled, the first and second SRS
resource sets are applied to the first and second (nominal) repetitions,
respectively, and the same SRS resource set mapping pattern continues to
the remaining (nominal) repetitions.</p>
<p>- When K &gt; 2 and <em>sequentialMapping</em> in
<em>ConfiguredGrantConfig</em> is enabled, first SRS resource set is
applied to the first and second (nominal) repetitions, and the second
SRS resource set is applied to the third and fourth (nominal)
repetitions, and the same SRS resource set mapping pattern continues to
the remaining (nominal) repetitions.</p>
<p>For PUSCH transmissions with a Type 1 configured grant, when two SRS
resource sets are configured in <em>srs-ResourceSetToAddModList</em> or
<em>srs-ResourceSetToAddModListDCI-0-2</em>, if configuredGrantConfig
contains only one <em>pathlossReferenceIndex, p0-PUSCH-Alpha,
powerControlLoopToUse,</em> <em>srs-ResourceIndicator</em> and
<em>precodingAndNumberOfLayers</em> (applicable when higher layer
parameter usage in <em>SRS-ResourceSet</em> set to 'codebook'), PUSCH
repetitions are associated only with the first SRS resource set.</p>
<p>If the UE is provided two SRS resource sets in
<em>srs-ResourceSetToAddModList</em> or
<em>srs-ResourceSetToAddModListDCI-0-2</em> with <em>usage</em> set to
'codebook' or 'nonCodebook', and the UE is not provided
<em>p0-PUSCH-Alpha2</em> and <em>powerControlLoopToUse2</em>, for a
retransmission of a configured grant Type 1 PUSCH, or for activation or
retransmission of a configured grant Type 2 PUSCH, scheduled by a DCI
format that includes an SRS resource set indicator field, the UE expects
the value of the SRS resource set indicator field to be set to '00', and
PUSCH repetitions are associated only with the first SRS resource
set.</p>
<p>The UE shall not transmit anything on the resources configured by
<em>configuredGrantConfig</em> if the higher layers did not deliver a
transport block to transmit on the resources allocated for uplink
transmission without grant.</p>
<p>A set of allowed periodicities <em>P</em> are defined in [12, TS
38.331]. The higher layer parameter <em>cg-nrofSlots</em>, provides the
number of consecutive slots allocated within a configured grant period.
The higher layer parameter <em>cg-nrofPUSCH-InSlot</em> provides the
number of consecutive PUSCH allocations within a slot, where the first
PUSCH allocation follows the higher layer parameter
<em>timeDomainAllocation</em> for Type 1 PUSCH transmission or the
higher layer configuration according to [10, TS 38.321], and UL grant
received on the DCI for Type 2 PUSCH transmissions, and the remaining
PUSCH allocations have the same length and PUSCH mapping type, and are
appended following the previous allocations without any gaps. The same
combination of start symbol and length and PUSCH mapping type repeats
over the consecutively allocated slots.</p>
<p>For operation with shared spectrum channel access, and when the
higher layer parameter <em>semiStaticChannelAccessConfigUE</em> is not
configured, where a UE is performing uplink transmission with configured
grants in contiguous OFDM symbols on all resource blocks of an RB set,
for the first such UL transmission the UE determines a duration of a
cyclic prefix extension <em>T<sub>ext</sub></em> to be applied for
transmission according to [4, TS 38.211] where the index for <span
class="math inline">\(\Delta_{i}\)</span> [4, TS 38.211] is chosen
randomly from a set of values configured by higher layers according to
the following rule:</p>
<p>- If the first such UL transmission is within a channel occupancy
initiated by the gNB (defined in Clause 4 of [16, TS 37.213]), the set
of values is determined by <em>cg-StartingFullBW-InsideCOT</em>;</p>
<p>- otherwise, the set of values is determined by
<em>cg-StartingFullBW-OutsideCOT</em>.</p>
<p>For operation with shared spectrum channel access, and when the
higher layer parameter <em>semiStaticChannelAccessConfigUE</em> is not
configured, where a UE is performing uplink transmission with configured
grants in contiguous OFDM symbols on fewer than all resource blocks of
an RB set, for the first such UL transmission the UE determines a
duration of a cyclic prefix extension <em>T<sub>ext</sub></em> to be
applied for transmission according to [4, TS 38.211] according to the
following rule:</p>
<p>- If the first such UL transmission is within a channel occupancy
initiated by the gNB (defined in Clause 4 of [16, TS 37.213]), the index
for <span class="math inline">\(\Delta_{i}\)</span> [4, TS 38.211] is
equal to <em>cg-StartingPartialBW-InsideCOT</em>;</p>
<p>- otherwise, the index for <span
class="math inline">\(\Delta_{i}\)</span> [4, TS 38.211] is equal to
<em>cg-StartingPartialBW-OutsideCOT.</em></p>
<h5
id="transport-block-repetition-for-uplink-transmissions-of-pusch-repetition-type-a-with-a-configured-grant">6.1.2.3.1
Transport Block repetition for uplink transmissions of PUSCH repetition
Type A with a configured grant</h5>
<p>The procedures described in this clause apply to PUSCH transmissions
of PUSCH repetition Type A with a Type 1 or Type 2 configured grant.</p>
<p>The higher layer parameter <em>repK-RV</em> defines the redundancy
version pattern to be applied to the repetitions. If
<em>cg-RetransmissionTimer</em> is provided, the redundancy version for
uplink transmission with a configured grant is determined by the UE. If
the parameter <em>repK-RV</em> is not provided in the
<em>configuredGrantConfig</em> and <em>cg-RetransmissionTimer</em> is
not provided, the redundancy version for uplink transmissions with a
configured grant shall be set to 0. If the parameter <em>repK-RV</em> is
provided in the <em>configuredGrantConfig</em> and
<em>cg-RetransmissionTimer</em> is not provided, for the <em>n</em>th
transmission occasion among <em>K</em> repetitions, <em>n</em>=1, 2, …,
<em>K</em>, it is associated with <em>(mod(((n-mod(n,
N))/N)-1,4)+1)<sup>th</sup></em> value in the configured RV sequence,
where <em>N</em>=1. If a configured grant configuration is configured
with <em>startingFromRV0</em> set to <em>'off'</em>, the initial
transmission of a transport block may only start at the first
transmission occasion of the <em>K</em> repetitions. Otherwise, the
initial transmission of a transport block may start at</p>
<p>- the first transmission occasion of the <em>K</em> repetitions if
the configured RV sequence is {0,2,3,1},</p>
<p>- any of the transmission occasions of the <em>K</em> repetitions
that are associated with RV=0 if the configured RV sequence is
{0,3,0,3},</p>
<p>- any of the transmission occasions of the <em>K</em> repetitions if
the configured RV sequence is {0,0,0,0}, except the last transmission
occasion when <em>K≥8</em>.</p>
<p>When the transmission occasions are associated with the first and
second SRS resource sets, if the parameter <em>repK-RV</em> is provided
in the <em>configuredGrantConfig</em>, for the <em>n</em>th transmission
occasion among all transmission occasions that are associated with the
SRS resource set of the first transmission occasion, it is associated
with <em>(mod(n-1,4)+1)<sup>th</sup></em> value in the configured RV
sequence, and for the <em>n</em>th transmission occasion among all
transmission occasions that are not associated with the SRS resource set
of the first transmission occasion, it is associated with
<em>(mod(n-1,4)+1)<sup>th</sup></em> value in the adjusted RV sequence
and the adjustment is based on additional shifting operation on the
configured RV sequence, where the shifting operation is defined as <span
class="math inline">\(\left( {rv}_{i} + \ {rv}_{s} \right)mod\
4\)</span> where <span class="math inline">\({rv}_{i}\ \)</span>is the
<em>i<sup>th</sup></em> RV value (<em>i</em>=1, 2, 3, 4) in the
configured RV sequence and <span class="math inline">\({rv}_{s}\)</span>
is configured by the higher layer parameter <em>sequenceOffsetforRV</em>
in <em>configuredGrantConfig</em>. When the transmission occasions are
associated with the first and second SRS resource sets, if a configured
grant configuration is configured with <em>startingFromRV0</em> set to
<em>'off'</em>, the initial transmission of a transport block may only
start at the first transmission occasion of the <em>K</em> repetitions.
Otherwise, the initial transmission of a transport block may start
at</p>
<p>- the first transmission occasion associated with RV = 0
corresponding to the first or second SRS resource set of the <em>K</em>
repetitions if the configured RV sequence is {0,2,3,1},</p>
<p>- any of the transmission occasions of the <em>K</em> repetitions
that are associated with RV=0 if the configured RV sequence is
{0,3,0,3},</p>
<p>- any of the transmission occasions of the <em>K</em> repetitions if
the configured RV sequence is {0,0,0,0}, except the last transmission
occasion when <em>K≥8</em>.</p>
<p>After the initial transmission of a transport block, later
transmission occasions among the <em>K</em> repetitions associated with
any RV value and associated to any of the first or second SRS resource
set can be used for transmitting the transport block.</p>
<p>For any RV sequence, the repetitions shall be terminated after
transmitting <em>K</em> repetitions, or at the last transmission
occasion among the <em>K</em> repetitions within the period <em>P</em>,
or from the starting symbol of the repetition that overlaps with a PUSCH
with the same HARQ process scheduled by DCI format 0_0, 0_1 or 0_2,
whichever is reached first. In addition, the UE shall terminate the
repetition of a transport block in a PUSCH transmission if the UE
receives a DCI format 0_1 with DFI flag provided and set to '1', and if
in this DCI the UE detects ACK for the HARQ process corresponding to
that transport block.</p>
<p>The UE is not expected to be configured with the time duration for
the transmission of <em>K</em> repetitions larger than the time duration
derived by the periodicity <em>P</em>. If the UE determines that, for a
transmission occasion, the number of symbols available for the PUSCH
transmission in a slot is smaller than transmission duration <em>L</em>,
the UE does not transmit the PUSCH in the transmission occasion.</p>
<p>For both Type 1 and Type 2 PUSCH transmissions with a configured
grant, when <em>K &gt;</em> 1<em>,</em></p>
<p>- For unpaired spectrum:</p>
<p>- If <em>AvailableSlotCounting</em> is enabled, the UE shall repeat
the TB across the <span class="math inline">\(N \bullet K\)</span> slots
determined for the PUSCH transmission applying the same symbol
allocation in each slot.</p>
<p>- A slot is not counted in the number of <span
class="math inline">\(N \bullet K\)</span> slots if at least one of the
symbols indicated by the indexed row of the used resource allocation
table in the slot overlaps with a DL symbol indicated by
<em>tdd-UL-DL-ConfigurationCommon</em> or
<em>tdd-UL-DL-ConfigurationDedicated</em> if provided, or a symbol of an
SS/PBCH block with index provided by <em>ssb-PositionsInBurst</em>.</p>
<p>- Otherwise, the UE shall repeat the TB across the <span
class="math inline">\(N \bullet K\)</span> consecutive slots applying
the same symbol allocation in each slot, except if the UE is provided
with higher layer parameters <em>cg-nrofSlots</em> and
<em>cg-nrofPUSCH-InSlot</em>, in which case the UE repeats the TB in the
<em>repK</em> earliest consecutive transmission occasion candidates
within the same configuration.</p>
<p>- For paired spectrum and SUL band:</p>
<p>- The UE shall repeat the TB across the <span class="math inline">\(N
\bullet K\)</span> consecutive slots applying the same symbol allocation
in each slot, except if the UE is provided with higher layer parameters
<em>cg-nrofSlots</em> and <em>cg-nrofPUSCH-InSlot</em>, in which case
the UE repeats the TB in the <em>repK</em> earliest consecutive
transmission occasion candidates within the same configuration.</p>
<p>- If <em>AvailableSlotCounting</em> is enabled, and in case of
reduced capability half-duplex UE, the UE shall repeat the TB across the
<span class="math inline">\(N \bullet K\)</span> slots applying the same
symbol allocation in each slot. A slot is not counted in the number of
<span class="math inline">\(N \bullet K\)</span> slots if at least one
of the symbols indicated by the indexed row of the used resource
allocation table in the slot does not start or end at least <span
class="math inline">\(N_{\text{Rx-Tx}} \cdot T_{\text{c}}\)</span> or
<span class="math inline">\(N_{\text{Tx-Rx}} \cdot
T_{\text{c}}\)</span>, respectively, from the last or first symbol of an
SS/PBCH block with index provided by <em>ssb-PositionsInBurst</em>.</p>
<p>A Type 1 or Type 2 PUSCH transmission with a configured grant in a
slot is omitted according to the conditions in Clause 9, Clause 11.1,
Clause 11.2A, Clause 15 and Clause 17.2 of [6, TS 38.213].</p>
<h5
id="transport-block-repetition-for-uplink-transmissions-of-pusch-repetition-type-b-with-a-configured-grant">6.1.2.3.2
Transport Block repetition for uplink transmissions of PUSCH repetition
Type B with a configured grant</h5>
<p>The procedures described in this Clause apply to PUSCH transmissions
of PUSCH repetition type B with a Type 1 or Type 2 configured grant.</p>
<p>For PUSCH transmissions with a Type 1 or Type 2 configured grant, the
nominal repetitions and the actual repetitions are determined according
to the procedures for PUSCH repetition Type B defined in Clause 6.1.2.1.
The higher layer configured parameters <em>repK-RV</em> defines the
redundancy version pattern to be applied to the repetitions. If the
parameter <em>repK-RV</em> is not provided in the
<em>configuredGrantConfig</em>, the redundancy version for each actual
repetition with a configured grant shall be set to 0. Otherwise, for the
<em>n</em>th transmission occasion among all the actual repetitions
(including the actual repetitions that are omitted) of the <em>K</em>
nominal repetitions, it is associated with <em>(mod(((n-mod(n,
N))/N)-1,4)+1)<sup>th</sup></em> value in the configured RV sequence,
where <em>N</em> = 1. If a configured grant configuration is configured
with <em>startingFromRV0</em> set to 'off', the initial transmission of
a transport block may only start at the first transmission occasion of
the actual repetitions. Otherwise, the initial transmission of a
transport block may start at</p>
<p>- the first transmission occasion of the actual repetitions if the
configured RV sequence is {0,2,3,1},</p>
<p>- any of the transmission occasions of the actual repetitions that
are associated with RV=0 if the configured RV sequence is {0,3,0,3},</p>
<p>- any of the transmission occasions of the actual repetitions if the
configured RV sequence is {0,0,0,0}, except the actual repetitions
within the last nominal repetition when <em>K≥8</em>.</p>
<p>When the transmission occasions are associated with the first and
second SRS resource sets, if the parameter <em>repK-RV</em> is provided
in the <em>configuredGrantConfig</em>, for the <em>n</em>th transmission
occasion among all actual repetitions (including the actual repetitions
that are omitted) that are associated with the SRS resource set of the
first transmission occasion, it is associated with
<em>(mod(n-1,4)+1)<sup>th</sup></em> value in the configured RV
sequence, and for the <em>n</em>th transmission occasion among all
actual repetitions that are not associated with the SRS resource set of
the first transmission occasion, it is associated with
<em>(mod(n-1,4)+1)<sup>th</sup></em> value in the adjusted RV sequence
and the adjustment is based on additional shifting operation on the
configured RV sequence, where the shifting operation is defined as <span
class="math inline">\(\left( {rv}_{i} + \ {rv}_{s} \right)mod\
4\)</span> where <span class="math inline">\({rv}_{i}\ \)</span>is the
<em>i<sup>th</sup></em> RV value (<em>i</em>=1, 2, 3, 4) in the
configured RV sequence and <span class="math inline">\({rv}_{s}\)</span>
is configured by the higher layer parameter <em>sequenceOffsetforRV</em>
in <em>configuredGrantConfig</em>. When the transmission occasions are
associated with the first and second SRS resource sets, if a configured
grant configuration is configured with <em>startingFromRV0</em> set to
<em>'off'</em>, the initial transmission of a transport block may only
start at the first transmission occasion of the <em>K</em> repetitions.
Otherwise, the initial transmission of a transport block may start
at</p>
<p>- the first transmission occasion associated with RV = 0
corresponding to the first or second SRS resource set of the <em>K</em>
repetitions if the configured RV sequence is {0,2,3,1},</p>
<p>- any of the transmission occasions of the <em>K</em> repetitions
that are associated with RV=0 if the configured RV sequence is
{0,3,0,3},</p>
<p>- any of the transmission occasions of the <em>K</em> repetitions if
the configured RV sequence is {0,0,0,0}, except the last transmission
occasion when <em>K≥8</em>.</p>
<p>After the initial transmission of a transport block, later
transmission occasions among the <em>K</em> repetitions associated with
any RV value and associated to any of the first or second SRS resource
set can be used for transmitting the transport block.</p>
<p>For any RV sequence, the repetitions shall be terminated after
transmitting K nominal repetitions, or at the last transmission occasion
among the <em>K</em> nominal repetitions within the period <em>P</em>,
or from the starting symbol of an actual repetition that overlaps with a
PUSCH with the same HARQ process scheduled by DCI format 0_0, 0_1 or
0_2, whichever is reached first. The UE is not expected to be configured
with the time duration for the transmission of <em>K</em> nominal
repetitions larger than the time duration derived by the periodicity
<em>P</em>.</p>
<h5
id="transport-block-repetition-for-uplink-transmissions-of-tb-processing-over-multiple-slots-with-a-configured-grant">6.1.2.3.3
Transport Block repetition for uplink transmissions of TB processing
over multiple slots with a configured grant</h5>
<p>The procedures described in this clause apply to PUSCH transmissions
of TB processing over multiple slots with a Type 2 configured grant.</p>
<p>The higher layer parameter <em>repK-RV</em> defines the redundancy
version pattern to be applied to the repetitions. If the parameter
<em>repK-RV</em> is not provided in the <em>configuredGrantConfig</em>,
the redundancy version for uplink transmissions with a configured grant
shall be set to 0. If the parameter <em>repK-RV</em> is provided in the
<em>configuredGrantConfig</em>, the <em>n</em>th transmission occasion
among <span class="math inline">\(N \bullet K\)</span> transmissions
occasions, <em>n</em>=0,1, …, <span class="math inline">\(N \bullet
K\)</span> <em>-1</em>, is associated with <em>(mod((n-mod(n,
N))/N,4)+1)<sup>th</sup></em> value in the configured RV sequence. When
<em>K</em>=1, or when <em>K</em>&gt;1 and the configured grant
configuration is configured with startingFromRV0 set to 'off', the
initial transmission of the transport block may only start at the first
transmission occasion of the <span class="math inline">\(N \bullet
K\)</span> transmission occasions. Otherwise, the initial transmission
of the transport block may start at</p>
<p>- The first transmission occasion of the <span
class="math inline">\(N \bullet K\)</span> transmission occasions if the
configured RV sequence is {0,2,3,1}.</p>
<p>- Any transmission occasion n associated with RV=0, and for which n
mod N =0, if the configured RV sequence is {0,3,0,3} or {0,0,0,0}.</p>
<p>The UE is not expected to be configured with the time duration for
<span class="math inline">\(N \bullet K\)</span> transmissions larger
than the time duration derived by the periodicity <em>P</em>. If the UE
determines that, for a transmission occasion, the number of symbols
available in a slot for the PUSCH transmission of TB processing over
multiple slots is smaller than transmission duration <em>L</em>, the UE
does not transmit the PUSCH in the transmission occasion.</p>
<p>For unpaired spectrum:</p>
<p>- The UE determines <span class="math inline">\(N \bullet K\)</span>
slots for a PUSCH transmission of TB processing over multiple slots with
a Type 2 configured grant activated by DCI format 0_1 or 0_2, based on
<em>tdd-UL-DL-ConfigurationCommon</em>,
<em>tdd-UL-DL-ConfigurationDedicated</em> and
<em>ssb-PositionsInBurst</em>, and the TDRA information field value in
the DCI format 0_1 or 0_2.</p>
<p>- A slot is not counted in the number of <span
class="math inline">\(N \bullet K\)</span> slots for a PUSCH
transmission of TB processing over multiple slots with a Type 2
configured grant activated by DCI format 0_1 or 0_2 if at least one of
the symbols indicated by the indexed row of the used resource allocation
table in the slot overlaps with a DL symbol indicated by
<em>tdd-UL-DL-ConfigurationCommon</em> or
<em>tdd-UL-DL-ConfigurationDedicated</em> if provided, or a symbol of an
SS/PBCH block with index provided by <em>ssb-PositionsInBurst</em>.</p>
<p>For paired spectrum and SUL band:</p>
<p>- The UE determines <span class="math inline">\(N \bullet K\)</span>
consecutive slots for a PUSCH transmission of TB processing over
multiple slots with a Type 2 configured grant activated by DCI format
0_1 or 0_2, based on the TDRA information field value in the DCI format
0_1 or 0_2.</p>
<p>- For the case of a reduced capability half-duplex UE, the UE
determines <span class="math inline">\(N \bullet K\)</span> slots for a
PUSCH transmission of TB processing over multiple slots with a Type 2
configured grant activated by DCI format 0_1 or 0_2, based on the TDRA
information field value in the DCI format 0_1 or 0_2. A slot is not
counted in the number of <span class="math inline">\(N \bullet
K\)</span> slots if at least one of the symbols indicated by the indexed
row of the used resource allocation table in the slot does not start or
end at least <span class="math inline">\(N_{\text{Rx-Tx}} \cdot
T_{\text{c}}\)</span> or <span class="math inline">\(N_{\text{Tx-Rx}}
\cdot T_{\text{c}}\)</span>, respectively, from the last or first symbol
of an SS/PBCH block with index provided by
<em>ssb-PositionsInBurst</em>.</p>
<p>For Type 2 PUSCH transmission with a configured grant of TB
processing over multiple slots<em>,</em> the UE shall transmit the TB
across the <span class="math inline">\(N \bullet K\)</span> slots
determined for the PUSCH transmission applying the same symbol
allocation in each slot. A Type 2 PUSCH transmission with a configured
grant of TB processing over multiple slots is omitted in a slot
according to the conditions in Clause 9, Clause 11.1, Clause 11.2A,
Clause 15 and Clause 17.2 of [6, TS 38.213].</p>
<h3 id="ue-procedure-for-applying-transform-precoding-on-pusch">6.1.3 UE
procedure for applying transform precoding on PUSCH</h3>
<p>For a PUSCH scheduled by RAR UL grant, or for a PUSCH scheduled by
fallbackRAR UL grant, or for a PUSCH scheduled by DCI format 0_0 with
CRC scrambled by TC-RNTI, the UE shall consider the transform precoding
either 'enabled' or 'disabled' according to the higher layer configured
parameter <em>msg3-transformPrecoder.</em></p>
<p>For a MsgA PUSCH, the UE shall consider the transform precoding
either 'enabled' or 'disabled' according to the higher layer configured
parameter <em>msgA-TransformPrecoder.</em> If higher layer parameter
<em>msgA-TransformPrecoder</em> is not configured, the UE shall consider
the transform precoding either 'enabled' or 'disabled' according to the
higher layer configured parameter <em>msg3-transformPrecoder.</em></p>
<p>For PUSCH transmission scheduled by a PDCCH with CRC scrambled by
CS-RNTI with NDI=1, C-RNTI, or MCS-C-RNTI or SP-CSI-RNTI:</p>
<p>- If the DCI with the scheduling grant was received with DCI format
0_0, the UE shall, for this PUSCH transmission, consider the transform
precoding either enabled or disabled according to the higher layer
configured parameter <em>msg3-transformPrecoder</em>.</p>
<p>- If the DCI with the scheduling grant was not received with DCI
format 0_0</p>
<p>- If the UE is configured with the higher layer parameter
<em>transformPrecoder</em> in <em>pusch-Config</em>, the UE shall, for
this PUSCH transmission, consider the transform precoding either enabled
or disabled according to this parameter.</p>
<p>- If the UE is not configured with the higher layer parameter
<em>transformPrecoder</em> in <em>pusch-Config</em>, the UE shall, for
this PUSCH transmission, consider the transform precoding either enabled
or disabled according to the higher layer configured parameter
<em>msg3-transformPrecoder</em>.</p>
<p>For PUSCH transmission with a configured grant</p>
<p>- If the UE is configured with the higher layer parameter
<em>transformPrecoder</em> in <em>configuredGrantConfig</em>, the UE
shall, for this PUSCH transmission, consider the transform precoding
either enabled or disabled according to this parameter.</p>
<p>- If the UE is not configured with the higher layer parameter
<em>transformPrecoder</em> in <em>configuredGrantConfig</em>, the UE
shall, for this PUSCH transmission, consider the transform precoding
either enabled or disabled according to the higher layer configured
parameter <em>msg3-transformPrecoder</em>.</p>
<h3
id="modulation-order-redundancy-version-and-transport-block-size-determination">6.1.4
Modulation order, redundancy version and transport block size
determination</h3>
<p>To determine the modulation order, target code rate, redundancy
version and transport block size for the physical uplink shared channel,
the UE shall first</p>
<p>- read the 5-bit modulation and coding scheme field <img
src="media/image742.svg" />in the DCI scheduling PUSCH or provided in a
DCI activating a configured grant Type 2 PUSCH, or as provided by
<em>mcsAndTBS</em> as described in Clause 6.1.2.3 for a configured grant
Type 1 PUSCH to determine the modulation order <img
src="media/image743.svg" /> and target code rate (<em>R</em>) based on
the procedure defined in Clause 6.1.4.1</p>
<p>- read redundancy version field (<em>rv</em>) in the DCI to determine
the redundancy version for PUSCH scheduled by DCI, or determine the
redundancy version according to Clause 6.1.2.3.1 for configured grant
Type 1 and Type 2 PUSCH,</p>
<p>and second</p>
<p>- use the number of layers <img src="media/image744.svg" />, the
total number of allocated PRBs <img src="media/image745.svg" /> to
determine the transport block size based on the procedure defined in
Clause 6.1.4.2.</p>
<p>When the UE is scheduled with multiple PUSCHs by a DCI, as described
in clause 6.1.2.1, the bits of <em>rv</em> field and NDI field,
respectively, in the DCI are one to one mapped to the scheduled PUSCH(s)
indicated by the TDRA information field with the corresponding transport
block(s) in the scheduled order where the LSB bits of the <em>rv</em>
field and NDI field, respectively, correspond to the last scheduled
PUSCH indicated by the TDRA information field.</p>
<p>Within a cell group, a UE is not required to handle PUSCH(s)
transmissions in slot <em>s<sub>j</sub></em> in serving cell-<em>j</em>,
and for <em>j</em> = 0,1,2.. <em>J-1</em>, slot <em>s<sub>j</sub></em>
overlapping with any given point in time, if the following condition is
not satisfied at that point in time:</p>
<p><span class="math inline">\(\sum_{j = 0}^{J - 1}\frac{\sum_{m = 0}^{M
- 1}V_{j,m}}{T_{slot}^{\mu(j)}} \leq DataRate\)</span>,</p>
<p>where</p>
<p><em>- J</em> is the number of configured serving cells belong to a
frequency range</p>
<p>- for the <em>j-th</em> serving cell,</p>
<p><em>- M</em> is the number of TB(s) transmitted in
slot-<em>s<sub>j</sub></em>. For PUSCH repetition Type B, each actual
repetition is counted separately.</p>
<p><em>- T<sub>slot</sub><sup>μ(j)</sup></em>
=10<sup>-3</sup>/2<sup><em>μ(j</em>)</sup>, where <em>μ(j)</em> is the
numerology for PUSCH(s) in slot <em>s<sub>j</sub></em> of the
<em>j</em>-th serving cell.</p>
<p>- for the <em>m</em>-th TB, <span class="math inline">\(V_{j,m} =
C&#39; \bullet \left\lfloor \frac{A}{C} \right\rfloor\)</span></p>
<p><em>- A</em> is the number of bits in the transport block as defined
in Clause 6.2.1 [5, TS 38.212]</p>
<p><em>- C</em> is the total number of code blocks for the transport
block defined in Clause 5.2.2 [5, TS 38.212].<span
class="math inline">\(\ \)</span></p>
<p>- <span class="math inline">\(C&#39;\)</span>is the number of
scheduled code blocks for the transport block as defined in Clause
5.4.2.1 [5,38.212]</p>
<p>- <span class="math inline">\(DataRate\)</span> [Mbps] is computed as
the maximum data rate summed over all the carriers in the frequency
range for any signaled band combination and feature set consistent with
the configured servings cells, where the data rate value is given by the
formula in Clause 4.1.2 in [13, TS 38.306], including the scaling factor
<em>f(i).</em></p>
<p>For a <em>j</em>-th serving cell, if higher layer parameter
<em>processingType2Enabled</em> of <em>PUSCH-ServingCellConfig</em> is
configured for the serving cell and set to 'enable'<em>,</em> or if at
least one <em>I<sub>MCS</sub> &gt; W</em> for a PUSCH, where <em>W</em>
= 28 for MCS tables 5.1.3.1-1 and 5.1.3.1-3, and <em>W</em> = 27 for MCS
tables 5.1.3.1-2, 6.1.4.1-1, and 6.1.4.1-2, or if it is an actual
repetition for PUSCH repetition Type B, the UE is not required to handle
PUSCH transmissions, if the following condition is not satisfied:</p>
<p><span class="math display">\[\frac{\sum_{m = 0}^{M - 1}V_{j,m}}{L
\times T_{s}^{\mu}} \leq DataRateCC\]</span></p>
<p>where</p>
<p>- <span class="math inline">\(L\ \)</span>is the number of symbols
assigned to the PUSCH</p>
<p>- <em>M</em> is the number of TB in the PUSCH</p>
<p>- <span class="math inline">\(T_{s}^{\mu} = \frac{10^{- 3}}{{2^{\mu}
\bullet N}_{symb}^{slot}}\)</span> where μ is the numerology of the
PUSCH</p>
<p>- for the <em>m</em>-th TB, <span class="math inline">\(V_{j,m} =
C&#39; \bullet \left\lfloor \frac{A}{C} \right\rfloor\)</span></p>
<p>- <em>A</em> is the number of bits in the transport block as defined
in Clause 6.2.1 [5, TS 38.212]</p>
<p>- <em>C</em> is the total number of code blocks for the transport
block defined in Clause 5.2.2 [5, TS 38.212]</p>
<p>- <span class="math inline">\(C&#39;\)</span> is the number of
scheduled code blocks for the transport block as defined in Clause
5.4.2.1 [5, TS 38.212]</p>
<p>- <span class="math inline">\(DataRateCC\)</span> [Mbps] is computed
as the maximum data rate for a carrier in the frequency band of the
serving cell for any signaled band combination and feature set
consistent with the serving cell, where the data rate value is given by
the formula in Clause 4.1.2 in [13, TS 38.306], including the scaling
factor <em>f(i)</em></p>
<p>- each actual repetition for PUSCH repetition type B is treated as
one PUSCH<em>.</em></p>
<h4 id="modulation-order-and-target-code-rate-determination-1">6.1.4.1
Modulation order and target code rate determination</h4>
<p>For a PUSCH scheduled by RAR UL grant or</p>
<p>for a PUSCH scheduled by a fallbackRAR UL grant or</p>
<p>for a MsgA PUSCH transmission, or</p>
<p>for a PUSCH scheduled by a DCI format 0_0 with CRC scrambled by
C-RNTI, MCS-C-RNTI, TC-RNTI, CS-RNTI, or</p>
<p>for a PUSCH scheduled by a DCI format 0_1 or DCI format 0_2 with CRC
scrambled by C-RNTI, MCS-C-RNTI, CS-RNTI, SP-CSI-RNTI, or</p>
<p>for a PUSCH with configured grant using CS-RNTI, and</p>
<p>if transform precoding is disabled for this PUSCH transmission
according to Clause 6.1.3</p>
<p>- if <em>mcs-TableDCI-0-2</em> in <em>pusch-Config</em> is set to
'qam256', and PUSCH is scheduled by a PDCCH with DCI format 0_2 with CRC
scrambled by C-RNTI or SP-CSI-RNTI,</p>
<p>- the UE shall use <em>I<sub>MCS</sub></em> and Table 5.1.3.1-2 to
determine the modulation order (<em>Q<sub>m</sub></em>) and Target code
rate (<em>R</em>) used in the physical uplink shared channel;</p>
<p>- elseif the UE is not configured with MCS-C-RNTI,
<em>mcs-TableDCI-0-2</em> in <em>pusch-Config</em> is set to
'qam64LowSE', and the PUSCH is scheduled by a PDCCH by a PDCCH with DCI
format 0_2 with CRC scrambled by C-RNTI or SP-CSI-RNTI,</p>
<blockquote>
<p>- the UE shall use <em>I<sub>MCS</sub></em> and Table 5.1.3.1-3 to
determine the modulation order (<em>Q<sub>m</sub></em>) and Target code
rate (<em>R</em>) used in the physical uplink shared channel.</p>
</blockquote>
<p>- elseif <em>mcs-Table</em> in <em>pusch-Config</em> is set to
'qam256', and PUSCH is scheduled by a PDCCH with DCI format 0_1 with CRC
scrambled by C-RNTI or SP-CSI-RNTI,</p>
<p>- the UE shall use <em>I<sub>MCS</sub></em> and Table 5.1.3.1-2 to
determine the modulation order (<em>Q<sub>m</sub></em>) and Target code
rate (<em>R</em>) used in the physical uplink shared channel.</p>
<p>- elseif the UE is not configured with MCS-C-RNTI, <em>mcs-Table</em>
in <em>pusch-Config</em> is set to 'qam64LowSE', and the PUSCH is
scheduled by a PDCCH with a DCI format other than DCI format 0_2 in a
UE-specific search space with CRC scrambled by C-RNTI or
SP-CSI-RNTI,</p>
<blockquote>
<p>- the UE shall use <em>I<sub>MCS</sub></em> and Table 5.1.3.1-3 to
determine the modulation order (<em>Q<sub>m</sub></em>) and Target code
rate (<em>R</em>) used in the physical uplink shared channel.</p>
</blockquote>
<p>- elseif the UE is configured with MCS-C-RNTI, and the PUSCH is
scheduled by a PDCCH with CRC scrambled by MCS-C-RNTI,</p>
<blockquote>
<p>- the UE shall use <em>I<sub>MCS</sub></em> and Table 5.1.3.1-3 to
determine the modulation order (<em>Q<sub>m</sub></em>) and Target code
rate (<em>R</em>) used in the physical uplink shared channel.</p>
</blockquote>
<p>- elseif <em>mcs-Table</em> in <em>configuredGrantConfig</em> is set
to 'qam256',</p>
<p>- if PUSCH is scheduled by a PDCCH with CRC scrambled by CS-RNTI
or</p>
<p>- if PUSCH is transmitted with configured grant</p>
<p>- the UE shall use <em>I<sub>MCS</sub></em> and Table 5.1.3.1-2 to
determine the modulation order (<em>Q<sub>m</sub></em>) and Target code
rate (<em>R</em>) used in the physical uplink shared channel.</p>
<p>- elseif <em>mcs-Table</em> in <em>configuredGrantConfig</em> is set
to 'qam64LowSE',</p>
<p>- if PUSCH is scheduled by a PDCCH with CRC scrambled by CS-RNTI
or</p>
<p>- if PUSCH is transmitted with configured grant,</p>
<p>- the UE shall use <em>I<sub>MCS</sub></em> and Table 5.1.3.1-3 to
determine the modulation order (<em>Q<sub>m</sub></em>) and Target code
rate (<em>R</em>) used in the physical uplink shared channel.</p>
<p>- elseif for a MsgA PUSCH transmission,</p>
<p>- the UE shall use higher layer parameter <em>msgA-MCS</em> for
<em>I<sub>MCS</sub></em> and Table 5.1.3.1-1 to determine the Target
code rate (<em>R</em>) used in the physical uplink shared channel.</p>
<p>- elseif the UE requests repetition of PUSCH scheduled by RAR UL
grant [10, TS 38.321], when transmitting PUSCH scheduled by RAR UL
grant,</p>
<p>- the 2 LSBs of the MCS information field of the RAR UL grant provide
a codepoint to determine the MCS index <em>I<sub>MCS</sub></em>
according to Table 6.1.4.1-3, based on whether or not the higher layer
parameter <em>mcs-Msg3-Repetitions</em> is configured. The UE shall use
the determined <em>I<sub>MCS</sub></em> and Table 5.1.3.1-1 to determine
the modulation order (<em>Q<sub>m</sub></em>) and Target code rate
(<em>R</em>) used in the physical uplink shared channel.</p>
<p>- elseif the UE requests repetition of PUSCH scheduled by RAR UL
grant [10, TS 38.321], when transmitting PUSCH scheduled by DCI format
0_0 with CRC scrambled by the TC-RNTI,</p>
<p>- the 3 LSBs of the MCS information field of the DCI format 0_0 with
CRC scrambled by the TC-RNTI provide a codepoint to determine the MCS
index <em>I<sub>MCS</sub></em> according to Table 6.1.4.1-4, based on
whether or not the higher layer parameter <em>mcs-Msg3-Repetitions</em>
is configured. The UE shall use the determined <em>I<sub>MCS</sub></em>
and Table 5.1.3.1-1 to determine the modulation order
(<em>Q<sub>m</sub></em>) and Target code rate (<em>R</em>) used in the
physical uplink shared channel.</p>
<p>- else</p>
<p>- the UE shall use <em>I<sub>MCS</sub></em> and Table 5.1.3.1-1 to
determine the modulation order (<em>Q<sub>m</sub></em>) and Target code
rate (<em>R</em>) used in the physical uplink shared channel.</p>
<p>else</p>
<p>- if <em>mcs-TableTransformPrecoderDCI-0-2</em> in
<em>pusch-Config</em> is set to 'qam256', and PUSCH is scheduled by a
PDCCH with DCI format 0_2 with CRC scrambled by C-RNTI or
SP-CSI-RNTI,</p>
<p>- the UE shall use <em>I<sub>MCS</sub></em> and Table 5.1.3.1.-2 to
determine the modulation order (<em>Q<sub>m</sub></em>) and Target code
rate (<em>R</em>) used in the physical uplink shared channel.</p>
<p>- elseif the UE is not configured with MCS-C-RNTI,
<em>mcs-TableTransformPrecoderDCI-0-2</em> in <em>pusch-Config</em> is
set to 'qam64LowSE', and the PUSCH is scheduled by a PDCCH with DCI
format 0_2 with CRC scrambled by C-RNTI or SP-CSI-RNTI,</p>
<p>- the UE shall use <em>I<sub>MCS</sub></em> and Table 6.1.4.1-2 to
determine the modulation order (<em>Q<sub>m</sub></em>) and Target code
rate (<em>R</em>) used in the physical uplink shared channel.</p>
<p>- elseif <em>mcs-TableTransformPrecoder</em> in <em>pusch-Config</em>
is set to 'qam256', and PUSCH is scheduled by a PDCCH with DCI format
0_1 with CRC scrambled by C-RNTI or SP-CSI-RNTI,</p>
<p>- the UE shall use <em>I<sub>MCS</sub></em> and Table 5.1.3.1.-2 to
determine the modulation order (<em>Q<sub>m</sub></em>) and Target code
rate (<em>R</em>) used in the physical uplink shared channel.</p>
<p>- elseif the UE is not configured with MCS-C-RNTI,
<em>mcs-TableTransformPrecoder</em> in <em>pusch-Config</em> is set to
'qam64LowSE', and the PUSCH is scheduled by a PDCCH with a DCI format
other than DCI format 0_2 in a UE-specific search space with CRC
scrambled by C-RNTI or SP-CSI-RNTI,</p>
<blockquote>
<p>- the UE shall use <em>I<sub>MCS</sub></em> and Table 6.1.4.1-2 to
determine the modulation order (<em>Q<sub>m</sub></em>) and Target code
rate (<em>R</em>) used in the physical uplink shared channel.</p>
</blockquote>
<p>- elseif the UE is configured with MCS-C-RNTI, and the PUSCH is
scheduled by a PDCCH with CRC scrambled by MCS-C-RNTI,</p>
<blockquote>
<p>- the UE shall use <em>I<sub>MCS</sub></em> and Table 6.1.4.1-2 to
determine the modulation order (<em>Q<sub>m</sub></em>) and Target code
rate (<em>R</em>) used in the physical uplink shared channel.</p>
</blockquote>
<p>- elseif <em>mcs-TableTransformPrecoder</em> in
<em>configuredGrantConfig</em> is set to 'qam256',</p>
<p>- if PUSCH is scheduled by a PDCCH with CRC scrambled by CS-RNTI
or</p>
<p>- if PUSCH is transmitted with configured grant,</p>
<p>- the UE shall use <em>I<sub>MCS</sub></em> and Table 5.1.3.1-2 to
determine the modulation order (<em>Q<sub>m</sub></em>) and Target code
rate (<em>R</em>) used in the physical uplink shared channel.</p>
<p>- elseif <em>mcs-TableTransformPrecoder</em> in
<em>configuredGrantConfig</em> is set to 'qam64LowSE',</p>
<p>- if PUSCH is scheduled by a PDCCH with CRC scrambled by CS-RNTI
or</p>
<p>- if PUSCH is transmitted with configured grant,</p>
<p>- the UE shall use <em>I<sub>MCS</sub></em> and Table 6.1.4.1-2 to
determine the modulation order (<em>Q<sub>m</sub></em>) and Target code
rate (<em>R</em>) used in the physical uplink shared channel.</p>
<p>- elseif for a MsgA PUSCH transmission,</p>
<p>- the UE shall use higher layer parameter <em>MsgA-MCS</em> for
<em>I<sub>MCS</sub></em> and Table 6.1.4.1-1 to determine the Target
code rate (<em>R</em>) used in the physical uplink shared channel.</p>
<p>- the UE shall use <em>q=2</em> for determining modulation order
<em>Q<sub>m</sub></em> in Table 6.1.4.1-1.</p>
<p>- elseif the UE requests repetition of PUSCH scheduled by RAR UL
grant [10, TS 38.321], when transmitting PUSCH scheduled by RAR UL
grant,</p>
<p>- the 2 LSBs of the MCS information field of the RAR UL grant provide
a codepoint to determine the MCS index <em>I<sub>MCS</sub></em>
according to Table 6.1.4.1-3, based on whether or not the higher layer
parameter <em>mcs-Msg3-Repetitions</em> is configured. The UE shall use
the determined <em>I<sub>MCS</sub></em> and Table 6.1.4.1-1 to determine
the modulation order (<em>Q<sub>m</sub></em>) and Target code rate
(<em>R</em>) used in the physical uplink shared channel.</p>
<p>- elseif the UE requests repetition of PUSCH scheduled by RAR UL
grant [10, TS 38.321], when transmitting PUSCH scheduled by DCI format
0_0 with CRC scrambled by the TC-RNTI,</p>
<p>- the 3 LSBs of the MCS information field of the DCI format 0_0 with
CRC scrambled by the TC-RNTI provide a codepoint to determine the MCS
index <em>I<sub>MCS</sub></em> according to Table 6.1.4.1-4, based on
whether or not the higher layer parameter <em>mcs-Msg3-Repetitions</em>
is configured. The UE shall use the determined <em>I<sub>MCS</sub></em>
and Table 6.1.4.1-1 to determine the modulation order
(<em>Q<sub>m</sub></em>) and Target code rate (<em>R</em>) used in the
physical uplink shared channel.</p>
<p>- else</p>
<p>- the UE shall use <em>I<sub>MCS</sub></em> and Table 6.1.4.1-1to
determine the modulation order (<em>Q<sub>m</sub></em>) and Target code
rate (<em>R</em>) used in the physical uplink shared channel.</p>
<p>end</p>
<p>For Table 6.1.4.1-1 and Table 6.1.4.1-2, if higher layer parameter
<em>tp-pi2BPSK</em> is configured, <em>q</em> = 1 otherwise
<em>q</em>=2.</p>
<p>Table 6.1.4.1-1: MCS index table for PUSCH with transform precoding
and 64QAM</p>
<table>
<colgroup>
<col style="width: 14%" />
<col style="width: 22%" />
<col style="width: 32%" />
<col style="width: 30%" />
</colgroup>
<thead>
<tr>
<th>MCS Index<br />
<em>I<sub>MCS</sub></em></th>
<th>Modulation Order<br />
<em>Q<sub>m</sub></em></th>
<th>Target code Rate R x 1024</th>
<th><p>Spectral</p>
<p>efficiency</p></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>0</strong></td>
<td>q</td>
<td>240/ q</td>
<td>0.2344</td>
</tr>
<tr>
<td><strong>1</strong></td>
<td>q</td>
<td>314/ q</td>
<td>0.3066</td>
</tr>
<tr>
<td><strong>2</strong></td>
<td>2</td>
<td>193</td>
<td>0.3770</td>
</tr>
<tr>
<td><strong>3</strong></td>
<td>2</td>
<td>251</td>
<td>0.4902</td>
</tr>
<tr>
<td><strong>4</strong></td>
<td>2</td>
<td>308</td>
<td>0.6016</td>
</tr>
<tr>
<td><strong>5</strong></td>
<td>2</td>
<td>379</td>
<td>0.7402</td>
</tr>
<tr>
<td><strong>6</strong></td>
<td>2</td>
<td>449</td>
<td>0.8770</td>
</tr>
<tr>
<td><strong>7</strong></td>
<td>2</td>
<td>526</td>
<td>1.0273</td>
</tr>
<tr>
<td><strong>8</strong></td>
<td>2</td>
<td>602</td>
<td>1.1758</td>
</tr>
<tr>
<td><strong>9</strong></td>
<td>2</td>
<td>679</td>
<td>1.3262</td>
</tr>
<tr>
<td><strong>10</strong></td>
<td><del>4</del></td>
<td>340</td>
<td>1.3281</td>
</tr>
<tr>
<td><strong>11</strong></td>
<td>4</td>
<td>378</td>
<td>1.4766</td>
</tr>
<tr>
<td><strong>12</strong></td>
<td>4</td>
<td>434</td>
<td>1.6953</td>
</tr>
<tr>
<td><strong>13</strong></td>
<td>4</td>
<td>490</td>
<td>1.9141</td>
</tr>
<tr>
<td><strong>14</strong></td>
<td>4</td>
<td>553</td>
<td>2.1602</td>
</tr>
<tr>
<td><strong>15</strong></td>
<td>4</td>
<td>616</td>
<td>2.4063</td>
</tr>
<tr>
<td><strong>16</strong></td>
<td>4</td>
<td>658</td>
<td>2.5703</td>
</tr>
<tr>
<td><strong>17</strong></td>
<td>6</td>
<td>466</td>
<td>2.7305</td>
</tr>
<tr>
<td><strong>18</strong></td>
<td>6</td>
<td>517</td>
<td>3.0293</td>
</tr>
<tr>
<td><strong>19</strong></td>
<td>6</td>
<td>567</td>
<td>3.3223</td>
</tr>
<tr>
<td><strong>20</strong></td>
<td>6</td>
<td>616</td>
<td>3.6094</td>
</tr>
<tr>
<td><strong>21</strong></td>
<td>6</td>
<td>666</td>
<td>3.9023</td>
</tr>
<tr>
<td><strong>22</strong></td>
<td>6</td>
<td>719</td>
<td>4.2129</td>
</tr>
<tr>
<td><strong>23</strong></td>
<td>6</td>
<td>772</td>
<td>4.5234</td>
</tr>
<tr>
<td><strong>24</strong></td>
<td>6</td>
<td>822</td>
<td>4.8164</td>
</tr>
<tr>
<td><strong>25</strong></td>
<td>6</td>
<td>873</td>
<td>5.1152</td>
</tr>
<tr>
<td><strong>26</strong></td>
<td>6</td>
<td>910</td>
<td>5.3320</td>
</tr>
<tr>
<td><strong>27</strong></td>
<td>6</td>
<td>948</td>
<td>5.5547</td>
</tr>
<tr>
<td><strong>28</strong></td>
<td>q</td>
<td colspan="2">reserved</td>
</tr>
<tr>
<td><strong>29</strong></td>
<td>2</td>
<td colspan="2">reserved</td>
</tr>
<tr>
<td><strong>30</strong></td>
<td>4</td>
<td colspan="2">reserved</td>
</tr>
<tr>
<td><strong>31</strong></td>
<td>6</td>
<td colspan="2">reserved</td>
</tr>
</tbody>
</table>
<p>Table 6.1.4.1-2: MCS index table 2 for PUSCH with transform precoding
and 64QAM</p>
<table>
<colgroup>
<col style="width: 14%" />
<col style="width: 22%" />
<col style="width: 32%" />
<col style="width: 30%" />
</colgroup>
<thead>
<tr>
<th>MCS Index<br />
<em>I<sub>MCS</sub></em></th>
<th>Modulation Order<br />
<em>Q<sub>m</sub></em></th>
<th>Target code Rate R x 1024</th>
<th><p>Spectral</p>
<p>efficiency</p></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>0</strong></td>
<td><em>q</em></td>
<td>60/<em>q</em></td>
<td>0.0586</td>
</tr>
<tr>
<td><strong>1</strong></td>
<td><em>q</em></td>
<td>80/<em>q</em></td>
<td>0.0781</td>
</tr>
<tr>
<td><strong>2</strong></td>
<td><em>q</em></td>
<td>100/<em>q</em></td>
<td>0.0977</td>
</tr>
<tr>
<td><strong>3</strong></td>
<td><em>q</em></td>
<td>128/<em>q</em></td>
<td>0.1250</td>
</tr>
<tr>
<td><strong>4</strong></td>
<td><em>q</em></td>
<td>156/<em>q</em></td>
<td>0.1523</td>
</tr>
<tr>
<td><strong>5</strong></td>
<td><em>q</em></td>
<td>198/<em>q</em></td>
<td>0.1934</td>
</tr>
<tr>
<td><strong>6</strong></td>
<td>2</td>
<td>120</td>
<td> 0.2344</td>
</tr>
<tr>
<td><strong>7</strong></td>
<td>2</td>
<td>157</td>
<td> 0.3066</td>
</tr>
<tr>
<td><strong>8</strong></td>
<td>2</td>
<td>193</td>
<td> 0.3770</td>
</tr>
<tr>
<td><strong>9</strong></td>
<td>2</td>
<td>251</td>
<td> 0.4902</td>
</tr>
<tr>
<td><strong>10</strong></td>
<td>2</td>
<td>308</td>
<td> 0.6016</td>
</tr>
<tr>
<td><strong>11</strong></td>
<td>2</td>
<td>379</td>
<td> 0.7402</td>
</tr>
<tr>
<td><strong>12</strong></td>
<td>2</td>
<td>449</td>
<td> 0.8770</td>
</tr>
<tr>
<td><strong>13</strong></td>
<td>2</td>
<td>526</td>
<td> 1.0273</td>
</tr>
<tr>
<td><strong>14</strong></td>
<td>2</td>
<td>602</td>
<td> 1.1758</td>
</tr>
<tr>
<td><strong>15</strong></td>
<td>2</td>
<td>679</td>
<td>1.3262</td>
</tr>
<tr>
<td><strong>16</strong></td>
<td>4</td>
<td>378</td>
<td>1.4766</td>
</tr>
<tr>
<td><strong>17</strong></td>
<td>4</td>
<td>434</td>
<td> 1.6953</td>
</tr>
<tr>
<td><strong>18</strong></td>
<td>4</td>
<td>490</td>
<td> 1.9141</td>
</tr>
<tr>
<td><strong>19</strong></td>
<td>4</td>
<td>553</td>
<td> 2.1602</td>
</tr>
<tr>
<td><strong>20</strong></td>
<td>4</td>
<td>616</td>
<td> 2.4063</td>
</tr>
<tr>
<td><strong>21</strong></td>
<td>4</td>
<td>658</td>
<td>2.5703</td>
</tr>
<tr>
<td><strong>22</strong></td>
<td>4</td>
<td>699</td>
<td> 2.7305</td>
</tr>
<tr>
<td><strong>23</strong></td>
<td>4</td>
<td>772</td>
<td> 3.0156</td>
</tr>
<tr>
<td><strong>24</strong></td>
<td>6</td>
<td>567</td>
<td> 3.3223</td>
</tr>
<tr>
<td><strong>25</strong></td>
<td>6</td>
<td>616</td>
<td> 3.6094</td>
</tr>
<tr>
<td><strong>26</strong></td>
<td>6</td>
<td>666</td>
<td> 3.9023</td>
</tr>
<tr>
<td><strong>27</strong></td>
<td>6</td>
<td>772</td>
<td> 4.5234</td>
</tr>
<tr>
<td><strong>28</strong></td>
<td>q</td>
<td colspan="2">reserved</td>
</tr>
<tr>
<td><strong>29</strong></td>
<td>2</td>
<td colspan="2">reserved</td>
</tr>
<tr>
<td><strong>30</strong></td>
<td>4</td>
<td colspan="2">reserved</td>
</tr>
<tr>
<td><strong>31</strong></td>
<td>6</td>
<td colspan="2">reserved</td>
</tr>
</tbody>
</table>
<p>Table 6.1.4.1-3: MCS index <em>I<sub>MCS</sub></em> as a function of
2 LSBs of MCS information field in RAR UL grant</p>
<table>
<colgroup>
<col style="width: 24%" />
<col style="width: 24%" />
<col style="width: 3%" />
<col style="width: 23%" />
<col style="width: 23%" />
</colgroup>
<thead>
<tr>
<th colspan="2"><em>mcs-Msg3-Repetitions is configured</em></th>
<th></th>
<th colspan="2"><em>mcs-Msg3-Repetitions is not configured</em></th>
</tr>
</thead>
<tbody>
<tr>
<td><em>Codepoint</em></td>
<td><em>I<sub>MCS</sub></em></td>
<td></td>
<td>Codepoint</td>
<td><em>I<sub>MCS</sub></em></td>
</tr>
<tr>
<td>00</td>
<td>First value of <em>mcs-Msg3-Repetitions</em></td>
<td></td>
<td>00</td>
<td>0</td>
</tr>
<tr>
<td>01</td>
<td>Second value of <em>mcs-Msg3-Repetitions</em></td>
<td></td>
<td>01</td>
<td>1</td>
</tr>
<tr>
<td>10</td>
<td>Third value of <em>mcs-Msg3-Repetitions</em></td>
<td></td>
<td>10</td>
<td>2</td>
</tr>
<tr>
<td>11</td>
<td>Fourth value of <em>mcs-Msg3-Repetitions</em></td>
<td></td>
<td>11</td>
<td>3</td>
</tr>
</tbody>
</table>
<p>Table 6.1.4.1-4: MCS index <em>I<sub>MCS</sub></em> as a function of
3 LSBs of MCS information field in DCI format 0_0 with CRC scrambled by
the TC-RNTI</p>
<table>
<colgroup>
<col style="width: 24%" />
<col style="width: 24%" />
<col style="width: 3%" />
<col style="width: 23%" />
<col style="width: 23%" />
</colgroup>
<thead>
<tr>
<th colspan="2"><em>mcs-Msg3-Repetitions is configured</em></th>
<th></th>
<th colspan="2"><em>mcs-Msg3-Repetitions is not configured</em></th>
</tr>
</thead>
<tbody>
<tr>
<td><em>Codepoint</em></td>
<td><em>I<sub>MCS</sub></em></td>
<td></td>
<td>Codepoint</td>
<td><em>I<sub>MCS</sub></em></td>
</tr>
<tr>
<td>000</td>
<td>First value of <em>mcs-Msg3-Repetitions</em></td>
<td></td>
<td>000</td>
<td>0</td>
</tr>
<tr>
<td>001</td>
<td>Second value of <em>mcs-Msg3-Repetitions</em></td>
<td></td>
<td>001</td>
<td>1</td>
</tr>
<tr>
<td>010</td>
<td>Third value of <em>mcs-Msg3-Repetitions</em></td>
<td></td>
<td>010</td>
<td>2</td>
</tr>
<tr>
<td>011</td>
<td>Fourth value of <em>mcs-Msg3-Repetitions</em></td>
<td></td>
<td>011</td>
<td>3</td>
</tr>
<tr>
<td>100</td>
<td>Fifth value of <em>mcs-Msg3-Repetitions</em></td>
<td></td>
<td>100</td>
<td>4</td>
</tr>
<tr>
<td>101</td>
<td>Sixth value of <em>mcs-Msg3-Repetitions</em></td>
<td></td>
<td>101</td>
<td>5</td>
</tr>
<tr>
<td>110</td>
<td>Seventh value of <em>mcs-Msg3-Repetitions</em></td>
<td></td>
<td>110</td>
<td>6</td>
</tr>
<tr>
<td>111</td>
<td>Eighth value of <em>mcs-Msg3-Repetitions</em></td>
<td></td>
<td>111</td>
<td>7</td>
</tr>
</tbody>
</table>
<h4 id="transport-block-size-determination-1">6.1.4.2 Transport block
size determination</h4>
<p>For a PUSCH scheduled by RAR UL grant or</p>
<p>for a PUSCH scheduled by fallbackRAR UL grant or</p>
<p>for a PUSCH scheduled by a DCI format 0_0 with CRC scrambled by
C-RNTI, MCS-C-RNTI, TC-RNTI, CS-RNTI, or</p>
<p>for a PUSCH scheduled by a DCI format 0_1 or DCI format 0_2 with CRC
scrambled by C-RNTI, MCS-C-RNTI, CS-RNTI, or</p>
<p>for a PUSCH transmission with configured grant, or</p>
<p>for a MsgA PUSCH transmission,</p>
<p>if</p>
<p>- <img src="media/image746.svg" />and transform precoding is disabled
and Table 5.1.3.1-2 is used, or</p>
<p>- <img src="media/image747.svg" /> and transform precoding is
disabled and a table other than Table 5.1.3.1-2 is used, or</p>
<p>- <img src="media/image748.svg" /> and transform precoding is
enabled, the UE shall first determine the TBS as specified below:</p>
<p>The UE shall first determine the number of REs
(<em>N<sub>RE</sub></em>) within the slot:</p>
<p>- A UE first determines the number of REs allocated for PUSCH within
a PRB <img src="media/image749.svg" /> by</p>
<p>- <img src="media/image750.svg" />, where<img
src="media/image62.svg" /> is the number of subcarriers in the frequency
domain in a physical resource block, <img src="media/image63.svg" />
<span class="math inline">\(N_{symb}^{slot}\)</span>is the number of
symbols <em>L</em> of the PUSCH allocation according to Clause 6.1.2.1
for scheduled PUSCH or Clause 6.1.2.3 for configured PUSCH, <img
src="media/image64.svg" /> is the number of REs for DM-RS per PRB in the
allocated duration including the overhead of the DM-RS CDM groups
without data, as described for PUSCH with a configured grant in Clause
6.1.2.3 or as indicated by DCI format 0_1 or DCI format 0_2 or as
described for DCI format 0_0 in Clause 6.2.2, and <img
src="media/image65.svg" /> is the overhead configured by higher layer
parameter <em>xOverhead</em> in <em>PUSCH-ServingCellConfig</em>. If the
<img src="media/image65.svg" /> is not configured (a value from 6, 12,
or 18), the <img src="media/image65.svg" /> is assumed to be 0. For Msg3
or MsgA PUSCH transmission the <img src="media/image65.svg" /> is always
set to 0. In case of PUSCH repetition Type B, <img
src="media/image64.svg" /> is determined assuming a nominal repetition
with the duration of <em>L</em> symbols without segmentation.</p>
<p>- A UE determines the total number of REs allocated for PUSCH <img
src="media/image751.svg" /> as follows</p>
<p>- For TB processing over multiple slots, <span
class="math inline">\(N_{RE} = N*\min\left( 156,N_{RE}&#39; \right)
\cdot n_{PRB}\)</span> where <img src="media/image752.svg" /> is the
total number of allocated PRBs for the UE and <em>N</em> is the number
of slots used for TBS determination indicated by
<em>numberOfSlotsTBoMS</em>.</p>
<p>- Otherwise, <span class="math inline">\(N_{RE} = \min\left(
156,N_{RE}&#39; \right) \cdot n_{PRB}\)</span>.</p>
<p>- Next, proceed with steps 2-4 as defined in Clause 5.1.3.2</p>
<p>- For a PUSCH scheduled by fallbackRAR UL grant, UE assumes the TB
size determined by the UL grant in the fallbackRAR shall be the same as
the TB size used in the corresponding MsgA PUSCH transmission.</p>
<p>else if</p>
<p>- <img src="media/image753.svg" /> and transform precoding is
disabled and Table 5.1.3.1-2 is used, or</p>
<p>- <img src="media/image753.svg" /> and transform precoding is
enabled,</p>
<p>- the TBS is assumed to be as determined from the DCI transported in
the latest PDCCH for the same transport block using <img
src="media/image754.svg" />. If there is no PDCCH for the same transport
block using <img src="media/image755.svg" />, and if the initial PUSCH
for the same transport block is scheduled by a RAR UL grant, the TBS
shall be determined from the RAR UL grant. If there is no PDCCH for the
same transport block using <img src="media/image755.svg" />, and if the
initial PUSCH for the same transport block is transmitted with
configured grant,</p>
<p>- the TBS shall be determined from <em>configuredGrantConfig</em> for
a configured grant Type 1 PUSCH.</p>
<p>- the TBS shall be determined from the most recent PDCCH scheduling a
configured grant Type 2 PUSCH.</p>
<blockquote>
<p>else</p>
</blockquote>
<p>- the TBS is assumed to be as determined from the DCI transported in
the latest PDCCH for the same transport block using <img
src="media/image756.svg" />. If there is no PDCCH for the same transport
block using <img src="media/image757.svg" />, and if the initial PUSCH
for the same transport block is scheduled by a RAR UL grant, the TBS
shall be determined from the RAR UL grant. If there is no PDCCH for the
same transport block using <img src="media/image757.svg" />, and if the
initial PUSCH for the same transport block is transmitted with
configured grant,</p>
<p>- the TBS shall be determined from <em>configuredGrantConfig</em> for
a configured grant Type 1 PUSCH.</p>
<p>- the TBS shall be determined from the most recent PDCCH scheduling a
configured grant Type 2 PUSCH.</p>
<h3 id="code-block-group-based-pusch-transmission">6.1.5 Code block
group based PUSCH transmission</h3>
<h4
id="ue-procedure-for-grouping-of-code-blocks-to-code-block-groups-1">6.1.5.1
UE procedure for grouping of code blocks to code block groups</h4>
<p>If a UE is configured to transmit code block group (CBG) based
transmissions by receiving the higher layer parameter
<em>codeBlockGroupTransmission</em> in <em>PUSCH-ServingCellConfig</em>,
the UE shall determine the number of CBGs for a PUSCH transmission
as</p>
<p><img src="media/image105.svg" />,</p>
<p>where <em>N</em> is the maximum number of CBGs per transport block as
configured by <em>maxCodeBlockGroupsPerTransportBlock</em> in
<em>PUSCH-ServingCellConfig</em>, and <em>C</em> is the number of code
blocks in the PUSCH according to the procedure defined in Clause 6.2.3
of [5, TS 38.212].</p>
<p>Define <img src="media/image106.svg" />, <img
src="media/image107.svg" />, and <img src="media/image108.svg" />.</p>
<p>If <img src="media/image109.svg" />, CBG <em>m</em>, <img
src="media/image758.svg" />, consists of code blocks with indices <img
src="media/image111.svg" />. CBG <em>m</em>, <img
src="media/image112.svg" />, consists of code blocks with indices <img
src="media/image113.svg" />.</p>
<h4
id="ue-procedure-for-transmitting-code-block-group-based-transmissions">6.1.5.2
UE procedure for transmitting code block group based transmissions</h4>
<p>If a UE is configured to transmit code block group-based
transmissions by receiving the higher layer parameter
<em>codeBlockGroupTransmission</em> in
<em>PUSCH-ServingCellConfig</em>,</p>
<p>- For an initial transmission of a TB as indicated by the '<em>New
Data Indicator'</em> field of the scheduling DCI, the UE may expect that
the <em>CBGTI</em> field indicates all the CBGs of the TB are to be
transmitted, and the UE shall include all the code block groups of the
TB.</p>
<p>- For a retransmission of a TB as indicated by the '<em>New Data
Indicator'</em> field of the scheduling DCI, the UE shall include only
the CBGs indicated by the <em>CBGTI</em> field of the scheduling
DCI.</p>
<p>A bit value of '0' in the <em>CBGTI</em> field indicates that the
corresponding CBG is not to be transmitted and '1' indicates that it is
to be transmitted. The order of <em>CBGTI</em> field bits is such that
the CBGs are mapped in order from CBG#0 onwards starting from the
MSB.</p>
<h3 id="uplink-switching">6.1.6 Uplink switching</h3>
<p>The UE may omit uplink transmission during the uplink switching gap
<span class="math inline">\(N_{\text{Tx1-Tx2}}\)</span> if the
conditions defined in this clause are met and the UE is configured with
<em>uplinkTxSwitching</em>. The switching gap <span
class="math inline">\(N_{\text{Tx1-Tx2}}\)</span> is indicated by UE
capability <em>uplinkTxSwitchingPeriod2T2T</em> if
<em>uplinkTxSwitching-2T-Mode</em> is configured, and
<em>uplinkTxSwitchingPeriod</em> otherwise:</p>
<p>- If a UE indicated a capability for uplink switching with
<em>BandCombination-UplinkTxSwitch</em> for a band combination, and if
it is for that band combination</p>
<p>- Configured with a MCG using E-UTRA radio access and with a SCG
using NR radio access (EN-DC), or</p>
<p>- Configured with uplink carrier aggregation, or</p>
<p>- Configured in a serving cell with two uplink carriers with higher
layer parameter <em>supplementaryUplink</em>.</p>
<p>The conditions under which the switching gap may be present are
defined for each of the cases in clauses 6.1.6.1, 6.1.6.2, and 6.1.6.3
respectively.</p>
<p>If an uplink switching is triggered for an uplink transmission
starting at <em>T<sub>0</sub></em>, after
<em>T<sub>0</sub>-T<sub>offset</sub></em>, the UE is not expected to
cancel the uplink switching, or to trigger any other new uplink
switching occurring before <em>T<sub>0</sub></em> for any other uplink
transmission that is scheduled after
<em>T<sub>0</sub>-T<sub>offset</sub></em>, where
<em>T<sub>offset</sub></em> is the UE processing procedure time defined
for the uplink transmission triggering the switch given in clause 5.3,
clause 5.4, clause 6.2.1, clause 6.4 and in clause 9 of [6, TS
38.213].</p>
<p>The UE does not expect to perform more than one uplink switching in a
slot with <em>µ<sub>UL </sub></em>= max(<em>µ<sub>UL, 1,</sub> µ<sub>UL,
2</sub></em>), where the <em>µ<sub>UL, 1</sub></em> corresponds to the
subcarrier spacing of the active UL BWP of one uplink carrier before the
switching gap and the <em>µ<sub>UL, 2</sub></em> corresponds to the
subcarrier spacing of the active UL BWP of the other uplink carrier
after the switching gap.</p>
<h4 id="uplink-switching-for-en-dc">6.1.6.1 Uplink switching for
EN-DC</h4>
<p>For a UE indicating a capability for uplink switching with
<em>BandCombination-UplinkTxSwitch</em> for a band combination, and if
it is for that band combination configured with a MCG using E-UTRA radio
access and with a SCG using NR radio access (EN-DC), if the UE is
configured with uplink switching with parameter
<em>uplinkTxSwitching</em>,</p>
<p>- for the UE configured with <em>switchedUL</em> by the parameter
<em>uplinkTxSwitchingOption</em>, when the UE is to transmit in the
uplink based on DCI(s) received before <span
class="math inline">\(\mathbf{T}_{\text{0}}\mathbf{-}\mathbf{T}_{\mathbf{offset}}\)</span>
or based on a higher layer configuration(s):</p>
<p>- when the UE is to transmit an NR uplink that takes place after an
E-UTRA uplink on another uplink carrier then the UE is not expected to
transmit for the duration of <span
class="math inline">\(N_{\text{Tx1-Tx2}}\)</span> on any of the two
carriers.</p>
<p>- when the UE is to transmit an E-UTRA uplink that takes place after
an NR uplink on another uplink carrier then the UE is not expected to
transmit for the duration of <span
class="math inline">\(N_{\text{Tx1-Tx2}}\)</span> on any of the two
carriers.</p>
<p>- the UE is not expected to transmit simultaneously on the NR uplink
and the E-UTRA uplink. If the UE is scheduled or configured to transmit
any NR uplink transmission overlapping with an E-UTRA uplink
transmission, the NR uplink transmission is dropped,</p>
<p>- for the UE configured with <em>uplinkTxSwitchingOption</em> set to
'dualUL'<em>,</em> when the UE is to transmit in the uplink based on
DCI(s) received before <span
class="math inline">\(\mathbf{T}_{\text{0}}\mathbf{-}\mathbf{T}_{\mathbf{offset}}\)</span>
or based on a higher layer configuration(s):</p>
<p>- when the UE is to transmit an NR two-port uplink that takes place
after an E-UTRA uplink on another uplink carrier then the UE is not
expected to transmit for the duration of <span
class="math inline">\(N_{\text{Tx1-Tx2}}\)</span> on any of the two
carriers.</p>
<p>- when the UE is to transmit an E-UTRA uplink that takes place after
an NR two-port uplink on another uplink carrier then the UE is not
expected to transmit for the duration of <span
class="math inline">\(N_{\text{Tx1-Tx2}}\)</span> on any of the two
carriers.</p>
<p>- the UE is not expected to transmit simultaneously a two- port
transmission on the NR uplink and the E-UTRA uplink.</p>
<p>- in all other cases the UE is expected to transmit normally all
uplink transmissions without interruptions.</p>
<p>- when the UE is configured with <em>tdm-PatternConfig</em> or by
<em>tdm-PatternConfig2</em></p>
<p>- for the E-UTRA subframes designated as uplink by the configuration,
the UE assumes the operation state in which one-port E-UTRA uplink can
be transmitted.</p>
<p>- for the E-UTRA subframes other than the ones designated as uplink
by the configuration, the UE assumes the operation state in which
two-port NR uplink can be transmitted.</p>
<h4 id="uplink-switching-for-carrier-aggregation">6.1.6.2 Uplink
switching for carrier aggregation</h4>
<p>For a UE indicating a capability for uplink switching with
<em>BandCombination-UplinkTxSwitch</em> or
<em>uplinkTxSwitchingPeriod2T2T</em> for a band combination, and if it
is for that band combination configured with uplink carrier
aggregation:</p>
<p>- If the UE is configured with uplink switching with parameter
<em>uplinkTxSwitching</em>, when the UE is to transmit in the uplink
based on DCI(s) received before <span
class="math inline">\(\mathbf{T}_{\text{0}}\mathbf{-}\mathbf{T}_{\mathbf{offset}}\)</span>
or based on a higher layer configuration(s):</p>
<p>- When the UE is to transmit a 2-port transmission on one uplink
carrier on one band and if the preceding uplink transmission is a 1-port
transmission on another uplink carrier on another band, then the UE is
not expected to transmit for the duration of <span
class="math inline">\(N_{\text{Tx1-Tx2}}\)</span> on any of the
carriers.</p>
<p>- When the UE is to transmit a 1-port transmission on one uplink
carrier on one band and if the preceding uplink transmission is a 2-port
transmission on another uplink carrier on another band, then the UE is
not expected to transmit for the duration of <span
class="math inline">\(N_{\text{Tx1-Tx2}}\)</span> on any of the
carriers.</p>
<p>- For the UE configured with <em>uplinkTxSwitchingOption</em> set to
'switchedUL', when the UE is to transmit a 1-port transmission on one
uplink carrier on one band and if the preceding uplink transmission was
a 1-port transmission on another uplink carrier on another band, then
the UE is not expected to transmit for the duration of <span
class="math inline">\(N_{\text{Tx1-Tx2}}\)</span> on any of the
carriers.</p>
<p>- For the UE configured with <em>uplinkTxSwitchingOption</em> set to
'dualUL', when the UE is to transmit a 2-port transmission on one uplink
carrier on one band and if the preceding uplink transmission was a
1-port transmission on a carrier on the same band and the UE is under
the operation state in which 2-port transmission cannot be supported in
the same band, then the UE is not expected to transmit for the duration
of <span class="math inline">\(N_{\text{Tx1-Tx2}}\)</span> on any of the
carriers.</p>
<p>- For the UE configured with <em>uplinkTxSwitchingOption</em> set to
'dualUL', when the UE is to transmit a 1-port transmission on one uplink
carrier on one band and if the preceding uplink transmission was a
1-port transmission on another uplink carrier on another band and the UE
is under the operation state in which 2-port transmission can be
supported in the same band, then the UE is not expected to transmit for
the duration of <span class="math inline">\(N_{\text{Tx1-Tx2}}\)</span>
on any of the carriers.</p>
<p>- For the UE configured with <em>uplinkTxSwitchingOption</em> set to
'dualUL', if the UE is configured with
<em>uplinkTxSwitching-DualUL-TxState</em> set to 'oneT', when the UE is
under the operation state in which 2-port transmission can be supported
on one carrier on one band followed by no transmission on any carrier on
the same band and 1-port transmission on the other carrier on another
band the UE shall consider this as if 1-port transmission was
transmitted on both uplinks, otherwise the UE shall consider this as if
2-port transmission took place on the transmitting carrier.</p>
<p>- If <em>uplinkTxSwitching-2T-Mode</em> is configured, when the UE is
to transmit a 2-port transmission on one uplink carrier on one band and
if the preceding uplink transmission is a 2-port transmission on another
uplink carrier on another band, then the UE is not expected to transmit
for the duration of <span
class="math inline">\(N_{\text{Tx1-Tx2}}\)</span> on any of the
carriers.</p>
<p>- The UE is not expected to be scheduled or configured with uplink
transmissions that result in simultaneous transmission on two antenna
ports on one uplink carrier on one band, and any transmission on another
uplink carrier on another band.</p>
<p>- In all other cases the UE is expected to transmit normally all
uplink transmissions without interruptions.</p>
<h5 id="void-2">6.1.6.2.1 void</h5>
<h4 id="uplink-switching-for-supplementary-uplink">6.1.6.3 Uplink
switching for supplementary uplink</h4>
<p>For a UE indicating a capability for uplink switching with
<em>BandCombination-UplinkTxSwitch</em> for a band combination, and if
it is for that band combination configured in a serving cell with two
uplink carriers with higher layer parameter
<em>supplementaryUplink</em>:</p>
<p>- If the UE is configured with uplink switching with parameter
<em>uplinkTxSwitching</em>,</p>
<p>- If the UE is to transmit any uplink channel or signal on a
different uplink on a different band from the preceding transmission
occasion based on DCI(s) received before <span
class="math inline">\(\mathbf{T}_{\text{0}}\mathbf{-}\mathbf{T}_{\mathbf{offset}}\)</span>
or based on a higher layer configuration(s), then the UE assumes that an
uplink switching is triggered in a duration of switching gap <span
class="math inline">\(\mathbf{N}_{\text{Tx1-Tx2}}\)</span>, where <span
class="math inline">\(\mathbf{T}_{\text{0}}\)</span> is the start time
of the first symbol of the transmission occasion of the uplink channel
or signal and <span
class="math inline">\(\mathbf{T}_{\mathbf{offset}}\)</span> is the
preparation procedure time of the transmission occasion of the uplink
channel or signal given in clause 5.3, clause 5.4, clause 6.2.1, clause
6.4 and in clause 9 of [6, TS 38.213], respectively. During the
switching gap <span
class="math inline">\(\mathbf{N}_{\text{Tx1-Tx2}}\)</span>, the UE is
not expected to transmit on any of the two uplinks.</p>
<p>- In all other cases the UE is expected to transmit normally all
uplink transmissions without interruptions.</p>
<h3
id="ue-procedure-for-determining-time-domain-windows-for-bundling-dm-rs">6.1.7
UE procedure for determining time domain windows for bundling DM-RS</h3>
<p>For PUSCH transmissions of PUSCH repetition Type A scheduled by DCI
format 0_1 or 0_2, PUSCH repetition Type A with a configured grant,
PUSCH repetition Type B and TB processing over multiple slots, when
<em>pusch-DMRS-Bundling</em> is enabled, and for PUCCH transmissions of
PUCCH repetition, when <em>PUCCH-DMRS-Bundling</em> is enabled, the UE
determines one or multiple nominal TDWs, as follows:</p>
<p>- For PUSCH transmissions of repetition Type A, PUSCH repetition Type
B and TB processing over multiple slots, the duration of each nominal
TDW except the last nominal TDW, in number of consecutive slots, is:</p>
<p>- Given by <em>pusch-TimeDomainWindowLength</em>, if configured.</p>
<p>- Computed as min (<em>maxDurationDMRS-Bundling</em>, M), if
<em>pusch-TimeDomainWindowLength</em> is not configured, where
<em>maxDurationDMRS-Bundling</em> is maximum duration for a nominal TDW
subject to UE capability [13, TS 38.306], M is the time duration in
consecutive slots of <span class="math inline">\(N \bullet K\)</span>
PUSCH transmissions, and where:</p>
<p>- For PUSCH transmissions of PUSCH repetition Type A, N=1 and K is
the number of repetitions, as defined in Clause 6.1.2.1 or in Clause
6.1.2.3.</p>
<p>- For PUSCH transmissions of PUSCH repetition Type B, N=1 and K is
the number of nominal repetitions, as defined in Clause 6.1.2.1 or in
Clause 6.1.2.3.</p>
<p>- For PUSCH transmissions of TB processing over multiple slots, N is
the number of slots used for TBS determination and K is the number of
repetitions of the number of slots N used for TBS determination, as
defined in Clause 6.1.2.1 or in Clause 6.1.2.3.</p>
<p>- For PUCCH transmissions of PUCCH repetition, the duration of each
nominal TDW except the last nominal TDW, in number of consecutive slots,
is:</p>
<p>- Given by <em>pucch-TimeDomainWindowLength</em>, if configured.</p>
<p>- Computed as min (<em>maxDurationDMRS-Bundling</em>, M), if
<em>pucch-TimeDomainWindowLength</em> is not configured, where
<em>maxDurationDMRS-Bundling</em> is maximum duration for a nominal TDW
subject to UE capability [13, TS 38.306], M is the time duration in
consecutive slots from the first slot determined for PUCCH transmissions
of PUCCH repetition to the last slot determined for PUCCH transmissions
of PUCCH repetition according to clause 9.2.6 of [6, TS 38.213].</p>
<p>- For PUSCH transmission of a PUSCH repetition Type A scheduled by
DCI format 0_1 or 0_2 and PUSCH repetition Type A with a configured
grant, when <em>AvailableSlotCounting</em> is enabled, and for TB
processing over multiple slots:</p>
<p>- The start of the first nominal TDW is the first slot determined for
the first PUSCH transmission.</p>
<p>- The end of the last nominal TDW is the last slot determined for the
last PUSCH transmission.</p>
<p>- The start of any other nominal TDWs is the first slot determined
for PUSCH transmission after the last slot determined for PUSCH
transmission of a previous nominal TDW.</p>
<p>- For PUSCH transmissions of a PUSCH repetition type A scheduled by
DCI format 0_1 or 0_2 and PUSCH repetition Type A with a configured
grant, when the UE is not configured with <em>AvailableSlotCounting</em>
or when <em>AvailableSlotCounting</em> is disabled, and for PUSCH
repetition type B:</p>
<p>- The start of the first nominal TDW is the first slot for the first
PUSCH transmission.</p>
<p>- The end of the last nominal TDW is the last slot for the last PUSCH
transmission.</p>
<p>- The start of any other nominal TDWs is the first slot after the
last slot of a previous nominal TDW.</p>
<p>- For PUCCH transmissions of a PUCCH repetition:</p>
<p>- The start of the first nominal TDW is the first slot determined for
the first PUCCH transmission.</p>
<p>- The end of the last nominal TDW is the last slot determined for the
last PUCCH transmission.</p>
<p>- The start of any other nominal TDWs is the first slot determined
for PUCCH transmission after the last slot determined for PUCCH
transmission of a previous nominal TDW.</p>
<p>For PUSCH transmissions of a PUSCH repetition Type A scheduled by DCI
format 0_1 or 0_2, PUSCH repetition Type A with a configured grant,
PUSCH repetition Type B and TB processing over multiple slots, a nominal
TDW consists of one or multiple actual TDWs. The UE determines the
actual TDWs as follows:</p>
<p>- The start of the first actual TDW is the first symbol of the first
PUSCH transmission in a slot for PUSCH transmission of PUSCH repetition
type A scheduled by DCI format 0_1 or 0_2, or PUSCH repetition Type A
with a configured grant, or PUSCH repetition type B or TB processing
over multiple slots within the nominal TDW.</p>
<p>- The end of an actual TDW is</p>
<p>- The last symbol of the last PUSCH transmission in a slot for PUSCH
transmission of PUSCH repetition type A scheduled by DCI format 0_1 or
0_2, or PUSCH repetition Type A with a configured grant, or PUSCH
repetition type B or TB processing over multiple slots within the
nominal TDW, if the actual TDW reaches the end of the last PUSCH
transmission within the nominal TDW.</p>
<p>- The last symbol of a PUSCH transmission before the event, if an
event occurs which causes power consistency and phase continuity not to
be maintained across PUSCH transmissions of PUSCH repetition type A
scheduled by DCI format 0_1 or 0_2, or PUSCH repetition Type A with a
configured grant, or PUSCH repetition type B or TB processing over
multiple slots within the nominal TDW, and the PUSCH transmission is in
a slot for PUSCH transmission of PUSCH repetition type A scheduled by
DCI format 0_1 or 0_2, or PUSCH repetition Type A with a configured
grant, or PUSCH repetition type B or TB processing over multiple
slots.</p>
<p>- When <em>pusch-WindowRestart</em> is enabled, the start of a new
actual TDW is the first symbol of the PUSCH transmission after the event
which causes power consistency and phase continuity not to be maintained
across PUSCH transmissions of PUSCH repetition type A scheduled by DCI
format 0_1 or 0_2, or PUSCH repetition Type A with a configured grant,
or PUSCH repetition type B or TB processing over multiple slots within
the nominal TDW, and the PUSCH transmission is in a slot for PUSCH
transmission of PUSCH repetition type A scheduled by DCI format 0_1 or
0_2, or PUSCH repetition Type A with a configured grant, or PUSCH
repetition type B or TB processing over multiple slots.</p>
<p>For PUCCH transmissions of PUCCH repetition, a nominal TDW consists
of one or multiple actual TDWs. The UE determines the actual TDWs as
follows:</p>
<p>- The start of the first actual TDW is the first symbol of the first
PUCCH transmission in a slot determined for PUCCH transmission within
the nominal TDW.</p>
<p>- The end of an actual TDW is</p>
<p>- The last symbol of the last PUCCH transmission in a slot determined
for transmission of the PUCCH within the nominal TDW, if the actual TDW
reaches the end of the last PUCCH transmission within the nominal
TDW.</p>
<p>- The last symbol of a PUCCH transmission before the event, if an
event occurs which causes power consistency and phase continuity not be
maintained across PUCCH transmissions of PUCCH repetition within the
nominal TDW, and the PUCCH transmission is in a slot determined for
transmission of the PUCCH.</p>
<p>- When <em>pucch-WindowRestart</em> is enabled, the start of a new
actual TDW is the first symbol of the PUCCH transmission after the event
which causes power consistency and phase continuity not to be maintained
across PUCCH transmissions of PUCCH repetition within the nominal TDW,
and the PUCCH transmission is in a slot determined for transmission of
the PUCCH.</p>
<p>Events which cause power consistency and phase continuity not to be
maintained across PUSCH transmissions of PUSCH repetition type A
scheduled by DCI format 0_1 or 0_2, or PUSCH repetition Type A with a
configured grant, or PUSCH repetition type B or TB processing over
multiple slots, or PUCCH transmissions of PUCCH repetition, within the
nominal TDW, are:</p>
<p>- A downlink slot or downlink reception or downlink monitoring based
on <em>tdd-UL-DL-ConfigurationCommon</em>
and <em>tdd-UL-DL-ConfigurationDedicated</em> for unpaired spectrum.</p>
<p>- The gap between any two consecutive PUSCH transmissions, or the gap
between any two consecutive PUCCH transmissions, exceeds 13 symbols for
normal cyclic prefix or exceeds 11 symbols for extended cyclic
prefix.</p>
<p>- The gap between any two consecutive PUSCH transmissions, or the gap
between any two consecutive PUCCH transmissions, does not exceed 13
symbols but other uplink transmissions are scheduled between the two
consecutive PUSCH transmissions or the two consecutive PUCCH
transmissions.</p>
<p>- For PUSCH transmissions of PUSCH repetition type A, or PUSCH
repetition type B or TB processing over multiple slots, a dropping or
cancellation of a PUSCH transmission according to clause 9, clause 11.1
and clause 11.2A of [6, TS 38.213].</p>
<p>- For PUCCH transmissions of PUCCH repetition, a dropping or
cancellation of a PUCCH transmission according to clause 9, clause 9.2.6
and clause 11.1 of [6, TS 38.213].</p>
<p>- For any two consecutive PUSCH transmissions of PUSCH repetition
type A, or PUSCH repetition type B, and when two SRS resource sets are
configured in <em>srs-ResourceSetToAddModList</em> or
<em>srs-ResourceSetToAddModListDCI-0-2</em> with higher layer parameter
<em>usage</em> in <em>SRS-ResourceSet</em> set to 'codebook' or
'noncodebook', a different SRS resource set association is used for the
two PUSCH transmissions of PUSCH repetition type A, or PUSCH repetition
type B, according to Clause 6.1.2.1.</p>
<p>- For any two consecutive PUCCH transmissions of PUCCH repetition,
and when a PUCCH resource used for repetitions of a PUCCH transmission
by a UE includes first and second spatial relations or first and second
sets of power control parameters, as described in [10, TS 38.321] and in
clause 7.2.1 of [6, TS 38.213], different spatial relations or different
power control parameters are used for the two PUCCH transmissions of
PUCCH repetition, according to Clause 9.2.6 of [6, TS 38.213].</p>
<p>- Uplink timing adjustment in response to a timing advance command
according to clause 4.2 of [6, TS 38.213].</p>
<p>- Frequency hopping.</p>
<p>- For reduced capability half-duplex UEs,</p>
<p>- a dropping or cancellation of a PUSCH or PUCCH transmission
according to clause 17.2 of [6, TS 38.213] or</p>
<p>- an overlapping of the gap between two consecutive PUSCH or two
consecutive PUCCH transmissions and any symbol of downlink reception or
downlink monitoring</p>
<p>The UE shall maintain power consistency and phase continuity within
an actual TDW, across PUSCH transmissions of PUSCH repetition Type A
scheduled by DCI format 0_1 or 0_2, or PUSCH repetition Type A with a
configured grant, or PUSCH repetition type B or TB processing over
multiple slots, or across PUCCH transmissions of PUCCH repetition, in
case the actual TDW is created in response to frequency hopping, or in
response to the use of a different SRS resource set association for the
two PUSCH transmissions of PUSCH repetition type A, or PUSCH repetition
type B, or in response to the use of different spatial relations or
different power control parameters for the two PUCCH transmissions of
PUCCH repetition, or in response to any event not triggered by DCI or
MAC-CE. The UE maintains power consistency and phase continuity within
an actual TDW, across PUSCH transmissions of PUSCH repetition Type A
scheduled by DCI format 0_1 or 0_2, or PUSCH repetition Type A with a
configured grant, or PUSCH repetition type B or TB processing over
multiple slots, or across PUCCH transmissions of PUCCH repetition, in
case the actual TDW is created in response to an event triggered by DCI
other than frequency hopping or the use of a different SRS resource set
association for the two PUSCH transmissions of PUSCH repetition type A,
or PUSCH repetition type B, or the use of different spatial relations or
different power control parameters for the two PUCCH transmissions of
PUCCH repetition, or in response to an event triggered by MAC-CE,
subject to UE capability. of <em>dmrs-BundlingRestart</em> [13, TS
38.306] and when <em>pusch-WindowRestart</em> or
<em>pucch-WindowRestart</em> is enabled.</p>
<h2 id="ue-reference-signal-rs-procedure">6.2 UE reference signal (RS)
procedure</h2>
<h3 id="ue-sounding-procedure">6.2.1 UE sounding procedure</h3>
<p>The UE may be configured with one or more Sounding Reference Signal
(SRS) resource sets as configured by the higher layer parameter
<em>SRS-ResourceSet</em> or <em>SRS-PosResourceSet</em>. For each SRS
resource set configured by <em>SRS-ResourceSet</em>, a UE may be
configured with <img src="media/image759.svg" />SRS resources (higher
layer parameter <em>SRS-Resource</em>), where the maximum value of K is
indicated by UE capability [13, 38.306]. When SRS resource set is
configured with the higher layer parameter <em>SRS-PosResourceSet,</em>
a UE may be configured with <em>K</em> ≥1 SRS resources (higher layer
parameter <em>SRS-PosResource</em>), where the maximum value of K is 16.
The SRS resource set applicability is configured by the higher layer
parameter <em>usage</em> in <em>SRS-ResourceSet.</em> When the higher
layer parameter <em>usage</em> is set to 'beamManagement'<em>,</em> only
one SRS resource in each of multiple SRS resource sets may be
transmitted at a given time instant, but the SRS resources in different
SRS resource sets with the same time domain behaviour in the same BWP
may be transmitted simultaneously. For a given CC, multiple SRS
resources across multiple sets with usage "beamManagement" are not
expected to be partially overlapped in time.</p>
<p>For the SRS resource set(s) configured <em>in
srs-ResourceSetToAddModListDCI-0-2</em> with higher layer parameter
<em>usage</em> set to '<em>antennaSwitching</em>' or
'<em>beamManagement</em>', the UE expects the same SRS resource set(s)
with the same <em>usage</em> being configured in
<em>srs-ResourceSetToAddModList.</em></p>
<p>When the UE is configured <em>dl-OrJointTCI-StateList</em> or
<em>ul-TCI-StateList,</em> the UE can assume that SRS resource(s) in any
SRS resource set, except SRS resource set for positioning and an SRS
resource set configured with <em>followUnifiedTCI-StateSRS</em>, can be
configured with <em>TCI-State</em> or <em>TCI-UL-State</em> or updated
as described in clause 6.1.3.59 or 6.1.3.60 of [10, TS 38.321]. The
reference RS in the <em>TCI-State</em> can be a CSI-RS resource in a
<em>NZP-CSI-RS-ResourceSet</em> configured with higher layer parameter
<em>repetition</em>, or a CSI-RS resource in an
<em>NZP-CSI-RS-ResourceSet</em> configured with higher layer parameter
<em>trs-Info</em>. The reference RS in the <em>TCI-UL-State</em>(s) can
be a CSI-RS resource in a <em>NZP-CSI-RS-ResourceSet</em> configured
with higher layer parameter <em>repetition</em>, a CSI-RS resource in an
<em>NZP-CSI-RS-ResourceSet</em> configured with higher layer parameter
<em>trs-Info</em>, an SRS resource with the higher layer parameter
<em>usage</em> set to 'beamManagement', or SS/PBCH block associated with
the same or different PCI from the PCI of the serving cell.</p>
<p>If an SRS resource set, except an SRS resource set for positioning,
is configured with <em>followUnifiedTCI-StateSRS</em>, the UE shall
transmit the target SRS resource(s) within the SRS resource set
according to the spatial relation, if applicable, with a reference to
the RS used for determining UL TX spatial filter. The RS is determined
based on an RS configured with <em>qcl-Type</em> set to 'typeD' in
<em>QCL-Info</em> of the indicated <em>TCI-State</em> or an RS in the
indicated <em>TCI-UL-State</em>. The reference RS in the indicated
<em>TCI-State</em> can be a CSI-RS resource in a
<em>NZP-CSI-RS-ResourceSet</em> configured with higher layer parameter
<em>repetition</em>, or a CSI-RS resource in an
<em>NZP-CSI-RS-ResourceSet</em> configured with higher layer parameter
<em>trs-Info.</em> The reference RS in the indicated
<em>TCI-UL-State</em> can be a CSI-RS resource in a
<em>NZP-CSI-RS-ResourceSet</em> configured with higher layer parameter
<em>repetition</em>, a CSI-RS resource in an
<em>NZP-CSI-RS-ResourceSet</em> configured with higher layer parameter
<em>trs-Info,</em> an SRS resource with the higher layer parameter
<em>usage</em> set to 'beamManagement', or SS/PBCH block associated with
the same or different PCI from the PCI of the serving cell.</p>
<p>For aperiodic SRS at least one state of the DCI field is used to
select at least one out of the configured SRS resource set(s).</p>
<p>The following SRS parameters are semi-statically configurable by
higher layer parameter <em>SRS-Resource</em> or
<em>SRS-PosResource</em>.</p>
<p>- <em>srs-ResourceId</em> or <em>SRS-PosResourceId</em> determines
SRS resource configuration identity.</p>
<p>- Number of SRS ports, as defined by the higher layer parameter
<em>nrofSRS-Ports</em> and described in clause 6.4.1.4 of [4, TS
38.211]. If not configured, <em>nrofSRS-Ports</em> is 1.</p>
<p><em>-</em> Time domain behaviour of SRS resource configuration as
indicated by the higher layer parameter <em>resourceType</em>, which may
be periodic, semi-persistent, aperiodic SRS transmission as defined in
clause 6.4.1.4 of [4, TS 38.211].</p>
<p>- Slot level periodicity and slot level offset as defined by the
higher layer parameters <em>periodicityAndOffset-p</em> or
<em>periodicityAndOffset-sp</em> for an SRS resource of type periodic or
semi-persistent. The UE is not expected to be configured with SRS
resources in the same SRS resource set <em>SRS-ResourceSet</em> or
<em>SRS-PosResourceSet</em> with different slot level periodicities. For
an <em>SRS-ResourceSet</em> configured with higher layer parameter
<em>resourceType</em> set to 'aperiodic', a slot level offset is defined
by the higher layer parameter <em>slotOffset.</em> For an
<em>SRS-ResourceSet</em> configured with higher layer parameter
<em>resourceType</em> set to 'aperiodic', a list of up to four different
available slot offset values from the reference slot <em>n</em> +
<em>k</em> to the slot where the aperiodic SRS resource set is
transmitted where <em>n</em> is the slot with triggering DCI and
<em>k</em> is <em>slotOffset,</em> can be configured by the higher layer
parameter <em>availableSlotOffsetList.</em> The parameter
<em>availableSlotOffsetList</em> can be configured up to 4 different
values<em>.</em> For an <em>SRS-PosResourceSet</em> configured with
higher layer parameter r<em>esourceType</em> set to 'aperiodic', the
slot level offset is defined by the higher layer parameter
<em>slotOffset</em> for each SRS resource.</p>
<p>- Number of OFDM symbols in the SRS resource, starting OFDM symbol of
the SRS resource within a slot including repetition factor R as defined
by the higher layer parameter <em>resourceMapping</em> and described in
clause 6.4.1.4 of [4, TS 38.211]. If <em>R</em> is not configured, then
<em>R</em> is equal to the number of OFDM symbols in the SRS
resource.</p>
<p>- SRS bandwidth <img src="media/image760.svg" />and <img
src="media/image761.svg" />, as defined by the higher layer parameter
<em>freqHopping</em> and described in clause 6.4.1.4 of [4, TS 38.211].
If not configured, then<img src="media/image760.svg" />= 0.</p>
<p>- Frequency hopping bandwidth <img src="media/image762.svg" />, as
defined by the higher layer parameter <em>freqHopping</em> and described
in clause 6.4.1.4 of [4, TS 38.211]. If not configured, then <img
src="media/image762.svg" />= 0.</p>
<p>- Defining partial frequency sounding factor and start RB index for
partial frequency sounding as defined by the higher layer parameters
<em>FreqScalingFactor</em> P<sub>F</sub> and <em>StartRBIndex
k</em><sub>F</sub>, respectively, and described in Clause 6.4.1.4 of [4,
TS 38.211]. If not configured, then <em>P</em><sub>F</sub> = 1 and
<em>k</em><sub>F</sub>,= 0.</p>
<p>- Defining start RB index hopping for partial frequency sounding in
different SRS frequency hopping periods for
aperiodic/periodic/semi-persistent SRS based on the hopping pattern
<em>k</em><sub>hop</sub> as described in clause 6.4.1.4.3 in [4, TS
38.211. If not configured, then start RB hopping is not enabled and
<em>k</em><sub>hop</sub> is fixed to be 0 for all SRS symbols.</p>
<p>- Defining frequency domain position and configurable shift, as
defined by the higher layer parameters <em>freqDomainPosition</em> and
<em>freqDomainShift</em>, respectively, and described in clause 6.4.1.4
of [4, TS 38.211]. If <em>freqDomainPosition</em> is not configured,
<em>freqDomainPosition</em> is zero.</p>
<p>- Cyclic shift, as defined by the higher layer parameter
<em>cyclicShift-n2</em>, <em>cyclicShift-n4, or cyclicShift-n8</em> for
transmission comb value 2, 4 or 8, and described in clause 6.4.1.4 of
[4, TS 38.211].</p>
<p>- Transmission comb value, as defined by the higher layer parameter
<em>transmissionComb</em> described in clause 6.4.1.4 of [4, TS
38.211].</p>
<p>- Transmission comb offset, as defined by the higher layer parameter
<em>combOffset-n2</em>, <em>combOffset-n4,</em> and
<em>combOffset-n8</em> for transmission comb value 2, 4, or 8, and
described in clause 6.4.1.4 of [4, TS 38.211].</p>
<p>- SRS sequence ID, as defined by the higher layer parameter
<em>sequenceId</em> in clause 6.4.1.4 of [4, TS 38.211].</p>
<p>- The configuration of the spatial relation between a reference RS
and the target SRS, where the higher layer parameter
<em>spatialRelationInfo</em> or <em>spatialRelationInfoPos</em>, if
configured, contains the ID of the reference RS. The reference RS may be
an SS/PBCH block, CSI-RS configured on serving cell indicated by higher
layer parameter <em>servingCellId</em> if present, same serving cell as
the target SRS otherwise, or an SRS configured on uplink BWP indicated
by the higher layer parameter <em>uplinkBWP</em>, and serving cell
indicated by the higher layer parameter <em>servingCellId</em> if
present, same serving cell as the target SRS otherwise. When the target
SRS is configured by the higher layer parameter
<em>SRS-PosResourceSet</em>, the reference RS may also be a DL PRS
configured on a serving cell or a non-serving cell indicated by the
higher layer parameter <em>dl-PRS</em>, or an SS/PBCH block of a
non-serving cell indicated by the higher layer parameter
<em>ssb-Ncell</em>. If the UE is configured with
<em>dl-OrJointTCI-StateList</em> or <em>ul-TCI-StateList</em>, the
reference RS may additionally be an SS/PBCH block associated with a PCI
different from the PCI of the serving cell.</p>
<p>The UE may be configured by the higher layer parameter
<em>resourceMapping</em> in <em>SRS-Resource</em> with an SRS resource
occupying <img src="media/image763.svg" /> adjacent OFDM symbols within
the last 6 symbols of the slot, or at any symbol location within the
slot if <em>resourceMapping-r16</em> is provided subject to UE
capability, where all antenna ports of the SRS resources are mapped to
each symbol of the resource. When the SRS is configured with the higher
layer parameter <em>SRS-PosResourceSet</em> the higher layer parameter
<em>resourceMapping-r16</em> in <em>SRS-PosResource</em> indicates an
SRS resource occupying <span class="math inline">\(N_{S} \in \left\{
1,2,4,8,12 \right\}\)</span> adjacent symbols anywhere within the slot.
When the SRS is configured with the higher layer parameter
<em>SRS-ResourceSet,</em> the higher layer parameter
<em>resourceMapping-r17</em> in <em>SRS-Resource</em> indicates an SRS
resource occupying <span class="math inline">\(N_{S} \in \left\{
1,2,4,8,10,12,14 \right\}\)</span> adjacent symbols anywhere within the
slot.</p>
<p>If a PUSCH with a priority index 0 and SRS configured by
<em>SRS-Resource</em> are transmitted in the same slot on a serving
cell, the UE may only be configured to transmit SRS after the
transmission of the PUSCH and the corresponding DM-RS.</p>
<p>If a PUSCH transmission with a priority index 1 or a PUCCH
transmission with a priority index 1 would overlap in time with an SRS
transmission on a serving cell, the UE does not transmit the SRS in the
overlapping symbol(s).</p>
<p>For a UE configured with one or more SRS resource configuration(s),
and when the higher layer parameter <em>resourceType</em> in
<em>SRS-Resource</em> or <em>SRS-PosResource</em> is set to
'periodic':</p>
<p>- if the UE is configured with the higher layer parameter
<em>spatialRelationInfo, spatialRelationInfo-PDC</em> or
<em>spatialRelationInfoPos</em> containing the ID of a reference
'ssb-Index', 'ssb-IndexServing', or 'ssb-IndexNcell', the UE shall
transmit the target SRS resource with the same spatial domain
transmission filter used for the reception of the reference SS/PBCH
block, if the higher layer parameter <em>spatialRelationInfo,
spatialRelationInfo-PDC</em> or <em>spatialRelationInfoPos</em> contains
the ID of a reference 'csi-RS-Index' or 'csi-RS-IndexServing', the UE
shall transmit the target SRS resource with the same spatial domain
transmission filter used for the reception of the reference periodic
CSI-RS or of the reference semi-persistent CSI-RS, if the higher layer
parameter <em>spatialRelationInfo, spatialRelationInfo-PDC</em> or
<em>spatialRelationInfoPos</em> containing the ID of a reference 'srs'
or 'srs-spatialRelation', the UE shall transmit the target SRS resource
with the same spatial domain transmission filter used for the
transmission of the reference periodic SRS. When the SRS is configured
by the higher layer parameter <em>SRS-PosResource</em> and if the higher
layer parameter <em>spatialRelationInfoPos</em> contains the ID of a
reference 'dl-PRS', the UE shall transmit the target SRS resource with
the same spatial domain transmission filter used for the reception of
the reference DL PRS. When the SRS is configured by the higher layer
parameter <em>SRS-Resource</em> and if the higher layer parameter
<em>spatialRelationInfo-PDC</em> contains the ID of a reference
'dl-PRS-PDC', the UE shall transmit the target SRS resource with the
same spatial domain transmission filter used for the reception of the
reference DL PRS for RTT-based propagation delay compensation according
to clause 9.</p>
<p>For a UE configured with one or more SRS resource configuration(s),
and when the higher layer parameter <em>resourceType</em> in
<em>SRS-Resource</em> or <em>SRS-PosResource</em> is set to
'semi-persistent':</p>
<p>- when a UE receives an activation command, as described in clause
6.1.3.17 or 6.1.3.36 of [10, TS 38.321], for an SRS resource, and when
the UE would transmit a PUCCH with HARQ-ACK information in slot
<em>n</em> corresponding to the PDSCH carrying the activation command,
the corresponding actions in [10, TS 38.321] and the UE assumptions on
SRS transmission corresponding to the configured SRS resource set shall
be applied starting from the first slot that is after slot <span
class="math inline">\(n + {3N}_{slot}^{subframe,µ}\)</span> where
<em>μ</em> is the SCS configuration for the PUCCH. The activation
command also contains spatial relation assumptions provided by a list of
references to reference signal IDs, one per element of the activated SRS
resource set. When the SRS is configured with the higher layer parameter
<em>SRS-ResourceSet</em>, each ID in the list refers to a reference
SS/PBCH block, NZP CSI-RS resource configured on serving cell indicated
by <em>Resource Serving Cell ID</em> field in the activation command if
present, same serving cell as the SRS resource set otherwise, or SRS
resource configured on serving cell and uplink bandwidth part indicated
by Resource <em>Serving Cell ID</em> field and <em>Resource BWP ID</em>
field in the activation command if present, same serving cell and
bandwidth part as the SRS resource set otherwise. When the SRS is
configured with the higher layer parameter <em>SRS-PosResourceSet</em>,
each ID in the list of reference signal IDs may refer to a reference
SS/PBCH block on a serving or non-serving cell indicated by <em>PCI</em>
field in the activation command, NZP CSI-RS resource configured on
serving cell indicated by <em>Resource Serving Cell ID</em> field in the
activation command if present, same serving cell as the SRS resource set
otherwise, SRS resource configured on serving cell and uplink bandwidth
part indicated by Resource <em>Serving Cell ID</em> field and
<em>Resource BWP ID</em> field in the activation command if present,
same serving cell and bandwidth part as the SRS resource set otherwise,
or DL PRS resource of a serving or non-serving cell associated with a
<em>dl-PRS-ID</em> indicated by <em>DL-PRS ID</em> field in the
activation command.</p>
<p>- if an SRS resource in the activated resource set is configured with
the higher layer parameter <em>spatialRelationInfo</em> or
<em>spatialRelationInfoPos</em>, the UE shall assume that the ID of the
reference signal in the activation command overrides the one configured
in <em>spatialRelationInfo</em> or <em>spatialRelationInfoPos.</em></p>
<p>- when a UE receives a deactivation command [10, TS 38.321] for an
activated SRS resource set, and when the UE would transmit a PUCCH with
HARQ-ACK information in slot <em>n</em> corresponding to the PDSCH
carrying the deactivation command, the corresponding actions in [10, TS
38.321] and UE assumption on cessation of SRS transmission corresponding
to the deactivated SRS resource set shall apply starting from the first
slot that is after slot <span class="math inline">\(n +
{3N}_{slot}^{subframe,µ}\)</span> where <em>μ</em> is the SCS
configuration for the PUCCH.</p>
<p>- if the UE is configured with the higher layer parameter
<em>spatialRelationInfo</em> or <em>spatialRelationInfoPos</em>
containing the ID of a reference 'ssb-Index', 'ssb-IndexServing', or
'ssb-IndexNcell' the UE shall transmit the target SRS resource with the
same spatial domain transmission filter used for the reception of the
reference SS/PBCH block, if the higher layer parameter
<em>spatialRelationInfo</em> or <em>spatialRelationInfoPos</em> contains
the ID of a reference 'csi-RS-Index' or 'csi-RS-IndexServing', the UE
shall transmit the target SRS resource with the same spatial domain
transmission filter used for the reception of the reference periodic
CSI-RS or of the reference semi-persistent CSI-RS, if the higher layer
parameter <em>spatialRelationInfo</em> or
<em>spatialRelationInfoPos</em> contains the ID of a reference 'srs' or
'srs-SpatialRelation', the UE shall transmit the target SRS resource
with the same spatial domain transmission filter used for the
transmission of the reference periodic SRS or of the reference
semi-persistent SRS. When the SRS is configured by the higher layer
parameter <em>SRS-PosResourceSet</em> and if the higher layer parameter
<em>spatialRelationInfoPos</em> contains the ID of a reference 'dl-PRS',
the UE shall transmit the target SRS resource with the same spatial
domain transmission filter used for the reception of the reference DL
PRS.</p>
<p>If the UE has an active semi-persistent SRS resource configuration
and has not received a deactivation command, the semi-persistent SRS
configuration is considered to be active in the UL BWP which is active,
otherwise it is considered suspended.</p>
<p>For a UE configured with one or more SRS resource configuration(s),
and when the higher layer parameter <em>resourceType</em> in
<em>SRS-Resource</em> or <em>SRS-PosResource</em> is set to
'aperiodic':</p>
<p>- the UE receives a configuration of SRS resource sets,</p>
<p>- the UE receives a downlink DCI, a group common DCI, or an uplink
DCI based command where a codepoint of the DCI may trigger one or more
SRS resource set(s). For SRS in a resource set with usage set to
'codebook' or 'antennaSwitching', the minimal time interval between the
last symbol of the PDCCH triggering the aperiodic SRS transmission and
the first symbol of SRS resource is <em>N<sub>2 </sub></em> symbols and
an additional time duration <em>T<sub>switch</sub></em>. Otherwise, the
minimal time interval between the last symbol of the PDCCH triggering
the aperiodic SRS transmission and the first symbol of SRS resource is
<em>N<sub>2</sub></em> +14 symbols and an additional time duration
<em>T<sub>switch</sub></em>. The minimal time interval unit of OFDM
symbol is counted based on the minimum subcarrier spacing given by
min(<em>µ<sub>PDCCH,</sub> µ<sub>UL</sub></em>) where
<em>µ<sub>UL</sub></em> is given by min(<em>µ<sub>UL,carrier1,</sub>
µ<sub>UL,carrier2,</sub> µ<sub>SRS</sub></em>) when the UE is configured
with the higher layer parameter <em>uplinkTxSwitchingOption</em> set to
'dualUL' for uplink carrier aggregation, and by <em>µ<sub>SRS</sub></em>
otherwise. <em>µ<sub>SRS</sub></em> and <em>µ<sub>PDCCH</sub></em> are
the subcarrier spacing configurations for triggered SRS and PDCCH
carrying the triggering command respectively.</p>
<p>- <em>T<sub>switch</sub></em>, <em>µ<sub>UL,carrier1 </sub></em>and
<em>µ<sub>UL,carrier2</sub></em> are defined in clause 6.4.</p>
<p>- A UE reporting its UE capability 'srs-TriggeringDCI' can be
indicated with DCI 0_1 and 0_2 to trigger aperiodic SRS without data and
without CSI as described in clause 7.3.1.1 of [5, TS 38.212]. Otherwise,
except for DCI format 0_1/0_2 with CRC scrambled by SP-CSI-RNTI, a UE is
not expected to receive a DCI format 0_1/0_2 with UL-SCH indicator of
"0" and CSI request of all zero(s) as described in clause 7.3.1.1 of [5,
TS 38.212].</p>
<p>- If the UE receives the DCI triggering aperiodic SRS in slot
<em>n</em> and at least one resource set is configured with parameter
<em>availableSlotOffset</em> across all configured BWPs in a component
carrier except when SRS is configured with the higher layer parameter
<em>SRS-PosResource</em>,</p>
<p>- if ca-<em>SlotOffset</em> is configured, the UE transmits aperiodic
SRS in each of the triggered SRS resource set(s) in the (<em>t</em> +
1)-th available slot counting from slot <img
src="media/image764.svg" />,</p>
<p>- otherwise the UE transmits aperiodic SRS in each of the triggered
SRS resource set(s) in the (<em>t</em> + 1)-th available slot counting
from slot <span class="math inline">\(\ \left\lfloor n \cdot
\frac{2^{\mu_{SRS}}}{2^{\mu_{PDCCH}}} \right\rfloor + k + K_{offset}
\cdot \frac{2^{\mu_{SRS}}}{2^{\mu_{K_{offset}}}},\ \ where\ K_{offset}\
\)</span>is a parameter configured by higher layer as specified in
clause 4.2 of [6, TS 38.213], and where</p>
<p><em>- k</em> is configured via higher layer parameter
<em>slotOffset</em> for each triggered SRS resources set and is based on
the subcarrier spacing of the triggered SRS transmission,
<em>µ<sub>SRS</sub></em> and <em>µ<sub>PDCCH</sub></em> are the
subcarrier spacing configurations for triggered SRS and PDCCH carrying
the triggering command, respectively.</p>
<p><em>-</em> <span class="math inline">\(\mu_{K_{offset}}\)</span>is
the subcarrier spacing configuration for <span
class="math inline">\(K_{offset}\)</span> with a value of 0 for
frequency range 1.</p>
<p><em>-</em> <span class="math inline">\(N_{\text{slot, offset,
PDCCH}}^{\text{CA}}\)</span> and <span
class="math inline">\(\mu_{\text{offset,PDCCH}}\)</span> are the <span
class="math inline">\(N_{\text{slot, offset}}^{\text{CA}}\)</span> and
the<img src="media/image15.svg" />, respectively, which are determined
by higher-layer configured <em>ca-SlotOffset</em> for the cell receiving
the PDCCH, <span class="math inline">\(N_{\text{slot, offset,
SRS}}^{\text{CA}}\)</span> and <span
class="math inline">\(\mu_{\text{offset,SRS}}\)</span> are the <span
class="math inline">\(N_{\text{slot, offset}}^{\text{CA}}\)</span> and
the<img src="media/image15.svg" />, respectively, which are determined
by higher-layer configured <em>ca-SlotOffset</em> for the cell
transmitting the SRS, as defined in [4, TS 38.211] clause 4.5.</p>
<p>- An available slot is a slot satisfying there are UL or flexible
symbol(s) for the time-domain location(s) for all the SRS resources in
the resource set and it satisfies UE capability on the minimum timing
requirement between triggering PDCCH and all the SRS resources in the
resource set. From the first symbol carrying the SRS request DCI to the
last symbol of the triggered SRS resource set, UE does not expect to
receive SFI indication, UL cancellation indication or dynamic scheduling
of DL channel/signal(s) on flexible symbol(s) that may change the
determination of available slot.</p>
<p><em>- t</em> is configured via higher layer parameter
<em>availableSlotOffsetList</em> with up to four different values of
<em>AvailableSlotOffset</em> for each triggered SRS resources set and it
is based on the subcarrier spacing of the triggered SRS transmission.
When one or more SRS resource sets across all configured BWPs in a
component carrier are configured, and at least one resource set is
configured with <em>availableSlotOffsetList</em> parameter of more than
one values, the indicated value of <em>t</em> is indicated by SOI field
in DCI scheduling PUSCH/PDSCH and DCI 0_1/0_2 without data and without
CSI request described in [5, TS 38.212]. The UE shall apply indicated
value <em>t</em> specifically for those sets with configured
<em>availableSlotOffsetList</em> parameter. When one or more SRS
resource sets across all configured BWPs in a component carrier are
configured and at least one resource set is configured with
<em>availableSlotOffsetList</em> parameter, and the
<em>availableSlotOffsetList</em> parameter for each SRS resource set has
only one value, the UE shall apply the configured value specifically for
those sets with configured <em>availableSlotOffsetList</em> parameter.
For SRS resource set configured with <em>availableSlotOffsetList</em>
parameter, each of resource set is configured with <em>K</em> values of
<em>AvailableSlotOffset</em>. For SRS resource set configured without
<em>availableSlotOffsetList</em> parameter, <em>t</em> = 0 is applied
for the resource set.</p>
<p>- If the UE receives the DCI triggering aperiodic SRS in slot
<em>n</em> and none of the resource sets is configured with parameter
<em>availableSlotOffsetList</em> across all configured BWPs in a
component carrier except when SRS is configured with the higher layer
parameter <em>SRS-PosResource</em></p>
<p>- if the UE is configured with <em>ca-SlotOffset</em> for at least
one of the triggered and triggering cell, the UE transmits aperiodic SRS
in each of the triggered SRS resource set(s) in slot <img
src="media/image764.svg" /><em>,</em></p>
<p>- otherwise, the UE transmits aperiodic SRS in each of the triggered
resource set(s) in slot <span class="math inline">\(K_{s} = \left\lfloor
n \cdot \frac{2^{\mu_{SRS}}}{2^{\mu_{PDCCH}}} \right\rfloor + k +
K_{offset} \cdot \frac{2^{\mu_{SRS}}}{2^{\mu_{K_{offset}}}}\)</span>,
where <span class="math inline">\(K_{offset}\)</span> is a parameter
configured by higher layer as specified in clause 4.2 of [6 TS 38.213],
and where</p>
<p><em>- k</em> is configured via higher layer parameter
<em>slotOffset</em> for each triggered SRS resources set and is based on
the subcarrier spacing of the triggered SRS transmission,
<em>µ<sub>SRS</sub></em> and <em>µ<sub>PDCCH</sub></em> are the
subcarrier spacing configurations for triggered SRS and PDCCH carrying
the triggering command respectively;</p>
<p><em>-</em> <span class="math inline">\(\mu_{K_{offset}}\)</span>is
the subcarrier spacing configuration for <span
class="math inline">\(K_{offset}\)</span> with a value of 0 for
frequency range 1.</p>
<p>- <span class="math inline">\(N_{\text{slot, offset,
PDCCH}}^{\text{CA}}\)</span> and <span
class="math inline">\(\mu_{\text{offset,PDCCH}}\ \)</span>are the <span
class="math inline">\({\ N}_{\text{slot, offset}}^{\text{CA}}\)</span>
and the<img src="media/image15.svg" />, respectively, which are
determined by higher-layer configured <em>ca-SlotOffset</em> for the
cell receiving the PDCCH, <span
class="math inline">\(N_{slot,offset,SRS}^{CA}\)</span> and <span
class="math inline">\(\mu_{offset,SRS}\)</span> are the <img
src="media/image765.svg" style="width:0.58333in;height:0.27778in" /> and
the <img src="media/image766.svg"
style="width:0.33472in;height:0.21667in" />, respectively, which are
determined by higher-layer configured <em>ca-SlotOffset</em> for the
cell transmitting the SRS, as defined in [4, TS 38.211] clause 4.5.</p>
<p>- If the UE receives the DCI triggering aperiodic SRS in slot
<em>n</em> and when SRS is configured with the higher layer parameter
<em>SRS-PosResource</em>, the UE transmits every aperiodic SRS resource
in each of the triggered SRS resource set(s) in slot <img
src="media/image764.svg" />, if UE is configured with
<em>ca-SlotOffset</em> for at least one of the triggered and triggering
cell, <span class="math inline">\(K_{s} = \left\lfloor n \cdot
\frac{2^{\mu_{SRS}}}{2^{\mu_{PDCCH}}} \right\rfloor + k + K_{offset}
\cdot \frac{2^{\mu_{SRS}}}{2^{\mu_{K_{offset}}}}\)</span>, otherwise,
where <span class="math inline">\(K_{offset}\)</span> is a parameter
configured by higher layer as specified in clause 4.2 of [6 TS 38.213],
and where</p>
<p><em>- k</em> is configured via higher layer parameter
<em>slotOffset</em> for each aperiodic SRS resource in each triggered
SRS resources set and is based on the subcarrier spacing of the
triggered SRS transmission, <em>µ<sub>SRS</sub></em> and
<em>µ<sub>PDCCH</sub></em> are the subcarrier spacing configurations for
triggered SRS and PDCCH carrying the triggering command
respectively;</p>
<p><em>-</em> <span class="math inline">\(\mu_{K_{offset}}\)</span> is
the subcarrier spacing configuration for <span
class="math inline">\(K_{offset}\)</span> with a value of 0 for
frequency range 1.</p>
<p>- <span class="math inline">\(N_{\text{slot, offset,
PDCCH}}^{\text{CA}}\)</span> and <span
class="math inline">\(\mu_{\text{offset,PDCCH}}\ \)</span>are the <span
class="math inline">\({\ N}_{\text{slot, offset}}^{\text{CA}}\)</span>
and the<img src="media/image15.svg" />, respectively, which are
determined by higher-layer configured <em>ca-SlotOffset</em> for the
cell receiving the PDCCH, <span
class="math inline">\(N_{slot,offset,SRS}^{CA}\)</span> and <span
class="math inline">\(\mu_{offset,SRS}\)</span> are the <img
src="media/image765.svg" style="width:0.58333in;height:0.27778in" /> and
the <img src="media/image766.svg"
style="width:0.33472in;height:0.21667in" />, respectively, which are
determined by higher-layer configured <em>ca-SlotOffset</em> for the
cell transmitting the SRS, as defined in [4, TS 38.211] clause 4.5.</p>
<p>- if the UE is configured with the higher layer parameter
<em>spatialRelationInfo</em> or <em>spatialRelationInfoPos</em>
containing the ID of a reference 'ssb-Index', 'ssb-IndexServing' or
'ssb-IndexNcell', the UE shall transmit the target SRS resource with the
same spatial domain transmission filter used for the reception of the
reference SS/PBCH block, if the higher layer parameter
<em>spatialRelationInfo</em> or <em>spatialRelationInfoPos</em> contains
the ID of a reference 'csi-RS-Index' or 'csi-RS-IndexServing', the UE
shall transmit the target SRS resource with the same spatial domain
transmission filter used for the reception of the reference periodic
CSI-RS or of the reference semi-persistent CSI-RS, or of the latest
reference aperiodic CSI-RS. If the higher layer parameter
<em>spatialRelationInfo</em> or <em>spatialRelationInfoPos</em> contains
the ID of a reference 'srs' or 'srs-SpatialRelation', the UE shall
transmit the target SRS resource with the same spatial domain
transmission filter used for the transmission of the reference periodic
SRS or of the reference semi-persistent SRS or of the reference
aperiodic SRS. When the SRS is configured by the higher layer parameter
<em>SRS-PosResourceSet</em> and if the higher layer parameter
<em>spatialRelationInfoPos</em> contains the ID of a reference 'dl-PRS',
the UE shall transmit the target SRS resource with the same spatial
domain transmission filter used for the reception of the reference DL
PRS.</p>
<p>- when a UE receives an spatial relation update command, as described
in clause 6.1.3.26 of [10, TS 38.321], for an SRS resource configured
with the higher layer parameter <em>SRS-Resource</em>, and when the
HARQ-ACK corresponding to the PDSCH carrying the update command is
transmitted in slot <em>n</em>, the corresponding actions in [10, TS
38.321] and the UE assumptions on updating spatial relation for the SRS
resource shall be applied for SRS transmission starting from the first
slot that is after slot <span class="math inline">\(n +
{3N}_{slot}^{subframe,µ}\ \)</span>where <em>μ</em> is the SCS
configuration for the PUCCH. The update command contains spatial
relation assumptions provided by a list of references to reference
signal IDs, one per element of the updated SRS resource set. Each ID in
the list refers to a reference SS/PBCH block, NZP CSI-RS resource
configured on serving cell indicated by <em>Resource Serving Cell
ID</em> field in the update command if present, same serving cell as the
SRS resource set otherwise, or SRS resource configured on serving cell
and uplink bandwidth part indicated by <em>Resource</em> <em>Serving
Cell ID</em> field and <em>Resource BWP ID</em> field in the update
command if present, same serving cell and bandwidth part as the SRS
resource set otherwise. When the UE is configured with the higher layer
parameter <em>usage</em> in <em>SRS-ResourceSet</em> set to
'antennaSwitching', the UE shall not expect to be configured with
different spatial relations for SRS resources in the same SRS resource
set.</p>
<p>The UE is not expected to be configured with different time domain
behavior for SRS resources in the same SRS resource set. The UE is also
not expected to be configured with different time domain behavior
between SRS resource and associated SRS resources set.</p>
<p>For operation in the same carrier, the UE is not expected to be
configured on overlapping symbols with a SRS resource configured by the
higher layer parameter <em>SRS-PosResource</em> and a SRS resource
configured by the higher layer parameter <em>SRS-Resource</em> with
<em>resourceType</em> of both SRS resources as 'periodic'.</p>
<p>For operation in the same carrier, the UE is not expected to be
activated or triggered to transmit SRS on overlapping symbols with a SRS
resource configured by the higher layer parameter
<em>SRS-PosResource</em> and a SRS resource configured by the higher
layer parameter <em>SRS-Resource</em> with <em>resourceType</em> of both
SRS resources as 'semi-persistent' or 'aperiodic'.</p>
<p>For operations in the same carrier, the UE is not expected to be
configured on overlapping symbols with more than one SRS resources
configured by the higher layer parameter <em>SRS-PosResource</em> with
<em>resourceType</em> of the SRS resources as 'periodic'.</p>
<p>For operations in the same carrier, the UE is not expected to be
activated or triggered to transmit SRS on overlapping symbols with more
than one SRS resources configured by the higher layer parameter
<em>SRS-PosResource</em> with <em>resourceType</em> of the SRS resources
as 'semi-persistent' or 'aperiodic'.</p>
<p>For intra-band and inter-band CA operations, a UE can simultaneously
transmit more than one SRS resource configured by
<em>SRS-PosResource</em> on different CCs, subject to UE's
capability</p>
<p>For intra-band and inter-band CA operations, a UE can simultaneously
transmit more than one SRS resource configured by
<em>SRS-PosResource</em> and <em>SRS-Resource</em> on different CCs,
subject to UE's capability.</p>
<p>The SRS request field [5, TS38.212] in DCI format 0_1, 1_1, 0_2 (if
SRS request field is present), 1_2 (if SRS request field is present)
indicates the triggered SRS resource set given in Table 7.3.1.1.2-24 of
[5, TS 38.212]. The 2-bit SRS request field in DCI format 2_3 indicates
the triggered SRS resource set given in clause 7.3 of [5, TS 38.212] and
defined by the entries of the higher layer parameter
<em>srs-ResourceSetToAddModList</em> if the UE is configured with higher
layer parameter <em>srs-TPC-PDCCH-Group</em> set to 'typeB', or
indicates the SRS transmission on a set of serving cells configured by
higher layers if the UE is configured with higher layer parameter
<em>srs-TPC-PDCCH-Group</em> set to 'typeA'.</p>
<p>For PUCCH and SRS on the same carrier, a UE shall not transmit SRS
when semi-persistent or periodic SRS is configured in the same symbol(s)
with PUCCH carrying only CSI report(s), or only L1-RSRP report(s), or
only L1-SINR report(s). A UE shall not transmit SRS when semi-persistent
or periodic SRS is configured or aperiodic SRS is triggered to be
transmitted in the same symbol(s) with PUCCH carrying HARQ-ACK, link
recovery request (as defined in clause 9.2.4 of [6, 38.213]) and/or SR.
In the case that SRS is not transmitted due to overlap with PUCCH, only
the SRS symbol(s) that overlap with PUCCH symbol(s) are dropped. PUCCH
shall not be transmitted when aperiodic SRS is triggered to be
transmitted to overlap in the same symbol with PUCCH carrying
semi-persistent/periodic CSI report(s) or semi-persistent/periodic
L1-RSRP report(s) only, or only L1-SINR report(s).</p>
<p>In case of intra-band contiguous carrier aggregation, or in
inter-band or intra-band non-contiguous CA band combination if
simultaneous SRS and PUCCH/PUSCH transmissions are not supported by UE,
the UE is not expected to be indicated with a SRS transmission from a
carrier and to be configured or scheduled with a PUSCH/UL DM-RS/UL
PT-RS/PUCCH transmission from a different carrier in the same
symbol.</p>
<p>In case of intra-band contiguous carrier aggregation, or in
inter-band CA band combination if simultaneous SRS and PRACH
transmissions are not supported by UE, or in case of intra-band
non-contiguous CA band combination if the UE is not configured with
higher layer parameter <em>intraBandNC-PRACH-simulTx-r17,</em> the UE
shall not transmit simultaneously SRS resource(s) from a carrier and
PRACH from a different carrier.</p>
<p>In case of intra-band contiguous carrier aggregation, or in
inter-band CA band combination if simultaneous SRS and MsgA
transmissions are not supported by UE, the UE shall not transmit
simultaneously SRS resource(s) from a carrier and MsgA from a different
carrier.</p>
<p>In case a SRS resource with <em>resourceType</em> set as 'aperiodic'
is triggered on the OFDM symbol(s) configured with
periodic/semi-persistent SRS transmission, the UE shall transmit the
aperiodic SRS resource and only the periodic/semi-persistent SRS
symbol(s) overlapping within the symbol(s) are dropped, while the
periodic/semi-persistent SRS symbol(s) that are not overlapped with the
aperiodic SRS resource are transmitted. In case a SRS resource with
<em>resourceType</em> set as 'semi-persistent' is triggered on the OFDM
symbol(s) configured with periodic SRS transmission, the UE shall
transmit the semi-persistent SRS resource and only the periodic SRS
symbol(s) overlapping within the symbol(s) are dropped, while the
periodic SRS symbol(s) that are not overlapped with the semi-persistent
SRS resource are transmitted.</p>
<p>When the UE is configured with the higher layer parameter
<em>usage</em> in <em>SRS-ResourceSet</em> set to 'antennaSwitching',
and a guard period of Y symbols is configured according to Clause
6.2.1.2, the UE shall use the same priority rules as defined above
during the guard period as if SRS was configured.</p>
<p>When a <em>spatialRelationInfo</em> is activated/updated for a
semi-persistent or aperiodic SRS resource configured by the higher layer
parameter <em>SRS-Resource</em> by a MAC CE for a set of CCs/BWPs, where
the applicable list of CCs provided by higher layer parameter
<em>simultaneousSpatial-UpdatedList1</em> or
<em>simultaneousSpatial-UpdatedList2</em> is determined by the indicated
CC in the MAC CE, the <em>spatialRelationInfo</em> is applied for the
semi-persistent or aperiodic SRS resource(s) with the same SRS resource
ID for all the BWPs in the determined CCs.</p>
<p>When the higher layer parameter <em>enableDefaultBeamPL-ForSRS</em>
is set 'enabled', and if the higher layer parameter
<em>spatialRelationInfo</em> for the SRS resource, except for the SRS
resource with the higher layer parameter <em>usage</em> in
SRS-ResourceSet set to 'beamManagement' or for the SRS resource with the
higher layer parameter <em>usage</em> in SRS-ResourceSet set to
'nonCodebook' with configuration of <em>associatedCSI-RS</em> or for the
SRS resource configured by the higher layer parameter
<em>SRS-PosResourceSet</em>, or <em>dl-OrJointTCI-StateList</em> or
<em>ul-TCI-StateList</em> is not configured in FR2 and if the UE is not
configured with higher layer parameter(s) <em>pathlossReferenceRS</em>,
and if the UE is not configured with different values of
<em>coresetPoolIndex</em> in <em>ControlResourceSets</em>, and is not
provided at least one TCI codepoint mapped with two TCI states, the UE
shall transmit the target SRS resource in an active UL BWP of a CC,</p>
<p>- according to the spatial relation, if applicable, with a reference
to the RS configured with <em>qcl-Type</em> set to 'typeD' corresponding
to the QCL assumption of the CORESET with the lowest
<em>controlResourceSetId</em> in the active DL BWP in the CC. If the
CORESET is activated with two TCI states, <em>sfnSchemePdcch</em> is
configured and the UE supports <em>sfn-DefaultUL-BeamSetup-r17</em>, UE
shall use the first TCI state as the QCL assumption.</p>
<p>- according to the spatial relation, if applicable, with a reference
to the RS configured with <em>qcl-Type</em> set to 'typeD' in the
activated TCI state with the lowest ID applicable to PDSCH in the active
DL BWP of the CC if the UE is not configured with any CORESET in the
active DL BWP of the CC.</p>
<h4 id="ue-srs-frequency-hopping-procedure">6.2.1.1 UE SRS frequency
hopping procedure</h4>
<p>For a given SRS resource, the UE is configured with repetition factor
R∈{1,2,4} or R∈{1,2,3,4,5,6,7,8,10,12,14} by higher layer parameter
<em>resourceMapping</em> in <em>SRS-Resource</em> where
<em>R</em>≤<em>N<sub>s</sub></em>. When frequency hopping within an SRS
resource in each slot is not configured (<em>R=N<sub>s</sub></em>), each
of the antenna ports of the SRS resource in each slot is mapped in all
the <img src="media/image767.svg" /> symbols to the same set of
subcarriers in the same set of PRBs. When frequency hopping within an
SRS resource in each slot is configured without repetition
(<em>R=1</em>), according to the SRS hopping parameters <img
src="media/image760.svg" />, <img src="media/image761.svg" />and <img
src="media/image762.svg" />defined in clause 6.4.1.4 of [4, TS 38.211],
each of the antenna ports of the SRS resource in each slot is mapped to
different sets of subcarriers in each OFDM symbol, where the same
transmission comb value is assumed for different sets of subcarriers.
When both frequency hopping and repetition within an SRS resource in
each slot are configured (<em>N<sub>s</sub></em> ≥ <em>4, R</em> ≥
<em>2</em>), each of the antenna ports of the SRS resource in each slot
is mapped to the same set of subcarriers within each set of R adjacent
OFDM symbols, and frequency hopping across the <span
class="math inline">\(\frac{N_{s}}{R}\)</span> sets is according to the
SRS hopping parameters <img src="media/image760.svg" />, <img
src="media/image761.svg" />and <img src="media/image762.svg" />, where
<span class="math inline">\(N_{s}\)</span> should be divisible by <span
class="math inline">\(R\)</span>.</p>
<p>For operation with shared spectrum channel access in FR1, the UE does
not expect that multiple hops of an SRS resource transmission are in
different RB sets.</p>
<p>A UE may be configured <span class="math inline">\(N_{s} =
2,4,8,10,12\ or\ 14\ \)</span> adjacent symbol aperiodic SRS resource
with intra-slot frequency hopping within a bandwidth part, where the
full hopping bandwidth is sounded with an equal-size subband across <img
src="media/image768.svg" /> symbols when frequency hopping is configured
with <em>R=1</em>. A UE may be configured <em>N<sub>s</sub></em> ≥
<em>4</em> adjacent symbols aperiodic SRS resource with intra-slot
frequency hopping within a bandwidth part, where the full hopping
bandwidth is sounded with an equal-size subband across <span
class="math inline">\(\frac{N_{s}}{R}\)</span> sets of <em>R</em>
adjacent OFDM symbols, when frequency hopping is configured with
<em>R</em> ≥ <em>2, N<sub>s</sub></em> ≥ <em>R</em> and
<em>N<sub>s</sub></em> should be divisible by <em>R</em>. Each of the
antenna ports of the SRS resource is mapped to the same set of
subcarriers within each set of R adjacent OFDM symbols of the
resource.</p>
<p>A UE may be configured<img src="media/image769.svg" /> symbol
periodic or semi-persistent SRS resource with inter-slot hopping within
a bandwidth part, where the SRS resource occupies the same symbol
location in each slot. A UE may be configured <span
class="math inline">\(N_{s} = 2,4,8,10,12\ or\ 14\)</span> symbol
periodic or semi-persistent SRS resource with intra-slot and inter-slot
hopping within a bandwidth part, where the SRS resource occupies the
same symbol location(s) in each slot. For <em>N<sub>s</sub></em> ≥
<em>4</em>, when frequency hopping is configured with <em>R</em> ≥
<em>2</em>, intra-slot and inter-slot hopping is supported with each of
the antenna ports of the SRS resource mapped to different sets of
subcarriers across <span class="math inline">\(\frac{N_{s}}{R}\)</span>
sets of <em>R</em> adjacent OFDM symbol(s) of the resource in each slot,
where <span class="math inline">\(N_{s}\)</span> should be divisible by
<em>R</em>. Each of the antenna ports of the SRS resource is mapped to
the same set of subcarriers within each set of <em>R</em> adjacent OFDM
symbols of the resource in each slot. For <em>N<sub>s</sub>= R</em>,
when frequency hopping is configured, inter-slot frequency hopping is
supported with each of the antenna ports of the SRS resource mapped to
the same set of subcarriers in <em>R</em> adjacent OFDM symbol(s) of the
resource in each slot.</p>
<h4 id="ue-sounding-procedure-for-dl-csi-acquisition">6.2.1.2 UE
sounding procedure for DL CSI acquisition</h4>
<p>When the UE is configured with the higher layer parameter
<em>usage</em> in <em>SRS-ResourceSet</em> set as 'antennaSwitching',
the UE may be configured with only one of the following configurations
depending on the indicated UE capability
<em>supportedSRS-TxPortSwitch</em> ('t1r2' for 1T2R, 't1r1-t1r2' for
1T=1R/1T2R, 't2r4' for 2T4R, 't1r4' for 1T4R, 't1r1-t1r2-t1r4' for
1T=1R/1T2R/1T4R, 't1r4-t2r4' for 1T4R/2T4R, 't1r1-t1r2-t2r2-t2r4' for
1T=1R/1T2R/2T=2R/2T4R, 't1r1-t1r2-t2r2-t1r4-t2r4' for
1T=1R/1T2R/2T=2R/1T4R/2T4R, 't1r1' for 1T=1R, 't2r2' for 2T=2R,
't1r1-t2r2' for 1T=1R/2T=2R, 't4r4' for 4T=4R, or 't1r1-t2r2-t4r4' for
1T=1R/2T=2R/4T=4R) or the UE may be configured with only one of the
following configurations depending on the indicated UE capability
<em>supportedSRS-TxPortSwitchBeyond4Rx</em> ('t1r1' for 1T=1R, 't2r2'
for 2T=2R, 't1r2' for 1T2R, 't4r4' for 4T=4R, 't2r4' for 2T4R, 't1r4'
for 1T4R, 't2r6' for 2T6R, 't1r6' for 1T6R, 't4r8' for 4T8R, 't2r8' for
2T8R, 't1r8' for 1T8R):</p>
<p>- For 1T2R, if the UE is indicating
<em>srs-AntennaSwitching2SP-1Periodic</em> and/or
<em>srs-ExtensionAperiodicSRS</em>:</p>
<p>- when the UE is indicating
<em>srs-AntennaSwitching2SP-1Periodic</em> only, then up to two SRS
resource sets with <em>resourceType</em> in <em>SRS-ResourceSet</em> set
to 'semi-persistent' and up to one SRS resource set with
<em>resourceType</em> in <em>SRS-ResourceSet</em> set to 'periodic' can
be configured, or up to two SRS resource sets configured with a
different value for the higher layer parameter <em>resourceType</em> in
<em>SRS-ResourceSet</em> can be configured, where the two SRS resource
sets configured with 'semi-persistent' are not activated at the same
time, each SRS resource set has two SRS resources transmitted in
different symbols, each SRS resource in a given set consisting of a
single SRS port, and the SRS port of the second resource in the set is
associated with a different UE antenna port than the SRS port of the
first resource in the same set.</p>
<p>- when the UE is indicating <em>srs-ExtensionAperiodicSRS</em> only,
then up to two SRS resource sets with <em>resourceType</em> in
<em>SRS-ResourceSet</em> set to 'aperiodic' and up to one SRS resource
set with <em>resourceType</em> in <em>SRS-ResourceSet</em> set to
'periodic' or 'semi-persistent' can be configured, or up to two SRS
resource sets configured with a different value for the higher layer
parameter <em>resourceType</em> in <em>SRS-ResourceSet</em> can be
configured. In the case of two resource sets with <em>resourceType</em>
in <em>SRS-ResourceSet</em> set to 'aperiodic', a total of two SRS
resources are transmitted in different symbols of two different slots,
the SRS port of each SRS resource in the given two sets is associated
with a different UE antenna port and the two sets are each configured
with one SRS resource. In the case of the one resource set with
<em>resourceType</em> in <em>SRS-ResourceSet</em> set to 'aperiodic' is
configured, a total of two SRS resources transmitted in different
symbols of one slot and where the SRS port of the second resource in the
given set is associated with a different UE antenna port than the SRS
port of the first resource in the same set. Each SRS resource set with
'resourceType' in <em>SRS-ResourceSet</em> set to 'periodic' or
'semi-persistent' has two SRS resources transmitted in different
symbols, each SRS resource in a given set consisting of a single SRS
port, and the SRS port of the second resource in the set is associated
with a different UE antenna port than the SRS port of the first resource
in the same set.</p>
<p>- zero or one or two SRS resource sets configured with different
value of <em>resourceType</em> in <em>SRS-ResourceSet</em> set to
'periodic' or 'semi-persistent' if the UE is not indicating
<em>srs-AntennaSwitching2SP-1Periodic</em>, or up to two SRS resource
sets configured with resourceType in SRS-ResourceSet set to
'semi-persistent' and up to one SRS resource set configured with
resourceType in SRS-ResourceSet set to 'periodic' if the UE is
indicating <em>srs-AntennaSwitching2SP-1Periodic</em>, where the two SRS
resource sets configured with 'semi-persistent' are not activated at the
same time. An SRS resource set has two SRS resources transmitted in
different symbols, each SRS resource in a given set consisting of a
single SRS port, and the SRS port of the second resource in the set is
associated with a different UE antenna port than the SRS port of the
first resource in the same set, and</p>
<p>- zero or one SRS resource set with <em>resourceType</em> in
<em>SRS-ResourceSet</em> set to 'aperiodic' if the UE is not indicating
<em>srs-ExtensionAperiodicSRS</em>, or up to two SRS resource sets
configured with <em>resourceType</em> in <em>SRS-ResourceSet</em> set to
'aperiodic' if the UE is indicating <em>srs-ExtensionAperiodicSRS</em>,
where in the case of one resource set, a total of two SRS resources
transmitted in different symbols of one slot and where the SRS port of
the second resource in the given set is associated with a different UE
antenna port than the SRS port of the first resource in the same set. In
the case of two resource sets, a total of two SRS resources are
transmitted in different symbols of two different slots, the SRS port of
each SRS resource in the given two sets is associated with a different
UE antenna port. The two sets are each configured with one SRS resource,
or</p>
<p>- otherwise, for 1T2R, up to two SRS resource sets configured with a
different value for the higher layer parameter <em>resourceType</em> in
<em>SRS-ResourceSet</em> set, where each set has two SRS resources
transmitted in different symbols, each SRS resource in a given set
consisting of a single SRS port, and the SRS port of the second resource
in the set is associated with a different UE antenna port than the SRS
port of the first resource in the same set, or</p>
<p>- For 2T4R, if the UE is indicating
<em>srs-AntennaSwitching2SP-1Periodic</em> and/or
<em>srs-ExtensionAperiodicSRS</em>:</p>
<p>- when the UE is indicating
<em>srs-AntennaSwitching2SP-1Periodic</em> only, then up to two SRS
resource sets with <em>resourceType</em> in <em>SRS-ResourceSet</em> set
to 'semi-persistent' and up to one SRS resource set with
<em>resourceType</em> in <em>SRS-ResourceSet</em> set to 'periodic' can
be configured, or up to two SRS resource sets configured with a
different value for the higher layer parameter <em>resourceType</em> in
<em>SRS-ResourceSet</em> can be configured, where the two SRS resource
sets configured with 'semi-persistent' are not activated at the same
time, each SRS resource set has two SRS resources transmitted in
different symbols, each SRS resource in a given set consisting of two
SRS ports, and the SRS port pair of the second resource is associated
with a different UE antenna port pair than the SRS port pair of the
first resource.</p>
<p>- when the UE is indicating <em>srs-ExtensionAperiodicSRS</em> only,
then up to two SRS resource sets with <em>resourceType</em> in
<em>SRS-ResourceSet</em> set to 'aperiodic' and up to one SRS resource
set with <em>resourceType</em> in <em>SRS-ResourceSet</em> set to
'periodic' or 'semi-persistent' can be configured, or up to two SRS
resource sets configured with a different value for the higher layer
parameter <em>resourceType</em> in <em>SRS-ResourceSet</em> can be
configured. In the case of two resource sets with <em>resourceType</em>
in <em>SRS-ResourceSet</em> set to 'aperiodic', a total of two SRS
resources are transmitted in different symbols of two different slots,
the SRS port pair of each SRS resource in the given two sets is
associated with a different UE antenna port pair and the two sets are
each configured with one SRS resource. In the case of one resource set
with <em>resourceType</em> in <em>SRS-ResourceSet</em> set to
'aperiodic' is configured, a total of two SRS resources transmitted in
different symbols in the same slot, each SRS resource in a given set
consisting of two SRS ports, and the SRS port pair of the second
resource is associated with a different UE antenna port pair than the
SRS port pair of the first resource. Each SRS resource set with
'resourceType' in <em>SRS-ResourceSet</em> set to 'periodic' or
'semi-persistent' has two SRS resources transmitted in different
symbols, each SRS resource in a given set consisting of two SRS ports,
and the SRS port pair of the second resource is associated with a
different UE antenna port pair than the SRS port pair of the first
resource.</p>
<p>- zero or one or two SRS resource sets configured with a different
value for the higher layer parameter <em>resourceType</em> in
<em>SRS-ResourceSet</em> set to 'periodic' or 'semi-persistent' if the
UE is not indicating <em>srs-AntennaSwitching2SP-1Periodic</em>, or up
to two SRS resource sets configured with <em>resourceType</em> in
<em>SRS-ResourceSet</em> set to 'semi-persistent' and up to one SRS
resource set configured with <em>resourceType</em> in
<em>SRS-ResourceSet</em> set to 'periodic' if the UE is indicating
<em>srs-AntennaSwitching2SP-1Periodic</em>, where the two SRS resource
sets configured with 'semi-persistent' are not activated at the same
time. Each SRS resource set has two SRS resources transmitted in
different symbols, each SRS resource in a given set consisting of two
SRS ports, and the SRS port pair of the second resource is associated
with a different UE antenna port pair than the SRS port pair of the
first resource, and,</p>
<p>- zero or one SRS resource set configured with <em>resourceType</em>
in <em>SRS-ResourceSet</em> set to 'aperiodic' if the UE is not
indicating <em>srs-ExtensionAperiodicSRS</em>, or up to two SRS resource
sets configured with <em>resourceType</em> in <em>SRS-ResourceSet</em>
set to 'aperiodic' if the UE is indicating
<em>srs-ExtensionAperiodicSRS</em>, where in the case of one resource
set, a total of two SRS resources transmitted in different symbols in
the same slot, each SRS resource in a given set consisting of two SRS
ports, and the SRS port pair of the second resource is associated with a
different UE antenna port pair than the SRS port pair of the first
resource. In the case of two resource sets, a total of two SRS resources
are transmitted in different symbols of two different slots, the SRS
port pair of each SRS resource in the given two sets is associated with
a different UE antenna port pair. The two sets are each configured with
one SRS resource, or</p>
<p>- otherwise, for 2T4R, up to two SRS resource sets configured with a
different value for the higher layer parameter <em>resourceType</em> in
<em>SRS-ResourceSet</em>, where each SRS resource set has two SRS
resources transmitted in different symbols, each SRS resource in a given
set consisting of two SRS ports, and the SRS port pair of the second
resource is associated with a different UE antenna port pair than the
SRS port pair of the first resource, or</p>
<p>- For 1T4R, if the UE is indicating
<em>srs-AntennaSwitching2SP-1Periodic</em> and/or
<em>srs-ExtensionAperiodicSRS</em> and/or <em>srs-OneAP-SRS</em>,</p>
<p>- zero or one SRS resource set configured with <em>resourceType</em>
in <em>SRS-ResourceSet</em> set to 'periodic' or 'semi-persistent' if
the UE is not indicating <em>srs-AntennaSwitching2SP-1Periodic</em>, or
up to two SRS resource sets configured with <em>resourceType</em> in
<em>SRS-ResourceSet</em> set to '<em>semi-persistent</em>' and up to one
SRS resource set configured with <em>resourceType</em> in
<em>SRS-ResourceSet</em> set to '<em>periodic</em>' if the UE is
indicating <em>srs-AntennaSwitching2SP-1Periodic</em>, where the two SRS
resource sets configured with 'semi-persistent' are not activated at the
same time. Each SRS resource set has four SRS resources transmitted in
different symbols, each SRS resource in a given set consisting of a
single SRS port, and the SRS port of each resource is associated with a
different UE antenna port, and</p>
<p>- zero or two SRS resource sets each configured with
<em>resourceType</em> in <em>SRS-ResourceSet</em> set to 'aperiodic', if
the UE is not indicating <em>srs-ExtensionAperiodicSRS</em> or
<em>srs-OneAP-SRS</em>, or zero or one or two or four SRS resource sets
each configured with <em>resourceType</em> in <em>SRS-ResourceSet</em>
set to 'aperiodic' if the UE is indicating
<em>srs-ExtensionAperiodicSRS</em> and <em>srs-OneAP-SRS</em>, or zero
or two or four SRS resource sets each configured with
<em>resourceType</em> in <em>SRS-ResourceSet</em> set to 'aperiodic' if
the UE is indicating <em>srs-ExtensionAperiodicSRS</em> only, or zero or
one or two SRS resource sets each configured with <em>resourceType</em>
in <em>SRS-ResourceSet</em> set to 'aperiodic' if the UE is indicating
<em>srs-OneAP-SRS</em> only. In the case of one resource set, a total of
four SRS resources are transmitted in different symbols in the same
slot, and the SRS port of each resource in the given set is associated
with a different UE antenna port. In the case of two resource sets, a
total of four SRS resources are transmitted in different symbols of two
different slots, and the SRS port of each SRS resource in the given two
sets is associated with a different UE antenna port. The two sets are
each configured with two SRS resources, or one set is configured with
one SRS resource and the other set is configured with three SRS
resources. In the case of four resource sets, a total of four SRS
resources are transmitted in different symbols of four different slots,
and the SRS port of each SRS resource in the given four sets is
associated with a different UE antenna port. The four sets are each
configured with one SRS resource. The UE shall expect that the value of
the higher layer parameter <em>aperiodicSRS-ResourceTrigger</em> or the
value of an entry in <em>AperiodicSRS-ResourceTriggerList</em> in each
<em>SRS-ResourceSet</em> is the same, and the value of the higher layer
parameter <em>slotOffset</em> in each <em>SRS-ResourceSet</em> is
different when none of the SRS resource sets is configured with
parameter <em>availableSlotOffsetList</em> across all configured BWPs in
a component carrier. Or,</p>
<p>- otherwise, for 1T4R,</p>
<p>- zero or one SRS resource set configured with higher layer parameter
<em>resourceType</em> in <em>SRS-ResourceSet</em> set to 'periodic' or
'semi-persistent' with four SRS resources transmitted in different
symbols, each SRS resource in a given set consisting of a single SRS
port, and the SRS port of each resource is associated with a different
UE antenna port, and</p>
<p>- zero or two SRS resource sets each configured with higher layer
parameter <em>resourceType</em> in <em>SRS-ResourceSet</em> set to
'aperiodic' and with a total of four SRS resources transmitted in
different symbols of two different slots, and where the SRS port of each
SRS resource in the given two sets is associated with a different UE
antenna port. The two sets are each configured with two SRS resources,
or one set is configured with one SRS resource and the other set is
configured with three SRS resources. The UE shall expect that the value
of the higher layer parameter <em>aperiodicSRS-ResourceTrigger</em> or
the value of an entry in <em>AperiodicSRS-ResourceTriggerList</em> in
each <em>SRS-ResourceSet</em> is the same, and the value of the higher
layer parameter <em>slotOffset</em> in each <em>SRS-ResourceSet</em> is
different when none of the SRS resource sets is configured with
parameter <em>availableSlotOffsetList</em> across all configured BWPs in
a component carrier. Or,</p>
<p>- For 1T=1R, or 2T=2R, or 4T=4R, up to two SRS resource sets each
with one SRS resource can be configured, where the number of SRS ports
for each resource is equal to 1, 2, or 4 if the UE is not indicating
<em>srs-AntennaSwitching2SP-1Periodic</em>. Up to two SRS resource sets
configured with <em>resourceType</em> in <em>SRS-ResourceSet</em> set to
'<em>semi-persistent</em>' and up to one SRS resource set configured
with <em>resourceType</em> in <em>SRS-ResourceSet</em> set to
'<em>periodic</em>' can be configured and the two SRS resource sets
configured with '<em>semi-persistent</em>' are not activated at the same
time, or up to two SRS resource sets can be configured, if the UE is
indicating <em>srs-AntennaSwitching2SP-1Periodic</em>, where each SRS
resource set has one SRS resource, the number of SRS ports for each
resource is equal to 1, 2, or 4, or</p>
<p>- For 1T6R, zero or one SRS resource sets configured with
<em>resourceType</em> in <em>SRS-ResourceSet</em> set to 'periodic',
where in the case of one resource set has six SRS resources transmitted
in different symbols, each SRS resource in a given set consisting of a
single SRS port, and the SRS port of the resource in the set is
associated with a different UE antenna port, and</p>
<p>- For 1T6R, zero or one SRS resource sets configured with
<em>resourceType</em> in <em>SRS-ResourceSet</em> set to
'semi-persistent' if the UE is not indicating
<em>srs-AntennaSwitching2SP-1Periodic</em>, or up to two SRS resource
sets configured with <em>resourceType</em> in <em>SRS-ResourceSet</em>
set to 'semi-persistent' if the UE is indicating
<em>srs-AntennaSwitching2SP-1Periodic</em>, where the two SRS resource
sets configured with 'semi-persistent' are not activated at the same
time. Each SRS resource set has six SRS resources transmitted in
different symbols, each SRS resource in a given set consisting of a
single SRS port, and the SRS port of the resource in the set is
associated with a different UE antenna port, and</p>
<p>- For 1T6R, zero or one or two or three SRS resource sets configured
with <em>resourceType</em> in <em>SRS-ResourceSet</em> set to
'aperiodic', where in the case of one resource set a total of six SRS
resources transmitted in different symbols, each SRS resource in a given
set consisting of a single SRS port, and the SRS port of each resource
in the set is associated with a different UE antenna port. In the case
of two resource sets a total of six SRS resources are transmitted in
different symbols of two different slots, and the SRS port of each SRS
resource in the given two sets is associated with a different UE antenna
port. In the case of three resource sets, a total of six SRS resources
are transmitted in different symbols of three different slots, and the
SRS port of each SRS resource in the given three sets is associated with
a different UE antenna port, or</p>
<p>- For 1T8R, zero or one SRS resource sets configured with
<em>resourceType</em> in <em>SRS-ResourceSet</em> set to 'periodic',
where in the case of one resource set has eight SRS resources
transmitted in different symbols, each SRS resource in a given set
consisting of a single SRS port, and the SRS port of the resource in the
set is associated with a different UE antenna port, and</p>
<p>- For 1T8R, zero or one SRS resource sets configured with
<em>resourceType</em> in <em>SRS-ResourceSet</em> set to
'semi-persistent' if the UE is not indicating
<em>srs-AntennaSwitching2SP-1Periodic</em>, or up to two SRS resource
sets configured with <em>resourceType</em> in <em>SRS-ResourceSet</em>
set to 'semi-persistent' if the UE is indicating
<em>srs-AntennaSwitching2SP-1Periodic</em>, where the two SRS resource
sets configured with 'semi-persistent' are not activated at the same
time. Each SRS resource set has eight SRS resources transmitted in
different symbols, each SRS resource in a given set consisting of a
single SRS port, and the SRS port of the resource in the set is
associated with a different UE antenna port, and</p>
<p>- For 1T8R, zero or two or three or four SRS resource sets configured
with <em>resourceType</em> in <em>SRS-ResourceSet</em> set to
'aperiodic', where in the case of two resource sets a total of eight SRS
resources transmitted in different symbols of two different slots, and
where the SRS port of each SRS resource in the given two sets is
associated with a different UE antenna port. In the case of three
resource sets a total of eight SRS resources are transmitted in
different symbols of three different slots, and the SRS port of each SRS
resource in the given three sets is associated with a different UE
antenna port. In the case of four resource sets a total of eight SRS
resources are transmitted in different symbols of four different slots,
and the SRS port of each SRS resource in the given four sets is
associated with a different UE antenna port, or</p>
<p>- For 2T6R, zero or one SRS resource sets configured with
<em>resourceType</em> in <em>SRS-ResourceSet</em> set to 'periodic',
where in the case of one resource set has three SRS resources
transmitted in different symbols, each SRS resource in a given set
consisting of a two SRS ports, and the SRS port pair of the resource in
the set is associated with a different UE antenna port pair, and</p>
<p>- For 2T6R, zero or one SRS resource sets configured
<em>resourceType</em> in <em>SRS-ResourceSet</em> set to
'semi-persistent' if the UE is not indicating
<em>srs-AntennaSwitching2SP-1Periodic</em>, or up to two SRS resource
sets configured with 'semi-persistent' and up to one SRS resource set
configured with 'periodic' if the UE is indicating
<em>srs-AntennaSwitching2SP-1Periodic</em>, where the two SRS resource
sets configured with 'semi-persistent' are not activated at the same
time. Each SRS resource set has three SRS resources transmitted in
different symbols, each SRS resource in a given set consisting of a two
SRS ports, and the SRS port pair of the resource in the set is
associated with a different UE antenna port pair, and</p>
<p>- For 2T6R, zero or one or two or three SRS resource sets configured
with <em>resourceType</em> in <em>SRS-ResourceSet</em> set to
'aperiodic, where in the case of one resource set has three SRS
resources transmitted in different symbols, each SRS resource in a given
set consisting of a two SRS ports, and the SRS port pair of the resource
in the set is associated with a different UE antenna port pair. In the
case of two resource sets a total of three SRS resources are transmitted
in different symbols of two different slots, and the SRS port pair of
each SRS resource in the given two sets is associated with a different
UE antenna port pair. One set is configured with two SRS resources and
another set with one resource. In the case of three resource sets a
total of three SRS resources are transmitted in different symbols of
three different slots, and the SRS port pair of each SRS resource in the
given three sets is associated with a different UE antenna port pair,
or</p>
<p>- For 2T8R, zero or one SRS resource sets configured with
<em>resourceType</em> in <em>SRS-ResourceSet</em> set to 'periodic',
where in the case of one resource set has four SRS resources transmitted
in different symbols, each SRS resource in a given set consisting of a
two SRS ports, and the SRS port pair of the resource in the set is
associated with a different UE antenna port pair, and</p>
<p>- For 2T8R, zero or one SRS resource sets configured with
<em>resourceType</em> in <em>SRS-ResourceSet</em> set to
'semi-persistent' if the UE is not indicating
<em>srs-AntennaSwitching2SP-1Periodic</em>, or up to two SRS resource
sets configured with 'semi-persistent' and up to one SRS resource set
configured with 'periodic' if the UE is indicating
<em>srs-AntennaSwitching2SP-1Periodic</em>, where the two SRS resource
sets configured with 'semi-persistent' are not activated at the same
time. Each SRS resource set has four SRS resources transmitted in
different symbols, each SRS resource in a given set consisting of a two
SRS ports, and the SRS port pair of the resource in the set is
associated with a different UE antenna port pair, and</p>
<p>- For 2T8R, zero or one or two or three or four SRS resource sets
configured with <em>resourceType</em> in <em>SRS-ResourceSet</em> set to
'aperiodic', where in the case of one resource set has four SRS
resources transmitted in different symbols, each SRS resource in a given
set consisting of a two SRS ports, and the SRS port pair of the resource
in the set is associated with a different UE antenna port pair. In the
case of two resource sets a total of four SRS resources transmitted in
different symbols of two different slots, and where the SRS port pair of
each SRS resource in the given two sets is associated with a different
UE antenna port pair. In the case of three resource sets a total of four
SRS resources transmitted in different symbols of three different slots,
and where the SRS port pair of each SRS resource in the given three sets
is associated with a different UE antenna port pair. Two sets are
configured with one SRS resource in each set and one resource set is
configured with two resources. In the case of four resource sets a total
of four SRS resources transmitted in different symbols of four different
slots, and where the SRS port pair of each SRS resource in the given
four sets is associated with a different UE antenna port pair. Four sets
are configured with one SRS resource in each set, or</p>
<p>- For 4T8R, zero or one or two SRS resource sets configured with a
different value of <em>resourceType</em> in <em>SRS-ResourceSet</em> set
to 'periodic' or 'semi-persistent' if the UE is not indicating
<em>srs-AntennaSwitching2SP-1Periodic</em>, or up to two SRS resource
sets configured with 'semi-persistent' and up to one SRS resource set
configured with 'periodic' if the UE is indicating
<em>srs-AntennaSwitching2SP-1Periodic</em>, where the two SRS resource
sets configured with 'semi-persistent' are not activated at the same
time. Each SRS resource set has two SRS resources transmitted in
different symbols, each SRS resource in a given set consisting of a four
SRS ports, and the SRS ports of the resource in the set are associated
with a different UE antenna ports, or</p>
<p>- For 4T8R, zero or one or two SRS resource sets configured with
<em>resourceType</em> in <em>SRS-ResourceSet</em> set to 'aperiodic',
where in the case of one resource set has two SRS resources transmitted
in different symbols, each SRS resource in a given set consisting of a
four SRS ports, and the SRS ports of the resource in the set are
associated with a different UE antenna ports. In the case of two
resource sets a total of two SRS resources are transmitted in different
symbols of two different slots, and where the SRS ports of each SRS
resource in the given two sets are associated with a different UE
antenna ports.</p>
<p>The UE is configured with a guard period of <em>Y</em> symbols, in
which the UE does not transmit any other signal, in the case the SRS
resources of a set are transmitted in the same slot. The guard period is
in-between the SRS resources of the set. For two SRS resource sets of an
antenna switching located in two consecutive slots, if UE is capable of
transmitting SRS in all symbols in one slot, a guard period of
<em>Y</em> symbols exists between the last OFDM symbol occupied by the
SRS resource set in the first slot and the first OFDM symbol occupied by
the SRS resource set in the second slot.</p>
<p>For the inter-set guard period, the UE does not transmit any other
signal on any symbols of the interval if the interval between SRS
resource sets is <em>Y</em> symbols.</p>
<p>- When both the SRS resource on all of the corresponding symbols
prior to the gap and the SRS resource on all of the corresponding
symbols after the gap are dropped due to collision handling, the gap
period is also dropped with same priority and can be used for UL
transmission.</p>
<p>The UE shall expect to be configured with the same number of SRS
ports for all SRS resources in the SRS resource set(s) with higher layer
parameter <em>usage</em> set as 'antennaSwitching'.</p>
<p>In the case that more than one SRS resource set configured with
<em>resourceType</em> in <em>SRS-ResourceSet</em> set to 'aperiodic',
the UE shall expect that the more than one set are configured with the
same values of the higher layer parameters <em>alpha</em>, <em>p0</em>,
<em>pathlossReferenceRS</em>, and
<em>srs-PowerControlAdjustmentStates</em> in
<em>SRS-ResourceSet</em>.</p>
<p>For 1T2R, 1T4R, 2T4R, 1T6R, 1T8R, 2T6R, 2T8R, or 4T8R, the UE shall
not expect to be configured or triggered with more than one SRS resource
set with higher layer parameter <em>usage</em> set as 'antennaSwitching'
in the same slot. For 1T=1R, 2T=2R or 4T=4R, the UE shall not expect to
be configured or triggered with more than one SRS resource set with
higher layer parameter <em>usage</em> set as 'antennaSwitching' in the
same symbol.</p>
<p>The value of <em>Y</em> is defined by Table 6.2.1.2-1.</p>
<p>Table 6.2.1.2-1: The minimum guard period between two SRS resources
of an SRS resource set for antenna switching</p>
<table>
<colgroup>
<col style="width: 23%" />
<col style="width: 38%" />
<col style="width: 38%" />
</colgroup>
<tbody>
<tr>
<td><img src="media/image770.svg" /></td>
<td><img src="media/image771.svg" /></td>
<td><em>Y</em> [symbol]</td>
</tr>
<tr>
<td>0</td>
<td>15</td>
<td>1</td>
</tr>
<tr>
<td>1</td>
<td>30</td>
<td>1</td>
</tr>
<tr>
<td>2</td>
<td>60</td>
<td>1</td>
</tr>
<tr>
<td>3</td>
<td>120</td>
<td>2</td>
</tr>
<tr>
<td style="text-align: center;">5</td>
<td style="text-align: center;">480</td>
<td style="text-align: center;">7</td>
</tr>
<tr>
<td style="text-align: center;">6</td>
<td style="text-align: center;">960</td>
<td style="text-align: center;">14</td>
</tr>
</tbody>
</table>
<h4 id="ue-sounding-procedure-between-component-carriers">6.2.1.3 UE
sounding procedure between component carriers</h4>
<p>For a carrier of a serving cell <em>c<sub>1</sub></em> with slot
formats comprised of DL and UL symbols, not configured for PUSCH/PUCCH
transmission, denote <span class="math inline">\(c_{2}\)</span> as the
corresponding carrier of a serving cell whose UL transmissions are
temporarily suspended as signalled by higher layer parameter
<em>srs-SwitchFromServCellIndex</em> and <em>srs-SwitchFromCarrier</em>.
Define the set <span class="math inline">\(S\left( c_{2} \right) = \{
c_{2},\ s_{1}(c_{2})\ldots s_{N - 1}(c_{2})\}\)</span> as the set of
carriers of serving cells that each carrier meets one of the following
conditions:</p>
<p>- <span class="math inline">\(s_{i}(c_{2})\)</span> is in the same
band and same TAG as <span class="math inline">\(c_{2}\)</span>;</p>
<p>- <span class="math inline">\(s_{i}(c_{2})\)</span> is a carrier of
inter-band CA with <span class="math inline">\(c_{2}\)</span> and <span
class="math inline">\(s_{i}(c_{2})\)</span> is indicated through the
capability signalling <em>srs-SwitchingAffectedBandsListNR-r17</em> to
be affected by the SRS switch from <span
class="math inline">\(c_{2}\)</span> to <span
class="math inline">\(c_{1}\)</span>;</p>
<p>where <span class="math inline">\(1 \leq i \leq N - 1\)</span>.</p>
<p>A UE can be configured with SRS resource(s) on a carrier
<em>c<sub>1</sub></em> with slot formats comprised of DL and UL symbols
and not configured for PUSCH/PUCCH transmission. For carrier
<em>c<sub>1</sub></em>, the UE is configured with higher layer parameter
<em>srs-SwitchFromServCellIndex</em> and <em>srs-SwitchFromCarrier</em>
the switching from carrier <em>c<sub>2</sub></em> which is configured
for PUSCH/PUCCH transmission. During SRS transmission on carrier
<em>c<sub>1 </sub></em>(including any interruption due to uplink or
downlink RF retuning time [11, TS 38.133] as defined by higher layer
parameters <em>switchingTimeUL</em> and <em>switchingTimeDL</em> of
<em>SRS-SwitchingTimeNR</em>), the UE temporarily suspends the uplink
transmission on carriers in the set <em>S(c<sub>2</sub>)</em>.</p>
<p>For an SRS transmission starting in symbol <span
class="math inline">\(N_{c_{1}}\)</span> of carrier <span
class="math inline">\(c_{1}\)</span> and a conflicting transmission in
any carrier <span class="math inline">\(within\ the\ set\ S\left( c_{2}
\right)\ \)</span> starting in symbol<span class="math inline">\(\
N_{S}\)</span>, the UE shall apply the prioritization / dropping rules
in the remainder of this clause taking into account:</p>
<p>- DCI(s) for which the time interval between the last symbol of PDCCH
and <span class="math inline">\(N_{c_{1}}\)</span> is at least<span
class="math inline">\({\ N}_{2}\ \)</span>symbols and an additional time
duration <span class="math inline">\(T_{SRS_{CS}}\)</span>, and the time
interval between the last symbol of PDCCH and <span
class="math inline">\(N_{S}\)</span> is at least <span
class="math inline">\({\ N}_{2}\)</span> symbols<em>;</em> and</p>
<p>- semi-persistent CSI reports or SRS considered active at least <span
class="math inline">\(N_{2}\)</span> symbols and an additional time
duration <span class="math inline">\(T_{SRS_{CS}}\)</span> before <span
class="math inline">\(N_{c_{1}}\)</span>, and considered active at least
<span class="math inline">\(N_{2}\)</span> symbols before <span
class="math inline">\(N_{S}\)</span>.</p>
<p>where <span class="math inline">\(T_{SRS_{CS}} = max\{
switchingTimeUL,switchingTimeDL\}\)</span>, and the time interval unit
of OFDM symbol is counted based on the smaller subcarrier spacing across
any carrier within the set <span class="math inline">\(S\left( c_{2}
\right)\)</span>, <span class="math inline">\(c_{1}\)</span> and their
corresponding scheduling cells.</p>
<p>The following prioritization rules shall be applied in case of
collision between a transmission of SRS over carrier <span
class="math inline">\(c_{1}\ \)</span> and transmission of a physical
signal/channel over a carrier of a serving cell in set <span
class="math inline">\(S\left( c_{2} \right)\)</span></p>
<p>- the UE shall not transmit SRS whenever SRS transmission (including
any interruption due to uplink or downlink RF retuning time [11, TS
38.133] as defined by higher layer parameters <em>switchingTimeUL</em>
and <em>switchingTimeDL</em> of <em>SRS-SwitchingTimeNR)</em> on the
carrier of the serving cell <span class="math inline">\(c_{1}\ \)</span>
and PUSCH/PUCCH transmission carrying HARQ-ACK/positive SR/RI/CRI/SSBRI
and/or PRACH on a carrier of a serving cell in set <span
class="math inline">\(S\left( c_{2} \right)\ \)</span>happen to overlap
in the same symbol</p>
<p>- the UE shall not transmit a periodic/semi-persistent SRS whenever
periodic/semi-persistent SRS transmission (including any interruption
due to uplink or downlink RF retuning time [11, TS 38.133] as defined by
higher layer parameters <em>switchingTimeUL</em> and
<em>switchingTimeDL</em> of <em>SRS-SwitchingTimeNR)</em> on the carrier
of the serving cell <span class="math inline">\(c_{1}\ \)</span> and
PUSCH transmission carrying aperiodic CSI on a carrier of a serving cell
in set <span class="math inline">\(S\left( c_{2} \right)\)</span> happen
to overlap in the same symbol</p>
<p>- the UE shall drop PUCCH/PUSCH transmission carrying
periodic/semi-persistent CSI comprising only CQI/PMI/L1-RSRP/L1-SINR,
and/or SRS transmission on a carrier of a serving cell in set <span
class="math inline">\(S\left( c_{2} \right)\)</span> configured for
PUSCH/PUCCH transmission whenever the transmission and SRS transmission
(including any interruption due to uplink or downlink RF retuning time
[11, TS 38.133] as defined by higher layer parameters
<em>switchingTimeUL</em> and <em>switchingTimeDL</em> of
<em>SRS-SwitchingTimeNR)</em> on the carrier of the serving cell <span
class="math inline">\(c_{1}\ \)</span> happen to overlap in the same
symbol</p>
<p>- the UE shall drop PUSCH transmission carrying aperiodic CSI
comprising only CQI/PMI/L1-RSRP/L1-SINR on a carrier of a serving cell
in set <span class="math inline">\(S\left( c_{2} \right)\
\)</span>whenever the transmission and aperiodic SRS transmission
(including any interruption due to uplink or downlink RF retuning time
[11, TS 38.133]) as defined by higher layer parameters
<em>switchingTimeUL</em> and <em>switchingTimeDL</em> of
<em>SRS-SwitchingTimeNR)</em> on the carrier of the serving cell <span
class="math inline">\(c_{1}\ \)</span> happen to overlap in the same
symbol.</p>
<p>For an aperiodic SRS triggered in DCI format 2_3 and if the UE is
configured with higher layer parameter <em>srs-TPC-PDCCH-Group</em> set
to 'typeA', and given by <em>SRS-CarrierSwitching,</em> without
PUSCH/PUCCH transmission, the UE in each serving cell transmits the
configured one or two SRS resource set(s) from
<em>srs-ResourceSetToAddModList</em> with higher layer parameter
<em>usage</em> set to 'antennaSwitching' and higher layer parameter
<em>resourceType</em> in <em>SRS-ResourceSet</em> set to
'aperiodic'.</p>
<p>For an aperiodic SRS triggered in DCI format 2_3 and if the UE is
configured with higher layer parameter <em>srs-TPC-PDCCH-Group</em> set
to 'typeB' without PUSCH/PUCCH transmission, the UE in each serving cell
transmits the configured one or two SRS resource set(s) from
<em>srs-ResourceSetToAddModList</em> with higher layer parameter
<em>usage</em> set to 'antennaSwitching' and higher layer parameter
<em>resourceType</em> in <em>SRS-ResourceSet</em> set to
'aperiodic'.</p>
<p>For an aperiodic SRS triggered in DCI format 1_1 or 1_2, if the UE is
configured by <em>SRS-CarrierSwitching</em>, it transmits SRS on one
serving cell not configured for PUSCH/PUCCH transmission scheduled by
the DCI and the UE in the serving cell transmits the configured one or
two SRS resource set(s) with higher layer parameter usage set to
'antennaSwitching' and higher layer parameter <em>resourceType</em> in
<em>SRS-ResourceSet</em> set to 'aperiodic'.</p>
<p>If the UE is not configured for PUSCH/PUCCH transmission on carrier
<em>c<sub>1 </sub></em>with slot formats comprised of DL and UL symbols,
and if the UE is not capable of simultaneous reception and transmission
on carrier <em>c<sub>1</sub></em> and serving cell
<em>c<sub>2</sub></em>, the UE is not expected to be configured or
indicated with SRS resource(s) such that SRS transmission on carrier
<em>c<sub>1</sub></em> (including any interruption due to uplink or
downlink RF retuning time [11, TS 38.133] as defined by higher layer
parameters <em>switchingTimeUL</em> and <em>switchingTimeDL</em> of
<em>SRS-SwitchingTimeNR</em>) would collide with the REs corresponding
to the SS/PBCH blocks configured for the UE or the slots belonging to a
control resource set indicated by <em>MIB</em> or <em>SIB1</em> on
serving cell <em>c<sub>2</sub></em>.</p>
<p>For <em>n</em>-th (<em>n ≥</em> 1) aperiodic SRS transmission on a
cell <em>c</em>, upon detection of a positive SRS request on a grant,
the UE shall commence this SRS transmission on the configured symbol and
slot provided</p>
<p>- it is no earlier than the summation of</p>
<p>- the maximum time duration between the two durations spanned by N
OFDM symbols of the numerology of cell <em>c</em> and the cell carrying
the grant respectively, and</p>
<p>- the UL or DL RF retuning time [11, TS 38.133] as defined by higher
layer parameters <em>switchingTimeUL</em> and <em>switchingTimeDL</em>
of <em>SRS-SwitchingTimeNR,</em></p>
<p>- it does not collide with any previous SRS transmissions, or
interruption due to UL or DL RF retuning time, except if the previous
SRS transmission is in the same cell <em>c</em> and the UE reports
<em>stayOnTargetCC-SRS-CarrierSwitch</em> for the corresponding band
combination.</p>
<p>otherwise, <em>n</em>-th SRS transmission is dropped, where N is the
reported capability as the minimum time interval in unit of symbols,
between the DCI triggering and aperiodic SRS transmission.</p>
<p>In case of inter-band carrier aggregation, a UE can simultaneously
transmit SRS and PUCCH/PUSCH across component carriers in different
bands subject to the UE's capability.</p>
<p>In case of inter-band carrier aggregation, a UE can simultaneously
transmit PRACH and SRS across component carriers in different bands
subject to UE's capability.</p>
<p>If the UE is not configured for PUSCH/PUCCH transmission for at least
one serving cell configured with slot formats comprised of DL and UL
symbols, and if the UE is not capable of simultaneous reception and
transmission on serving cell <em>c<sub>1</sub></em> and serving cell
s(<em>c<sub>2</sub></em>), and if a UE</p>
<p>- is configured with multiple serving cells and is provided with
<em>directionalCollisionHandling-r16</em> = 'enabled' for a set of
serving cell(s) among the configured multiple serving cells including
serving cell <em>c<sub>1</sub></em> and s(<em>c<sub>2</sub></em>),
and</p>
<p>- indicates support of <em>half-DuplexTDD-CA-SameSCS-r16</em>
capability, and</p>
<p>- is not configured to monitor PDCCH for detection of DCI format 2_0
on any of the multiple serving cells,</p>
<p>the UE shall apply first the prioritization/dropping rules described
above for sounding procedure between component carriers and then apply
the procedures for directional collision handling in clause 11.1 of [6,
TS 38.213].</p>
<h4 id="ue-sounding-procedure-for-positioning-purposes">6.2.1.4 UE
sounding procedure for positioning purposes</h4>
<p>When the SRS is configured by the higher layer parameter
<em>SRS-PosResource</em> and if the higher layer parameter
<em>spatialRelationInfoPos</em> is configured<em>,</em> it contains the
ID of the configuration fields of a reference RS according to Clause
6.3.2 of [TS 38.331]. The reference RS can be an SRS configured by the
higher layer parameter <em>SRS-Resource</em> or
<em>SRS-PosResource</em>, CSI-RS, SS/PBCH block, or a DL PRS configured
on a serving cell or a SS/PBCH block or a DL PRS configured on a
non-serving cell. If the UE is configured for transmission of
<em>SRS-PosResource</em> in RRC_INACTIVE mode, the configured
<em>spatialRelationInfoPos</em> is also applicable.</p>
<p>The UE is not expected to transmit multiple SRS resources with
different spatial relations in the same OFDM symbol.</p>
<p>If the UE is not configured with the higher layer parameter
<em>spatialRelationInfoPos</em> the UE may use a fixed spatial domain
transmission filter for transmissions of the SRS configured by the
higher layer parameter <em>SRS-PosResource</em> across multiple SRS
resources or it may use a different spatial domain transmission filter
across multiple SRS resources.</p>
<p>In RRC_CONNECTED mode, the UE is only expected to transmit an SRS
configured by the higher layer parameter <em>SRS-PosResource</em> within
the active UL BWP of the UE.</p>
<p>When the configuration of SRS is done by the higher layer parameter
<em>SRS-PosResource</em>, the UE can only be provided with a single RS
source in <em>spatialRelationInfoPos</em> per SRS resource for
positioning.</p>
<p>For operation on the same carrier, if an SRS configured by the higher
parameter <em>SRS-PosResource</em> collides with a scheduled PUSCH, the
SRS is dropped in the symbols where the collision occurs.</p>
<p>The UE does not expect to be configured with <em>SRS-PosResource</em>
on a carrier of a serving cell with slot formats comprised of DL and UL
symbols, not configured for PUSCH/PUCCH transmission.</p>
<p>Timing Error Group (TEG) at UE side is defined:</p>
<p>- UE Tx TEG is associated with the transmissions of one or more UL
SRS resources for the positioning purpose, which have the Tx timing
error difference within a certain margin.</p>
<p>The UE may be configured to report, via high layer parameter
<em>nr-UE-RxTxTEG-Request</em> or
<em>ue-TxTEG-RequestUL-TDOA-Config</em>, subject to UE capability,
association information of the already transmitted SRS resource(s)
configured by the higher layer parameter <em>SRS-PosResource</em> with
UE Tx TEG(s) via higher layer parameter <em>nr-SRS-TxTEG-Set</em> or
<em>ue-TxTEG-AssociationList</em>.</p>
<p>The UE may report, via high layer parameter
<em>ue-TxTEG-TimingErrorMarginValue</em>, the UE Tx TEG timing error
margin value of all the UE Tx TEGs within one
<em>UEPositioningAssistanceInfo</em>.</p>
<p>If the UE reports a UE Tx TEG ID with a UE Rx-Tx time difference
measurement, as defined in clause 5.1.6.5, the UE shall report the
association information of the already transmitted SRS resources
configured by the higher layer parameter <em>SRS-PosResource</em> with
the UE Tx TEG ID.</p>
<p>If the UE is configured with SRS resources configured by the higher
layer parameter <em>SRS-PosResource</em> in multiple CCs, the UE should
report the <em>carrierFreq or servCellId</em> of the SRS resources when
it reports the UE Tx TEG associations.</p>
<p>If the UE reports a UE RxTx TEG ID with a UE Rx-Tx time difference
measurement, the UE may report a UE Tx TEG ID.</p>
<p>If the UE reports a UE Tx TEG ID with a UE Rx-Tx time difference
measurement, the UE may report a UE Tx TEG timing error margin value,
via high layer parameter <em>nr-UE-TxTEG-TimingErrorMargin</em>, for all
the UE Tx TEGs within one
<em>NR-Multi-RTT-SignalMeasurementInformation</em>.</p>
<p>Subject to UE capability, the UE may be configured with an SRS
resource for positioning associated with the initial UL BWP, and the SRS
resource is transmitted inside the initial UL BWP during RRC_INACTIVE
mode with the same CP and subcarrier spacing as configured for the
initial UL BWP. Subject to UE capability, the UE may be configured with
an SRS resource for positioning outside the initial BWP including
frequency location and bandwidth, subcarrier spacing, and CP length for
transmission of the SRS in RRC_INACTIVE mode. If an SRS symbol for
positioning outside the initial BWP in RRC_INACTIVE mode including the
switching time, indicated in higher layer parameter
<em>switchingTimeSRS-TX-OtherTX</em>, in unpaired spectrum, subject to
UE capability, collides in time domain with other DL signals or channels
or UL signals or channels, the colliding SRS symbol for positioning is
dropped. If an SRS symbol for positioning outside the initial BWP in
RRC_INACTIVE mode including the switching time, indicated in higher
layer parameter <em>switchingTimeSRS-TX-OtherTX</em>, in paired spectrum
or SUL band, subject to UE capability, collides in time domain with UL
signals or channels on the same carrier, the colliding SRS symbol for
positioning is dropped. The SRS resource for positioning outside the
initial BWP in RRC_INACTIVE mode is configured in the same band and CC
as the initial UL BWP.</p>
<p>If the UE in RRC_INACTIVE mode determines that the UE is not able to
accurately measure the configured DL RS in
<em>SRS-SpatialRelationInfoPos</em> for a SRS resource for positioning
where the DL RS is semi-persistent or periodic, the UE stops
transmission of the SRS resource for positioning.</p>
<p>The UE is not expected to simultaneously transmit SRS resources
configured by the higher layer parameter <em>SRS-PosResource</em> on NUL
and SUL band in RRC_INACTIVE mode.</p>
<h3 id="ue-dm-rs-transmission-procedure">6.2.2 UE DM-RS transmission
procedure</h3>
<p>The DM-RS transmission procedures for PUSCH scheduled by PDCCH with
DCI format 0_1 described in this clause equally apply to PUSCH scheduled
by PDCCH with DCI format 0_2, by applying the parameters of
<em>dmrs-UplinkForPUSCH-MappingTypeA-DCI-0-2</em> and
<em>dmrs-UplinkForPUSCH-MappingTypeB-DCI-0-2</em> instead of
<em>dmrs-UplinkForPUSCH-MappingTypeA</em> and
<em>dmrs-UplinkForPUSCH-MappingTypeB</em>.</p>
<p>When transmitted PUSCH is neither scheduled by DCI format 0_1/0_2
with CRC scrambled by C-RNTI, CS-RNTI, SP-CSI-RNTI or MCS-C-RNTI, nor
corresponding to a configured grant, nor being a PUSCH for Type-2 random
access procedure, the UE shall use single symbol front-loaded DM-RS of
configuration type 1 on DM-RS port 0 and the remaining REs not used for
DM-RS in the symbols are not used for any PUSCH transmission except for
PUSCH with allocation duration of 2 or less OFDM symbols with transform
precoding disabled, additional DM-RS can be transmitted according to the
scheduling type and the PUSCH duration as specified in Table 6.4.1.1.3-3
of [4, TS38.211] for frequency hopping disabled and as specified in
Table 6.4.1.1.3-6 of [4, TS38.211] for frequency hopping enabled,
and</p>
<p>If frequency hopping is disabled:</p>
<p>- The UE shall assume <em>dmrs-AdditionalPosition</em> equals to
'pos2' and up to two additional DM-RS can be transmitted according to
PUSCH duration, or</p>
<p>If frequency hopping is enabled:</p>
<p>- The UE shall assume <em>dmrs-AdditionalPosition</em> equals to
'pos1' and up to one additional DM-RS can be transmitted according to
PUSCH duration.</p>
<p>When transmitted PUSCH is scheduled by activation DCI format 0_0 with
CRC scrambled by CS-RNTI, the UE shall use single symbol front-loaded
DM-RS of configuration type provided by higher layer parameter
<em>dmrs-Type</em> in <em>DMRS-UplinkConfig</em> on DM-RS port 0 and the
remaining REs not used for DM-RS in the symbols are not used for any
PUSCH transmission except for PUSCH with allocation duration of 2 or
less OFDM symbols with transform precoding disabled, and additional
DM-RS with <em>dmrs-AdditionalPosition</em> from
C<em>onfiguredGrantConfig</em> can be transmitted according to the
scheduling type and the PUSCH duration as specified in Table 6.4.1.1.3-3
of [4, TS38.211] for frequency hopping disabled and as specified in
Table 6.4.1.1.3-6 of [4, TS38.211] for frequency hopping enabled.</p>
<p>For the UE-specific reference signals generation as defined in Clause
6.4.1.1 of [4, TS 38.211], a UE can be configured by higher layers with
one or two scrambling identity(s), <span
class="math inline">\(n_{ID}^{DMRS,i}\ \)</span><em>i</em> = 0,1 which
are the same for both PUSCH mapping Type A and Type B.</p>
<p>When transmitted PUSCH is scheduled by DCI format 0_1 with CRC
scrambled by C-RNTI, CS-RNTI, SP-CSI-RNTI or MCS-C-RNTI, or
corresponding to a configured grant, or being a PUSCH for Type-2 random
access procedure,</p>
<p>- for a configured-grant based PUSCH transmission in RRC_INACTIVE
state, the UE is provided with a set of DM-RS port(s) by
<em>sdt-DMRS-Ports</em>. The DM-RS port for the PUSCH is determined by
the mapping between SS/PBCH block(s) and a PUSCH occasion and the
associated DM-RS resource as described in Clause 19.1 of [6, TS
38.213].</p>
<p>- the UE may be configured with higher layer parameter
<em>dmrs-Type</em> in <em>DMRS-UplinkConfig</em>, and the configured
DM-RS configuration type is used for transmitting PUSCH in as defined in
Clause 6.4.1.1 of [4, TS 38.211].</p>
<p>- the UE may be configured with the maximum number of front-loaded
DM-RS symbols for PUSCH by higher layer parameter <em>maxLength</em> in
<em>DMRS-UplinkConfig,</em> or by higher layer parameter
<em>msgA-MaxLength</em> in <em>msgA-DMRS-Config</em>,</p>
<p>- if <em>maxLength</em> is not configured, single-symbol DM-RS can be
scheduled for the UE by DCI or configured by the configured grant
configuration, and the UE can be configured with a number of additional
DM-RS for PUSCH by higher layer parameter
<em>dmrs-AdditionalPosition,</em> which can be 'pos0', 'pos1', 'pos2',
'pos3'.</p>
<p>- if <em>maxLength</em> is configured, either single-symbol DM-RS or
double symbol DM-RS can be scheduled for the UE by DCI or configured by
the configured grant configuration, and the UE can be configured with a
number of additional DM-RS for PUSCH by higher layer parameter
<em>dmrs-AdditionalPosition,</em> which can be 'pos0' or 'pos1'.</p>
<p>- for MsgA PUSCH for Type-2 random access procedure the UE can be
configured with a number of additional DM-RS for PUSCH by higher layer
parameter <em>msgA-DMRS-AdditionalPosition,</em> which can be 'pos0',
'pos1', 'pos2', 'pos3' for single-symbol DM-RS or 'pos0', 'pos1' for
double-symbol DM-RS.</p>
<p>- and, the UE shall transmit a number of additional DM-RS as
specified in Table 6.4.1.1.3-3 and Table 6.4.1.1.3-4 in -Clause
6.4.1.1.3 of [4, TS 38.211].</p>
<p>If a UE transmitting PUSCH scheduled by DCI format 0_2 is configured
with the higher layer parameter <em>phaseTrackingRS</em> in
<em>dmrs-UplinkForPUSCH-MappingTypeA-DCI-0-2</em> or
<em>dmrs-UplinkForPUSCH-MappingTypeB-DCI-0-2</em>, or a UE transmitting
PUSCH scheduled by DCI format 0_0 or DCI format 0_1 is configured with
the higher layer parameter <em>phaseTrackingRS</em> in
<em>dmrs-UplinkForPUSCH-MappingTypeA</em> or
<em>dmrs-UplinkForPUSCH-MappingTypeB</em>, the UE may assume that the
following configurations are not occurring simultaneously for the
transmitted PUSCH</p>
<p>- any DM-RS ports among 4-7 or 6-11 for DM-RS configurations type 1
and type 2, respectively are scheduled for the UE and PT-RS is
transmitted from the UE.</p>
<p>For PUSCH scheduled by DCI format 0_1, by activation DCI format 0_1
with CRC scrambled by CS-RNTI, or configured by configured grant Type 1
configuration, the UE shall assume the DM-RS CDM groups indicated in
Tables 7.3.1.1.2-6 to 7.3.1.1.2-23 of Clause 7.3.1.1 of [5, TS38.212]
are not used for data transmission, where "1", "2" and "3" for the
number of DM-RS CDM group(s) correspond to CDM group 0, {0,1}, {0,1,2},
respectively.</p>
<p>For PUSCH scheduled by DCI format 0_0 or by activation DCI format 0_0
with CRC scrambled by CS-RNTI, the UE shall assume the number of DM-RS
CDM groups without data is 1 which corresponds to CDM group 0 for the
case of PUSCH with allocation duration of 2 or less OFDM symbols with
transform precoding disabled, the UE shall assume that the number of
DM-RS CDM groups without data is 3 which corresponds to CDM group
{0,1,2} for the case of PUSCH scheduled by activation DCI format 0_0 and
the <em>dmrs-Type</em> in <em>DMRS-UplinkConfig</em> equal to 'type2'
and the PUSCH allocation duration being more than 2 OFDM symbols, and
the UE shall assume that the number of DM-RS CDM groups without data is
2 which corresponds to CDM group {0,1} for all other cases.</p>
<p>For MsgA PUSCH transmission, if the UE is not configured with
<em>msgA-PUSCH-DMRS-CDM-group,</em> the UE shall assume that 2 DM-RS CDM
groups are configured. Otherwise, <em>msgA-PUSCH-DMRS-CDM-group</em>
indicates which DM-RS CDM group to use from the set of {0,1}.</p>
<p>For MsgA PUSCH transmission, if the UE is not configured with
<em>msgA-PUSCH-NrofPorts,</em> the UE shall assume that 4 ports are
configured per DM-RS CDM group for double-symbol DM-RS. Otherwise,
<em>msgA-PUSCH-NrofPorts</em> with value of 0 indicates the first port
per DM-RS CDM group, while a value of 1 indicates the first two ports
per DM-RS CDM group.</p>
<p>For uplink DM-RS with PUSCH, the UE may assume the ratio of PUSCH
EPRE to DM-RS EPRE (<img src="media/image3.svg" /> [dB]) is given by
Table 6.2.2-1 according to the number of DM-RS CDM groups without data.
The DM-RS scaling factor <img src="media/image772.svg" /> specified in
clause 6.4.1.1.3 of [4, TS 38.211] is given by <img
src="media/image773.svg" />.</p>
<p>Table 6.2.2-1: The ratio of PUSCH EPRE to DM-RS EPRE</p>
<table>
<colgroup>
<col style="width: 29%" />
<col style="width: 37%" />
<col style="width: 32%" />
</colgroup>
<thead>
<tr>
<th>Number of DM-RS CDM groups without data</th>
<th>DM-RS configuration type 1</th>
<th>DM-RS configuration type 2</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>0 dB</td>
<td>0 dB</td>
</tr>
<tr>
<td>2</td>
<td>-3 dB</td>
<td>-3 dB</td>
</tr>
<tr>
<td>3</td>
<td>-</td>
<td>-4.77 dB</td>
</tr>
</tbody>
</table>
<p>For PUSCH repetition Type B, the DM-RS transmission procedure is
applied for each actual repetition separately based on the allocation
duration of the actual repetition. A UE is not expected to be indicated
with an antenna port configuration that is invalid for the allocated
duration of any actual repetition.</p>
<h3 id="ue-pt-rs-transmission-procedure">6.2.3 UE PT-RS transmission
procedure</h3>
<p>The procedures on PT-RS transmission described in this clause as well
as clauses 6.2.3.1 and 6.2.3.2 apply to a UE PUSCH transmission
scheduled by DCI format 0_2 if the higher layer parameter
<em>phaseTrackingRS</em> in
<em>dmrs-UplinkForPUSCH-MappingTypeA-DCI-0-2</em> or
<em>dmrs-UplinkForPUSCH-MappingTypeB-DCI-0-2</em> is configured, to
PUSCH transmissions scheduled by DCI format 0_0 or format 0_1 if the
higher layer parameter <em>phaseTrackingRS</em> in
<em>dmrs-UplinkForPUSCH-MappingTypeA</em> or
<em>dmrs-UplinkForPUSCH-MappingTypeB</em> is configured and PUSCH
transmissions corresponding to a configured grant if the higher layer
parameter <em>phaseTrackingRS</em> in <em>cg-DMRS-Configuration</em> is
configured. If a UE is not configured with the higher layer parameter
<em>phaseTrackingRS</em> in the respective <em>DMRS-UplinkConfig</em>,
the UE shall not transmit PT-RS. The PT-RS is only present on PUSCH
scheduled by PDCCH with CRC scrambled by MCS-C-RNTI, C-RNTI, CS-RNTI,
SP-CSI-RNTI and on PUSCH corresponding to a configured grant. For PUSCH
repetition Type B, the PT-RS transmission procedure is applied for each
actual repetition separately based on the allocation duration of the
actual repetition.</p>
<h4
id="ue-pt-rs-transmission-procedure-when-transform-precoding-is-not-enabled">6.2.3.1
UE PT-RS transmission procedure when transform precoding is not
enabled</h4>
<p>When transform precoding is not enabled and if a UE is configured
with the higher layer parameter <em>phaseTrackingRS</em> in
<em>DMRS-UplinkConfig,</em></p>
<p>- the higher layer parameters <em>timeDensity</em> and
<em>frequencyDensity</em> in <em>PTRS-UplinkConfig</em> indicate the
threshold values <em>ptrs-MCS<sub>i</sub></em>, <em>i</em>=1,2,3 and
<em>N<sub>RB,i</sub></em> , <em>i</em>=0,1, as shown in Table 6.2.3.1-1
and Table 6.2.3.1-2, respectively.</p>
<p>- if either or both higher layer parameters <em>timeDensity</em>
and/or <em>frequencyDensity</em> in <em>PTRS-UplinkConfig</em> are
configured, the UE shall assume the PT-RS antenna ports' presence and
pattern are a function of the corresponding scheduled MCS and scheduled
bandwidth in a corresponding bandwidth part as shown in Table 6.2.3.1-1
and Table 6.2.3.1-2, respectively,</p>
<p>- if the higher layer parameter <em>timeDensity</em> is not
configured, the UE shall assume <em>L<sub>PT-RS </sub></em>= 1.</p>
<p>- if the higher layer parameter <em>frequencyDensity</em> is not
configured, the UE shall assume <em>K<sub>PT-RS</sub></em> = 2.</p>
<p>- if none of the higher layer parameters <em>timeDensity</em> and
<em>frequencyDensity</em> in <em>PTRS-UplinkConfig</em> are configured,
the UE shall assume <em>L<sub>PT-RS</sub></em> = 1 and
<em>K<sub>PT-RS</sub></em> = 2.</p>
<p>Table 6.2.3.1-1: Time density of PT-RS as a function of scheduled
MCS</p>
<table>
<colgroup>
<col style="width: 51%" />
<col style="width: 48%" />
</colgroup>
<thead>
<tr>
<th>Scheduled MCS</th>
<th>Time density(<img src="media/image101.svg" />)</th>
</tr>
</thead>
<tbody>
<tr>
<td>I<sub>MCS</sub> &lt; ptrs-MCS<sub>1</sub></td>
<td>PT-RS is not present</td>
</tr>
<tr>
<td>ptrs-MCS1 <img src="media/image102.svg" /> I<sub>MCS</sub> &lt;
ptrs-MCS2</td>
<td>4</td>
</tr>
<tr>
<td>ptrs-MCS2 <img src="media/image103.svg" /> I<sub>MCS</sub> &lt;
ptrs-MCS3</td>
<td>2</td>
</tr>
<tr>
<td>ptrs-MCS3 <img src="media/image103.svg" /> I<sub>MCS</sub> &lt;
ptrs-MCS4</td>
<td>1</td>
</tr>
</tbody>
</table>
<p>Table 6.2.3.1-2: Frequency density of PT-RS as a function of
scheduled bandwidth</p>
<table>
<colgroup>
<col style="width: 49%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr>
<th>Scheduled bandwidth</th>
<th>Frequency density (<img src="media/image104.svg" />)</th>
</tr>
</thead>
<tbody>
<tr>
<td>N<sub>RB</sub> &lt; N<sub>RB0</sub></td>
<td>PT-RS is not present</td>
</tr>
<tr>
<td>N<sub>RB0</sub> <img src="media/image103.svg" /> N<sub>RB</sub> &lt;
N<sub>RB1</sub></td>
<td>2</td>
</tr>
<tr>
<td>N<sub>RB1</sub> <img src="media/image103.svg" /> N<sub>RB</sub></td>
<td>4</td>
</tr>
</tbody>
</table>
<p>The higher layer parameter <em>PTRS-UplinkConfig</em> provides the
parameters <em>ptrs-MCS<sub>i</sub></em>, <em>i</em>=1,2,3 and with
values in 0-29 when MCS Table 5.1.3.1-1 or Table 5.1.3.1-3 is used and
0-28 when MCS Table 5.1.3.1-2 is used, respectively. <em>ptrs-MCS4</em>
is not explicitly configured by higher layers but assumed 29 when MCS
Table 5.1.3.1-1 or Table 5.1.3.1-3 is used and 28 when MCS Table
5.1.3.1-2 is used. The higher layer parameter <em>PTRS-UplinkConfig</em>
provides the parameters <em>N<sub>RBi</sub></em> <em>i</em>=0,1 with
values in range 1-276.</p>
<p>If the higher layer parameter <em>PTRS-UplinkConfig</em> indicates
that the time density thresholds <em>ptrs-MCS<sub>i</sub></em> =
<em>ptrs-MCS<sub>i+1</sub></em>, then the time density
<em>L<sub>PTRS</sub></em> of the associated row where both these
thresholds appear in Table 6.2.3.1-1 is disabled. If the higher layer
parameter <em>frequencyDensity</em> in <em>PTRS-UplinkConfig</em>
indicates that the frequency density thresholds
<em>N<sub>RB,i</sub></em> = <em>N<sub>RB,i+1</sub></em>, then the
frequency density <em>K<sub>PTRS</sub></em> of the associated row where
both these thresholds appear in Table 6.2.3.1-2 is disabled.</p>
<p>If either or both of the parameters PT-RS time density
(<em>L<sub>PT-RS</sub></em>) and PT-RS frequency density
(<em>K<sub>PT-RS</sub></em>), shown in Table 6.2.3.1-1 and Table
6.2.3.1-2, indicates that are configured as 'PT-RS not present', the UE
shall assume that PT-RS is not present.</p>
<p>When a UE is scheduled to transmit PUSCH with allocation duration of
2 symbols or less, and if <em>L<sub>PT-RS</sub></em> is set to 2 or 4,
the UE shall not transmit PT-RS. When a UE is scheduled to transmit
PUSCH with allocation duration of 4 symbols or less, and if
<em>L<sub>PT-RS</sub></em> is set to 4, the UE shall not transmit
PT-RS.</p>
<p>When a UE is scheduled to transmit PUSCH for retransmission, if the
UE is scheduled with <em>I<sub>MCS</sub></em> &gt; <em>V</em>, where
<em>V</em> = 28 for MCS Table 5.1.3.1-1 and MCS Table 5.1.3.1-3 and
<em>V</em> = 27 for MCS Table 5.1.3.1-2, respectively, the MCS for PT-RS
time-density determination is obtained from the DCI for the same
transport block in the initial transmission, which is smaller than or
equal to V.</p>
<p>The maximum number of configured PT-RS ports is given by the higher
layer parameter <em>maxNrofPorts</em> in <em>PTRS-UplinkConfig.</em> The
UE is not expected to be configured with a larger number of UL PT-RS
ports than it has reported need for.</p>
<p>If a UE has reported the capability of supporting full-coherent UL
transmission, the UE shall expect the number of UL PT-RS ports to be
configured as one if UL-PTRS is configured.</p>
<p>For codebook or non-codebook based UL transmission, the association
between UL PT-RS port(s) and DM-RS port(s) is signalled by <em>PTRS-DMRS
association</em> field(s) in DCI format 0_1 and DCI format 0_2. For a
PUSCH corresponding to a configured grant Type 1 transmission, the UE
may assume the association between UL PT-RS port(s) and DM-RS port(s)
defined by value 0 in Table 7.3.1.1.2-25 or value "00" in Table
7.3.1.1.1.2-26 described in Clause 7.3.1 of [5, TS38.212].</p>
<p>For PUSCH scheduled by DCI format 0_0 or by activation DCI format
0_0, the UL PT-RS port is associated to DM-RS port 0.</p>
<p>For non-codebook based UL transmission, the actual number of UL PT-RS
port(s) to transmit is determined based on SRI(s) in DCI format 0_1 and
DCI format 0_2 or higher layer parameter <em>sri-ResourceIndicator</em>
in <em>rrc-ConfiguredUplinkGrant</em>. When two SRS resource sets are
configured in <em>srs-ResourceSetToAddModList</em> or
<em>srs-ResourceSetToAddModListDCI-0-2</em> with higher layer parameter
<em>usage</em> in <em>SRS-ResourceSet</em> set to 'noncodebook', the
actual number of UL PT-RS port(s) to transmit corresponding to each SRS
resource set is determined based on SRI(s) corresponding to the
associated SRS resource set or higher layer parameter
<em>sri-ResourceIndicator or sri-ResourceIndicator2</em> corresponding
to the associated SRS resource set in
<em>rrc-ConfiguredUplinkGrant</em>. A UE is configured with the PT-RS
port index for each configured SRS resource by the higher layer
parameter <em>ptrs-PortIndex</em> configured by <em>SRS-Config</em> if
the UE is configured with the higher layer parameter <em>phaseTrackingRS
in DMRS-UplinkConfig</em>. If the PT-RS port index associated with
different SRIs are the same, the corresponding UL DM-RS ports are
associated to the one UL PT-RS port.</p>
<p>For partial-coherent and non-coherent codebook-based UL transmission,
the actual number of UL PT-RS port(s) is determined based on TPMI(s)
and/or number of layers which are indicated by '<em>Precoding
information and number of layers'</em> field(s) in DCI format 0_1 and
DCI format 0_2 or configured by higher layer parameter
<em>precodingAndNumberOfLayers</em>:</p>
<p>- if the UE is configured with the higher layer parameter
<em>maxNrofPorts</em> in <em>PTRS-UplinkConfig</em> set to 'n2', the
actual UL PT-RS port(s) and the associated transmission layer(s) are
derived from indicated TPMI(s) as:</p>
<p>- PUSCH antenna port 1000 and 1002 in indicated TPMI(s) share PT-RS
port 0, and PUSCH antenna port 1001 and 1003 in indicated TPMI(s) share
PT-RS port 1.</p>
<blockquote>
<p>- UL PT-RS port 0 is associated with the UL layer 'x' of layers which
are transmitted with PUSCH antenna port 1000 and PUSCH antenna port 1002
in indicated TPMI(s), and UL PT-RS port 1 is associated with the UL
layer 'y' of layers which are transmitted with PUSCH antenna port 1001
and PUSCH antenna port 1003 in indicated TPMI(s), where 'x' and/or 'y'
are given by DCI parameter '<em>PTRS-DMRS association'</em> as shown in
DCI format 0_1 and DCI format 0_2 described in Clause 7.3.1 of [5,
TS38.212].</p>
</blockquote>
<p>When the UE is scheduled with <em>Q<sub>p</sub></em>={1,2} PT-RS
port(s) in uplink and the number of scheduled layers is <img
src="media/image774.svg" />,</p>
<p>- If the UE is configured with higher layer parameter
<em>ptrs-Power</em>, the PUSCH to PT-RS power ratio per layer per RE
<img src="media/image775.svg" /> is given by <img
src="media/image776.svg" />, where <img src="media/image777.svg" /> is
shown in the Table 6.2.3.1-3 according to the higher layer parameter
<em>ptrs-Power</em>, the PT-RS scaling factor <img
src="media/image778.svg" /> specified in clause 6.4.1.2.2.1 of [4, TS
38.211] is given by <img src="media/image779.svg" />and also on the
'<em>Precoding Information and Number of Layers'</em> field in DCI.</p>
<p>- The UE shall assume <em>ptrs-Power</em> in
<em>PTRS-UplinkConfig</em> is set to state "00" in Table 6.2.3.1-3 if
not configured or in case of non-codebook based PUSCH.</p>
<p>Table 6.2.3.1-3: Factor related to PUSCH to PT-RS power ratio per
layer per RE <img src="media/image777.svg" /></p>
<table>
<colgroup>
<col style="width: 10%" />
<col style="width: 7%" />
<col style="width: 12%" />
<col style="width: 12%" />
<col style="width: 11%" />
<col style="width: 13%" />
<col style="width: 12%" />
<col style="width: 9%" />
<col style="width: 10%" />
</colgroup>
<thead>
<tr>
<th rowspan="3"><em>UL-PTRS-power /</em> <img
src="media/image780.svg" /></th>
<th></th>
<th colspan="7">The number of PUSCH layers ( <img
src="media/image781.svg" />)</th>
</tr>
<tr>
<th>1</th>
<th colspan="2">2</th>
<th colspan="2">3</th>
<th colspan="3">4</th>
</tr>
<tr>
<th>All cases</th>
<th>Full coherent</th>
<th>Partial and non- coherent and non-codebook based</th>
<th>Full coherent</th>
<th>Partial and non- coherent and non-codebook based</th>
<th>Full coherent</th>
<th>Partial coherent</th>
<th>Non-coherent and non-codebook based</th>
</tr>
</thead>
<tbody>
<tr>
<td>00</td>
<td>0</td>
<td>3</td>
<td>3<em>Q<sub>p</sub></em>-3</td>
<td>4.77</td>
<td>3<em>Q<sub>p</sub></em>-3</td>
<td>6</td>
<td>3<em>Q<sub>p</sub></em></td>
<td>3<em>Q<sub>p</sub></em>-3</td>
</tr>
<tr>
<td>01</td>
<td>0</td>
<td>3</td>
<td>3</td>
<td>4.77</td>
<td>4.77</td>
<td>6</td>
<td>6</td>
<td>6</td>
</tr>
<tr>
<td>10</td>
<td colspan="8">Reserved</td>
</tr>
<tr>
<td>11</td>
<td colspan="8">Reserved</td>
</tr>
</tbody>
</table>
<h4
id="ue-pt-rs-transmission-procedure-when-transform-precoding-is-enabled">6.2.3.2
UE PT-RS transmission procedure when transform precoding is enabled</h4>
<p>When transform precoding is enabled and if a UE is configured with
the higher layer parameter <em>transformPrecoderEnabled</em> in
<em>PTRS-UplinkConfig,</em></p>
<p>- the UE shall be configured with the higher layer parameters
<em>sampleDensity</em> and the UE shall assume the PT-RS antenna ports'
presence and PT-RS group pattern are a function of the corresponding
scheduled bandwidth in a corresponding bandwidth part, as shown in Table
6.2.3.2-1. The UE shall assume no PT-RS is present when the number of
scheduled RBs is less than N<sub>RB0</sub> if N<sub>RB0</sub> &gt; 1 or
if the RNTI equals TC-RNTI.</p>
<p>- and the UE may be configured PT-RS time density
<em>L<sub>PT-RS</sub></em> = 2 with the higher layer parameter
<em>timeDensityTransformPrecoding.</em> Otherwise, the UE shall assume
<em>L<sub>PT-RS</sub></em> = 1.</p>
<p>- if the higher layer parameter <em>sampleDensity</em> indicates that
the sample density thresholds <em>N<sub>RB,i</sub></em> =
<em>N<sub>RB,i+1</sub></em>, then the associated row where both these
thresholds appear in Table 6.2.3.2-1 is disabled.</p>
<p>Table 6.2.3.2-1: PT-RS group pattern as a function of scheduled
bandwidth</p>
<table>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 32%" />
</colgroup>
<thead>
<tr>
<th>Scheduled bandwidth</th>
<th>Number of PT-RS groups</th>
<th><p>Number of samples</p>
<p>per PT-RS group</p></th>
</tr>
</thead>
<tbody>
<tr>
<td><em>N<sub>RB0 </sub></em><img
src="media/image103.svg" /><em>N<sub>RB</sub></em> &lt;
<em>N<sub>RB1</sub></em></td>
<td>2</td>
<td>2</td>
</tr>
<tr>
<td><em>N<sub>RB1</sub></em> <img src="media/image103.svg" />
<em>N<sub>RB</sub></em> &lt; <em>N<sub>RB2</sub></em></td>
<td>2</td>
<td>4</td>
</tr>
<tr>
<td><em>N<sub>RB2</sub></em> <img src="media/image103.svg" />
<em>N<sub>RB</sub></em> &lt; <em>N<sub>RB3</sub></em></td>
<td>4</td>
<td>2</td>
</tr>
<tr>
<td><em>N<sub>RB3</sub></em> <img src="media/image103.svg" />
<em>N<sub>RB</sub></em> &lt; <em>N<sub>RB4</sub></em></td>
<td>4</td>
<td>4</td>
</tr>
<tr>
<td><em>N<sub>RB4</sub></em> <img src="media/image103.svg" />
<em>N<sub>RB</sub></em></td>
<td>8</td>
<td>4</td>
</tr>
</tbody>
</table>
<p>When transform precoding is enabled and if a UE is configured with
the higher layer parameter <em>transformPrecoderEnabled</em> in
<em>PTRS-UplinkConfig,</em> the PT-RS scaling factor <em>β</em>'
specified in Clause 6.4.1.2.2.2 of [4, TS 38.211] is determined by the
scheduled modulation order as shown in table 6.2.3.2-2.</p>
<p>Table 6.2.3.2-2: PT-RS scaling factor (<em>β</em>') when transform
precoding enabled.</p>
<table>
<colgroup>
<col style="width: 48%" />
<col style="width: 51%" />
</colgroup>
<thead>
<tr>
<th>Scheduled modulation</th>
<th>PT-RS scaling factor (<em>β</em>')</th>
</tr>
</thead>
<tbody>
<tr>
<td>π/2-BPSK</td>
<td>1</td>
</tr>
<tr>
<td>QPSK</td>
<td>1</td>
</tr>
<tr>
<td>16QAM</td>
<td><img src="media/image782.svg" /></td>
</tr>
<tr>
<td>64QAM</td>
<td><img src="media/image783.svg" /></td>
</tr>
<tr>
<td>256QAM</td>
<td><img src="media/image784.svg" /></td>
</tr>
</tbody>
</table>
<h2 id="ue-pusch-frequency-hopping-procedure">6.3 UE PUSCH frequency
hopping procedure</h2>
<h3
id="frequency-hopping-for-pusch-repetition-type-a-and-for-tb-processing-over-multiple-slots">6.3.1
Frequency hopping for PUSCH repetition Type A and for TB processing over
multiple slots</h3>
<p>For PUSCH repetition Type A other than the PUSCH scheduled by RAR UL
grant or fallbackRAR UL grant or by DCI format 0_0 with CRC scrambled by
TC-RNTI and for TB processing over multiple slots (as determined
according to procedures defined in Clause 6.1.2.1 for scheduled PUSCH,
or Clause 6.1.2.3 for configured PUSCH), a UE is configured for
frequency hopping by the higher layer parameter
<em>frequencyHoppingDCI-0-2</em> in <em>pusch-Config</em> for PUSCH
transmission scheduled by DCI format 0_2, and by
<em>frequencyHopping</em> provided in <em>pusch-Config</em> for PUSCH
transmission scheduled by a DCI format other than 0_2<em>,</em> and by
<em>frequencyHopping</em> provided in <em>configuredGrantConfig</em> for
configured PUSCH transmission. For PUSCH repetition Type A scheduled by
RAR UL grant or by DCI format 0_0 with CRC scrambled by TC-RNTI, a UE is
configured for frequency hopping by the frequency hopping flag
information field of the RAR UL grant, and by the frequency hopping flag
information field of DCI format 0_0 with CRC scrambled by TC-RNTI,
respectively. One of two frequency hopping modes can be configured:</p>
<p>- Intra-slot frequency hopping, applicable to single slot and
multi-slot configured PUSCH transmission, multi-slot PUSCH transmission
scheduled by DCI format 0_1 or 0_2, each of multiple PUSCH transmissions
scheduled by a DCI if the higher layer parameter
<em>pusch-TimeDomainAllocationListForMultiPUSCH</em> is configured and
each of multiple configured grant PUSCH transmissions in a configuration
where the higher layer parameters <em>cg-nrofSlots</em> and
<em>cg-nrofPUSCH-InSlot</em> are provided.</p>
<p>- Inter-slot frequency hopping, applicable to multi-slot PUSCH
transmission.</p>
<p>For operation with shared spectrum channel access in FR1, the UE does
not expect that two hops of a PUSCH transmission are in different RB
sets.</p>
<p>In case of resource allocation type 2, the UE transmits PUSCH without
frequency hopping.</p>
<p>In case of resource allocation type 1, whether or not transform
precoding is enabled for PUSCH transmission, the UE may perform PUSCH
frequency hopping, if the frequency hopping field in a corresponding
detected DCI format or in a random access response UL grant is set to 1,
or if for a Type 1 PUSCH transmission with a configured grant the higher
layer parameter <em>frequencyHoppingOffset</em> is provided, otherwise
no PUSCH frequency hopping is performed. When frequency hopping is
enabled for PUSCH, the RE mapping is defined in clause 6.3.1.6 of [4, TS
38.211].</p>
<p>For a PUSCH scheduled by RAR UL grant, fallbackRAR UL grant, or by
DCI format 0_0 with CRC scrambled by TC-RNTI, frequency offsets are
obtained as described in clause 8.3 of [6, TS 38.213]. Otherwise, for a
PUSCH scheduled by DCI format 0_0/0_1 or a PUSCH based on a Type2
configured UL grant activated by DCI format 0_0/0_1 and for resource
allocation type 1, frequency offsets are configured by higher layer
parameter <em>frequencyHoppingOffsetLists</em> in <em>pusch-Config</em>.
For a PUSCH scheduled by DCI format 0_2 or a PUSCH based on a Type2
configured UL grant activated by DCI format 0_2 and for resource
allocation type 1, frequency offsets are configured by higher layer
parameter <em>frequencyHoppingOffsetListsDCI-0-2</em> in
<em>pusch-Config</em>.</p>
<p>- When the size of the active BWP is less than 50 PRBs, one of two
higher layer configured offsets is indicated in the UL grant.</p>
<p>- When the size of the active BWP is equal to or greater than 50
PRBs, one of four higher layer configured offsets is indicated in the UL
grant.</p>
<p>For PUSCH based on a Type1 configured UL grant the frequency offset
is provided by the higher layer parameter
<em>frequencyHoppingOffset</em> in
<em>rrc-ConfiguredUplinkGrant</em>.</p>
<p>For a MsgA PUSCH the frequency offset is provided by the higher layer
parameter as described in [6, TS 38.213].</p>
<p>In case of intra-slot frequency hopping, the starting RB in each hop
is given by:</p>
<p><img src="media/image785.svg" />,</p>
<p>where <em>i</em>=0 and <em>i</em>=1 are the first hop and the second
hop respectively, and <img src="media/image786.svg" /> is the starting
RB within the UL BWP, as calculated from the resource block assignment
information of resource allocation type 1 (described in Clause
6.1.2.2.2) or as calculated from the resource assignment for MsgA PUSCH
(described in [6, TS 38.213]) and <img src="media/image787.svg" />is the
frequency offset in RBs between the two frequency hops. The number of
symbols in the first hop is given by <img src="media/image788.svg" />,
the number of symbols in the second hop is given by <img
src="media/image789.svg" />, where <span
class="math inline">\(N_{symb}^{PUSCH,s}\)</span> is the length of the
PUSCH transmission in OFDM symbols in one slot.</p>
<p>In case of inter-slot frequency hopping and when
<em>pusch-DMRS-Bundling</em> is not enabled, or for inter-slot frequency
hopping for a PUSCH scheduled by RAR UL grant or DCI format 0_0 with CRC
scrambled by TC-RNTI, the starting RB during slot <img
src="media/image790.svg" /> is given by:</p>
<p><img src="media/image791.svg" />,</p>
<p>where <img src="media/image792.svg" /> is the current slot number
within a system radio frame, where a multi-slot PUSCH transmission can
take place, <img src="media/image793.svg" /> is the starting RB within
the UL BWP, as calculated from the resource block assignment information
of resource allocation type 1 (described in Clause 6.1.2.2.2) and <img
src="media/image794.svg" />is the frequency offset in RBs between the
two frequency hops.</p>
<p>In case of inter-slot frequency hopping and when
<em>pusch-DMRS-Bundling</em> is enabled, and when a PUSCH is not
scheduled by RAR UL grant or DCI format 0_0 with CRC scrambled by
TC-RNTI, the starting RB during slot <img src="media/image790.svg" /> is
given by:</p>
<p><span class="math inline">\({RB}_{start}\left( n_{s}^{\mu} \right) =
\left\{ \begin{array}{r}
{RB}_{start} \\
\left( {RB}_{start} + {RB}_{offset} \right)modN_{BWP}^{size}
\end{array}\binom{\left\lfloor \frac{n_{s}^{\mu}}{N_{FH}} \right\rfloor\
mod\ 2 = 0}{\left\lfloor \frac{n_{s}^{\mu}}{N_{FH}} \right\rfloor\ mod\
2 = 1} \right.\ \)</span></p>
<p>where <span class="math inline">\(n_{s}^{\mu}\)</span> is the current
slot number within a system radio frame, <span
class="math inline">\(N_{FH}\)</span> is the value of the higher layer
parameter <em>pusch-FrequencyHopping-Interval</em>, <img
src="media/image793.svg" /> is the starting RB within the UL BWP, as
calculated from the resource block assignment information of resource
allocation type 1 (described in Clause 6.1.2.2.2) and<img
src="media/image794.svg" />is the frequency offset in RBs between the
two frequency hops.</p>
<h3 id="frequency-hopping-for-pusch-repetition-type-b">6.3.2 Frequency
hopping for PUSCH repetition Type B</h3>
<p>For PUSCH repetition Type B (as determined according to procedures
defined in Clause 6.1.2.1 for scheduled PUSCH, or Clause 6.1.2.3 for
configured PUSCH), a UE is configured for frequency hopping by the
higher layer parameter <em>frequencyHoppingDCI-0-2</em> in
<em>pusch-Config</em> for PUSCH transmission scheduled by DCI format
0_2, by <em>frequencyHoppingDCI-0-1</em> provided in
<em>pusch-Config</em> for PUSCH transmission scheduled by DCI format
0_1, and by <em>frequencyHoppingPUSCH-RepTypeB</em> provided in
<em>rrc-ConfiguredUplinkGrant</em> for Type 1 configured PUSCH
transmission. The frequency hopping mode for Type 2 configured PUSCH
transmission follows the configuration of the activating DCI format. One
of two frequency hopping modes can be configured:</p>
<p>- Inter-repetition frequency hopping</p>
<p>- Inter-slot frequency hopping</p>
<p>For operation with shared spectrum channel access in FR1, the UE does
not expect that two hops of a PUSCH transmission are in different RB
sets.</p>
<p>In case of resource allocation type 1, whether or not transform
precoding is enabled for PUSCH transmission, the UE may perform PUSCH
frequency hopping, if the frequency hopping field in a corresponding
detected DCI format is set to 1, or if for a Type 1 PUSCH transmission
with a configured grant the higher layer parameter
<em>frequencyHoppingPUSCH-RepTypeB</em> is provided, otherwise no PUSCH
frequency hopping is performed. When frequency hopping is enabled for
PUSCH, the RE mapping is defined in clause 6.3.1.6 of [4, TS
38.211].</p>
<p>For a PUSCH scheduled by DCI format 0_1 or a PUSCH based on a Type 2
configured UL grant activated by DCI format 0_1 and for resource
allocation type 1, frequency offsets are configured by higher layer
parameter <em>frequencyHoppingOffsetLists</em> in <em>pusch-Config</em>.
For a PUSCH scheduled by DCI format 0_2 or a PUSCH based on a Type 2
configured UL grant activated by DCI format 0_2 and for resource
allocation type 1, frequency offsets are configured by higher layer
parameter <em>frequencyHoppingOffsetListsDCI-0-2</em> in
<em>pusch-Config</em>.</p>
<p>- When the size of the active BWP is less than 50 PRBs, one of two
higher layer configured offsets is indicated in the UL grant.</p>
<p>- When the size of the active BWP is equal to or greater than 50
PRBs, one of four higher layer configured offsets is indicated in the UL
grant.</p>
<p>For PUSCH based on a Type1 configured UL grant the frequency offset
is provided by the higher layer parameter
<em>frequencyHoppingOffset</em> in
<em>rrc-ConfiguredUplinkGrant</em>.</p>
<p>In case of inter-repetition frequency hopping, the starting RB for an
actual repetition within the <em>n</em>-th nominal repetition (as
defined in Clause 6.1.2.1) is given by:</p>
<p><img src="media/image795.png"
style="width:3.05861in;height:0.46533in" />,</p>
<p>where RB<sub>start</sub> is the starting RB within the UL BWP, as
calculated from the resource block assignment information of resource
allocation type 1 (described in Clause 6.1.2.2.2) and
RB<sub>offset</sub> is the frequency offset in RBs between the two
frequency hops.</p>
<p>In case of inter-slot frequency hopping, the starting RB during slot
<img src="media/image790.svg" /> follows that of inter-slot frequency
hopping for PUSCH Repetition Type A in Clause 6.3.1.</p>
<h2 id="ue-pusch-preparation-procedure-time">6.4 UE PUSCH preparation
procedure time</h2>
<p>If the first uplink symbol in the PUSCH allocation for a transport
block, including the DM-RS, as defined by the slot offset
<em>K<sub>2</sub></em> and K<sub>offset</sub>, if configured, and the
start <em>S</em> and length <em>L</em> of the PUSCH allocation indicated
by '<em>Time domain resource assignment</em>' of the scheduling DCI and
including the effect of the timing advance, is no earlier than at symbol
<em>L<sub>2</sub></em>, where <em>L<sub>2</sub></em> is defined as the
next uplink symbol with its CP starting <img src="media/image796.svg" />
after the end of the reception of the last symbol of the PDCCH carrying
the DCI scheduling the PUSCH, then the UE shall transmit the transport
block. When the PDCCH reception includes two PDCCH candidates from two
respective search space sets, as described in clause 10.1 of [6, TS
38.213], for the purpose of determining the last symbol of the PDCCH
carrying the DCI scheduling the PUSCH, the PDCCH candidate that ends
later in time is used.</p>
<p><em>- N<sub>2</sub></em> is based on <em>µ</em> of Table 6.4-1 and
Table 6.4-2 for UE processing capability 1 and 2 respectively, where
<em>µ</em> corresponds to the one of (<em>µ<sub>DL</sub></em>,
<em>µ<sub>UL</sub></em>) resulting with the largest
<em>T<sub>proc,2</sub></em>, where the <em>µ<sub>DL</sub></em>
corresponds to the subcarrier spacing of the downlink with which the
PDCCH carrying the DCI scheduling the PUSCH was transmitted and
<em>µ<sub>UL</sub></em> corresponds to the subcarrier spacing of the
uplink channel with which the PUSCH is to be transmitted, and <em>κ</em>
is defined in clause 4.1 of [4, TS 38.211].</p>
<p><em>-</em> For operation with shared spectrum channel access in FR1,
<img src="media/image698.svg" />is calculated according to [4, TS
38.211], otherwise <img src="media/image698.svg" />=0.</p>
<p>- If the first symbol of the PUSCH allocation consists of DM-RS only,
then <em>d<sub>2,1 </sub></em>= 0<em>,</em> otherwise <em>d<sub>2,1
</sub></em>= 1.</p>
<p>- If the UE is configured with multiple active component carriers,
the first uplink symbol in the PUSCH allocation further includes the
effect of timing difference between component carriers as given in [11,
TS 38.133].</p>
<p>- If the scheduling DCI triggered a switch of BWP,
<em>d<sub>2,2</sub></em> equals to the switching time as defined in [11,
TS 38.133], otherwise <em>d<sub>2,2</sub></em>=0.</p>
<p>- If a PUSCH of a larger priority index would overlap with a PUCCH of
a smaller priority index and the PUCCH and PUSCH are not simultaneously
transmitted, and the UE is not provided <em>uci-MuxWithDiffPrio</em> for
the primary PUCCH group or
<em>uci-MuxWithDiffPrioSecondaryPUCCHgroup</em> for the secondary PUCCH
group, <em>d<sub>2</sub></em> for the PUSCH of a larger priority is set
as reported by the UE; otherwise <em>d<sub>2</sub> = 0.</em></p>
<p>- For a UE that supports capability 2 on a given cell, the processing
time according to UE processing capability 2 is applied if the high
layer parameter <em>processingType2Enabled</em> in
<em>PUSCH-ServingCellConfig</em> is configured for the cell and set to
'enable',</p>
<p>- If the PUSCH indicated by the DCI is overlapping with one or more
PUCCH channels, then the transport block is multiplexed following the
procedure in clause 9.2.5 of [6, TS 38.213], otherwise the transport
block is transmitted on the PUSCH indicated by the DCI.</p>
<p>- If uplink switching gap is triggered as defined in clause 6.1.6,
<img src="media/image797.svg" /> equals to the switching gap duration
and for the UE configured with higher layer parameter
<em>uplinkTxSwitchingOption</em> set to 'dualUL' for uplink carrier
aggregation <em>µ<sub>UL</sub></em>=min(<em>µ<sub>UL,carrier1,</sub>
µ<sub>UL,carrier2</sub></em>), otherwise <img
src="media/image798.svg" />.</p>
<p>Otherwise the UE may ignore the scheduling DCI.</p>
<p>The value of <img src="media/image799.svg" /> is used both in the
case of normal and extended cyclic prefix.</p>
<p>Table 6.4-1: PUSCH preparation time for PUSCH timing capability 1</p>
<table>
<colgroup>
<col style="width: 16%" />
<col style="width: 83%" />
</colgroup>
<thead>
<tr>
<th><img src="media/image800.svg" /></th>
<th>PUSCH preparation time <em>N<sub>2</sub></em> [symbols]</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>10</td>
</tr>
<tr>
<td>1</td>
<td>12</td>
</tr>
<tr>
<td>2</td>
<td>23</td>
</tr>
<tr>
<td>3</td>
<td>36</td>
</tr>
<tr>
<td>5</td>
<td>144</td>
</tr>
<tr>
<td>6</td>
<td>288</td>
</tr>
</tbody>
</table>
<p>Table 6.4-2: PUSCH preparation time for PUSCH timing capability 2</p>
<table>
<colgroup>
<col style="width: 16%" />
<col style="width: 83%" />
</colgroup>
<thead>
<tr>
<th><img src="media/image800.svg" /></th>
<th>PUSCH preparation time <em>N<sub>2</sub></em> [symbols]</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>5</td>
</tr>
<tr>
<td>1</td>
<td>5.5</td>
</tr>
<tr>
<td>2</td>
<td>11 for frequency range 1</td>
</tr>
</tbody>
</table>
<h1
id="ue-procedures-for-transmitting-and-receiving-on-a-carrier-with-intra-cell-guard-bands">7
UE procedures for transmitting and receiving on a carrier with
intra-cell guard bands</h1>
<p>For operation with shared spectrum channel access for FR1, when the
UE is configured with any of <em>IntraCellGuardBandsPerSCS</em> for UL
carrier and for DL carrier with SCS configuration <span
class="math inline">\(\mu\)</span>, the UE is provided with <span
class="math inline">\(\ N_{RB - set,x} - 1\)</span> intra-cell guard
bands on a carrier with <span class="math inline">\(\mu\)</span>, each
defined by start CRB and size in number of CRBs, <span
class="math inline">\(GB_{\ s,x}^{start,\mu}\ \)</span> and <span
class="math inline">\(GB_{\ s,x}^{size,\mu}\ \)</span>, provided by
higher layer parameters <em>startCRB</em> and <em>nrofCRBs</em>,
respectively, where <span class="math inline">\(s \in \left\{
0,1,\ldots,N_{\text{RB-set},x} - 2 \right\}\)</span>. The subscript
<em>x</em> is set to DL and UL for the downlink and uplink,
respectively. Where there is no risk of confusion, the subscript
<em>x</em> can be dropped. The intra-cell guard bands separate <span
class="math inline">\(N_{RB - set,x}\ \)</span>RB sets, each defined by
start and end CRB, <span class="math inline">\(RB_{\ s,x}^{start,\mu}\
\)</span>and <span class="math inline">\(RB_{\ s,x}^{end,\mu}\)</span>,
respectively. The UE does not expect that <em>nrofCRBs</em> is
configured with non-zero value smaller than the applicable intra-cell
guard bands as specified in [8, TS 38.101-1] corresponding to <span
class="math inline">\(\mu\)</span> and carrier size <span
class="math inline">\(N_{\text{grid,x}}^{\text{size},\mu}\)</span>. The
UE determines the start and end CRB indices for <span
class="math inline">\(s \in \left\{ 0,1,\ldots,N_{\text{RB-set},x} - 1
\right\}\)</span> as</p>
<p><span class="math inline">\({RB}_{\ s,x}^{\text{start,}\mu} =
N_{\text{grid,}x}^{\text{start},\mu} + \left\{ \begin{matrix}
0 &amp; s = 0 \\
GB_{\ s - 1,x}^{\text{start},\mu} + GB_{\ s - 1,x}^{\text{size},\mu}
&amp; \text{otherwise}
\end{matrix} \right.\ \)</span></p>
<p>and</p>
<p><span class="math inline">\({RB}_{\ s,x}^{\text{end,}\mu} =
N_{\text{grid},x}^{\text{start},\mu} + \left\{ \begin{matrix}
N_{\text{grid},x}^{\text{size},\mu} - 1 &amp; s = N_{\text{RB-set},x} -
1 \\
GB_{\ s,x}^{\text{start},\mu} - 1 &amp; \text{otherwise}
\end{matrix} \right.\ \)</span></p>
<p>The RB set with index <span class="math inline">\(s\)</span> consists
of <span class="math inline">\(RB_{s,x}^{size,\mu}\)</span> resource
blocks where <span class="math inline">\(\ RB_{s,x}^{size,\mu} = RB_{\
s,x}^{end,\mu} - RB_{\ s,x}^{start,\mu} + 1\)</span>. When the UE is not
configured with <em>IntraCellGuardBandsPerSCS</em> for <span
class="math inline">\(\mu\)</span>, the UE determines the CRB indices
for the intra-cell guard band(s), if any, and corresponding RB set(s)
according to the nominal intra-cell guard band and RB set pattern as
specified in [8, TS 38.101-1] corresponding to <span
class="math inline">\(\mu\)</span> and carrier size <span
class="math inline">\(N_{\text{grid,}x}^{\text{size},\mu}\)</span>. For
either or both DL and UL, if the nominal intra-cell guard band and RB
set pattern as specified in [8, TS 38.101-1] contains no intra-cell
guard bands, the number of RB sets for the carrier is <span
class="math inline">\(N_{RB\text{-}set,x} = 1\)</span>.</p>
<p>For a carrier with <span class="math inline">\(\mu\)</span>, the UE
expects <span class="math inline">\(\ \ N_{\ \text{BWP},i}^{start,\mu} =
{RB}_{\ s0,x}^{start,\mu}\)</span> and <span class="math inline">\(N_{\
\text{BWP},i}^{size,\mu} = {RB}_{\ s1,x}^{end,\mu} - {RB}_{\
s0,x}^{start,\mu} + 1\ \)</span> where <span class="math inline">\(0
\leq s0 \leq s1 \leq N_{RB\text{-}set,x} - 1\)</span> for a BWP
<em>i</em> configured by <em>initialDownlinkBWP</em> or
<em>BWP-Downlink</em> for the DL BWP, or <em>initialUplinkBWP</em> or
<em>BWP-Uplink</em> for the UL BWP. Within the BWP <em>i</em>, RB sets
are numbered in increasing order from 0 to <span
class="math inline">\(N_{RB\text{-}set,x}^{\text{BWP}} - 1\ \)</span>
where <span class="math inline">\(N_{RB\text{-}set,x}^{\text{BWP}}\
\)</span> is the number of RB sets contained in the BWP <em>i</em> and
RB set 0 within the BWP <em>i</em> corresponds to RB set <span
class="math inline">\(s0\)</span> in the carrier and RB set <span
class="math inline">\(N_{RB\text{-}set,x}^{\text{BWP}} - 1\)</span>
within the BWP <em>i</em> corresponds to RB set <span
class="math inline">\(s1\)</span> in the carrier.</p>
<p>When a UE is provided with <em>nrofCRBs =</em> 0 for all intra-cell
guard band(s) on a carrier with <span
class="math inline">\(\mu\)</span>, the UE is indicated that no
intra-cell guard-bands are configured for the carrier and expects <span
class="math inline">\(N_{RB - set,x} &gt; 1\)</span>. For <span
class="math inline">\(\mu = 0\)</span>, the UE expects the number of RBs
within a RB set is between 100 and 110. For <span
class="math inline">\(\mu = 1\)</span>, the UE expects the number of RBs
within a RB set is between 50 and 55 except for at most one RB set which
may contain 56 RBs.</p>
<h1 id="physical-sidelink-shared-channel-related-procedures">8 Physical
sidelink shared channel related procedures</h1>
<p>A UE can be configured by higher layers with one or more sidelink
resource pools. A sidelink resource pool can be for transmission of
PSSCH, as described in Clause 8.1, or for reception of PSSCH, as
described in Clause 8.3 and can be associated with either sidelink
resource allocation mode 1 or sidelink resource allocation mode 2.</p>
<p>In the frequency domain, a sidelink resource pool consists of
<em>sl-NumSubchannel</em> contiguous sub-channels. A sub-channel
consists of <em>sl-SubchannelSize</em> contiguous PRBs, where
<em>sl-NumSubchannel</em> and <em>sl-SubchannelSize</em> are higher
layer parameters.</p>
<p>The set of slots that may belong to a sidelink resource pool is
denoted by <span
class="math inline">\((t_{0}^{SL},t_{1}^{SL},\cdots,t_{T_{\max} -
1}^{SL})\)</span> where</p>
<p>- <span class="math inline">\({0 \leq t}_{i}^{SL} &lt; 10240 \times
2^{\mu},\ 0 \leq i &lt; T_{\max},\)</span></p>
<p>- the slot index is relative to slot#0 of the radio frame
corresponding to SFN 0 of the serving cell or DFN 0,</p>
<p>- the set includes all the slots except the following slots,</p>
<p>- <span class="math inline">\(N_{S - SSB}\)</span> slots in which
S-SS/PSBCH block (S-SSB) is configured,</p>
<p>- <span class="math inline">\(N_{nonSL}\)</span> slots in each of
which at least one of <em>Y-th</em>, <em>(Y+1)-th</em>, …,
<em>(Y+X-1)-th</em> OFDM symbols are not semi-statically configured as
UL as per the higher layer parameter
<em>tdd-UL-DL-ConfigurationCommon</em> of the serving cell if provided
or <em>sl-TDD-Configuration</em> if provided or <em>sl-TDD-Config</em>
of the received PSBCH if provided, where <em>Y</em> and <em>X</em> are
set by the higher layer parameters <em>sl-StartSymbol</em> and
<em>sl-LengthSymbols</em>, respectively.</p>
<p>- The reserved slots which are determined by the following steps.</p>
<p>1) the remaining slots excluding <span class="math inline">\(N_{S -
SSB}\)</span> slots and <span class="math inline">\(N_{nonSL}\)</span>
slots from the set of all the slots are denoted by <span
class="math inline">\((l_{0},l_{1},\cdots,l_{(10240 \times 2^{\mu} -
N_{S - SSB} - N_{nonSL} - 1)})\)</span> arranged in increasing order of
slot index.</p>
<p>2) a slot <span class="math inline">\(l_{r}\ (0 \leq r &lt; 10240
\times 2^{\mu} - N_{S - SSB} - N_{nonSL})\)</span> belongs to the
reserved slots if <span class="math inline">\(r = \left\lfloor \frac{m
\bullet (10240 \times 2^{\mu} - N_{S - SSB} - N_{nonSL})}{N_{reserved}}
\right\rfloor\)</span>, here <span class="math inline">\(m =
0,1,\cdots,N_{reserved} - 1\)</span> and <span
class="math inline">\(N_{reserved} = \left( 10240 \times 2^{\mu} - N_{S
- SSB} - N_{nonSL} \right)\ mod\ L_{bitmap}\)</span> where <span
class="math inline">\(L_{bitmap}\)</span> denotes the length of bitmap
configured by higher layers.</p>
<p>- The slots in the set are arranged in increasing order of slot
index.</p>
<p>The UE determines the set of logical slots assigned to a sidelink
resource pool as follows:</p>
<p>- a bitmap <span class="math inline">\(\left(
b_{0},b_{1},\ldots,b_{L_{bitmap} - 1} \right)\)</span> associated with
the resource pool is used where <span
class="math inline">\(L_{bitmap}\)</span> the length of the bitmap is
configured by higher layers.</p>
<p>- a slot <span class="math inline">\(t_{k}^{SL}\ (0 \leq k &lt; 10240
\times 2^{\mu} - N_{S - SSB} - N_{nonSL} - N_{reserved})\)</span>
belongs to the set if <span class="math inline">\(b_{k&#39;} =
1\)</span> where <span class="math inline">\(k&#39; = k\ mod\
L_{bitmap}\)</span>.</p>
<p>- The slots in the set are re-indexed such that the subscripts
<em>i</em> of the remaining slots <span
class="math inline">\({t&#39;}_{i}^{SL}\)</span> are successive {0, 1,
…, <span class="math inline">\({T&#39;}_{\max} - 1\}\)</span> where
<span class="math inline">\({T&#39;}_{\max}\)</span> is the number of
the slots remaining in the set.</p>
<p>The UE determines the set of resource blocks assigned to a sidelink
resource pool as follows:</p>
<blockquote>
<p>- The resource block pool consists of <span
class="math inline">\(N_{PRB}\)</span> PRBs.</p>
<p>- The sub-channel <em>m</em> for <span class="math inline">\(m =
0,1,\cdots,numSubchannel - 1\)</span> consists of a set of <span
class="math inline">\(n_{subCHsize}\)</span> contiguous resource blocks
with the physical resource block number <span
class="math inline">\(n_{PRB} = n_{subCHRBstart} + m \bullet
n_{subCHsize} + j\)</span> for <span class="math inline">\(j =
0,1,\cdots,n_{subCHsize} - 1\)</span>, where <span
class="math inline">\(n_{subCHRBstart}\)</span>, <span
class="math inline">\(n_{subCHsize}\)</span> and <em>numSubchannel</em>
are given by higher layer parameters <em>sl-StartRB-Subchannel</em>,
<em>sl-SubchannelSize</em> and <em>sl-NumSubchannel</em>,
respectively</p>
</blockquote>
<p>A UE is not expected to use the last <span
class="math inline">\(N_{PRB}\ \text{mod}\ n_{subCHsize}\)</span> PRBs
in the resource pool.</p>
<h2
id="ue-procedure-for-transmitting-the-physical-sidelink-shared-channel">8.1
UE procedure for transmitting the physical sidelink shared channel</h2>
<p>Each PSSCH transmission is associated with an PSCCH transmission.</p>
<p>That PSCCH transmission carries the 1<sup>st</sup> stage of the SCI
associated with the PSSCH transmission; the 2<sup>nd</sup> stage of the
associated SCI is carried within the resource of the PSSCH.</p>
<p>If the UE transmits SCI format 1-A on PSCCH according to a PSCCH
resource configuration in slot <em>n</em> and PSCCH resource <em>m</em>,
then for the associated PSSCH transmission in the same slot</p>
<p>- one transport block is transmitted with up to two layers;</p>
<p>- The number of layers (ʋ) is determined according to the '<em>Number
of DMRS port'</em> field in the SCI;</p>
<p>- The set of consecutive symbols within the slot for transmission of
the PSSCH is determined according to clause 8.1.2.1;</p>
<p>- The set of contiguous resource blocks for transmission of the PSSCH
is determined according to clause 8.1.2.2;</p>
<p>Transform precoding is not supported for PSSCH transmission.</p>
<p>Only wideband precoding is supported for PSSCH transmission.</p>
<p>The DM-RS antenna ports <img src="media/image801.png"
style="width:0.64653in;height:0.21736in"
alt="cid:image011.png@01D5F222.20AEBCB0" /> in Clause 8.4.1.1.2 of [4,
TS38.211] are determined according to the ordering of DM-RS port(s)
given by Tables 8.3.1.1-3 in Clause 8.3.1.1 of [5, TS 38.212].</p>
<p>The UE shall set the contents of the SCI format 2-A as follows:</p>
<p>- the UE shall set value of the <em>'HARQ process number'</em> field
as indicated by higher layers.</p>
<p>- the UE shall set value of the '<em>NDI</em>' field as indicated by
higher layers.</p>
<p>- the UE shall set value of the '<em>Redundancy version</em>' field
as indicated by higher layers.</p>
<p>- the UE shall set value of the '<em>Source ID</em>' field as
indicated by higher layers.</p>
<p>- the UE shall set value of the '<em>Destination ID</em>' field as
indicated by higher layers.</p>
<p>- the UE shall set value of the '<em>HARQ feedback enabled/disabled
indicator</em>' field as indicated by higher layers.</p>
<p>- the UE shall set value of the '<em>Cast type indicator</em>' field
as indicated by higher layers.</p>
<p>- the UE shall set value of the '<em>CSI request</em>' field as
indicated by higher layers.</p>
<p>The UE shall set the contents of the SCI formats 2-B as follows:</p>
<p>- the UE shall set value of the '<em>HARQ process number</em>' field
as indicated by higher layers.</p>
<p>- the UE shall set value of the '<em>NDI</em>' field as indicated by
higher layers.</p>
<p>- the UE shall set value of the '<em>Redundancy version</em>' field
as indicated by higher layers.</p>
<p>- the UE shall set value of the '<em>Source ID</em>' field as
indicated by higher layers.</p>
<p>- the UE shall set value of the '<em>Destination ID</em>' field as
indicated by higher layers.</p>
<p>- the UE shall set value of the '<em>HARQ feedback enabled/disabled
indicator</em>' field as indicated by higher layers.</p>
<p>- the UE shall set value of the '<em>Zone ID</em>' field as indicated
by higher layers.</p>
<p>- the UE shall set the '<em>Communication range requirement</em>'
field as indicated by higher layers.</p>
<p>The UE shall set the contents of the SCI format 2-C as follows:</p>
<p>- the UE shall set value of the <em>'HARQ process number'</em> field
as indicated by higher layers.</p>
<p>- the UE shall set value of the '<em>NDI</em>' field as indicated by
higher layers.</p>
<p>- the UE shall set value of the '<em>Redundancy version</em>' field
as indicated by higher layers.</p>
<p>- the UE shall set value of the '<em>Source ID</em>' field as
indicated by higher layers.</p>
<p>- the UE shall set value of the '<em>Destination ID</em>' field as
indicated by higher layers.</p>
<p>- the UE shall set value of the '<em>HARQ feedback enabled/disabled
indicator</em>' field as indicated by higher layers.</p>
<p>- the UE shall set value of the '<em>CSI request</em>' field as
indicated by higher layers.</p>
<p>- the UE shall set value of '<em>Providing/Requesting indicator</em>'
field as indicated by higher layers.</p>
<p>- if '<em>Providing/Requesting indicator</em>' indicates SCI format
2-C is used to convey an explicit request for inter-UE coordination
information:</p>
<p>- the UE shall set value of the '<em>Priority</em>' field as
indicated by higher layers.</p>
<p>- the UE shall set value of the '<em>Number of subchannels</em>'
field as indicated by higher layers.</p>
<p>- the UE shall set value of the '<em>Resource reservation
period</em>' field as indicated by higher layers.</p>
<p>- the UE shall set value of the '<em>Resource selection window
location</em>' field as indicated by higher layers.</p>
<p>- the UE shall set value of the '<em>Resource set type</em>' field as
indicated by higher layers if higher layer parameter
<em>sl-DetermineResourceType</em> is configured to 'UE-B's request';
otherwise this field is omitted.</p>
<p>- if '<em>Providing/Requesting indicator</em>' indicates SCI format
2-C is used to convey inter-UE coordination information:</p>
<p>- the UE shall set value of the '<em>Resource set type</em>' field as
indicated by higher layers.</p>
<p>- the UE shall set value of the '<em>Resource combination(s)</em>'
field (clause 8.1.5A) as indicated by higher layers.</p>
<p>- the UE shall set value of the <em>'Lowest subchannel indices'</em>
as indicated by higher layers</p>
<p>- the UE shall set value of the '<em>First resource location</em>' as
indicated by higher layers</p>
<p>- the UE shall set value of the '<em>Reference slot location</em>' as
indicated by higher layers</p>
<h3 id="transmission-schemes-2">8.1.1 Transmission schemes</h3>
<p>Only one transmission scheme is defined for the PSSCH and is used for
all PSSCH transmissions.</p>
<p>PSSCH transmission is performed with up to two antenna ports, with
antenna ports 1000-1001 as defined in clause 8.2.4 of [4, TS
38.211].</p>
<h3 id="resource-allocation-2">8.1.2 Resource allocation</h3>
<p>In sidelink resource allocation mode 1:</p>
<p>- for PSSCH and PSCCH transmission, dynamic grant, configured grant
type 1 and configured grant type 2 are supported. The configured grant
Type 2 sidelink transmission is semi-persistently scheduled by a SL
grant in a valid activation DCI according to Clause 10.2A of [6, TS
38.213].</p>
<h4 id="resource-allocation-in-time-domain-2">8.1.2.1 Resource
allocation in time domain</h4>
<p>The UE shall transmit the PSSCH in the same slot as the associated
PSCCH.</p>
<p>The minimum resource allocation unit in the time domain is a
slot.</p>
<p>The UE shall transmit the PSSCH in consecutive symbols within the
slot, subject to the following restrictions:</p>
<p>- The UE shall not transmit PSSCH in symbols which are not configured
for sidelink. A symbol is configured for sidelink, according to higher
layer parameters <em>sl-StartSymbol</em> and <em>sl-LengthSymbols</em>,
where <em>sl-StartSymbol</em> is the symbol index of the first symbol of
<em>sl-LengthSymbols</em> consecutive symbols configured for
sidelink.</p>
<p>- Within the slot, PSSCH resource allocation starts at symbol
<em>sl-StartSymbol+1.</em></p>
<p>- The UE shall not transmit PSSCH in symbols which are configured for
use by PSFCH, if PSFCH is configured in this slot.</p>
<p>- The UE shall not transmit PSSCH in the last symbol configured for
sidelink.</p>
<p>- The UE shall not transmit PSSCH in the symbol immediately preceding
the symbols which are configured for use by PSFCH, if PSFCH is
configured in this slot.</p>
<p>In sidelink resource allocation mode 1:</p>
<p>- For sidelink dynamic grant, the PSSCH transmission is scheduled by
a DCI format 3_0.</p>
<p>- For sidelink configured grant type 2, the configured grant is
activated by a DCI format 3_0.</p>
<p>- For sidelink dynamic grant and sidelink configured grant type
2:</p>
<p>- The "Time gap" field value <em>m</em> of the DCI format 3_0
provides an index <em>m</em> + 1 into a slot offset table. That table is
given by higher layer parameter <em>sl-DCI-ToSL-Trans</em> and the table
value at index <em>m</em> + 1 will be referred to as slot offset <span
class="math inline">\(K_{SL}\)</span>.</p>
<p>- The slot of the first sidelink transmission scheduled by the DCI is
the first SL slot of the corresponding resource pool that starts not
earlier than <span class="math inline">\(T_{\text{DL}} -
\frac{T_{\text{TA}}}{2} + K_{SL} \times T_{\text{slot}}\)</span>, where
<span class="math inline">\(T_{\text{DL}}\)</span> is the starting time
of the downlink slot carrying the corresponding DCI, <span
class="math inline">\(T_{\text{TA}}\)</span> is the timing advance value
corresponding to the TAG of the serving cell on which the DCI is
received and <span class="math inline">\(K_{SL}\ \)</span>is the slot
offset between the slot of the DCI and the first sidelink transmission
scheduled by DCI and <span class="math inline">\(T_{slot}\ \)</span> is
the SL slot duration.</p>
<p>- The "Configuration index" field of the DCI format 3_0, if provided
and not reserved, indicates the index of the sidelink configured type
2.</p>
<p>- For sidelink configured grant type 1:</p>
<p>- The slot of the first sidelink transmissions follows the higher
layer configuration according to [10, TS 38.321].</p>
<h4 id="resource-allocation-in-frequency-domain-2">8.1.2.2 Resource
allocation in frequency domain</h4>
<p>The resource allocation unit in the frequency domain is the
sub-channel.</p>
<p>The sub-channel assignment for sidelink transmission is determined
using the "Frequency resource assignment" field in the associated
SCI.</p>
<p>The lowest sub-channel for sidelink transmission is the sub-channel
on which the lowest PRB of the associated PSCCH is transmitted.</p>
<p>If a PSSCH scheduled by a PSCCH would overlap with resources
containing the PSCCH, the resources corresponding to a union of the
PSCCH that scheduled the PSSCH and associated PSCCH DM-RS are not
available for the PSSCH.</p>
<h3
id="modulation-order-target-code-rate-redundancy-version-and-transport-block-size-determination-1">8.1.3
Modulation order, target code rate, redundancy version and transport
block size determination</h3>
<p>The redundancy version is given by the "Redundancy version" field in
SCI format 2-A, 2-B or 2-C.</p>
<h4 id="modulation-order-and-target-code-rate-determination-2">8.1.3.1
Modulation order and target code rate determination</h4>
<p><em>I<sub>MCS </sub></em>is given by the '<em>Modulation and coding
scheme</em>' field in SCI format 1-A.</p>
<p>The MCS table is determined as follows: Table 5.1.3.1-1 is used if no
additional MCS table is configured by higher layer parameter
<em>sl-Additional-MCS-Table</em>; otherwise an MCS table is determined
according to Table 8.1.3.1-1 or Table 8.1.3.1-2 and '<em>Additional</em>
<em>MCS table indicator</em>' field in SCI format 1-A.</p>
<p>Table 8.1.3.1-1: Mapping of one bit of MCS table indicator to MCS
table</p>
<table>
<colgroup>
<col style="width: 20%" />
<col style="width: 79%" />
</colgroup>
<tbody>
<tr>
<td>MCS table indicator</td>
<td>MCS table</td>
</tr>
<tr>
<td>'0'</td>
<td style="text-align: center;">Table 5.1.3.1-1</td>
</tr>
<tr>
<td>'1'</td>
<td style="text-align: center;">1<sup>st</sup> table provided by higher
layer parameter <em>sl-Additional-MCS-Table</em></td>
</tr>
</tbody>
</table>
<p>Table 8.1.3.1-2: Mapping of two bits of MCS table indicator to MCS
table</p>
<table>
<colgroup>
<col style="width: 20%" />
<col style="width: 79%" />
</colgroup>
<tbody>
<tr>
<td>MCS table indicator</td>
<td>MCS table</td>
</tr>
<tr>
<td>'00'</td>
<td style="text-align: center;">Table 5.1.3.1-1</td>
</tr>
<tr>
<td>'01'</td>
<td style="text-align: center;">1<sup>st</sup> table provided by higher
layer parameter <em>sl-Additional-MCS-Table</em></td>
</tr>
<tr>
<td>'10'</td>
<td style="text-align: center;">2<sup>nd</sup> table provided by higher
layer parameter <em>sl-Additional-MCS-Table</em></td>
</tr>
<tr>
<td>'11'</td>
<td style="text-align: center;">reserved</td>
</tr>
</tbody>
</table>
<p>The UE shall use <em>I<sub>MCS</sub></em> and the MCS table
determined according to the previous step to determine the modulation
order (<em>Q<sub>m</sub></em>) and Target code rate (<em>R</em>) used in
the physical sidelink shared channel.</p>
<h4 id="transport-block-size-determination-2">8.1.3.2 Transport block
size determination</h4>
<p>For the PSSCH assigned by SCI, if Table 5.1.3.1-2 is used and <img
src="media/image58.svg" /><span class="math inline">\(0\  \leq \ I_{MCS\
} \leq 27\)</span><em>,</em> or a table other than Table 5.1.3.1-2 is
used and <img src="media/image59.svg" /><span
class="math inline">\(0\  \leq \ I_{MCS\ } \leq 28\)</span><em>,</em>
the UE shall first determine the TBS as specified below:</p>
<p>The UE shall first determine the number of REs
(<em>N<sub>RE</sub></em>) within the slot.</p>
<p>- A UE first determines the number of REs allocated for PSSCH within
a PRB (<span class="math inline">\(N_{RE}&#39;\)</span>) by <span
class="math inline">\(N_{RE}&#39; = N_{sc}^{RB}\left( N_{symb}^{sh} -
N_{symb}^{PSFCH} \right) - N_{oh}^{PRB} - N_{RE}^{DMRS}\)</span>,
where</p>
<p>- <span class="math inline">\(N_{sc}^{RB} = 12\)</span> is the number
of subcarriers in a physical resource block,</p>
<p>- <span class="math inline">\(N_{symb}^{sh}\)</span><span
class="math inline">\(N_{symb}^{slot}\)</span> =
<em>sl-LengthSymbols</em> -2, where <em>sl-LengthSymbols</em> is the
number of sidelink symbols within the slot provided by higher
layers,</p>
<p>- <span class="math inline">\(N_{symb}^{PSFCH}\)</span> = 3 if
'<em>PSFCH overhead indication'</em> field of SCI format 1-A indicates
"1", and <span class="math inline">\(N_{symb}^{PSFCH}\)</span> = 0
otherwise, if higher layer parameter <em>sl-PSFCH-Period</em> is 2 or 4.
If higher layer parameter <em>sl-PSFCH-Period</em> is 0, <span
class="math inline">\(N_{symb}^{PSFCH} = 0\)</span>. If higher layer
parameter <em>sl-PSFCH-Period</em> is 1, <span
class="math inline">\(N_{symb}^{PSFCH} = 3\)</span>.</p>
<p>- <span class="math inline">\(N_{oh}^{PRB}\)</span> is the overhead
given by higher layer parameter <em>sl-X-Overhead</em>,</p>
<p>- <span class="math inline">\(N_{RE}^{DMRS}\)</span> is given by
Table 8.1.3.2-1 according to higher layer parameter
<em>sl-PSSCH-DMRS-TimePatternList.</em></p>
<p>Table 8.1.3.2-1: <span
class="math inline">\(\mathbf{N}_{\mathbf{RE}}^{\mathbf{DMRS}}\)</span>
according to higher layer parameter
<em>sl-PSSCH-DMRS-TimePatternList</em></p>
<table>
<colgroup>
<col style="width: 67%" />
<col style="width: 32%" />
</colgroup>
<thead>
<tr>
<th
style="text-align: center;"><em>sl-PSSCH-DMRS-TimePatternList</em></th>
<th style="text-align: center;"><span
class="math display">\[N_{RE}^{DMRS}\]</span></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">{2}</td>
<td style="text-align: center;">12</td>
</tr>
<tr>
<td style="text-align: center;">{3}</td>
<td style="text-align: center;">18</td>
</tr>
<tr>
<td style="text-align: center;">{4}</td>
<td style="text-align: center;">24</td>
</tr>
<tr>
<td style="text-align: center;">{2,3}</td>
<td style="text-align: center;">15</td>
</tr>
<tr>
<td style="text-align: center;">{2,4}</td>
<td style="text-align: center;">18</td>
</tr>
<tr>
<td style="text-align: center;">{3,4}</td>
<td style="text-align: center;">21</td>
</tr>
<tr>
<td style="text-align: center;">{2,3,4}</td>
<td style="text-align: center;">18</td>
</tr>
</tbody>
</table>
<p>- A UE determines the total number of REs allocated for PSSCH (<img
src="media/image66.svg" />)<span class="math inline">\(N_{RE})\)</span>
by <span class="math inline">\(N_{RE} = N_{RE}&#39; \bullet n_{PRB} -
N_{RE}^{SCI,1} - N_{RE}^{SCI,2}\)</span><span
class="math inline">\(N_{RE} = \ {\overline{N}}_{RE}&#39;*\
n_{PRB}\)</span>, where</p>
<p>- <em>n<sub>PRB</sub></em> is the total number of allocated PRBs for
the PSSCH,</p>
<p>- <span class="math inline">\(N_{RE}^{SCI,1}\)</span> is the total
number of REs occupied by the PSCCH and PSCCH DM-RS.</p>
<p>- <span class="math inline">\(N_{RE}^{SCI,2}\)</span> is the number
of coded modulation symbols generated for 2<sup>nd</sup>-stage SCI
transmission (prior to duplication for the 2<sup>nd</sup> layer, if
present) according to Clause 8.4.4 of [5, TS 38.212], with the
assumption of <span class="math inline">\(\gamma = 0\)</span>.</p>
<p>The UE determines TBS according to Steps 2), 3), and 4) in clause
5.1.3.2.</p>
<p>A UE is not expected to receive an SCI indicating <span
class="math inline">\(28 \leq I_{MCS} \leq 31\)</span> if Table
5.1.3.1-2 is used, or <span class="math inline">\(29 \leq I_{MCS} \leq
31\)</span> otherwise.</p>
<h3
id="ue-procedure-for-determining-the-subset-of-resources-to-be-reported-to-higher-layers-in-pssch-resource-selection-in-sidelink-resource-allocation-mode-2">8.1.4
UE procedure for determining the subset of resources to be reported to
higher layers in PSSCH resource selection in sidelink resource
allocation mode 2</h3>
<p>In resource allocation mode 2, the higher layer can request the UE to
determine a subset of resources from which the higher layer will select
resources for PSSCH/PSCCH transmission. To trigger this procedure, in
slot <em>n,</em> the higher layer provides the following parameters for
this PSSCH/PSCCH transmission:</p>
<p>- the resource pool from which the resources are to be reported;</p>
<p>- L1 priority, <span class="math inline">\(prio_{TX}\)</span>;</p>
<p>- the remaining packet delay budget;</p>
<p>- the number of sub-channels to be used for the PSSCH/PSCCH
transmission in a slot, <span
class="math inline">\(L_{\text{subCH}}\)</span>;</p>
<p>- optionally, the resource reservation interval, <span
class="math inline">\(P_{\text{rsvp\_TX}}\)</span>, in units of
msec.</p>
<p>- if the higher layer requests the UE to determine a subset of
resources from which the higher layer will select resources for
PSSCH/PSCCH transmission as part of re-evaluation or pre-emption
procedure, the higher layer provides a set of resources <span
class="math inline">\((r_{0},r_{1},r_{2},\ldots)\ \)</span>which may be
subject to re-evaluation and a set of resources <span
class="math inline">\((r_{0}&#39;,r_{1}&#39;,r_{2}&#39;,\ldots)\
\)</span>which may be subject to pre-emption.</p>
<p>- it is up to UE implementation to determine the subset of resources
as requested by higher layers before or after the slot <span
class="math inline">\(r_{i}^{&#39;&#39;}\)</span> - <span
class="math inline">\(T_{3}\)</span>, where <span
class="math inline">\(r_{i}^{&#39;&#39;}\)</span> is the slot with the
smallest slot index among <span
class="math inline">\((r_{0},r_{1},r_{2},\ldots)\ \)</span>and <span
class="math inline">\((r_{0}&#39;,r_{1}&#39;,r_{2}&#39;,\ldots)\
\)</span>, and <span class="math inline">\(T_{3}\)</span> is equal to
<span class="math inline">\(T_{proc,1}^{SL}\)</span>, where <span
class="math inline">\(T_{proc,1}^{SL}\ \)</span><em> </em>is defined in
slots in Table 8.1.4-2 where <span
class="math inline">\(\mu_{SL}\)</span> is the SCS configuration of the
SL BWP.</p>
<p>- Optionally, the indication of resource selection mechanism.</p>
<p>The following higher layer parameters affect this procedure:</p>
<p><em>- sl-SelectionWindowList</em>: internal parameter <span
class="math inline">\(T_{2min}\)</span> is set to the corresponding
value from higher layer parameter <em>sl-SelectionWindowList</em> for
the given value of <span class="math inline">\(prio_{TX}\)</span>.</p>
<p><em>- sl-Thres-RSRP-List</em>: this higher layer parameter provides
an RSRP threshold for each combination <span
class="math inline">\(\left( p_{i},\, p_{j} \right)\)</span>, where
<span class="math inline">\(p_{i}\)</span> is the value of the priority
field in a received SCI format 1-A and <span
class="math inline">\(p_{j}\)</span> is the priority of the transmission
of the UE selecting resources; for a given invocation of this procedure,
<span class="math inline">\(p_{j}\  = \ prio_{TX}\)</span>.</p>
<p><em>- sl-RS-ForSensing</em> selects if the UE uses the PSSCH-RSRP or
PSCCH-RSRP measurement, as defined in clause 8.4.2.1.</p>
<p><em>- sl-ResourceReservePeriodList</em></p>
<p><em>- sl-SensingWindow</em>: internal parameter <span
class="math inline">\(T_{0}\)</span> is defined as the number of slots
corresponding to <em>sl-SensingWindow</em> msec</p>
<p><em>- sl-TxPercentageList</em>: internal parameter <span
class="math inline">\(X\)</span> for a given <span
class="math inline">\(prio_{TX}\)</span> is defined as
<em>sl-TxPercentageList (</em><span
class="math inline">\(prio_{TX}\)</span><em>)</em> converted from
percentage to ratio</p>
<p>- <em>sl-PreemptionEnable</em>: if <em>sl-PreemptionEnable</em> is
provided, and if it is not equal to 'enabled', internal parameter <span
class="math inline">\(prio_{pre}\)</span> is set to the higher layer
provided parameter <em>sl-PreemptionEnable.</em></p>
<p>- Optionally, minimum number of <em>Y</em> slots as <span
class="math inline">\(Y_{\min}\)</span>
(<em>sl</em>-<em>MinNumCandidateSlotsPeriodic</em>), which indicates the
minimum number of <em>Y</em> slots that are included in the candidate
resources corresponding to periodic-based partial sensing and contiguous
partial sensing for resource (re)selection triggered by periodic
transmission (<span class="math inline">\(P_{\text{rsvp\_TX}} \neq
0\)</span>).</p>
<p>- Optionally, minimum number of <span
class="math inline">\(Y&#39;\)</span> slots as <span
class="math inline">\({Y&#39;}_{{min\ }\ }\)</span>
(<em>sl</em>-<em>MinNumCandidateSlotsAperiodic</em>), which indicates
the minimum number of <span class="math inline">\(Y&#39;\)</span> slots
that are included in the candidate resources corresponding to
periodic-based partial sensing and/or contiguous partial sensing results
(if available) for resource (re)selection triggered by aperiodic
transmission (<span class="math inline">\(P_{\text{rsvp\_TX}} =
0\)</span>).</p>
<p>- Optionally, sensing occasion as
<em>sl-PBPS-OccasionReservePeriodList,</em> which indicates the subset
of periodicity values from <em>sl-ResourceReservePeriodList</em> used to
determine periodic sensing occasions in periodic-based partial sensing.
If not configured, all periodicity values from
<em>sl-ResourceReservePeriodList</em> are used to determine periodic
sensing occasions in periodic-based partial sensing.</p>
<p>- Optionally, additional sensing occasions as
<em>sl-Additional-PBPS-Occasion</em>, which indicates that UE
additionally monitors periodic sensing occasions that correspond to a
set of values. The possible values of the set at least includes the most
recent sensing occasion before the first slot of the candidate slots
subject to processing time restriction as specified below for a given
reservation periodicity and the last periodic sensing occasion prior to
the most recent one for the given reservation periodicity. If not
(pre-)configured, the UE monitors the most recent sensing occasion
before the first slot of the candidate slots subject to processing time
restriction as specified below for the given periodicity used to
determine periodic sensing occasions in periodic-based partial
sensing.</p>
<blockquote>
<p>- Optionally, indication of the size in logical slots of contiguous
partial sensing window for periodic transmissions as defined by the
parameter <em>sl-CPS-WindowPeriodic</em>.</p>
<p>Optionally, indication of the size in logical slots of contiguous
partial sensing window for aperiodic transmissions as defined by the
parameter <em>sl-CPS-WindowAperiodic.</em></p>
</blockquote>
<p>- Optionally, indication of whether UE is required to perform SL
reception of PSCCH and RSRP measurement for partial sensing on slots in
SL DRX inactive time as <em>sl-PartialSensingInactiveTime.</em></p>
<p>The resource reservation interval, <span
class="math inline">\(P_{\text{rsvp\_TX}}\)</span>, if provided, is
converted from units of msec to units of logical slots, resulting in
<span class="math inline">\(P_{\text{rsvp\_TX}}&#39;\)</span> according
to clause 8.1.7.</p>
<p>When the resource pool is (pre-)configured with
<em>sl-AllowedResourceSelectionConfig</em> including full sensing, and
full sensing is configured in the UE by higher layers, the UE performs
full sensing.</p>
<p>When periodic reservation for another TB
(<em>sl-MultiReserveResource</em>) is enabled for the resource pool, the
resource pool is (pre-)configured with
<em>sl-AllowedResourceSelectionConfig</em> including partial sensing,
and partial sensing is configured by higher layer, the UE performs
periodic-based partial sensing, unless other conditions state otherwise
in the specification.</p>
<p>When a UE is triggered by higher layer to report resources for
resource (re-)selection in a mode 2 Tx pool, the resource pool is
(pre-)configured with <em>sl-AllowedResourceSelectionConfig</em>
including partial sensing, and partial sensing is configured by higher
layer, the UE performs contiguous partial sensing, unless stated
otherwise in the specification.</p>
<p>Notation:</p>
<p><span class="math inline">\(\left( {t&#39;}_{0}^{SL},\
{t&#39;}_{1}^{SL},\ {t&#39;}_{2}^{SL},\ldots \right)\)</span> denotes
the set of slots which belongs to the sidelink resource pool and is
defined in Clause 8.</p>
<p>The following steps are used:</p>
<p>1) A candidate single-slot resource for transmission <span
class="math inline">\(R_{\text{x,y}}\)</span> is defined as a set of
<span class="math inline">\(L_{\text{subCH}}\)</span> contiguous
sub-channels with sub-channel <em>x+j</em> in slot <span
class="math inline">\({t&#39;}_{y}^{SL}\)</span> where <span
class="math inline">\(j = 0,...,L_{\text{subCH}} - 1\)</span>. The UE
shall assume that any set of <span
class="math inline">\(L_{\text{subCH}}\)</span> contiguous sub-channels
included in the corresponding resource pool within the time interval
<span class="math inline">\(\lbrack n + T_{1},n + T_{2}\rbrack\)</span>
correspond to one candidate single-slot resource for UE performing full
sensing, in a set of <em>Y</em> candidate slots within the time interval
<span class="math inline">\(\left\lbrack n + T_{1},n + T_{2}
\right\rbrack\)</span> correspond to one candidate single-slot resource
for UE performing periodic-based partial sensing together with
contiguous partial sensing and resource (re)selection triggered by
periodic transmission (<span class="math inline">\(P_{\text{rsvp\_TX}}
\neq 0\)</span>), or in a set of <em>Y'</em> candidate slots within the
time interval <span class="math inline">\(\lbrack n + T_{1},n +
T_{2}\rbrack\)</span> correspond to one candidate single-slot resource
for UE performing at least contiguous partial sensing and resource
(re)selection triggered by aperiodic transmission (<span
class="math inline">\(P_{\text{rsvp\_TX}} = 0\)</span>), where</p>
<p>- selection of <span class="math inline">\(T_{1}\)</span> is up to UE
implementation under <span class="math inline">\(0\  \leq \ T_{1}
\leq\)</span> <span class="math inline">\(T_{proc,1}^{SL}\ \)</span> ,
where <span class="math inline">\(T_{proc,1}^{SL}\ \)</span> is defined
in slots in Table 8.1.4-2 where <span
class="math inline">\(\mu_{SL}\)</span> is the SCS configuration of the
SL BWP;</p>
<p>- if <span class="math inline">\({\ T}_{2min}\)</span> is shorter
than the remaining packet delay budget (in slots) then <span
class="math inline">\(T_{2}\ \)</span>is up to UE implementation subject
to <span class="math inline">\(T_{2min}\  \leq \ T_{2}\)</span> <span
class="math inline">\(\leq\)</span> remaining packet delay budget (in
slots); otherwise <span class="math inline">\(T_{2}\ \)</span>is set to
the remaining packet delay budget (in slots).</p>
<p>- <span class="math inline">\(Y\)</span> is selected by UE where
<span class="math inline">\(Y \geq Y_{\min}\)</span>.</p>
<p>- <span class="math inline">\(Y&#39;\)</span> is selected by UE where
<span class="math inline">\(Y&#39; \geq Y_{\min}&#39;\)</span>. When the
UE performs at least contiguous partial sensing and if <span
class="math inline">\(P_{\text{rsvp\_TX}} = 0\)</span>, the UE selects a
set of <span class="math inline">\(Y&#39;\)</span> candidate slots with
corresponding PBPS and/or CPS results (if available). If the number of
candidate slots <span class="math inline">\(Y&#39;\)</span> is smaller
than <span class="math inline">\(Y_{\min}&#39;\)</span>, it is up to UE
implementation to include other candidate slots.</p>
<p>The total number of candidate single-slot resources is denoted by
<span class="math inline">\(M_{\text{total}}\)</span>.</p>
<p>2) The sensing window is defined by the range of slots [<span
class="math inline">\(n\, –T_{0},n–T_{proc,0}^{SL}\)</span>), when the
UE performs full sensing, where <span
class="math inline">\(T_{0}\)</span> is defined above and <span
class="math inline">\(T_{proc,0}^{SL}\)</span> is defined in slots in
Table 8.1.4-1 where <span class="math inline">\(\mu_{SL}\)</span> is the
SCS configuration of the SL BWP. The UE shall monitor slots which
belongs to a sidelink resource pool within the sensing window except for
those in which its own transmissions occur. The UE shall perform the
behaviour in the following steps based on PSCCH decoded and RSRP
measured in these slots.</p>
<p>When the UE performs periodic-based partial sensing, the UE shall
monitor slots at <span class="math inline">\(t_{y - k \times
P_{reserve}&#39;}^{&#39;SL}\)</span>, where <span
class="math inline">\({t&#39;}_{y}^{SL}\)</span> is a slot of the
selected candidate slots and <span
class="math inline">\(P_{reserve}&#39;\)</span> is <span
class="math inline">\(P_{reserve}\)</span> converted to units of logical
slot according to clause 8.1.7. The UE shall perform the behaviour in
the following steps based on PSCCH decoded and RSRP measured in these
slots.</p>
<p>The value of <span class="math inline">\(P_{reserve}\)</span>
corresponds to <em>sl-PBPS-OccasionReservePeriodList</em> if
(pre-)configured, otherwise, the values correspond to all periodicity
from <em>sl-ResourceReservePeriodList.</em></p>
<p>The UE monitors sensing occasion(s) determined by
<em>sl-Additional-PBPS-Occasion</em>, as previously described, and not
earlier than <span class="math inline">\(n\, –T_{0}\)</span>. For a
given periodicity <span class="math inline">\(P_{reserve}\)</span>, the
values of <em>k</em> correspond to the most recent sensing occasion
earlier than <span class="math inline">\({t&#39;}_{y0}^{SL} -
{(T}_{proc,0}^{SL} + T_{proc,1}^{SL}\ )\ \)</span>if
<em>sl-Additional-PBPS-Occasion</em> is not (pre-)configured, and
additionally includes the value of <em>k</em> corresponding to the last
periodic sensing occasion prior to the most recent one if
<em>sl-Additional-PBPS-Occasion</em> is (pre-)configured. <span
class="math inline">\({t&#39;}_{y0}^{SL}\)</span> is the first slot of
the selected <em>Y</em> candidate slots of PBPS.</p>
<p>When the UE performs periodic-based partial sensing and contiguous
partial sensing with periodic reservation for another TB
(<em>sl-MultiReserveResource</em>) enabled and <span
class="math inline">\(P_{\text{rsvp\_TX}} \neq 0\)</span>, the
contiguous partial sensing window is defined by the range of slots <span
class="math inline">\(\lbrack n + T_{A},\ n + T_{B}\rbrack\)</span>.
<em>n</em>+<em>T</em><sub>A</sub> is <em>M</em> consecutive logical
slots earlier than slot <span
class="math inline">\({t&#39;}_{y0}^{SL}\)</span>, and
<em>n</em>+<em>T</em><sub>B</sub> is <span
class="math inline">\(T_{proc,0}^{SL} + T_{proc,1}^{SL}\)</span> slots
earlier than <span class="math inline">\({t&#39;}_{y0}^{SL}\)</span>,
where <span class="math inline">\({t&#39;}_{y0}^{SL}\)</span> is the
first slot of the selected <em>Y</em> candidate slots of PBPS, and <span
class="math inline">\(T_{proc,0}^{SL}\)</span>, <span
class="math inline">\(T_{proc,1}^{SL}\)</span> are in units of physical
time/slots. The value of <em>M</em> is (pre-)configured with the
<em>sl-CPS-WindowPeriodic</em>. The UE shall perform the behaviour in
the following steps based on PSCCH decoded and RSRP measured in these
slots. If <em>sl-CPS-WindowPeriodic</em> is not (pre-)configured,
<em>M</em> equals to 31.</p>
<p>When the UE performs at least contiguous partial sensing and if <span
class="math inline">\(P_{\text{rsvp\_TX}} = 0\)</span>, the contiguous
partial sensing window is defined by the range of slots <span
class="math inline">\(\lbrack n + T_{A},\ n + T_{B}\rbrack\)</span>.
<span class="math inline">\(T_{A}\)</span> and <span
class="math inline">\(T_{B}\)</span> are both selected such that the UE
has sensing results starting at least <em>M</em> consecutive logical
slots before <span class="math inline">\({t&#39;}_{y0}^{SL}\)</span> and
ending at <span class="math inline">\(T_{proc,0}^{SL} +
T_{proc,1}^{SL}\)</span> slots earlier than <span
class="math inline">\({t&#39;}_{y0}^{SL}\)</span>, where <span
class="math inline">\({t&#39;}_{y0}^{SL}\)</span> is the first slot of
the selected <span class="math inline">\(Y&#39;\)</span>candidate slots.
The value of <em>M</em> is (pre-)configured with the
<em>sl-CPS-WindowAperiodic</em>. The UE shall perform the behaviour in
the following steps based on PSCCH decoded and RSRP measured in these
slots. If <em>sl-CPS-WindowAperiodic</em> is not (pre-)configured,
<em>M</em> equals to 31. When the minimum <em>M</em> slots for CPS
cannot be guaranteed and when <span
class="math inline">\(P_{\text{rsvp\_TX}} = 0\)</span>, it is up to UE
implementation to either continue with step 3) or perform random
selection.</p>
<p>Whether the UE is required to performs SL reception of PSCCH and RSRP
measurement for partial sensing on slots in SL DRX inactive time is
enabled/disabled by higher layer parameter
<em>sl-PartialSensingInactiveTime.</em> When it is enabled, if UE
performs periodic-based partial sensing on the slots in SL DRX inactive
time for a given periodicity corresponding to <span
class="math inline">\(P_{\text{reserve}}\)</span>, UE monitors only the
default periodic sensing occasions (most recent sensing occasion) from
the slots; if UE performs contiguous partial sensing on the slots in SL
DRX inactive time, UE monitors a minimum of <em>M</em> slots from the
slots.</p>
<p>3) The internal parameter <span
class="math inline">\(Th(p_{i},p_{j})\ \)</span> is set to the
corresponding value of RSRP threshold indicated by the <em>i</em>-th
field in <em>sl-Thres-RSRP-List</em>, where <span
class="math inline">\(i = p_{i} + \left( p_{j} - 1
\right)*8\)</span>.</p>
<p>4) The set <span class="math inline">\(S_{A}\)</span> is initialized
to the set of all the candidate single-slot resources.</p>
<p>5) The UE shall exclude any candidate single-slot resource <span
class="math inline">\(R_{\text{x,y}}\)</span> from the set <span
class="math inline">\(S_{A}\)</span> if it meets all the following
conditions:</p>
<p>- the UE has not monitored slot <span
class="math inline">\({t&#39;}_{m}^{SL}\)</span> in Step 2.</p>
<p>- for any periodicity value allowed by the higher layer parameter
<em>sl-ResourceReservePeriodList</em> and a hypothetical SCI format 1-A
received in slot <span class="math inline">\({t&#39;}_{m}^{SL}\)</span>
with '<em>Resource reservation period</em>' field set to that
periodicity value and indicating all subchannels of the resource pool in
this slot, condition c in step 6 would be met.</p>
<p>5a) If the number of candidate single-slot resources <span
class="math inline">\(R_{\text{x,y}}\)</span> remaining in the set <span
class="math inline">\(S_{A}\)</span> is smaller than <span
class="math inline">\(X \cdot M_{\text{total}}\)</span>, the set <span
class="math inline">\(S_{A}\)</span> is initialized to the set of all
the candidate single-slot resources as in step 4.</p>
<p>6) The UE shall exclude any candidate single-slot resource <span
class="math inline">\(R_{\text{x,y}}\)</span> from the set <span
class="math inline">\(S_{A}\)</span> if it meets all the following
conditions:</p>
<p>a) the UE receives an SCI format 1-A in slot <span
class="math inline">\({t&#39;}_{m}^{SL}\)</span>, and '<em>Resource
reservation period'</em> field, if present, and '<em>Priority</em>'
field in the received SCI format 1-A indicate the values <span
class="math inline">\(P_{\text{rsvp\_RX}}\)</span> and <span
class="math inline">\(prio_{RX}\)</span>, respectively according to
Clause 16.4 in [6, TS 38.213];</p>
<p>b) the RSRP measurement performed, according to clause 8.4.2.1 for
the received SCI format 1-A, is higher than <span
class="math inline">\(Th\left( prio_{RX},prio_{TX} \right);\)</span></p>
<p>c) the SCI format received in slot <span
class="math inline">\({t&#39;}_{m}^{SL}\ \)</span>or the same SCI format
which, if and only if the '<em>Resource reservation period</em>' field
is present in the received SCI format 1-A, is assumed to be received in
slot(s) <span class="math inline">\({t&#39;}_{m + q \times
P_{rsvp\text{\_}RX}&#39;}^{SL}\)</span> determines according to clause
8.1.5 the set of resource blocks and slots which overlaps with <span
class="math inline">\(R_{x,y + j \times P_{rsvp\_ TX}&#39;}\)</span> for
<em>q</em>=1, 2, …, <em>Q</em> and <em>j=</em>0, 1, …, <span
class="math inline">\(C_{resel} - 1\)</span>. Here, <span
class="math inline">\(P_{rsvp\text{\_}RX}&#39;\)</span> is <span
class="math inline">\(P_{\text{rsvp\_RX}}\)</span> converted to units of
logical slots according to clause 8.1.7, <span class="math inline">\(Q =
\left\lceil \frac{T_{scal}}{P_{rsvp\text{\_}RX}} \right\rceil\ \)</span>
if <span class="math inline">\(P_{rsvp\_ RX} &lt; \ T_{scal}\)</span>
and <span class="math inline">\(\ n&#39; - m \leq
P_{rsvp\text{\_}RX}&#39;\)</span>, where if the UE is configured with
full sensing by its higher layer, <span
class="math inline">\({t&#39;}_{n&#39;}^{SL}\  = \ n\)</span> if slot
<em>n</em> belongs to the set <span class="math inline">\(\left(
{t&#39;}_{0}^{SL},{t&#39;}_{1}^{SL},...,{t&#39;}_{{T&#39;}_{\max} -
1}^{SL} \right)\)</span>, otherwise slot <span
class="math inline">\({t&#39;}_{n&#39;}^{SL}\)</span> is the first slot
after slot <em>n</em> belonging to the set <span
class="math inline">\(\left(
{t&#39;}_{0}^{SL},{t&#39;}_{1}^{SL},...,{t&#39;}_{{T&#39;}_{\max} -
1}^{SL} \right)\)</span>; If UE is configured with partial sensing by
its higher layer, <span class="math inline">\({t&#39;}_{n&#39;}^{SL} =
{t&#39;}_{y_{i}}^{SL} - T_{proc,1}^{SL}\)</span> if slot <span
class="math inline">\({t&#39;}_{y_{i}}^{SL} - T_{proc,1}^{SL}\)</span>
belongs to the set <span class="math inline">\(\left(
{t&#39;}_{0}^{SL},{t&#39;}_{1}^{SL},...,{t&#39;}_{{T&#39;}_{\max} -
1}^{SL} \right)\)</span>, otherwise, slot <span
class="math inline">\({t&#39;}_{n&#39;}^{SL}\)</span> is the first slot
after slot <span class="math inline">\({t&#39;}_{y_{i}}^{SL} -
T_{proc,1}^{SL}\)</span> belonging to the set <span
class="math inline">\(\left(
{t&#39;}_{0}^{SL},{t&#39;}_{1}^{SL},...,{t&#39;}_{{T&#39;}_{\max} -
1}^{SL} \right)\)</span>. Otherwise <span class="math inline">\(Q =
1\)</span>. If the UE is configured with full sensing by its higher
layer, <span class="math inline">\(T_{scal}\)</span> is set to selection
window size <em>T<sub>2</sub></em> converted to units of msec. If UE is
configured with partial sensing by its higher layer, <span
class="math inline">\(T_{scal} = {t&#39;}_{y_{L}}^{SL} -
({t&#39;}_{y_{i}}^{SL} - T_{proc,1}^{SL})\)</span> shall be converted to
milliseconds, where slot <span
class="math inline">\({t&#39;}_{y_{L}}^{SL}\)</span> is the last slot of
the <span class="math inline">\(Y\)</span> or <span
class="math inline">\(Y&#39;\)</span> candidate slots. The slot <span
class="math inline">\({t&#39;}_{y_{i}}^{SL}\)</span> is the first slot
of the selected/remaining set of <span class="math inline">\(Y\)</span>
or <span class="math inline">\(Y&#39;\)</span> candidate slots.</p>
<p>6a) This step is executed only if the procedure in clause 8.1.4A is
triggered.</p>
<p>6b) This step is executed only if the procedure in clause 8.1.4C is
triggered.</p>
<p>7) If the number of candidate single-slot resources remaining in the
set <span class="math inline">\(S_{A}\)</span> is smaller than <span
class="math inline">\(X \cdot M_{\text{total}}\)</span>, then <span
class="math inline">\(Th(p_{i},p_{j})\)</span> is increased by 3 dB for
each priority value <span class="math inline">\(Th(p_{i},p_{j})\)</span>
and the procedure continues with step 4.</p>
<p>7a) If sidelink DRX active time of RX UE is provided by the higher
layer and there is no candidate single-slot resource remained within the
sidelink DRX active time in the set <span
class="math inline">\(S_{A}\)</span>, the UE based on its implementation
additionally selects and includes at least one candidate single-slot
resources within the sidelink DRX active time in the set <span
class="math inline">\(S_{A}\)</span>.</p>
<p>The UE shall report set <span class="math inline">\(S_{A}\)</span> to
higher layers.</p>
<p>If a resource <span class="math inline">\(r_{i}\)</span> from the set
<span class="math inline">\((r_{0},r_{1},r_{2},\ldots)\)</span> is not a
member of <span class="math inline">\(S_{A}\)</span>, then the UE shall
report re-evaluation of the resource <span
class="math inline">\(r_{i}\)</span> to higher layers.</p>
<p>If a resource <span class="math inline">\(r_{i}&#39;\)</span> from
the set <span
class="math inline">\((r_{0}&#39;,r_{1}&#39;,r_{2}&#39;,\ldots)\)</span>
meets the conditions below then the UE shall report pre-emption of the
resource <span class="math inline">\(r_{i}&#39;\)</span> to higher
layers.</p>
<p>- <span class="math inline">\(r_{i}&#39;\)</span> is not a member of
<span class="math inline">\(S_{A}\)</span>, and</p>
<p>- <span class="math inline">\(r_{i}&#39;\)</span> meets the
conditions for exclusion in step 6, with <span
class="math inline">\(Th\left( prio_{RX},prio_{TX} \right)\)</span> set
to the final threshold after executing steps 1)-7), i.e. including all
necessary increments for reaching <span class="math inline">\(X \cdot
M_{total}\)</span>, and</p>
<p>- the associated priority <span
class="math inline">\(prio_{RX},\)</span> satisfies one of the following
conditions:</p>
<p>- <em>sl-PreemptionEnable</em> is provided and is equal to 'enabled'
and <span class="math inline">\(prio_{TX} &gt; prio_{RX}\)</span></p>
<p>- <em>sl-PreemptionEnable</em> is provided and is not equal to
'enabled', and <span class="math inline">\(prio_{RX} &lt;
prio_{pre}\)</span> and <span class="math inline">\(prio_{TX} &gt;
prio_{RX}\)</span></p>
<p>Table 8.1.4-1: <span
class="math inline">\(\mathbf{T}_{\mathbf{proc,0}}^{\mathbf{SL}}\)</span>
depending on sub-carrier spacing</p>
<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr>
<th style="text-align: left;"><span
class="math display">\[\mathbf{\mu}_{\mathbf{SL}}\]</span></th>
<th style="text-align: center;"><span
class="math inline">\(\mathbf{T}_{\mathbf{proc,0}}^{\mathbf{SL}}\)</span>
<strong>[slots]</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
</tr>
<tr>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
</tr>
<tr>
<td style="text-align: center;">2</td>
<td style="text-align: center;">2</td>
</tr>
<tr>
<td style="text-align: center;">3</td>
<td style="text-align: center;">4</td>
</tr>
</tbody>
</table>
<p>Table 8.1.4-2: <span
class="math inline">\(\mathbf{T}_{\mathbf{proc,1}}^{\mathbf{SL}}\)</span>
depending on sub-carrier spacing</p>
<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr>
<th style="text-align: left;"><span
class="math display">\[\mathbf{\mu}_{\mathbf{SL}}\]</span></th>
<th style="text-align: center;"><span
class="math inline">\(\mathbf{T}_{\mathbf{proc,1}}^{\mathbf{SL}}\)</span>
<strong>[slots]</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">0</td>
<td style="text-align: center;">3</td>
</tr>
<tr>
<td style="text-align: center;">1</td>
<td style="text-align: center;">5</td>
</tr>
<tr>
<td style="text-align: center;">2</td>
<td style="text-align: center;">9</td>
</tr>
<tr>
<td style="text-align: center;">3</td>
<td style="text-align: center;">17</td>
</tr>
</tbody>
</table>
<p>When the UE performs periodic-based partial sensing and contiguous
partial sensing, and when the UE is triggered to perform re-evaluation
and/or pre-emption checking, and if <span
class="math inline">\(P_{\text{rsvp\_TX}} \neq 0\)</span>,</p>
<p>- During the <em>q</em><sup>th</sup> reservation period
(<em>q</em>=0,1,2,…, <em>Cresel</em>-1), candidate resource set
(<em>S<sub>A</sub></em>) is initialized to the remaining <em>Y</em>
candidate slots starting from slot <span
class="math inline">\({t&#39;}_{yi}^{SL}\)</span> and ending at the last
slot of the <em>Y</em> candidate slots, where the slot indices of the
remaining <em>Y</em> candidate slots are equal to <span
class="math inline">\({t&#39;}_{y + q \times
P_{rsvp\text{\_}TX}&#39;}^{SL}\)</span>, where <span
class="math inline">\({t&#39;}_{y}^{SL}\)</span> is a slot index of
<em>Y</em> candidate slots used in the initial resource
(re)selection.</p>
<p>- <span class="math inline">\({t&#39;}_{yi}^{SL}\)</span> is the
first candidate slot starting from slot <em>n+T<sub>3</sub></em>.</p>
<p>- The UE performs PBPS for the remaining <em>Y</em> candidate slots
according to <span class="math inline">\(t_{y&#39; - k \times
P_{reserve}&#39;}^{&#39;SL}\)</span> except for those in which its own
transmissions occur, where<span
class="math inline">\({t&#39;}_{\mathbf{y&#39;}}^{SL}\)</span> is a slot
belonging to the remaining <em>Y</em> candidate slots, and <em>k</em>
and <em>P<sub>reserve</sub></em> are the same as resource (re)selection,
where the values of <em>k</em> correspond to the most recent sensing
occasion earlier than <span class="math inline">\({t&#39;}_{yi}^{SL} -
{(T}_{proc,0}^{SL} + T_{proc,1}^{SL}\ )\ \)</span>if
<em>sl-Additional-PBPS-Occasion</em> is not (pre-)configured, and
additionally includes the value of <em>k</em> corresponding to the last
periodic sensing occasion prior to the most recent one if
<em>sl-Additional-PBPS-Occasion</em> is (pre-)configured.</p>
<p>- The UE performs CPS starting from <em>M</em> logical slots earlier
than <span class="math inline">\({t&#39;}_{yi}^{SL}\)</span> to <span
class="math inline">\(T_{proc,0}^{SL} + T_{proc,1}^{SL}\)</span> slots
earlier than <span class="math inline">\({t&#39;}_{yi}^{SL}\)</span>
except for those in which its own transmissions occur.</p>
<p>- By default, <em>M</em> is 31 unless (pre-)configured with another
value by <em>sl-CPS-WindowPeriodic</em>.</p>
<p>When the UE is triggered to perform re-evaluation and/or pre-emption
checking, performs at least contiguous partial sensing, and if <span
class="math inline">\(P_{\text{rsvp\_TX}} = 0\)</span>,</p>
<p>- Candidate resource set (<em>S<sub>A</sub></em>) is initialized to
the remaining <em>Y'</em> candidate slots starting from slot <span
class="math inline">\({t&#39;}_{yi}^{SL}\)</span> and ending at the last
slot of the <em>Y'</em> candidate slots, where <span
class="math inline">\({t&#39;}_{yi}^{SL}\)</span> is the first candidate
slot starting from slot <em>n+T<sub>3</sub></em>.</p>
<p>- It is up to UE implementation that UE may perform PBPS for periodic
sensing occasions after the resource (re)selection when higher layer
parameter <em>sl-MultiReserveResource</em> is enabled.</p>
<p>- UE performs CPS starting from at least <em>M</em> consecutive
logical slots earlier than <span
class="math inline">\({t&#39;}_{yi}^{SL}\)</span> to <span
class="math inline">\(T_{proc,0}^{SL} + T_{proc,1}^{SL}\)</span> slots
earlier than <span class="math inline">\({t&#39;}_{yi}^{SL}\)</span>
except for those in which its own transmissions occur.</p>
<p>- For minimum size <em>M</em> of the contiguous partial sensing
window <span class="math inline">\(\lbrack n + T_{A},\ n +
T_{B}\rbrack\)</span>, by default, <em>M</em> is 31 unless
(pre-)configured with another value, by
<em>sl-CPS-WindowAperiodic</em>.</p>
<blockquote>
<p>When the minimum <em>M</em> slots for CPS cannot be guaranteed, UE
senses in all available slots starting from the resource (re)selection
trigger slot of the same TB to <span
class="math inline">\(T_{proc,0}^{SL} + T_{proc,1}^{SL}\)</span> slots
earlier than <span class="math inline">\({t&#39;}_{yi}^{SL}\)</span>.
The UE re-evaluation and pre-emption checking is based on all available
sensing results after <span class="math inline">\(n\,
–T_{0}\)</span>.</p>
</blockquote>
<h3
id="a-ue-procedure-for-determining-a-set-of-preferred-or-non-preferred-resources-for-another-ues-transmission">8.1.4A
UE procedure for determining a set of preferred or non-preferred
resources for another UE's transmission</h3>
<p>When this procedure is triggered, the following parameters are
provided by the higher layer:</p>
<p>- the resource pool from which the preferred or non-preferred
resources are to be determined;</p>
<p>- the resource selection window <span class="math inline">\(\lbrack n
+ T_{1},n + T_{2}\rbrack\)</span> within which the preferred or
non-preferred resources are to be determined;</p>
<p>- the resource set type (either preferred or non-preferred resource
set);</p>
<p>- if the resource set type indicates preferred set, then the higher
layer additionally provides the following parameters:</p>
<p>- L1 priority, <span class="math inline">\(prio_{TX}\)</span>;</p>
<p>- the number of sub-channels to be used for the PSSCH/PSCCH
transmission in a slot, <span
class="math inline">\(L_{\text{subCH}}\)</span>;</p>
<p>- the resource reservation period, <span
class="math inline">\(P_{\text{rsvp\_TX}}\)</span>, if present.</p>
<p>The value of <span class="math inline">\(C_{resel}\)</span> is
determined by the UE according to clause 8.1.5.</p>
<p>When this procedure is triggered by another UE's explicit request,
the fields in the request are interpreted as follows:</p>
<blockquote>
<p>- The field 'Resource selection window location' is the concatenation
of the starting time location and the ending time location of the
resource selection window. The starting and ending time locations of the
resource selection window are each encoded in the same way as the
reference slot as described in clause 8.1.5A.</p>
<p>- The field 'Resource reservation period' is encoded in the same way
as the field of the same name in SCI format 1-A.</p>
</blockquote>
<p>When determining a preferred resource set, the UE applies the
procedure described in clause 8.1.4 with the above parameters and the
following modifications:</p>
<p>- Step 6a) The UE excludes candidate single-slot resource(s)
belonging to slot(s) where the UE does not expect to perform SL
reception of a TB due to half-duplex operation, if all the following
conditions are met:</p>
<p>- the UE is a destination UE of the TB for whose transmission the
preferred resource set is being determined;</p>
<p>- the higher layer parameter <em>sl-Condition1-A-2</em> is not set to
'Disabled'.</p>
<p>When determining a non-preferred resource set, the UE considers any
resource(s) within the resource selection window, if indicated by a
received explicit request, and satisfying at least one of the following
conditions as non-preferred resource(s):</p>
<p>- resource(s) indicated by a received SCI format 1-A, satisfying at
least one of the following criteria:</p>
<p>- the RSRP measurement performed, according to clause 8.4.2.1, for
the received SCI format 1-A, is higher than <span
class="math inline">\(Th\left( prio_{RX} \right)\)</span> where <span
class="math inline">\(prio_{RX}\)</span> is the value of the priority
field in the received SCI format 1-A. The internal parameter <span
class="math inline">\(Th(p_{i})\)</span> is set to the corresponding
value of RSRP threshold indicated by the <em>k</em>-th field in
<em>sl-ThresholdRSRP-Condition1-B-1-Option1List</em>, where <span
class="math inline">\(k = p_{i}\)</span>.</p>
<p>- the UE is a destination UE of a TB associated with the received SCI
format 1-A and the RSRP measurement performed, according to clause
8.4.2.1 for the received SCI format 1-A, is lower than <span
class="math inline">\(Th&#39;\left( prio_{RX} \right)\)</span> where
<span class="math inline">\(prio_{RX}\)</span> is the value of the
priority field in the received SCI format 1-A. The internal parameter
<span class="math inline">\(Th&#39;(p_{i})\)</span> is set to the
corresponding value of RSRP threshold indicated by the <em>k</em>-th
field in <em>sl-ThresholdRSRP-Condition1-B-1-Option2List</em>, where
<span class="math inline">\(k = p_{i}\)</span>.</p>
<p>- resources(s) in slot(s) in which the UE does not expect to perform
SL reception due to half duplex operation, if the UE is a destination UE
of a TB for whose transmission the non-preferred resource set is being
determined.</p>
<h3 id="b-void">8.1.4B Void </h3>
<h3
id="c-ue-procedure-for-using-a-received-non-preferred-resource-set">8.1.4C
UE procedure for using a received non-preferred resource set </h3>
<p>A UE configured with the higher layer parameter
<em>sl-InterUE-CoordinationScheme1</em> uses a received non-preferred
resource set as follows when performing resource (re-)selection:</p>
<p>- the UE excludes in Step 6b) of clause 8.1.4 resource(s) overlapping
with the non-preferred resource set.</p>
<p>If it is not possible to meet the requirement that the number of
candidate single-slot resources remaining in the set <span
class="math inline">\(S_{A}\)</span> be at least <span
class="math inline">\(X \cdot M_{\text{total}}\)</span> after excluding
resource(s) overlapping with the received non-preferred resource set, it
is up to UE implementation whether or not to take into account the
received non-preferred resource set to meet such requirement.</p>
<p>The UE is not required to use any resource from the non-preferred
resource set in its resource (re-)selection if that resource is earlier
than (<span class="math inline">\(T_{proc,0}^{SL}\)</span>+ <span
class="math inline">\(T_{proc,1}^{SL}\)</span>+ <span
class="math inline">\(T_{proc,2}^{SL}\)</span>) after the resource of
inter-UE coordination information transmission, where <span
class="math inline">\(T_{proc,2}^{SL}\)</span> is equal to (<span
class="math inline">\(T_{proc,0}^{SL}\)</span>+ <span
class="math inline">\(T_{proc,1}^{SL}\)</span>) when only MAC CE is used
for inter-UE coordination information transmission, or <span
class="math inline">\(T_{proc,2}^{SL}\)</span> is equal to <span
class="math inline">\(T_{proc,0}^{SL}\)</span> when MAC CE and SCI
format 2-C are both used for inter-UE coordination information
transmission.</p>
<p>The case when <span class="math inline">\(T_{proc,2}^{SL}\)</span> is
equal to <span class="math inline">\(T_{proc,0}^{SL}\)</span> is
assuming that SCI format 2-C is received.</p>
<h3
id="ue-procedure-for-determining-slots-and-resource-blocks-for-pssch-transmission-associated-with-an-sci-format-1-a">8.1.5
UE procedure for determining slots and resource blocks for PSSCH
transmission associated with an SCI format 1-A</h3>
<p>The set of slots and resource blocks for PSSCH transmission is
determined by the resource used for the PSCCH transmission containing
the associated SCI format 1-A, and fields '<em>Frequency resource
assignment</em>', '<em>Time resource assignment</em>' of the associated
SCI format 1-A as described below.</p>
<p>'<em>Time resource assignment</em>' carries logical slot offset
indication of N = 1 or 2 actual resources when
<em>sl-MaxNumPerReserve</em> is 2, and N = 1 or 2 or 3 actual resources
when <em>sl-MaxNumPerReserve</em> is 3, in a form of time RIV (TRIV)
field which is determined as follows:</p>
<p>if <span class="math inline">\(N = 1\)</span></p>
<p><span class="math inline">\(TRIV = 0\)</span></p>
<p>elseif <span class="math inline">\(N = 2\)</span></p>
<p><span class="math inline">\(TRIV = t_{1}\)</span></p>
<p>else</p>
<p>if <span class="math inline">\(\left( t_{2} - t_{1} - 1 \right) \leq
15\)</span></p>
<p><span class="math inline">\(TRIV = 30\left( t_{2} - t_{1} - 1 \right)
+ t_{1} + 31\)</span></p>
<p>else</p>
<p><span class="math inline">\(TRIV = 30\left( 31 - t_{2} + t_{1}
\right) + 62 - t_{1}\)</span></p>
<p>end if</p>
<p>end if</p>
<p>where the first resource is in the slot where SCI format 1-A was
received, and <span class="math inline">\(t_{i}\)</span> denotes i-th
resource time offset in logical slots of a resource pool with respect to
the first resource where for N = 2, <span class="math inline">\(1 \leq
t_{1} \leq 31\)</span>; and for N = 3, <span class="math inline">\(1
\leq t_{1} \leq 30\)</span>, <span class="math inline">\(t_{1} &lt;
t_{2} \leq 31\)</span>.</p>
<p>The starting sub-channel <span
class="math inline">\(n_{subCH,0}^{start}\)</span> of the first resource
is determined according to clause 8.1.2.2. The number of contiguously
allocated sub-channels for each of the N resources <span
class="math inline">\(L_{\text{subCH}} \geq 1\)</span> and the starting
sub-channel indexes of resources indicated by the received SCI format
1-A, except the resource in the slot where SCI format 1-A was received,
are determined from "Frequency resource assignment" which is equal to a
frequency RIV (FRIV) where.</p>
<p>If <em>sl-MaxNumPerReserve</em> is 2 then</p>
<p><span class="math inline">\(FRIV = n_{subCH,1}^{start} + \sum_{i =
1}^{L_{\text{subCH}} - 1}\left( N_{\text{ subchannel}}^{\text{ }SL} + 1
- i \right)\)</span></p>
<p>If <em>sl-MaxNumPerReserve</em> is 3 then</p>
<p><span class="math inline">\(FRIV = n_{subCH,1}^{start} +
n_{subCH,2}^{start} \cdot \left( N_{\text{ subchannel}}^{\text{ }SL} + 1
- L_{\text{subCH}} \right) + \sum_{i = 1}^{L_{\text{subCH}} - 1}\left(
N_{\text{ subchannel}}^{\text{ }SL} + 1 - i \right)^{2}\)</span></p>
<p>where</p>
<p>- <span class="math inline">\(n_{subCH,1}^{start}\)</span> denotes
the starting sub-channel index for the second resource</p>
<p>- <span class="math inline">\(n_{subCH,2}^{start}\)</span> denotes
the starting sub-channel index for the third resource</p>
<p>- <span class="math inline">\(N_{\text{ subchannel}}^{\text{
}SL}\)</span> is the number of sub-channels in a resource pool provided
according to the higher layer parameter <em>sl-NumSubchannel</em></p>
<p>If TRIV indicates <em>N</em> &lt; <em>sl-MaxNumPerReserve</em>, the
starting sub-channel indexes corresponding to
<em>sl-MaxNumPerReserve</em> minus N last resources are not used.</p>
<p>The number of slots in one set of the time and frequency resources
for transmission opportunities of PSSCH is given by <span
class="math inline">\(C_{resel}\)</span> where <span
class="math inline">\(C_{resel}\)</span>=
10*SL_RESOURCE_RESELECTION_COUNTER [10, TS 38.321] if configured else
<span class="math inline">\(C_{resel}\)</span> is set to 1.</p>
<p>If a set of sub-channels in slot <span
class="math inline">\({t&#39;}_{m}^{SL}\)</span> is determined as the
time and frequency resource for PSSCH transmission corresponding to the
selected sidelink grant (described in [10, TS 38.321]), the same set of
sub-channels in slots <span class="math inline">\({t&#39;}_{m + j \times
P_{rsvp\_ TX}&#39;}^{SL}\)</span> are also determined for PSSCH
transmissions corresponding to the same sidelink grant where
<em>j=</em>1, 2,<em>…,</em> <span class="math inline">\(C_{resel} -
1\)</span>, <span class="math inline">\(P_{\text{rsvp\_TX}}\)</span>, if
provided, is converted from units of msec to units of logical slots,
resulting in <span
class="math inline">\(P_{\text{rsvp\_TX}}&#39;\)</span> according to
clause 8.1.7, and <span class="math inline">\(\left( {t&#39;}_{0}^{SL},\
{t&#39;}_{1}^{SL},\ {t&#39;}_{2}^{SL},\ldots \right)\)</span> is
determined by Clause 8. Here, <span
class="math inline">\(P_{\text{rsvp\_TX}}\)</span> is the resource
reservation interval indicated by higher layers.</p>
<h3
id="a-ue-procedure-for-determining-slots-and-resource-blocks-indicated-by-a-preferred-or-non-preferred-resource-set">8.1.5A
UE procedure for determining slots and resource blocks indicated by a
preferred or non-preferred resource set</h3>
<p>The set of slots and resource blocks indicated by a set of preferred
or non-preferred resource(s) is determined as described below.</p>
<p>The set of preferred or non-preferred resources <span
class="math inline">\(\left\{ r_{0},r_{1},r_{2},\ldots
\right\}\)</span>, is indicated by a reference slot <span
class="math inline">\(t_{ref}\)</span> and <span
class="math inline">\(M\)</span> tuples <span
class="math inline">\(({TRIV}_{m},{FRIV}_{m},P_{rsvp,m})\)</span>, <span
class="math inline">\(1 \leq m \leq M\)</span> indicated by the
'resource combination' field, where for each tuple <span
class="math inline">\({TRIV}_{m}\)</span> is indicated by the 9 MSBs,
followed by <span class="math inline">\({FRIV}_{m}\)</span> and <span
class="math inline">\(P_{rsvp,m}\)</span> (if present).</p>
<p>The reference slot <span class="math inline">\(t_{ref}\)</span> is
indicated by the 'Reference slot location' field as a combination of DFN
index and slot index [5, TS 38.212], with the 10 MSBs indicating the DFN
index. <span class="math inline">\({TRIV}_{m}\)</span> and <span
class="math inline">\({FRIV}_{m}\)</span> are interpreted according to
clause 8.1.5, with the following modifications:</p>
<p>- the value of <em>sl-MaxNumPerReserve</em> is fixed to 3.</p>
<p>- "slot where SCI format 1-A was received" is replaced by slot
indicated as the first resource location of a <span
class="math inline">\({TRIV}_{m}\)</span>.</p>
<p>- the first resource location of each <span
class="math inline">\({TRIV}_{m}\)</span> for <span
class="math inline">\(m &gt; 1\)</span> is indicated by a slot offset
<span class="math inline">\(t_{m}\)</span> in logical slots with respect
to the reference slot <span class="math inline">\(t_{ref}\)</span>; the
slot offset <span class="math inline">\(t_{m}\)</span> is indicated by
the 'first resource location' field; the first resource location of
<span class="math inline">\({TRIV}_{1}\)</span> is at slot offset 0 with
respect to the reference slot.</p>
<p>- "the received SCI format 1-A, except the resource in the slot where
SCI format 1-A was received" is replaced by "each tuple"</p>
<p>- the starting sub-channel <span
class="math inline">\(n_{subCH,0}^{start}\)</span> of the first resource
of each tuple is separately indicated.</p>
<p>The starting sub-channel <span
class="math inline">\(n_{subCH,0}^{start}\)</span> of the first resource
of each tuple is indicated by the 'Lowest subChannel indices' field. The
resource reservation period <span
class="math inline">\(P_{rsvp,m}\)</span> is encoded as in SCI format
1-A.</p>
<p>If the set is indicated by an SCI format 2-C, the number of tuples is
<span class="math inline">\(M = 2\)</span>.</p>
<p>A UE forms the union of the subsets indicated by each tuple <span
class="math inline">\(({TRIV}_{m},{FRIV}_{m},P_{rsvp,m})\)</span> to
obtain the set <span class="math inline">\(\left\{
r_{0},r_{1},r_{2},\ldots \right\}\)</span>.</p>
<h3
id="sidelink-congestion-control-in-sidelink-resource-allocation-mode-2">8.1.6
Sidelink congestion control in sidelink resource allocation mode 2</h3>
<p>If a UE is configured with higher layer parameter
<em>sl-CR-Limit</em> and transmits PSSCH in slot <em>n</em>, the UE
shall ensure the following limits for any priority value k;</p>
<p><span class="math inline">\(\sum_{i \geq k}^{}{CR(i)} \leq
CR_{Limit}(k)\)</span></p>
<p>where <span class="math inline">\(CR(i)\)</span> is the CR evaluated
in slot <em>n</em>-<em>N</em> for the PSSCH transmissions with
'<em>Priority</em>' field in the SCI set to <em>i</em>, and <span
class="math inline">\(CR_{Limit}(k)\)</span> corresponds to the high
layer parameter <em>sl-CR-Limit</em> that is associated with the
priority value <em>k</em> and the CBR range which includes the CBR
measured in slot <em>n</em>-<em>N</em>, where <em>N</em> is the
congestion control processing time.</p>
<p>The congestion control processing time <em>N</em> is based on µ of
Table 8.1.6-1 and Table 8.1.6-2 for UE processing capability 1 and 2
respectively, where µ corresponds to the subcarrier spacing of the
sidelink channel with which the PSSCH is to be transmitted. A UE shall
only apply a single processing time capability in sidelink congestion
control.</p>
<p>Table 8.1.6-1: Congestion control processing time for processing
timing capability 1</p>
<table>
<colgroup>
<col style="width: 8%" />
<col style="width: 91%" />
</colgroup>
<thead>
<tr>
<th style="text-align: center;"><strong>µ</strong></th>
<th style="text-align: center;">Congestion control processing time N
[slots]</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">0</td>
<td style="text-align: center;">2</td>
</tr>
<tr>
<td style="text-align: center;">1</td>
<td style="text-align: center;">2</td>
</tr>
<tr>
<td style="text-align: center;">2</td>
<td style="text-align: center;">4</td>
</tr>
<tr>
<td style="text-align: center;">3</td>
<td style="text-align: center;">8</td>
</tr>
</tbody>
</table>
<p>Table 8.1.6-2: Congestion control processing time for processing
timing capability 2</p>
<table>
<colgroup>
<col style="width: 8%" />
<col style="width: 91%" />
</colgroup>
<thead>
<tr>
<th style="text-align: center;"><strong>µ</strong></th>
<th style="text-align: center;">Congestion control processing time N
[slots]</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">0</td>
<td style="text-align: center;">2</td>
</tr>
<tr>
<td style="text-align: center;">1</td>
<td style="text-align: center;">4</td>
</tr>
<tr>
<td style="text-align: center;">2</td>
<td style="text-align: center;">8</td>
</tr>
<tr>
<td style="text-align: center;">3</td>
<td style="text-align: center;">16</td>
</tr>
</tbody>
</table>
<p>It is up to UE implementation how to meet the above limits, including
dropping the transmissions in slot <em>n</em>.</p>
<h3
id="ue-procedure-for-determining-the-number-of-logical-slots-for-a-reservation-period">8.1.7
UE procedure for determining the number of logical slots for a
reservation period </h3>
<p>A given resource reservation period <span
class="math inline">\(P_{\text{rsvp}}\)</span> in milliseconds is
converted to a period <span class="math inline">\(P_{rsvp}&#39;\)</span>
in logical slots as:</p>
<p><span class="math display">\[P_{rsvp}&#39; = \left\lceil
\frac{{T&#39;}_{\max}\ }{10240\ ms} \times P_{rsvp}
\right\rceil\]</span></p>
<p><img src="media/image802.png" />where <span
class="math inline">\({T&#39;}_{\max}\)</span> is the number of slots
that belong to a resource pool as defined in Clause 8.</p>
<h2 id="ue-procedure-for-transmitting-sidelink-reference-signals">8.2 UE
procedure for transmitting sidelink reference signals</h2>
<h3 id="csi-rs-transmission-procedure">8.2.1 CSI-RS transmission
procedure</h3>
<p>A UE transmits sidelink CSI-RS within a unicast PSSCH transmission if
the following conditions hold:</p>
<p>- CSI reporting is enabled by higher layer parameter
<em>sl-CSI-Acquisition</em>; and</p>
<p>- the '<em>CSI request</em>' field in the corresponding SCI format
2-A or 2-C is set to 1.</p>
<p>The following parameters for CSI-RS transmission are configured for
each CSI-RS configuration:</p>
<p>- <em>sl-CSI-RS-FirstSymbol</em> indicates the first OFDM symbol in a
PRB used for SL CSI-RS</p>
<p>- <em>sl-CSI-RS-FreqAllocation</em> indicates the number of antenna
ports and the frequency domain allocation for SL CSI-RS.</p>
<p>When the UE is configured with <em>Q<sub>p</sub></em>={1,2} CSI-RS
port(s) in sidelink and the number of scheduled layers is <span
class="math inline">\(n_{layer}^{PSSCH}\)</span>,</p>
<p>- The CSI-RS scaling factor <span
class="math inline">\(\beta_{CSIRS}\)</span> specified in clause
8.4.1.5.3 of [4, TS 38.211] is given by <span
class="math inline">\(\beta_{CSIRS} = \beta_{DMRS}^{PSSCH} \bullet
\sqrt{\frac{n_{layer}^{PSSCH}}{Q_{p}}}\ \)</span> where <span
class="math inline">\(\beta_{DMRS}^{PSSCH}\)</span> is the scaling
factor for the corresponding PSSCH specified in clause 8.3.1.5 of [4, TS
38.211].</p>
<h3 id="pssch-dm-rs-transmission-procedure">8.2.2 PSSCH DM-RS
transmission procedure</h3>
<p>The UE selects the DM-RS time domain pattern out of the patterns
configured using the higher layer parameter
<em>sl-PSSCH-DMRS-TimePatternList</em> for the resource pool on which
the PSSCH is to be transmitted. If more than one DM-RS time domain
pattern is configured, the selected pattern is indicated by the
'<em>DMRS pattern</em>' field in the SCI format 1-A associated with the
PSSCH transmission.</p>
<p>If PSSCH DM-RS and PSCCH are mapped to the same OFDM symbol, then
this mapping within a single sub-channel is only supported if higher
layer parameter <em>sl-SubchannelSize</em> &gt;= 20, i.e. the
sub-channel size is at least 20 PRBs.</p>
<p>When a sub-channel size is less than 20 PRBs and the size of PSCCH is
less than the sub-channel size, a UE is not expected to choose a PSSCH
DM-RS pattern to be transmitted in the same OFDM symbol with PSCCH.</p>
<h3 id="pt-rs-transmission-procedure">8.2.3 PT-RS transmission
procedure</h3>
<p>Transmission of PT-RS is only supported in frequency range 2.</p>
<p>The UE PT-RS transmission procedure specified in clause 6.2.3.1
applies for derivation of the PT-RS parameters
<em>L<sub>PT-RS</sub></em> and<em><sub>,</sub> K<sub>PT-RS
</sub></em>and for determination of PT-RS presence, with the following
changes:</p>
<p>- <em>timeDensity</em> and <em>frequencyDensity</em> in
<em>PTRS-UplinkConfig</em> are replaced by <em>sl-PTRS-TimeDensity</em>
and <em>sl-PTRS-FreqDensity</em> in <em>SL-PTRS-Config</em>
respectively, and <em>SL-PTRS-Config</em> is (pre)configured per
resource pool;</p>
<p>- the number of antenna ports is the same as the number of PSSCH
DM-RS antenna ports and the association between a PT-RS antenna port and
a PSSCH DM-RS antenna port is fixed.</p>
<h2
id="ue-procedure-for-receiving-the-physical-sidelink-shared-channel">8.3
UE procedure for receiving the physical sidelink shared channel</h2>
<p>For sidelink resource allocation mode 1, a UE upon detection of SCI
format 1-A on PSCCH can decode PSSCH according to the detected SCI
formats 2-A, 2-B and 2-C, and associated PSSCH resource configuration
configured by higher layers. The UE is not required to decode more than
one PSCCH at each PSCCH resource candidate.</p>
<p>For sidelink resource allocation mode 2, a UE upon detection of SCI
format 1-A on PSCCH can decode PSSCH according to the detected SCI
formats 2-A, 2-B and 2-C, and associated PSSCH resource configuration
configured by higher layers. The UE is not required to decode more than
one PSCCH at each PSCCH resource candidate.</p>
<p>A UE is required to decode neither the corresponding SCI formats 2-A,
2-B and 2-C nor the PSSCH associated with an SCI format 1-A if the SCI
format 1-A indicates an MCS table that the UE does not support.</p>
<h2 id="ue-procedure-for-receiving-reference-signals-1">8.4 UE procedure
for receiving reference signals</h2>
<h3 id="csi-rs-reception-procedure-1">8.4.1 CSI-RS reception
procedure</h3>
<p>The CSI-RS defined in Clause 8.4.1.5 of [4, TS 38.211] may be used
for CSI computation.</p>
<h3 id="dm-rs-reception-procedure-for-rsrp-computation">8.4.2 DM-RS
reception procedure for RSRP computation</h3>
<p>8.4.2.1 RSRP for resource selection in sidelink resource allocation
mode 2</p>
<p>In sidelink resource allocation mode 2, the UE measures RSRP for
resource selection as follows:</p>
<p>- PSSCH-RSRP over the DM-RS resource elements for the PSSCH according
to the received SCI format 1-A if higher layer parameter
<em>sl-RS-ForSensing</em> is set to 'pssch', and</p>
<p>- PSCCH-RSRP over the DM-RS resource elements for the PSCCH carrying
the received SCI format 1-A if higher layer parameter
<em>sl-RS-ForSensing</em> is set to 'pscch<em>'</em>.</p>
<h3 id="pt-rs-reception-procedure-1">8.4.3 PT-RS reception
procedure</h3>
<p>Reception of PT-RS is only supported in frequency range 2.</p>
<p>The UE PT-RS reception procedure specified in clause 5.1.6.3 applies
for derivation of the PT-RS parameters <em>L<sub>PT-RS</sub></em> and
<em>K<sub>PT-RS </sub></em>and for determination of PT-RS presence, with
the following changes:</p>
<p>- <em>timeDensity</em> and f<em>requencyDensity</em> in
<em>PTRS-DownlinkConfig</em> are replaced by
<em>sl-PTRS-TimeDensity</em> and <em>sl-PTRS-FreqDensity</em> in
<em>SL-PTRS-Config</em> respectively, and <em>SL-PTRS-Config</em> is
(pre)configured per resource pool;</p>
<p>- the number of antenna ports is the same as the number of PSSCH
DM-RS antenna ports and the association between a PT-RS antenna port and
a PSSCH DM-RS antenna port is fixed.</p>
<h2 id="ue-procedure-for-reporting-channel-state-information-csi-1">8.5
UE procedure for reporting channel state information (CSI)</h2>
<h3 id="channel-state-information-framework-1">8.5.1 Channel state
information framework</h3>
<p>CSI consists of Channel Quality Indicator (CQI) and Rank Indicator
(RI). The CQI and RI are always reported together.</p>
<h4 id="reporting-configurations-1">8.5.1.1 Reporting
configurations</h4>
<p>The UE shall calculate CSI parameters (if reported) assuming the
following dependencies between CSI parameters (if reported)</p>
<p>- CQI shall be calculated conditioned on the reported RI</p>
<p>The CSI reporting can be aperiodic (using [10, TS 38.321]). Table
8.5.1.1-1 shows the supported combinations of CSI reporting
configurations and CSI-RS configurations and how the CSI reporting is
triggered for CSI-RS configuration. Aperiodic CSI-RS is configured and
triggered/activated as described in Clause 8.5.1.2.</p>
<p>Table 8.5.1.1-1 Triggering/Activation of CSI reporting for the
possible CSI-RS Configurations.</p>
<table>
<colgroup>
<col style="width: 49%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr>
<th><strong>CSI-RS Configuration</strong></th>
<th><strong>Aperiodic CSI Reporting</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Aperiodic CSI-RS</td>
<td>Triggered by SCI.</td>
</tr>
</tbody>
</table>
<p>For CSI reporting, wideband CQI reporting is supported. A wideband
CQI is reported for a single codeword for the entire CSI reporting
band.</p>
<h4 id="triggering-of-sidelink-csi-reports">8.5.1.2 Triggering of
sidelink CSI reports</h4>
<p>The CSI-triggering UE is not allowed to trigger another aperiodic CSI
report for the same UE before the last slot of the expected reception or
completion of the ongoing aperiodic CSI report associated with the SCI
format 2-A or 2-C with the '<em>CSI request</em>' field set to 1, where
the last slot of the expected reception of the ongoing aperiodic CSI
report is given by [10, TS38.321].</p>
<p>An aperiodic CSI report is triggered by an SCI format 2-A or 2-C with
the '<em>CSI request</em>' field set to 1.</p>
<p>A UE is not expected to transmit a sidelink CSI-RS and a sidelink
PT-RS which overlap.</p>
<h3 id="channel-state-information-1">8.5.2 Channel state
information</h3>
<h4 id="csi-reporting-quantities">8.5.2.1 CSI reporting quantities</h4>
<h5 id="channel-quality-indicator-cqi-1">8.5.2.1.1 Channel quality
indicator (CQI)</h5>
<p>The UE shall derive CQI as specified in clause 5.2.2.1, with the
following changes</p>
<p>- PDSCH replaced by PSSCH</p>
<p>- uplink slot replaced by sidelink slot</p>
<p>- downlink physical resource blocks replaced by sidelink physical
resource blocks</p>
<p>- Transport Block Size determination according to Clause 8.1.3.2</p>
<p>- CSI reference resource according to the Clause 8.5.2.3</p>
<p>- interference measurements are not supported</p>
<p>- sub-band CQI is not supported</p>
<p>- cqi-Table is determined as follows</p>
<p>- cqi-Table = 'table1' if Table 5.1.3.1-1 is determined as the MCS
table according to Clause 8.1.3.1 of [6, 38.214],</p>
<p>- cqi-Table = 'table2' if Table 5.1.3.1-2 is determined as the MCS
table according to Clause 8.1.3.1 of [6, 38.214],</p>
<p>- cqi-Table = 'table3' if Table 5.1.3.1-3 is determined as the MCS
table according to Clause 8.1.3.1 of [6, 38.214]</p>
<h4 id="reference-signal-csi-rs-1">8.5.2.2 Reference signal
(CSI-RS)</h4>
<p>The UE can be configured with one CSI-RS pattern as indicated by the
higher layer parameters <em>sl-CSI-RS-FreqAllocation,
sl-CSI-RS-FirstSymbol</em> in <em>SL-CSI-RS-Config</em>.</p>
<p>Parameters for which the UE shall assume non-zero transmission power
for CSI-RS are configured according to clause 8.2.1.</p>
<p>A UE is not expected to be configured such that a CSI-RS and the
corresponding PSCCH can be mapped to the same resource element. A UE is
not expected to receive sidelink CSI-RS and PSSCH DM-RS, nor CSI-RS and
2nd-stage SCI, on the same symbol.</p>
<p>Sidelink CSI-RS shall be transmitted according to [4, TS 38.211] in
the resource blocks used for the PSSCH associated with the SCI format
2-A or 2-C triggering a report.</p>
<h4 id="csi-reference-resource-definition-1">8.5.2.3 CSI reference
resource definition</h4>
<p>The CSI reference resource in sidelink is defined as follows:</p>
<p>- In the frequency domain, the CSI reference resource is defined by
the group of sidelink physical resource blocks containing the sidelink
CSI-RS to which the derived CSI relates.</p>
<p>- In the time domain, the CSI reference resource for a CSI reporting
in sidelink slot <em>n</em> is defined by a single sidelink slot
<em>n<sub>CSI_ref</sub></em> where <em>n<sub>CSI_ref</sub></em> is the
same sidelink slot as the corresponding CSI request.</p>
<p>If configured to report CQI index and RI index, in the CSI reference
resource, the UE shall assume the following for the purpose of deriving
the CQI index and RI index:</p>
<p>- The reference resource uses the CP length and subcarrier spacing
configured for the SL BWP.</p>
<p>- Redundancy Version 0.</p>
<p>- PSCCH occupies 2 OFDM symbols.</p>
<p>- The number of PSSCH and DM-RS symbols is equal to
<em>sl-LengthSymbols</em>‒2.</p>
<p>- Assume no REs allocated for sidelink CSI-RS.</p>
<p>- Assume no REs allocated SCI format 2-A, SCI format 2-B or SCI
format 2-C.</p>
<p>- Assume the same number of DM-RS symbols as the smallest one
configured by the higher layer parameter
<em>sl-PSSCH-DMRS-TimePatternList.</em></p>
<p>- Assume no REs allocated for sidelink PT-RS.</p>
<p>- Assume sidelink CSI-RS RE power is the same as PSSCH RE power.</p>
<p>- The PSSCH transmission scheme where the UE may assume that PSSCH
transmission would be performed with up to 2 transmission layers as
defined in Clause 8.3.1.4 of [4, TS 38.211]. For CQI calculation, the UE
should assume that PSSCH signals on antenna ports in the set [1000,…,
1000+ν-1] for ν layers would result in signals equivalent to
corresponding symbols transmitted on antenna ports [3000,…,
3000+<em>P</em>-1], as given by</p>
<p><span class="math inline">\(\left\lbrack \begin{array}{r}
y^{(3000)}(i) \\
\cdots \\
y^{(3000 + P - 1)}(i)
\end{array} \right\rbrack = W(i)\left\lbrack \begin{array}{r}
x^{(0)}(i) \\
\cdots \\
x^{(\nu - 1)}(i)
\end{array} \right\rbrack\)</span></p>
<blockquote>
<p>where <img src="media/image671.svg" /> is a vector of PSSCH symbols
from the layer mapping defined in Clause 8.3.1.4 of [4, TS 38.211],
<span class="math inline">\(P \in \lbrack 1,2\rbrack\)</span> is the
number of CSI-RS ports. If only one CSI-RS port is configured,
<em>W(i)</em> is 1. Otherwise, <em>W(i)</em> is the identity
matrix<em>.</em></p>
</blockquote>
<h3 id="csi-reporting">8.5.3 CSI reporting</h3>
<p>The UE can be configured with one CSI reporting latency bound as
indicated by the higher layer parameter
<em>sl-LatencyBoundCSI-Report</em>. CSI reporting is aperiodic and is
described in [10, TS 38.321].</p>
<h2 id="ue-pssch-preparation-procedure-time">8.6 UE PSSCH preparation
procedure time</h2>
<p>For sidelink dynamic grant and for SL configured grant type 2
activation, if the first sidelink symbol in the sidelink allocation for
a PSSCH for a transport block and the associated PSCCH, including the
DM-RS and the duplicated symbol, as defined by the slot offset <span
class="math inline">\(K_{SL}\)</span> of the scheduling DCI for dynamic
grant or the activating DCI for SL configured grant type 2, is no
earlier than at symbol <em>L</em>, where <em>L</em> is defined as the
next sidelink symbol with its CP starting <span
class="math inline">\(T_{proc} = (N_{2} + d_{2,1})(2048 + 144) \cdot
\kappa 2^{- \mu} \cdot T_{C}\)</span> after the end of the reception of
the last symbol of the PDCCH carrying the DCI scheduling the sidelink
transmissions for dynamic grant or activating the SL configured grant
type 2, then the UE shall transmit the PSSCH and the associated
PSCCH.</p>
<p><em>- N<sub>2</sub></em> is based on <em>µ</em> of Table 8.6-1, where
<em>µ</em> corresponds to the one of (<em>µ<sub>DL</sub></em>,
<em>µ<sub>SL</sub></em>) resulting with the largest
<em>T<sub>proc</sub></em>, where the <em>µ<sub>DL</sub></em> corresponds
to the subcarrier spacing of the downlink with which the PDCCH carrying
the DCI scheduling the PSSCH for dynamic grant or activating the SL
configured grant type 2 was transmitted and <em>µ<sub>SL</sub></em>
corresponds to the subcarrier spacing of the sidelink channel with which
the PSSCH and the associated PSCCH are to be transmitted, and <em>κ</em>
is defined in Clause 4.1 of [4, TS 38.211].</p>
<p>- <em>d<sub>2,1 </sub></em>= 1.</p>
<p>Otherwise the UE may ignore the scheduling DCI for dynamic grant or
the activating DCI for SL configured grant type 2.</p>
<p>The value of <span class="math inline">\(T_{proc}\)</span> is used
both in the case of normal and extended cyclic prefix.</p>
<p>Table 8.6-1: PSSCH preparation time</p>
<table>
<colgroup>
<col style="width: 16%" />
<col style="width: 83%" />
</colgroup>
<thead>
<tr>
<th><img src="media/image800.svg" /></th>
<th>PSSCH preparation time <em>N<sub>2</sub></em> [symbols]</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>10</td>
</tr>
<tr>
<td>1</td>
<td>12</td>
</tr>
<tr>
<td>2</td>
<td>23</td>
</tr>
<tr>
<td>3</td>
<td>36</td>
</tr>
</tbody>
</table>
<p>For sidelink resource allocation mode 1, the UE does not expect that
the first sidelink symbol in the sidelink allocation for a PSSCH for
retransmission of a transport block and the associated PSCCH, including
the DM-RS and the duplicated symbol as defined by the "Time resource
assignment" field of the corresponding DCI for dynamic grant or for SL
configured grant type 2, or by <em>sl-TimeResourceCG-Type1</em> for
configured grant type 1 starts earlier than at symbol <span
class="math inline">\(L\)</span> where <span
class="math inline">\(L\)</span> is defined as the next sidelink symbol
with its CP starting <span class="math inline">\(T_{prep} +
\delta\)</span> after the end of the last symbol of the PSFCH occasion
corresponding to the most recent transmission of PSSCH for the same
transport block, where <span class="math inline">\(T_{prep}\)</span> is
defined in Clause 16.5 of [6, TS 38.213] and <span
class="math inline">\(\delta = {5 \bullet 10}^{- 4}\ s\)</span>.
Otherwise the UE may skip the retransmission of the PSSCH and the
transmission of the corresponding PSCCH.</p>
<h1
id="ue-procedures-for-transmitting-and-receiving-for-rtt-based-propagation-delay-compensation">9
UE procedures for transmitting and receiving for RTT-based propagation
delay compensation</h1>
<p>For operation with RTT-based propagation delay compensation, the UE
may be configured with either:</p>
<p>- one CSI-RS for tracking with higher layer parameter
<em>pdc-Info</em> for Rx – Tx time difference estimation at UE side and
one SRS resource set with <em>usage-PDC</em>, or</p>
<p>- one PRS configuration of higher layer parameter
<em>nr-DL-PRS-PDC-ResourceSet</em> [12, TS 38.331] for Rx – Tx time
difference estimation at UE side and one SRS resource set with
<em>usage-PDC</em>.</p>
<p>The related UE procedures for transmitting uplink reference signals
and receiving downlink reference signals for RTT-based propagation delay
compensation are defined as follows:</p>
<p>- for reception of CSI-RS for tracking with higher layer parameter
<em>pdc-Info</em>, the UE follows the procedures for reception of CSI-RS
for tracking defined in Clause 5.1.6.1.1.</p>
<p>- for reception of the one PRS configuration provided by RRC [12, TS
38.331] for RTT-based propagation delay compensation, the UE follows the
procedure for PRS reception for RTT-based propagation delay compensation
defined in Clause 9.1<em>.</em></p>
<p>- for transmission of an SRS resource set configured with
<em>usage-PDC</em>, the UE follows the procedures for SRS transmission
defined in Clause 6.2.1.</p>
<h2
id="prs-reception-procedure-for-rtt-based-propagation-delay-compensation">9.1
PRS reception procedure for RTT-based propagation delay
compensation</h2>
<p>The DL PRS resource set for RTT-based propagation delay compensation
consists of K≥1 DL PRS resource(s) where each has an associated spatial
transmission filter. Each DL PRS resource is configured via higher layer
parameters <em>NR-DL-PRS-Resource</em> and is uniquely defined by
<em>nr-DL-PRS-ResourceID</em>. The subcarrier spacing and the cyclic
prefix of the DL PRS resources are defined by the subcarrier spacing and
the cyclic prefix of the DL active bandwidth part of the serving
cell.</p>
<p>The DL PRS resource set for RTT-based propagation delay compensation
is configured by <em>nr-DL-PRS-PDC-ResourceSet</em>, consists of one or
more DL PRS resource(s) and it is defined by:</p>
<p><em>- periodicityAndOffset</em> defines the DL PRS resource
periodicity and takes values <span
class="math inline">\(T_{\text{per}}^{\text{PRS}} \in 2^{\mu}\left\{ 4,\
5,\ 8,\ 10,\ 16,\ 20,\ 32,\ 40,\ 64,\ 80,\ 160,\ 320,\ 640,\ 1280,\
2560,\ 5120,\ 10240 \right\}\ \)</span>slots, where <span
class="math inline">\(\mu = 0,\ 1,\ 2,\ 3\ \)</span>for 15, 30, 60 and
120 kHz subcarrier spacing respectively and the slot offset for DL PRS
resource set with respect to SFN0 slot 0. All the DL PRS resources are
configured with the same DL PRS resource periodicity.</p>
<p><em>- repetitionFactor</em> defines how many times each DL-PRS
resource is repeated for a single instance of the DL-PRS resource set
and takes values <span class="math inline">\(T_{\text{rep}}^{\text{PRS}}
\in \left\{ 1,2,4,6,8,16,32 \right\}\)</span>. All the DL PRS resources
within the resource set have the same resource repetition factor.</p>
<p><em>- timeGap</em> defines the offset in number of slots between two
repeated instances of a DL PRS resource with the same
<em>nr-DL-PRS-ResourceID</em> within a single instance of the DL PRS
resource set. The UE only expects to be configured with <em>timeGap</em>
if <em>repetitionFactor</em> is configured with value greater than 1.
The time duration spanned by one instance of a
<em>nr-DL-PRS-ResourceSet</em> is not expected to exceed the configured
value of DL PRS periodicity. All the DL PRS resources within the
resource set have the same value of <em>timeGap.</em></p>
<p><em>- resourceList</em> determines the DL PRS resources that are
contained within the DL PRS resource set.</p>
<p><em>- dl-PRS-ResourceBandwidth</em> defines the number of resource
blocks configured for DL PRS transmission. The parameter has a
granularity of 4 PRBs with a minimum of 24 PRBs and a maximum of 272
PRBs. All the DL PRS resources within the resource set have the same
value of <em>dl-PRS-ResourceBandwidth.</em></p>
<p><em>- dl-PRS-StartPRB</em> defines the starting PRB index of the DL
PRS resource with respect to subcarrier 0 in common resource block 0.
The starting PRB index has a granularity of one PRB with a minimum value
of 0 and a maximum value of 2176 PRBs. All the DL PRS resources within
the resource set have the same value of <em>dl-PRS-StartPRB.</em></p>
<p><em>- numSymbols</em> defines the number of symbols of the DL PRS
resource within a slot where the allowable values are given in Clause
7.4.1.7.3 of [4, TS38.211]. All the DL PRS resources within the resource
set have the same value of <em>numSymbols.</em></p>
<p>A DL PRS resource is defined by:</p>
<p><em>- nr-DL-PRS-ResourceID</em> determines the DL PRS resource
configuration identity. All DL PRS resource IDs are locally defined
within the DL PRS resource set.</p>
<p><em>- dl-PRS-SequenceID</em> is used to initialize c<sub>init</sub>
value used in pseudo random generator as described in Clause 7.4.1.7.2
of [4, TS 38.211] for generation of DL PRS sequence for a given DL PRS
resource.</p>
<p><em>- dl-PRS-CombSizeN-AndReOffset</em> defines the comb size of a DL
PRS resource, where the allowable values are given in Clause 7.4.1.7.3
of [TS38.211], and the starting RE offset of the first symbol within a
DL PRS resource in frequency. The UE may expect the same comb size to be
configured for all DL PRS resources of the PRS resource set. The
relative RE offsets of the remaining symbols within a DL PRS resource
are defined based on the initial offset and the rule described in Clause
7.4.1.7.3 of [4, TS 38.211].</p>
<p><em>- dl-PRS-ResourceSlotOffset</em> determines the starting slot of
the DL PRS resource with respect to corresponding DL PRS resource set
slot offset.</p>
<p><em>- dl-PRS-ResourceSymbolOffset</em> determines the starting symbol
of a slot configured with the DL PRS resource.</p>
<p><em>- dl-PRS-QCL-Info</em> defines any quasi co-location information
of the DL PRS resource with other reference signals. The DL PRS may be
configured with QCL 'typeD' with a DL PRS in the same PRS resource set,
or with <em>rs-Type</em> set to 'typeC', 'typeD', or 'typeC-plus-typeD'
with a SS/PBCH Block from the serving cell.</p>
<p>The UE assumes constant EPRE is used for all REs of a given DL PRS
resource.</p>
<p>The UE assumes that the DL PRS from the serving cell is not mapped to
any symbol that contains SS/PBCH block from the serving cell.</p>
<p>The UE does not expect to be scheduled or configured for reception of
any downlink channel or any other downlink signal(s) in the OFDM
symbol(s) and PRBs of the DL PRS resource for RTT-based propagation
delay compensation to be received.</p>
<p>The UE is expected to receive the DL PRS for RTT-based propagation
delay compensation only in RRC_CONNECTED state and within the DL active
bandwidth part of the serving cell.</p>
<p class="heading" id="annex-a-informative-change-history">Annex
&lt;A&gt; (informative):<br />
Change history</p>
<table>
<colgroup>
<col style="width: 8%" />
<col style="width: 8%" />
<col style="width: 10%" />
<col style="width: 5%" />
<col style="width: 4%" />
<col style="width: 4%" />
<col style="width: 51%" />
<col style="width: 7%" />
</colgroup>
<tbody>
<tr>
<td colspan="8">Change history</td>
</tr>
<tr>
<td style="text-align: center;"><strong>Date</strong></td>
<td style="text-align: center;"><strong>Meeting</strong></td>
<td style="text-align: center;"><strong>TDoc</strong></td>
<td style="text-align: center;"><strong>CR</strong></td>
<td style="text-align: center;"><strong>Rev</strong></td>
<td style="text-align: center;"><strong>Cat</strong></td>
<td style="text-align: center;"><strong>Subject/Comment</strong></td>
<td style="text-align: center;"><strong>New version</strong></td>
</tr>
<tr>
<td>2017-05</td>
<td>RAN1#89</td>
<td>R1-1708892</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">-</td>
<td>-</td>
<td>Draft skeleton</td>
<td>0.0.0</td>
</tr>
<tr>
<td>2017-07</td>
<td>AH_1706</td>
<td>R1-1712016</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td></td>
<td>Inclusion of agreements up to and including RAN1#AH2</td>
<td>0.0.1</td>
</tr>
<tr>
<td>2017-08</td>
<td>AH_1706</td>
<td>R1-1714234</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td></td>
<td>Inclusion of agreements up to and including RAN1#AH2</td>
<td>0.0.2</td>
</tr>
<tr>
<td>2017-08</td>
<td>RAN1#90</td>
<td>R1-1714596</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td></td>
<td>Updated editor's version</td>
<td>0.0.3</td>
</tr>
<tr>
<td>2017-08</td>
<td>RAN1#90</td>
<td>R1-1714626</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td></td>
<td>Updated editor's version</td>
<td>0.0.4</td>
</tr>
<tr>
<td>2017-08</td>
<td>RAN1#90</td>
<td>R1-1715077</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td></td>
<td>Endorsed version by RAN1#90</td>
<td>0.1.0</td>
</tr>
<tr>
<td>2017-08</td>
<td>RAN1#90</td>
<td>R1-1715324</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td></td>
<td>Inclusion of agreements up to and including RAN1#90</td>
<td>0.1.1</td>
</tr>
<tr>
<td>2017-08</td>
<td>RAN1#90</td>
<td>R1-1715331</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td></td>
<td>Updated editor's version</td>
<td>0.1.2</td>
</tr>
<tr>
<td>2017-09</td>
<td>RAN#77</td>
<td>RP-172001</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td></td>
<td>For information to plenary</td>
<td>1.0.0</td>
</tr>
<tr>
<td>2017-09</td>
<td>AH_1709</td>
<td>R1-1716930</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td></td>
<td>Inclusion of agreements up to and including RAN1#AH3</td>
<td>1.0.1</td>
</tr>
<tr>
<td>2017-10</td>
<td>RAN1#90bis</td>
<td>R1-1718808</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td></td>
<td>Updated editor's version</td>
<td>1.0.2</td>
</tr>
<tr>
<td>2017-10</td>
<td>RAN1#90bis</td>
<td>R1-1718819</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td></td>
<td>Endorsed version by RAN1#90bis</td>
<td>1.1.0</td>
</tr>
<tr>
<td>2017-10</td>
<td>RAN1#90bis</td>
<td>R1-1719227</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td></td>
<td>Inclusion of agreements up to and including RAN1#90bis</td>
<td>1.1.1</td>
</tr>
<tr>
<td>2017-11</td>
<td>RAN1#90bis</td>
<td>R1-1720113</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td></td>
<td>Inclusion of agreements up to and including RAN1#90bis</td>
<td>1.1.2</td>
</tr>
<tr>
<td>2017-11</td>
<td>RAN1#90bis</td>
<td>R1-1720114</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td></td>
<td>Inclusion of agreements up to and including RAN1#90bis</td>
<td>1.1.3</td>
</tr>
<tr>
<td>2017-11</td>
<td>RAN1#90bis</td>
<td>R1-1721051</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td></td>
<td>Endorsed version</td>
<td>1.2.0</td>
</tr>
<tr>
<td>2017-12</td>
<td>RAN1#91</td>
<td>R1-1721344</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td></td>
<td>Inclusion of agreements up to and including RAN1#91</td>
<td>1.3.0</td>
</tr>
<tr>
<td>2017-12</td>
<td>RAN#78</td>
<td>RP-172416</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td></td>
<td>Endorsed version for approval by plenary</td>
<td>2.0.0</td>
</tr>
<tr>
<td>2017-12</td>
<td>RAN#78</td>
<td></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td></td>
<td>Approved by plenary – Rel-15 spec under change control</td>
<td>15.0.0</td>
</tr>
<tr>
<td>2018-03</td>
<td>RAN#79</td>
<td>RP-180200</td>
<td style="text-align: center;">0001</td>
<td style="text-align: center;"></td>
<td>F</td>
<td>CR capturing the Jan18 ad-hoc and RAN1#92 meeting agreements</td>
<td>15.1.0</td>
</tr>
<tr>
<td>2018-06</td>
<td>RAN#80</td>
<td>RP-181172</td>
<td style="text-align: center;">0002</td>
<td style="text-align: center;">1</td>
<td>F</td>
<td>CR to 38.214 capturing the RAN1#92bis and RAN1#93 meeting
agreements</td>
<td>15.2.0</td>
</tr>
<tr>
<td>2018-06</td>
<td>RAN#80</td>
<td>RP-181257</td>
<td style="text-align: center;">0003</td>
<td style="text-align: center;">-</td>
<td>B</td>
<td>CR to 38.214 capturing the RAN1#92bis and RAN1#93 meeting agreements
related to URLLC</td>
<td>15.2.0</td>
</tr>
<tr>
<td>2018-06</td>
<td>RAN#80</td>
<td>RP-181172</td>
<td style="text-align: center;">0004</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>CR to 38.214: maintenance according to agreed Rel 15 features</td>
<td>15.2.0</td>
</tr>
<tr>
<td>2018-09</td>
<td>RAN#81</td>
<td>RP-181789</td>
<td style="text-align: center;">0005</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>CR to 38.214 capturing the RAN1#94 meeting agreements</td>
<td>15.3.0</td>
</tr>
<tr>
<td>2018-12</td>
<td>RAN#82</td>
<td>RP-182523</td>
<td style="text-align: center;">0006</td>
<td style="text-align: center;">2</td>
<td>F</td>
<td>Combined CR of all essential corrections to 38.214 from RAN1#94bis
and RAN1#95</td>
<td>15.4.0</td>
</tr>
<tr>
<td>2019-03</td>
<td>RAN#83</td>
<td>RP-190632</td>
<td style="text-align: center;">0007</td>
<td style="text-align: center;">3</td>
<td>F</td>
<td>Correction to aperiodic CSI-RS triggering with different numerology
between PDCCH and CSI-RS</td>
<td>15.5.0</td>
</tr>
<tr>
<td>2019-03</td>
<td>RAN#83</td>
<td>RP-190450</td>
<td style="text-align: center;">0009</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on CSI-RS configuration in 38.214</td>
<td>15.5.0</td>
</tr>
<tr>
<td>2019-03</td>
<td>RAN#83</td>
<td>RP-190450</td>
<td style="text-align: center;">0010</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on uplink resource allocation type 1</td>
<td>15.5.0</td>
</tr>
<tr>
<td>2019-03</td>
<td>RAN#83</td>
<td>RP-190450</td>
<td style="text-align: center;">0011</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on determination of the resource allocation table for
PUSCH with SP CSI</td>
<td>15.5.0</td>
</tr>
<tr>
<td>2019-03</td>
<td>RAN#83</td>
<td>RP-190450</td>
<td style="text-align: center;">0012</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on PUSCH resource allocation</td>
<td>15.5.0</td>
</tr>
<tr>
<td>2019-03</td>
<td>RAN#83</td>
<td>RP-190450</td>
<td style="text-align: center;">0013</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Change Request for alignment of frequency domain resource allocation
with 38.213 for a PUSCH transmission scheduled by a RAR UL grant</td>
<td>15.5.0</td>
</tr>
<tr>
<td>2019-03</td>
<td>RAN#83</td>
<td>RP-190450</td>
<td style="text-align: center;">0014</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>CR on sequential PDSCH and PUSCH scheduling</td>
<td>15.5.0</td>
</tr>
<tr>
<td>2019-03</td>
<td>RAN#83</td>
<td>RP-190450</td>
<td style="text-align: center;">0015</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>CR on out of HARQ order with multiple PDSCHs within one slot</td>
<td>15.5.0</td>
</tr>
<tr>
<td>2019-03</td>
<td>RAN#83</td>
<td>RP-190450</td>
<td style="text-align: center;">0016</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction to LBRM restriction</td>
<td>15.5.0</td>
</tr>
<tr>
<td>2019-03</td>
<td>RAN#83</td>
<td>RP-190450</td>
<td style="text-align: center;">0017</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>CR on PDSCH beam indication</td>
<td>15.5.0</td>
</tr>
<tr>
<td>2019-03</td>
<td>RAN#83</td>
<td>RP-190450</td>
<td style="text-align: center;">0018</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on TCI indication for multi-slot PDSCH</td>
<td>15.5.0</td>
</tr>
<tr>
<td>2019-03</td>
<td>RAN#83</td>
<td>RP-190450</td>
<td style="text-align: center;">0019</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Clarifications on CSI reporting on PUSCH</td>
<td>15.5.0</td>
</tr>
<tr>
<td>2019-03</td>
<td>RAN#83</td>
<td>RP-190450</td>
<td style="text-align: center;">0020</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>QCL properties of Msg4 in CONNECTED Mode</td>
<td>15.5.0</td>
</tr>
<tr>
<td>2019-03</td>
<td>RAN#83</td>
<td>RP-190450</td>
<td style="text-align: center;">0022</td>
<td style="text-align: center;">1</td>
<td>F</td>
<td>CR on dynamic grant overriding configured grant</td>
<td>15.5.0</td>
</tr>
<tr>
<td>2019-03</td>
<td>RAN#83</td>
<td>RP-190450</td>
<td style="text-align: center;">0023</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on PUSCH with configured grant</td>
<td>15.5.0</td>
</tr>
<tr>
<td>2019-03</td>
<td>RAN#83</td>
<td>RP-190450</td>
<td style="text-align: center;">0024</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Corrections to 38.214</td>
<td>15.5.0</td>
</tr>
<tr>
<td>2019-03</td>
<td>RAN#83</td>
<td>RP-190425</td>
<td style="text-align: center;">0025</td>
<td style="text-align: center;">1</td>
<td>F</td>
<td>CR on QCL assumption for receiving PDSCH for RAR</td>
<td>15.5.0</td>
</tr>
<tr>
<td>2019-06</td>
<td>RAN#84</td>
<td>RP-191552</td>
<td style="text-align: center;">0035</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Removal of "Correction to aperiodic CSI-RS triggering with different
numerology between PDCCH and CSI-RS"</td>
<td>15.6.0</td>
</tr>
<tr>
<td>2019-06</td>
<td>RAN#84</td>
<td>RP-191284</td>
<td style="text-align: center;">0026</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Corrections on non-codebook based UL transmission to TS 38.214</td>
<td>15.6.0</td>
</tr>
<tr>
<td>2019-06</td>
<td>RAN#84</td>
<td>RP-191284</td>
<td style="text-align: center;">0027</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>CR on UE procedure for PDSCH and PUSCH</td>
<td>15.6.0</td>
</tr>
<tr>
<td>2019-06</td>
<td>RAN#84</td>
<td>RP-191284</td>
<td style="text-align: center;">0028</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on configured scheduling PUSCH repetition with dynamic
SFI</td>
<td>15.6.0</td>
</tr>
<tr>
<td>2019-06</td>
<td>RAN#84</td>
<td>RP-191284</td>
<td style="text-align: center;">0029</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>CR on rate matching for PDSCH scheduled by DCI format 1_0</td>
<td>15.6.0</td>
</tr>
<tr>
<td>2019-06</td>
<td>RAN#84</td>
<td>RP-191284</td>
<td style="text-align: center;">0030</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Clarification on CG transmission opportunities</td>
<td>15.6.0</td>
</tr>
<tr>
<td>2019-06</td>
<td>RAN#84</td>
<td>RP-191284</td>
<td style="text-align: center;">0031</td>
<td style="text-align: center;">5</td>
<td>F</td>
<td>Corrections to 38.214 including alignment of terminology across
specifications</td>
<td>15.6.0</td>
</tr>
<tr>
<td>2019-06</td>
<td>RAN#84</td>
<td>RP-191284</td>
<td style="text-align: center;">0032</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>CR to 38.214 clarifying calculation of DataRate and DataRateCC</td>
<td>15.6.0</td>
</tr>
<tr>
<td>2019-06</td>
<td>RAN#84</td>
<td>RP-191284</td>
<td style="text-align: center;">0033</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on PUSCH retransmission for a serving cell configured
with two uplinks</td>
<td>15.6.0</td>
</tr>
<tr>
<td>2019-06</td>
<td>RAN#84</td>
<td>RP-191284</td>
<td style="text-align: center;">0034</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Corrections to 38.214 regarding the MAC CE activation/deactivation
timing in mixed numerology scenario</td>
<td>15.6.0</td>
</tr>
<tr>
<td>2019-09</td>
<td>RAN#85</td>
<td>RP-191943</td>
<td style="text-align: center;">0037</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on UE receiving PDSCH procedure in FR2</td>
<td>15.7.0</td>
</tr>
<tr>
<td>2019-09</td>
<td>RAN#85</td>
<td>RP-191943</td>
<td style="text-align: center;">0038</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on slot aggregation</td>
<td>15.7.0</td>
</tr>
<tr>
<td>2019-09</td>
<td>RAN#85</td>
<td>RP-191943</td>
<td style="text-align: center;">0039</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>CR on grant-based PDSCH overlapping with SPS PDSCH</td>
<td>15.7.0</td>
</tr>
<tr>
<td>2019-09</td>
<td>RAN#85</td>
<td>RP-191943</td>
<td style="text-align: center;">0040</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on the resource mapping of PDSCH in TS 38.214</td>
<td>15.7.0</td>
</tr>
<tr>
<td>2019-09</td>
<td>RAN#85</td>
<td>RP-191943</td>
<td style="text-align: center;">0041</td>
<td style="text-align: center;">1</td>
<td>F</td>
<td>Corrections to 38.214 including alignment of terminology across
specifications in RAN1#98</td>
<td>15.7.0</td>
</tr>
<tr>
<td>2019-09</td>
<td>RAN#85</td>
<td>RP-191943</td>
<td style="text-align: center;">0042</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Clarification of PUSCH with SP-CSI overlapping with PUSCH with
data</td>
<td>15.7.0</td>
</tr>
<tr>
<td>2019-12</td>
<td>RAN#86</td>
<td>RP-192627</td>
<td style="text-align: center;">0045</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on resource allocation for uplink transmission with
configured grant Type 1</td>
<td>15.8.0</td>
</tr>
<tr>
<td>2019-12</td>
<td>RAN#86</td>
<td>RP-192627</td>
<td style="text-align: center;">0046</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Clarification to the dynamically scheduled PDSCH collision with
SPS-PDSCH</td>
<td>15.8.0</td>
</tr>
<tr>
<td>2019-12</td>
<td>RAN#86</td>
<td>RP-192627</td>
<td style="text-align: center;">0047</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on rate-matching for LTE-CRS-toMatchAround</td>
<td>15.8.0</td>
</tr>
<tr>
<td>2019-12</td>
<td>RAN#86</td>
<td>RP-192627</td>
<td style="text-align: center;">0048</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on timing for MAC CE applicability in 38.214</td>
<td>15.8.0</td>
</tr>
<tr>
<td>2019-12</td>
<td>RAN#86</td>
<td>RP-192627</td>
<td style="text-align: center;">0049</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Corrections to 38.214 including alignment of terminology across
specifications in RAN1#98bis and RAN1#99</td>
<td>15.8.0</td>
</tr>
<tr>
<td>2019-12</td>
<td>RAN#86</td>
<td>RP-192634</td>
<td style="text-align: center;">0043</td>
<td style="text-align: center;">1</td>
<td>B</td>
<td>Introduction of UE behaviour for SRS measurements for CLI</td>
<td>16.0.0</td>
</tr>
<tr>
<td>2019-12</td>
<td>RAN#86</td>
<td>RP-192635</td>
<td style="text-align: center;">0050</td>
<td style="text-align: center;">-</td>
<td>B</td>
<td>Introduction of two-step RACH</td>
<td>16.0.0</td>
</tr>
<tr>
<td>2019-12</td>
<td>RAN#86</td>
<td>RP-192636</td>
<td style="text-align: center;">0051</td>
<td style="text-align: center;">-</td>
<td>B</td>
<td>Introduction of NR - U</td>
<td>16.0.0</td>
</tr>
<tr>
<td>2019-12</td>
<td>RAN#86</td>
<td>RP-192637</td>
<td style="text-align: center;">0052</td>
<td style="text-align: center;">-</td>
<td>B</td>
<td>Introduction of integrated access and backhaul for NR</td>
<td>16.0.0</td>
</tr>
<tr>
<td>2019-12</td>
<td>RAN#86</td>
<td>RP-192638</td>
<td style="text-align: center;">0053</td>
<td style="text-align: center;">-</td>
<td>B</td>
<td>Introduction of NR V2X</td>
<td>16.0.0</td>
</tr>
<tr>
<td>2019-12</td>
<td>RAN#86</td>
<td>RP-192639</td>
<td style="text-align: center;">0054</td>
<td style="text-align: center;">-</td>
<td>B</td>
<td>Introduction of NR URLLC support</td>
<td>16.0.0</td>
</tr>
<tr>
<td>2019-12</td>
<td>RAN#86</td>
<td>RP-192641</td>
<td style="text-align: center;">0055</td>
<td style="text-align: center;">-</td>
<td>B</td>
<td>Introduction of NR enhanced MIMO</td>
<td>16.0.0</td>
</tr>
<tr>
<td>2019-12</td>
<td>RAN#86</td>
<td>RP-192642</td>
<td style="text-align: center;">0056</td>
<td style="text-align: center;">-</td>
<td>B</td>
<td>Introduction of cross-slot scheduling restriction</td>
<td>16.0.0</td>
</tr>
<tr>
<td>2019-12</td>
<td>RAN#86</td>
<td>RP-192643</td>
<td style="text-align: center;">0057</td>
<td style="text-align: center;">-</td>
<td>B</td>
<td>Introduction of NR positioning support</td>
<td>16.0.0</td>
</tr>
<tr>
<td>2019-12</td>
<td>RAN#86</td>
<td>RP-192645</td>
<td style="text-align: center;">0058</td>
<td style="text-align: center;">-</td>
<td>B</td>
<td>Introduction of Cross-carrier Scheduling with Different
Numerologies</td>
<td>16.0.0</td>
</tr>
<tr>
<td>2019-12</td>
<td>RAN#86</td>
<td>RP-192646</td>
<td style="text-align: center;">0059</td>
<td style="text-align: center;">-</td>
<td>B</td>
<td>Introduction of multiple LTE CRS rate matching patterns</td>
<td>16.0.0</td>
</tr>
<tr>
<td>2019-12</td>
<td>RAN#86</td>
<td>RP-192646</td>
<td style="text-align: center;">0060</td>
<td style="text-align: center;">-</td>
<td>B</td>
<td>Aperiodic CSI-RS Triggering for UE reporting beamSwitchTiming values
of 224 and 336</td>
<td>16.0.0</td>
</tr>
<tr>
<td>2019-12</td>
<td>RAN#86</td>
<td>RP-192646</td>
<td style="text-align: center;">0061</td>
<td style="text-align: center;">-</td>
<td>B</td>
<td>Behaviour for triggered with a CSI report for non-active BWP</td>
<td>16.0.0</td>
</tr>
<tr>
<td>2019-12</td>
<td>RAN#86</td>
<td>RP-192646</td>
<td style="text-align: center;">0062</td>
<td style="text-align: center;">-</td>
<td>B</td>
<td>Introduction of downgraded configurations for SRS antenna
switching</td>
<td>16.0.0</td>
</tr>
<tr>
<td>2019-12</td>
<td>RAN#86</td>
<td>RP-192646</td>
<td style="text-align: center;">0063</td>
<td style="text-align: center;">-</td>
<td>B</td>
<td>Introduction of one-slot periodic TRS configuration for FR1 under a
certain condition</td>
<td>16.0.0</td>
</tr>
<tr>
<td>2019-12</td>
<td>RAN#86</td>
<td>RP-192640</td>
<td style="text-align: center;">0064</td>
<td style="text-align: center;">-</td>
<td>B</td>
<td>Introduction of Industrial IoT</td>
<td>16.0.0</td>
</tr>
<tr>
<td>2020-03</td>
<td>RAN#87-e</td>
<td>RP-200185</td>
<td style="text-align: center;">0068</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Corrections on NR - U</td>
<td>16.1.0</td>
</tr>
<tr>
<td>2020-03</td>
<td>RAN#87-e</td>
<td>RP-200187</td>
<td style="text-align: center;">0069</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Corrections on NR V2X</td>
<td>16.1.0</td>
</tr>
<tr>
<td>2020-03</td>
<td>RAN#87-e</td>
<td>RP-200483</td>
<td style="text-align: center;">0070</td>
<td style="text-align: center;">1</td>
<td>F</td>
<td>Corrections on Cross-carrier Scheduling with Different
Numerologies</td>
<td>16.1.0</td>
</tr>
<tr>
<td>2020-03</td>
<td>RAN#87-e</td>
<td>RP-200188</td>
<td style="text-align: center;">0071</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Corrections on NR URLLC support</td>
<td>16.1.0</td>
</tr>
<tr>
<td>2020-03</td>
<td>RAN#87-e</td>
<td>RP-200190</td>
<td style="text-align: center;">0072</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Corrections on NR enhanced MIMO</td>
<td>16.1.0</td>
</tr>
<tr>
<td>2020-03</td>
<td>RAN#87-e</td>
<td>RP-200189</td>
<td style="text-align: center;">0073</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Corrections on Industrial IoT</td>
<td>16.1.0</td>
</tr>
<tr>
<td>2020-03</td>
<td>RAN#87-e</td>
<td>RP-200191</td>
<td style="text-align: center;">0074</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Corrections of cross-slot scheduling restriction and CSI/L1-RSRP
measurement outside active time</td>
<td>16.1.0</td>
</tr>
<tr>
<td>2020-03</td>
<td>RAN#87-e</td>
<td>RP-200184</td>
<td style="text-align: center;">0075</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Corrections on two-step RACH after RAN1#100-e</td>
<td>16.1.0</td>
</tr>
<tr>
<td>2020-03</td>
<td>RAN#87-e</td>
<td>RP-200192</td>
<td style="text-align: center;">0076</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Corrections of NR positioning support</td>
<td>16.1.0</td>
</tr>
<tr>
<td>2020-03</td>
<td>RAN#87-e</td>
<td>RP-200448</td>
<td style="text-align: center;">0078</td>
<td style="text-align: center;">-</td>
<td>A</td>
<td>CR on UL PTRS density selection</td>
<td>16.1.0</td>
</tr>
<tr>
<td>2020-06</td>
<td>RAN#88-e</td>
<td>RP-200683</td>
<td style="text-align: center;">0080</td>
<td style="text-align: center;">-</td>
<td>A</td>
<td>CR on CSI reporting for BWP size &lt; 24 PRBs</td>
<td>16.2.0</td>
</tr>
<tr>
<td>2020-06</td>
<td>RAN#88-e</td>
<td>RP-200683</td>
<td style="text-align: center;">0082</td>
<td style="text-align: center;">-</td>
<td>A</td>
<td>CR on 38.214 PDSCH resource mapping</td>
<td>16.2.0</td>
</tr>
<tr>
<td>2020-06</td>
<td>RAN#88-e</td>
<td>RP-200683</td>
<td style="text-align: center;">0084</td>
<td style="text-align: center;">-</td>
<td>A</td>
<td>CR to 38.214 clarification on resource and port occupation of
duplicate CSI-RS resources</td>
<td>16.2.0</td>
</tr>
<tr>
<td>2020-06</td>
<td>RAN#88-e</td>
<td>RP-200693</td>
<td style="text-align: center;">0085</td>
<td style="text-align: center;">1</td>
<td>F</td>
<td>Corrections of cross-slot scheduling restriction</td>
<td>16.2.0</td>
</tr>
<tr>
<td>2020-06</td>
<td>RAN#88-e</td>
<td>RP-200686</td>
<td style="text-align: center;">0086</td>
<td style="text-align: center;">1</td>
<td>F</td>
<td>Correction of two-step RACH</td>
<td>16.2.0</td>
</tr>
<tr>
<td>2020-06</td>
<td>RAN#88-e</td>
<td>RP-200690</td>
<td style="text-align: center;">0087</td>
<td style="text-align: center;">1</td>
<td>F</td>
<td>Corrections on NR URLLC support</td>
<td>16.2.0</td>
</tr>
<tr>
<td>2020-06</td>
<td>RAN#88-e</td>
<td>RP-200691</td>
<td style="text-align: center;">0088</td>
<td style="text-align: center;">1</td>
<td>F</td>
<td>Corrections on Industrial IoT</td>
<td>16.2.0</td>
</tr>
<tr>
<td>2020-06</td>
<td>RAN#88-e</td>
<td>RP-200694</td>
<td style="text-align: center;">0089</td>
<td style="text-align: center;">1</td>
<td>F</td>
<td>Corrections of NR positioning support</td>
<td>16.2.0</td>
</tr>
<tr>
<td>2020-06</td>
<td>RAN#88-e</td>
<td>RP-200687</td>
<td style="text-align: center;">0090</td>
<td style="text-align: center;">1</td>
<td>F</td>
<td>Corrections on NR - U</td>
<td>16.2.0</td>
</tr>
<tr>
<td>2020-06</td>
<td>RAN#88-e</td>
<td>RP-200689</td>
<td style="text-align: center;">0091</td>
<td style="text-align: center;">1</td>
<td>F</td>
<td>Corrections on NR V2X</td>
<td>16.2.0</td>
</tr>
<tr>
<td>2020-06</td>
<td>RAN#88-e</td>
<td>RP-200696</td>
<td style="text-align: center;">0092</td>
<td style="text-align: center;">1</td>
<td>F</td>
<td>Corrections on Cross-carrier Scheduling with Different
Numerologies</td>
<td>16.2.0</td>
</tr>
<tr>
<td>2020-06</td>
<td>RAN#88-e</td>
<td>RP-200692</td>
<td style="text-align: center;">0093</td>
<td style="text-align: center;">1</td>
<td>F</td>
<td>Corrections on NR enhanced MIMO</td>
<td>16.2.0</td>
</tr>
<tr>
<td>2020-06</td>
<td>RAN#88-e</td>
<td>RP-200685</td>
<td style="text-align: center;">0094</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on SRS-RSRP reception procedure for CLI</td>
<td>16.2.0</td>
</tr>
<tr>
<td>2020-06</td>
<td>RAN#88-e</td>
<td>RP-200683</td>
<td style="text-align: center;">0097</td>
<td style="text-align: center;">-</td>
<td>A</td>
<td>CR on SRS for 38.214</td>
<td>16.2.0</td>
</tr>
<tr>
<td>2020-06</td>
<td>RAN#88-e</td>
<td>RP-200683</td>
<td style="text-align: center;">0099</td>
<td style="text-align: center;">-</td>
<td>A</td>
<td>CR on 38.214 rate-matching for PDSCH with SPS</td>
<td>16.2.0</td>
</tr>
<tr>
<td>2020-06</td>
<td>RAN#88-e</td>
<td>RP-200683</td>
<td style="text-align: center;">0101</td>
<td style="text-align: center;">-</td>
<td>A</td>
<td>Correction for SP-CSI reporting on PUSCH</td>
<td>16.2.0</td>
</tr>
<tr>
<td>2020-06</td>
<td>RAN#88-e</td>
<td>RP-200683</td>
<td style="text-align: center;">0103</td>
<td style="text-align: center;">-</td>
<td>A</td>
<td>CR on port and CSI-RS resource counting</td>
<td>16.2.0</td>
</tr>
<tr>
<td>2020-06</td>
<td>RAN#88-e</td>
<td>RP-200705</td>
<td style="text-align: center;">0106</td>
<td style="text-align: center;">-</td>
<td>B</td>
<td>Introduction of switched uplink operation</td>
<td>16.2.0</td>
</tr>
<tr>
<td>2020-06</td>
<td>RAN#88-e</td>
<td>RP-200697</td>
<td style="text-align: center;">0107</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on aperiodic CSI-RS triggering with beam switching timing
of 224 and 336 and on CSI reporting</td>
<td>16.2.0</td>
</tr>
<tr>
<td>2020-06</td>
<td>RAN#88-e</td>
<td>RP-200697</td>
<td style="text-align: center;">0108</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction to TBS determination when 3824&lt;Ninfo&lt;3825</td>
<td>16.2.0</td>
</tr>
<tr>
<td>2020-06</td>
<td>RAN#88-e</td>
<td>RP-200697</td>
<td style="text-align: center;">0109</td>
<td style="text-align: center;">-</td>
<td>D</td>
<td>Editorial corrections</td>
<td>16.2.0</td>
</tr>
<tr>
<td>2020-09</td>
<td>RAN#89-e</td>
<td>RP-201803</td>
<td style="text-align: center;">0111</td>
<td style="text-align: center;">-</td>
<td>A</td>
<td>CR on Measurement Restriction for L1-RSRP</td>
<td>16.3.0</td>
</tr>
<tr>
<td>2020-09</td>
<td>RAN#89-e</td>
<td>RP-201803</td>
<td style="text-align: center;">0113</td>
<td style="text-align: center;">-</td>
<td>A</td>
<td>Correction on sounding procedure between component carriers</td>
<td>16.3.0</td>
</tr>
<tr>
<td>2020-09</td>
<td>RAN#89-e</td>
<td>RP-201803</td>
<td style="text-align: center;">0115</td>
<td style="text-align: center;">-</td>
<td>A</td>
<td>Clarification on which UE capability component indicates the number
of supported simultaneous CSI calculations <span
class="math inline">\(N_{CPU}\)</span></td>
<td>16.3.0</td>
</tr>
<tr>
<td>2020-09</td>
<td>RAN#89-e</td>
<td>RP-201814</td>
<td style="text-align: center;">0116</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Corrections to PDSCH PRB bundling notation (Rel-15 origin)</td>
<td>16.3.0</td>
</tr>
<tr>
<td>2020-09</td>
<td>RAN#89-e</td>
<td>RP-201804</td>
<td style="text-align: center;">0117</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>CR on 2-step RACH for 38.214</td>
<td>16.3.0</td>
</tr>
<tr>
<td>2020-09</td>
<td>RAN#89-e</td>
<td>RP-201813</td>
<td style="text-align: center;">0118</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Corrections on Cross-carrier Scheduling with Different
Numerologies</td>
<td>16.3.0</td>
</tr>
<tr>
<td>2020-09</td>
<td>RAN#89-e</td>
<td>RP-201809</td>
<td style="text-align: center;">0120</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on SRS carrier switching</td>
<td>16.3.0</td>
</tr>
<tr>
<td>2020-09</td>
<td>RAN#89-e</td>
<td>RP-201814</td>
<td style="text-align: center;">0121</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on aperiodic CSI-RS triggering with beam switching timing
of 224 and 336</td>
<td>16.3.0</td>
</tr>
<tr>
<td>2020-09</td>
<td>RAN#89-e</td>
<td>RP-201814</td>
<td style="text-align: center;">0122</td>
<td style="text-align: center;">-</td>
<td>B</td>
<td>Introduction of flexible TRS bandwidth for BWP of 52 RBs</td>
<td>16.3.0</td>
</tr>
<tr>
<td>2020-09</td>
<td>RAN#89-e</td>
<td>RP-201814</td>
<td style="text-align: center;">0123</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on 38.214 for PUSCH with UL skipping (Note: CR was not
implementable because "not based on the latest version of the
specification")</td>
<td>16.3.0</td>
</tr>
<tr>
<td>2020-09</td>
<td>RAN#89-e</td>
<td>RP-201810</td>
<td style="text-align: center;">0124</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>RRM measurements when drx-onDurationTimer does not start</td>
<td>16.3.0</td>
</tr>
<tr>
<td>2020-09</td>
<td>RAN#89-e</td>
<td>RP-201820</td>
<td style="text-align: center;">0125</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on uplink Tx switching</td>
<td>16.3.0</td>
</tr>
<tr>
<td>2020-09</td>
<td>RAN#89-e</td>
<td>RP-201807</td>
<td style="text-align: center;">0126</td>
<td style="text-align: center;">1</td>
<td>F</td>
<td>Corrections on 5G V2X sidelink features</td>
<td>16.3.0</td>
</tr>
<tr>
<td>2020-09</td>
<td>RAN#89-e</td>
<td>RP-201809</td>
<td style="text-align: center;">0127</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Corrections to MIMO enhancements</td>
<td>16.3.0</td>
</tr>
<tr>
<td>2020-09</td>
<td>RAN#89-e</td>
<td>RP-201811</td>
<td style="text-align: center;">0128</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Corrections to NR positioning support</td>
<td>16.3.0</td>
</tr>
<tr>
<td>2020-09</td>
<td>RAN#89-e</td>
<td>RP-201805</td>
<td style="text-align: center;">0129</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Corrections to NR-based access to unlicensed spectrum</td>
<td>16.3.0</td>
</tr>
<tr>
<td>2020-09</td>
<td>RAN#89-e</td>
<td>RP-201808</td>
<td style="text-align: center;">0130</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Corrections on NR URLLC support</td>
<td>16.3.0</td>
</tr>
<tr>
<td>2020-12</td>
<td>RAN#90-e</td>
<td>RP-202385</td>
<td style="text-align: center;">0131</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Corrections for default TCI state of AP CSI-RS in multi-TRP</td>
<td>16.4.0</td>
</tr>
<tr>
<td>2020-12</td>
<td>RAN#90-e</td>
<td>RP-202390</td>
<td style="text-align: center;">0132</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on beam switch timing for aperiodic TRS</td>
<td>16.4.0</td>
</tr>
<tr>
<td>2020-12</td>
<td>RAN#90-e</td>
<td>RP-202401</td>
<td style="text-align: center;">0133</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on increased number of CSI-RS for mobility per MO</td>
<td>16.4.0</td>
</tr>
<tr>
<td>2020-12</td>
<td>RAN#90-e</td>
<td>RP-202390</td>
<td style="text-align: center;">0134</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>38.214 CR (Rel-16, F, Rel-15 originating) to fix configurable
xOverhead values for TBS determination</td>
<td>16.4.0</td>
</tr>
<tr>
<td>2020-12</td>
<td>RAN#90-e</td>
<td>RP-202385</td>
<td style="text-align: center;">0135</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Corrections for the issue of PDCCH and PDSCH colliding in
multi-TRP</td>
<td>16.4.0</td>
</tr>
<tr>
<td>2020-12</td>
<td>RAN#90-e</td>
<td>RP-202385</td>
<td style="text-align: center;">0136</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on TCI state codepoint mapping for DCI format 1_2</td>
<td>16.4.0</td>
</tr>
<tr>
<td>2020-12</td>
<td>RAN#90-e</td>
<td>RP-202384</td>
<td style="text-align: center;">0137</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on data rate restriction in a slot for PUSCH repetition
Type B</td>
<td>16.4.0</td>
</tr>
<tr>
<td>2020-12</td>
<td>RAN#90-e</td>
<td>RP-202390</td>
<td style="text-align: center;">0138</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction to beam switch timing</td>
<td>16.4.0</td>
</tr>
<tr>
<td>2020-12</td>
<td>RAN#90-e</td>
<td>RP-202385</td>
<td style="text-align: center;">0139</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>CR on Interference Measurement Resource for L1-SINR</td>
<td>16.4.0</td>
</tr>
<tr>
<td>2020-12</td>
<td>RAN#90-e</td>
<td>RP-202383</td>
<td style="text-align: center;">0140</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Corrections related to the sidelink slot index</td>
<td>16.4.0</td>
</tr>
<tr>
<td>2020-12</td>
<td>RAN#90-e</td>
<td>RP-202383</td>
<td style="text-align: center;">0141</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on sidelink resource pool determination based on
PSBCH</td>
<td>16.4.0</td>
</tr>
<tr>
<td>2020-12</td>
<td>RAN#90-e</td>
<td>RP-202383</td>
<td style="text-align: center;">0142</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Introduction of the preparation time for SL retransmissions in Mode
1</td>
<td>16.4.0</td>
</tr>
<tr>
<td>2020-12</td>
<td>RAN#90-e</td>
<td>RP-202386</td>
<td style="text-align: center;">0143</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on L1-RSRP and Minimum scheduling offset</td>
<td>16.4.0</td>
</tr>
<tr>
<td>2020-12</td>
<td>RAN#90-e</td>
<td>RP-202383</td>
<td style="text-align: center;">0145</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on redundancy version for PSSCH</td>
<td>16.4.0</td>
</tr>
<tr>
<td>2020-12</td>
<td>RAN#90-e</td>
<td>RP-202385</td>
<td style="text-align: center;">0146</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>CR on Measurement Restriction for L1-SINR</td>
<td>16.4.0</td>
</tr>
<tr>
<td>2020-12</td>
<td>RAN#90-e</td>
<td>RP-202387</td>
<td style="text-align: center;">0147</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction to DL PRS duration calculation for DL PRS processing</td>
<td>16.4.0</td>
</tr>
<tr>
<td>2020-12</td>
<td>RAN#90-e</td>
<td>RP-202387</td>
<td style="text-align: center;">0148</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>CR on DL PRS resource prioritization for UE measurements</td>
<td>16.4.0</td>
</tr>
<tr>
<td>2020-12</td>
<td>RAN#90-e</td>
<td>RP-202387</td>
<td style="text-align: center;">0149</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>CR on the configuration of spatial relation for the SRS for
positioning</td>
<td>16.4.0</td>
</tr>
<tr>
<td>2020-12</td>
<td>RAN#90-e</td>
<td>RP-202387</td>
<td style="text-align: center;">0150</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>CR for replacement of cell terminology in PRS reception
procedure</td>
<td>16.4.0</td>
</tr>
<tr>
<td>2020-12</td>
<td>RAN#90-e</td>
<td>RP-202387</td>
<td style="text-align: center;">0152</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>CR for parameter name alignment and reference corrections in PRS
reception procedure</td>
<td>16.4.0</td>
</tr>
<tr>
<td>2020-12</td>
<td>RAN#90-e</td>
<td>RP-202389</td>
<td style="text-align: center;">0153</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Corrections for A-CSI triggering with unaligned CA</td>
<td>16.4.0</td>
</tr>
<tr>
<td>2020-12</td>
<td>RAN#90-e</td>
<td>RP-202398</td>
<td style="text-align: center;">0154</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Alignment of RRC parameter names for 38.214</td>
<td>16.4.0</td>
</tr>
<tr>
<td>2021-03</td>
<td>RAN#91-e</td>
<td>RP-210047</td>
<td style="text-align: center;">0156</td>
<td style="text-align: center;">-</td>
<td>A</td>
<td>Correction on MCS values for PT-RS time density determination in TS
38.214</td>
<td>16.5.0</td>
</tr>
<tr>
<td>2021-03</td>
<td>RAN#91-e</td>
<td>RP-210048</td>
<td style="text-align: center;">0157</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>CR on DMRS configuration for MsgA in 38.214</td>
<td>16.5.0</td>
</tr>
<tr>
<td>2021-03</td>
<td>RAN#91-e</td>
<td>RP-210049</td>
<td style="text-align: center;">0158</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on joint configuration of semi-static repetitions and
multi-pusch scheduling</td>
<td>16.5.0</td>
</tr>
<tr>
<td>2021-03</td>
<td>RAN#91-e</td>
<td>RP-210055</td>
<td style="text-align: center;">0159</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on UE sounding procedure</td>
<td>16.5.0</td>
</tr>
<tr>
<td>2021-03</td>
<td>RAN#91-e</td>
<td>RP-210052</td>
<td style="text-align: center;">0160</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>CR on Default TCI state of Scheme 3 and Scheme 4</td>
<td>16.5.0</td>
</tr>
<tr>
<td>2021-03</td>
<td>RAN#91-e</td>
<td>RP-210052</td>
<td style="text-align: center;">0161</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>CR on multi-TRP</td>
<td>16.5.0</td>
</tr>
<tr>
<td>2021-03</td>
<td>RAN#91-e</td>
<td>RP-210052</td>
<td style="text-align: center;">0162</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>CR on PDSCH QCL</td>
<td>16.5.0</td>
</tr>
<tr>
<td>2021-03</td>
<td>RAN#91-e</td>
<td>RP-210052</td>
<td style="text-align: center;">0163</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>CR on L1-SINR based beam measurement</td>
<td>16.5.0</td>
</tr>
<tr>
<td>2021-03</td>
<td>RAN#91-e</td>
<td>RP-210050</td>
<td style="text-align: center;">0164</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Corrections related to the sidelink resource reservation period</td>
<td>16.5.0</td>
</tr>
<tr>
<td>2021-03</td>
<td>RAN#91-e</td>
<td>RP-210050</td>
<td style="text-align: center;">0165</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction to pre-emption condition for Mode-2 resource
allocation</td>
<td>16.5.0</td>
</tr>
<tr>
<td>2021-03</td>
<td>RAN#91-e</td>
<td>RP-210051</td>
<td style="text-align: center;">0166</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on Part 2 CSI dropping for UCI multiplexing on PUSCH
repetition Type B</td>
<td>16.5.0</td>
</tr>
<tr>
<td>2021-03</td>
<td>RAN#91-e</td>
<td>RP-210058</td>
<td style="text-align: center;">0167</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on uplink Tx switching</td>
<td>16.5.0</td>
</tr>
<tr>
<td>2021-03</td>
<td>RAN#91-e</td>
<td>RP-210053</td>
<td style="text-align: center;">0168</td>
<td style="text-align: center;">1</td>
<td>F</td>
<td>CR for the configuration of semi-persistent SRS</td>
<td>16.5.0</td>
</tr>
<tr>
<td>2021-03</td>
<td>RAN#91-e</td>
<td>RP-210053</td>
<td style="text-align: center;">0169</td>
<td style="text-align: center;">1</td>
<td>F</td>
<td>CR for the configuration of DL-PRS as the spatial relation of
periodic and semi-persistent positioning SRS</td>
<td>16.5.0</td>
</tr>
<tr>
<td>2021-03</td>
<td>RAN#91-e</td>
<td>RP-210053</td>
<td style="text-align: center;">0170</td>
<td style="text-align: center;">1</td>
<td>F</td>
<td>CR for the configuration of SRS for positioning in SRS carrier
switching</td>
<td>16.5.0</td>
</tr>
<tr>
<td>2021-03</td>
<td>RAN#91-e</td>
<td>RP-210053</td>
<td style="text-align: center;">0171</td>
<td style="text-align: center;">1</td>
<td>F</td>
<td>CR on DL PRS resource indication in activation command for
semi-persistent SRS for positioning and amount of DL PRS resource sets
per TRP</td>
<td>16.5.0</td>
</tr>
<tr>
<td>2021-03</td>
<td>RAN#91-e</td>
<td>RP-210053</td>
<td style="text-align: center;">0172</td>
<td style="text-align: center;">1</td>
<td>F</td>
<td>CR on timestamp reference in NR positioning measurement report</td>
<td>16.5.0</td>
</tr>
<tr>
<td>2021-03</td>
<td>RAN#91-e</td>
<td>RP-210053</td>
<td style="text-align: center;">0173</td>
<td style="text-align: center;">1</td>
<td>F</td>
<td>CR on measurement gap configuration for NR positioning</td>
<td>16.5.0</td>
</tr>
<tr>
<td>2021-03</td>
<td>RAN#91-e</td>
<td>RP-210054</td>
<td style="text-align: center;">0175</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Additional timing delay for applying QCL relation on the PDSCH with
cross-carrier scheduling with different SCS.</td>
<td>16.5.0</td>
</tr>
<tr>
<td>2021-03</td>
<td>RAN#91-e</td>
<td>RP-210051</td>
<td style="text-align: center;">0176</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on PDSCH resource mapping with RE symbol level
granularity</td>
<td>16.5.0</td>
</tr>
<tr>
<td>2021-03</td>
<td>RAN#91-e</td>
<td>RP-210051</td>
<td style="text-align: center;">0177</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Active time duration of NZP CSI-RS resource</td>
<td>16.5.0</td>
</tr>
<tr>
<td>2021-03</td>
<td>RAN#91-e</td>
<td>RP-210059</td>
<td style="text-align: center;">0178</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Editorial corrections for 38.214</td>
<td>16.5.0</td>
</tr>
<tr>
<td>2021-03</td>
<td>RAN#91-e</td>
<td>RP-210309</td>
<td style="text-align: center;">0123</td>
<td style="text-align: center;">2</td>
<td>F</td>
<td>Correction on 38.214 for PUSCH with UL skipping in Rel-16</td>
<td>16.5.0</td>
</tr>
<tr>
<td>2021-06</td>
<td>RAN#92-e</td>
<td>RP-211237</td>
<td style="text-align: center;">0179</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on out-of-order HARQ operation in 38.214</td>
<td>16.6.0</td>
</tr>
<tr>
<td>2021-06</td>
<td>RAN#92-e</td>
<td>RP-211239</td>
<td style="text-align: center;">0180</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>38.214 CR on CSI request constraint per slot</td>
<td>16.6.0</td>
</tr>
<tr>
<td>2021-06</td>
<td>RAN#92-e</td>
<td>RP-211240</td>
<td style="text-align: center;">0181</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Timelines for SRS carrier switching</td>
<td>16.6.0</td>
</tr>
<tr>
<td>2021-06</td>
<td>RAN#92-e</td>
<td>RP-211238</td>
<td style="text-align: center;">0182</td>
<td style="text-align: center;">1</td>
<td>F</td>
<td>Correction to the DL PRS reception procedure for PRS cell
determination</td>
<td>16.6.0</td>
</tr>
<tr>
<td>2021-06</td>
<td>RAN#92-e</td>
<td>RP-211235</td>
<td style="text-align: center;">0183</td>
<td style="text-align: center;">1</td>
<td>F</td>
<td>Correction to sidelink resource identification procedure avoiding
infinite loop issue</td>
<td>16.6.0</td>
</tr>
<tr>
<td>2021-06</td>
<td>RAN#92-e</td>
<td>RP-211234</td>
<td style="text-align: center;">0184</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on averaging CSI-RS for measuring CSI across DL
bursts</td>
<td>16.6.0</td>
</tr>
<tr>
<td>2021-06</td>
<td>RAN#92-e</td>
<td>RP-211233</td>
<td style="text-align: center;">0186</td>
<td style="text-align: center;">1</td>
<td>A</td>
<td>Rel-15 editorial corrections for TS 38.214 (mirrored to Rel-16)</td>
<td>16.6.0</td>
</tr>
<tr>
<td>2021-06</td>
<td>RAN#92-e</td>
<td>RP-211243</td>
<td style="text-align: center;">0187</td>
<td style="text-align: center;">1</td>
<td>F</td>
<td>Rel-16 editorial corrections for TS 38.214</td>
<td>16.6.0</td>
</tr>
<tr>
<td>2021-06</td>
<td>RAN#92-e</td>
<td>RP-211236</td>
<td style="text-align: center;">0188</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on DMRS reception and transmission procedure in TS
38.214</td>
<td>16.6.0</td>
</tr>
<tr>
<td>2021-06</td>
<td>RAN#92-e</td>
<td>RP-211237</td>
<td style="text-align: center;">0189</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on simultaneous multi-CC spatial relation update for
SRS</td>
<td>16.6.0</td>
</tr>
<tr>
<td>2021-06</td>
<td>RAN#92-e</td>
<td>RP-211237</td>
<td style="text-align: center;">0190</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on enabling configuration of time restriction over
L1-SINR measurement</td>
<td>16.6.0</td>
</tr>
<tr>
<td>2021-06</td>
<td>RAN#92-e</td>
<td>RP-211237</td>
<td style="text-align: center;">0191</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Corrections on RRC names and interpretation for Multi-TRP</td>
<td>16.6.0</td>
</tr>
<tr>
<td>2021-06</td>
<td>RAN#92-e</td>
<td>RP-211251</td>
<td style="text-align: center;">0192</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction of UE Power Saving</td>
<td>16.6.0</td>
</tr>
<tr>
<td>2021-06</td>
<td>RAN#92-e</td>
<td>RP-211233</td>
<td style="text-align: center;">0194</td>
<td style="text-align: center;">-</td>
<td>A</td>
<td>Correction on enabling configuration of time restriction over
L1-RSRP and CSI measurement</td>
<td>16.6.0</td>
</tr>
<tr>
<td>2021-06</td>
<td>RAN#92-e</td>
<td>RP-211233</td>
<td style="text-align: center;">0196</td>
<td style="text-align: center;">-</td>
<td>A</td>
<td>Clarification on back-to-back PUSCHs scheduling restriction</td>
<td>16.6.0</td>
</tr>
<tr>
<td>2021-06</td>
<td>RAN#92-e</td>
<td>RP-211235</td>
<td style="text-align: center;">0197</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Corrections for transmitting sidelink reference signals in TS
38.214</td>
<td>16.6.0</td>
</tr>
<tr>
<td>2021-06</td>
<td>RAN#92-e</td>
<td>RP-211238</td>
<td style="text-align: center;">0198</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>CR on DL PRS periodicity and muting repetition factor</td>
<td>16.6.0</td>
</tr>
<tr>
<td>2021-06</td>
<td>RAN#92-e</td>
<td>RP-211238</td>
<td style="text-align: center;">0199</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>CR on measurement gap request inside of the active DL BWP for DL PRS
measurements</td>
<td>16.6.0</td>
</tr>
<tr>
<td>2021-06</td>
<td>RAN#92-e</td>
<td>RP-211239</td>
<td style="text-align: center;">0200</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>38.214 CR on unaligned frame boundary CA with A-CSI-RS transmission
and CSI reference resource definition</td>
<td>16.6.0</td>
</tr>
<tr>
<td>2021-06</td>
<td>RAN#92-e</td>
<td>RP-211238</td>
<td style="text-align: center;">0201</td>
<td style="text-align: center;">1</td>
<td>F</td>
<td>CR on SCS values for DL PRS</td>
<td>16.6.0</td>
</tr>
<tr>
<td>2021-06</td>
<td>RAN#92-e</td>
<td>RP-211238</td>
<td style="text-align: center;">0202</td>
<td style="text-align: center;">1</td>
<td>F</td>
<td>CR on correction to DL PRS processing priority order</td>
<td>16.6.0</td>
</tr>
<tr>
<td>2021-06</td>
<td>RAN#92-e</td>
<td>RP-211236</td>
<td style="text-align: center;">0203</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on SRS resource set configuration in TS 38.214</td>
<td>16.6.0</td>
</tr>
<tr>
<td>2021-09</td>
<td>RAN#93-e</td>
<td>RP-211847</td>
<td style="text-align: center;">0204</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction to PDSCH rate matching for SPS</td>
<td>16.7.0</td>
</tr>
<tr>
<td>2021-09</td>
<td>RAN#93-e</td>
<td>RP-211844</td>
<td style="text-align: center;">0205</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>CR on sum data rate for tdmSchemeA and fdmSchemeB</td>
<td>16.7.0</td>
</tr>
<tr>
<td>2021-09</td>
<td>RAN#93-e</td>
<td>RP-211842</td>
<td style="text-align: center;">0206</td>
<td style="text-align: center;">1</td>
<td>F</td>
<td>Correction on procedure for transmitting the physical sidelink
shared channel</td>
<td>16.7.0</td>
</tr>
<tr>
<td>2021-09</td>
<td>RAN#93-e</td>
<td>RP-211843</td>
<td style="text-align: center;">0207</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on invalid symbol determination for PUSCH repetition Type
B</td>
<td>16.7.0</td>
</tr>
<tr>
<td>2021-09</td>
<td>RAN#93-e</td>
<td>RP-211846</td>
<td style="text-align: center;">0208</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on cross-carrier scheduling and cross-carrier CSI-RS
triggering</td>
<td>16.7.0</td>
</tr>
<tr>
<td>2021-09</td>
<td>RAN#93-e</td>
<td>RP-211845</td>
<td style="text-align: center;">0209</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>CR on terminology correction to cell for positioning</td>
<td>16.7.0</td>
</tr>
<tr>
<td>2021-09</td>
<td>RAN#93-e</td>
<td>RP-211845</td>
<td style="text-align: center;">0210</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>CR on alignment with RAN4 on DL PRS processing</td>
<td>16.7.0</td>
</tr>
<tr>
<td>2021-09</td>
<td>RAN#93-e</td>
<td>RP-211841</td>
<td style="text-align: center;">0212</td>
<td style="text-align: center;">-</td>
<td>A</td>
<td>CR to 38.214 clarification on coefficients packing order for Type II
CSI</td>
<td>16.7.0</td>
</tr>
<tr>
<td>2021-09</td>
<td>RAN#93-e</td>
<td>RP-211841</td>
<td style="text-align: center;">0214</td>
<td style="text-align: center;">-</td>
<td>A</td>
<td>Clarification on back-to-back PUSCHs scheduling restriction</td>
<td>16.7.0</td>
</tr>
<tr>
<td>2021-09</td>
<td>RAN#93-e</td>
<td>RP-211850</td>
<td style="text-align: center;">0215</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Rel-16 editorial corrections for TS 38.214</td>
<td>16.7.0</td>
</tr>
<tr>
<td>2021-12</td>
<td>RAN#94-e</td>
<td>RP-212958</td>
<td style="text-align: center;">0218</td>
<td style="text-align: center;">-</td>
<td>A</td>
<td>Correction on semi-persistent CSI reporting on PUSCH</td>
<td>16.8.0</td>
</tr>
<tr>
<td>2021-12</td>
<td>RAN#94-e</td>
<td>RP-212960</td>
<td style="text-align: center;">0219</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Corrections on UE PDSCH processing time for DCI format 1_2</td>
<td>16.8.0</td>
</tr>
<tr>
<td>2021-12</td>
<td>RAN#94-e</td>
<td>RP-212961</td>
<td style="text-align: center;">0220</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on frequency hopping for PUSCH and SRS</td>
<td>16.8.0</td>
</tr>
<tr>
<td>2021-12</td>
<td>RAN#94-e</td>
<td>RP-212958</td>
<td style="text-align: center;">0222</td>
<td style="text-align: center;">-</td>
<td>A</td>
<td>Rel-15 editorial corrections for TS 38.214</td>
<td>16.8.0</td>
</tr>
<tr>
<td>2021-12</td>
<td>RAN#94-e</td>
<td>RP-212964</td>
<td style="text-align: center;">0223</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Rel-16 editorial corrections for TS 38.214</td>
<td>16.8.0</td>
</tr>
<tr>
<td>2021-12</td>
<td>RAN#94-e</td>
<td>RP-212981</td>
<td style="text-align: center;">0224</td>
<td style="text-align: center;">-</td>
<td>B</td>
<td>Introduction of NR further Multi-RAT Dual-Connectivity
enhancements</td>
<td>17.0.0</td>
</tr>
<tr>
<td>2021-12</td>
<td>RAN#94-e</td>
<td>RP-212973</td>
<td style="text-align: center;">0225</td>
<td style="text-align: center;">-</td>
<td>B</td>
<td>Introduction of NR coverage enhancements</td>
<td>17.0.0</td>
</tr>
<tr>
<td>2021-12</td>
<td>RAN#94-e</td>
<td>RP-212982</td>
<td style="text-align: center;">0226</td>
<td style="text-align: center;">-</td>
<td>B</td>
<td>Introduction of DL 1024QAM for NR FR1</td>
<td>17.0.0</td>
</tr>
<tr>
<td>2021-12</td>
<td>RAN#94-e</td>
<td>RP-212967</td>
<td style="text-align: center;">0227</td>
<td style="text-align: center;">-</td>
<td>B</td>
<td>Introduction of NR Extending current NR operation to 71GHz</td>
<td>17.0.0</td>
</tr>
<tr>
<td>2021-12</td>
<td>RAN#94-e</td>
<td>RP-212966</td>
<td style="text-align: center;">0228</td>
<td style="text-align: center;">-</td>
<td>B</td>
<td>Introduction of further enhancements on MIMO for NR</td>
<td>17.0.0</td>
</tr>
<tr>
<td>2021-12</td>
<td>RAN#94-e</td>
<td>RP-212968</td>
<td style="text-align: center;">0229</td>
<td style="text-align: center;">-</td>
<td>B</td>
<td>Introduction of enhanced Industrial Internet of Things (IoT) and
ultra-reliable and low latency communication (URLLC) support for NR</td>
<td>17.0.0</td>
</tr>
<tr>
<td>2021-12</td>
<td>RAN#94-e</td>
<td>RP-212979</td>
<td style="text-align: center;">0230</td>
<td style="text-align: center;">-</td>
<td>B</td>
<td>Introduction of NR Multicast and Broadcast Services</td>
<td>17.0.0</td>
</tr>
<tr>
<td>2021-12</td>
<td>RAN#94-e</td>
<td>RP-212969</td>
<td style="text-align: center;">0231</td>
<td style="text-align: center;">-</td>
<td>B</td>
<td>Introduction of solutions for NR to support non-terrestrial networks
(NTN)</td>
<td>17.0.0</td>
</tr>
<tr>
<td>2021-12</td>
<td>RAN#94-e</td>
<td>RP-212970</td>
<td style="text-align: center;">0232</td>
<td style="text-align: center;">-</td>
<td>B</td>
<td>Introduction of NR Positioning Enhancements</td>
<td>17.0.0</td>
</tr>
<tr>
<td>2021-12</td>
<td>RAN#94-e</td>
<td>RP-212971</td>
<td style="text-align: center;">0233</td>
<td style="text-align: center;">-</td>
<td>B</td>
<td>Introduction of NR reduced capability NR devices</td>
<td>17.0.0</td>
</tr>
<tr>
<td>2021-12</td>
<td>RAN#94-e</td>
<td>RP-212983</td>
<td style="text-align: center;">0234</td>
<td style="text-align: center;">-</td>
<td>B</td>
<td>Introduction of UL Tx Switching enhancements</td>
<td>17.0.0</td>
</tr>
<tr>
<td>2021-12</td>
<td>RAN#94-e</td>
<td>RP-212978</td>
<td style="text-align: center;">0235</td>
<td style="text-align: center;">-</td>
<td>B</td>
<td>Introduction of NR Sidelink enhancements</td>
<td>17.0.0</td>
</tr>
<tr>
<td>2021-12</td>
<td>RAN#94-e</td>
<td>RP-212972</td>
<td style="text-align: center;">0236</td>
<td style="text-align: center;">-</td>
<td>B</td>
<td>Introduction of NR UE Power Saving Enhancements</td>
<td>17.0.0</td>
</tr>
<tr>
<td>2021-12</td>
<td>RAN#94-e</td>
<td>RP-213524</td>
<td style="text-align: center;">0237</td>
<td style="text-align: center;">-</td>
<td>B</td>
<td>Introduction of NR small data transmissions in INACTIVE state</td>
<td>17.0.0</td>
</tr>
<tr>
<td>2022-03</td>
<td>RAN#95-e</td>
<td>RP-220246</td>
<td style="text-align: center;">0239</td>
<td style="text-align: center;">-</td>
<td>A</td>
<td>Correction on determination of SRS resource set triggered by DCI
format 2_3</td>
<td>17.1.0</td>
</tr>
<tr>
<td>2022-03</td>
<td>RAN#95-e</td>
<td>RP-220244</td>
<td style="text-align: center;">0242</td>
<td style="text-align: center;">-</td>
<td>A</td>
<td>Corrections on mapping between the Time domain resource allocation
field value of the RAR UL grant and a row index of an allocated
table</td>
<td>17.1.0</td>
</tr>
<tr>
<td>2022-03</td>
<td>RAN#95-e</td>
<td>RP-220246</td>
<td style="text-align: center;">0244</td>
<td style="text-align: center;">-</td>
<td>A</td>
<td>Corrections on time domain resource allocation procedure for a PUSCH
scheduled by RAR UL grant or by fallbackRAR UL grant</td>
<td>17.1.0</td>
</tr>
<tr>
<td>2022-03</td>
<td>RAN#95-e</td>
<td>RP-220247</td>
<td style="text-align: center;">0246</td>
<td style="text-align: center;">-</td>
<td>A</td>
<td>Correction on frequency hopping for PUSCH with a configured
grant</td>
<td>17.1.0</td>
</tr>
<tr>
<td>2022-03</td>
<td>RAN#95-e</td>
<td>RP-220269</td>
<td style="text-align: center;">0248</td>
<td style="text-align: center;">-</td>
<td>A</td>
<td>CR on correction of indicated TCI states for single-DCI based MTRP
schemes</td>
<td>17.1.0</td>
</tr>
<tr>
<td>2022-03</td>
<td>RAN#95-e</td>
<td>RP-220269</td>
<td style="text-align: center;">0250</td>
<td style="text-align: center;">-</td>
<td>A</td>
<td>CR on PMI indexing correction in Type II and eType II CSI</td>
<td>17.1.0</td>
</tr>
<tr>
<td>2022-03</td>
<td>RAN#95-e</td>
<td>RP-220269</td>
<td style="text-align: center;">0252</td>
<td style="text-align: center;">-</td>
<td>A</td>
<td>Correction of NZC partitioning in eType II CSI</td>
<td>17.1.0</td>
</tr>
<tr>
<td>2022-03</td>
<td>RAN#95-e</td>
<td>RP-220257</td>
<td style="text-align: center;">0253</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Corrections on NR coverage enhancements</td>
<td>17.1.0</td>
</tr>
<tr>
<td>2022-03</td>
<td>RAN#95-e</td>
<td>RP-220251</td>
<td style="text-align: center;">0254</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Corrections on NR extensions of current NR operation to 71GHz</td>
<td>17.1.0</td>
</tr>
<tr>
<td>2022-03</td>
<td>RAN#95-e</td>
<td>RP-220252</td>
<td style="text-align: center;">0255</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Corrections on enhanced Industrial Internet of Things (IoT) and
ultra-reliable and low latency communication (URLLC) support for NR</td>
<td>17.1.0</td>
</tr>
<tr>
<td>2022-03</td>
<td>RAN#95-e</td>
<td>RP-220263</td>
<td style="text-align: center;">0256</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Corrections on NR Multicast and Broadcast Services</td>
<td>17.1.0</td>
</tr>
<tr>
<td>2022-03</td>
<td>RAN#95-e</td>
<td>RP-220949</td>
<td style="text-align: center;">0257</td>
<td style="text-align: center;">1</td>
<td>B</td>
<td>Corrections on NR Sidelink enhancements</td>
<td>17.1.0</td>
</tr>
<tr>
<td>2022-03</td>
<td>RAN#95-e</td>
<td>RP-220256</td>
<td style="text-align: center;">0258</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Corrections on NR UE Power Saving Enhancements</td>
<td>17.1.0</td>
</tr>
<tr>
<td>2022-03</td>
<td>RAN#95-e</td>
<td>RP-220265</td>
<td style="text-align: center;">0259</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Corrections on further Multi-RAT Dual-Connectivity enhancements</td>
<td>17.1.0</td>
</tr>
<tr>
<td>2022-03</td>
<td>RAN#95-e</td>
<td>RP-220266</td>
<td style="text-align: center;">0260</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Corrections on DL 1024QAM for NR FR1</td>
<td>17.1.0</td>
</tr>
<tr>
<td>2022-03</td>
<td>RAN#95-e</td>
<td>RP-220264</td>
<td style="text-align: center;">0261</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Corrections on NR Dynamic Spectrum Sharing enhancements</td>
<td>17.1.0</td>
</tr>
<tr>
<td>2022-03</td>
<td>RAN#95-e</td>
<td>RP-220250</td>
<td style="text-align: center;">0262</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on further enhancements on MIMO for NR</td>
<td>17.1.0</td>
</tr>
<tr>
<td>2022-03</td>
<td>RAN#95-e</td>
<td>RP-220253</td>
<td style="text-align: center;">0263</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Corrections on solutions for NR to support non-terrestrial networks
(NTN)</td>
<td>17.1.0</td>
</tr>
<tr>
<td>2022-03</td>
<td>RAN#95-e</td>
<td>RP-220254</td>
<td style="text-align: center;">0264</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on NR Positioning Enhancements</td>
<td>17.1.0</td>
</tr>
<tr>
<td>2022-03</td>
<td>RAN#95-e</td>
<td>RP-220255</td>
<td style="text-align: center;">0265</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Corrections on NR reduced capability NR devices</td>
<td>17.1.0</td>
</tr>
<tr>
<td>2022-03</td>
<td>RAN#95-e</td>
<td>RP-220267</td>
<td style="text-align: center;">0266</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Corrections on UL Tx Switching enhancements</td>
<td>17.1.0</td>
</tr>
<tr>
<td>2022-03</td>
<td>RAN#95-e</td>
<td>RP-220270</td>
<td style="text-align: center;">0267</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Corrections on UL Tx Switching enhancements</td>
<td>17.1.0</td>
</tr>
<tr>
<td>2022-03</td>
<td>RAN#95-e</td>
<td>RP-220249</td>
<td style="text-align: center;">0269</td>
<td style="text-align: center;">-</td>
<td>A</td>
<td>Rel-16 editorial corrections for TS 38.214 (mirrored to Rel-17)</td>
<td>17.1.0</td>
</tr>
<tr>
<td>2022-06</td>
<td>RAN#96</td>
<td>RP-221620</td>
<td style="text-align: center;">0273</td>
<td style="text-align: center;">-</td>
<td>A</td>
<td>Clarification of PUSCH with SP-CSI overlapping with PUSCH with
data</td>
<td>17.2.0</td>
</tr>
<tr>
<td>2022-06</td>
<td>RAN#96</td>
<td>RP-221598</td>
<td style="text-align: center;">0275</td>
<td style="text-align: center;">-</td>
<td>A</td>
<td>Correction on SRS resource set with 'antennaSwitching' and
'beamManagement'</td>
<td>17.2.0</td>
</tr>
<tr>
<td>2022-06</td>
<td>RAN#96</td>
<td>RP-221620</td>
<td style="text-align: center;">0277</td>
<td style="text-align: center;">-</td>
<td>A</td>
<td>Correction for parallel transmission of SRS and PUSCH/PUCCH</td>
<td>17.2.0</td>
</tr>
<tr>
<td>2022-06</td>
<td>RAN#96</td>
<td>RP-221616</td>
<td style="text-align: center;">0278</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Corrections on SRS carrier switching</td>
<td>17.2.0</td>
</tr>
<tr>
<td>2022-06</td>
<td>RAN#96</td>
<td>RP-221616</td>
<td style="text-align: center;">0279</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Simultaneous transmission of SRS and other channels for intra-band
non-contiguous carrier aggregation</td>
<td>17.2.0</td>
</tr>
<tr>
<td>2022-06</td>
<td>RAN#96</td>
<td>RP-221607</td>
<td style="text-align: center;">0280</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Corrections on NR coverage enhancements</td>
<td>17.2.0</td>
</tr>
<tr>
<td>2022-06</td>
<td>RAN#96</td>
<td>RP-221601</td>
<td style="text-align: center;">0281</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Corrections on NR extensions of current NR operation to 71GHz</td>
<td>17.2.0</td>
</tr>
<tr>
<td>2022-06</td>
<td>RAN#96</td>
<td>RP-221602</td>
<td style="text-align: center;">0282</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Corrections on enhanced Industrial Internet of Things (IoT) and
ultra-reliable and low latency communication (URLLC) support for NR</td>
<td>17.2.0</td>
</tr>
<tr>
<td>2022-06</td>
<td>RAN#96</td>
<td>RP-221612</td>
<td style="text-align: center;">0283</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Corrections on NR Multicast and Broadcast Services</td>
<td>17.2.0</td>
</tr>
<tr>
<td>2022-06</td>
<td>RAN#96</td>
<td>RP-221611</td>
<td style="text-align: center;">0284</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Corrections on NR Sidelink enhancements</td>
<td>17.2.0</td>
</tr>
<tr>
<td>2022-06</td>
<td>RAN#96</td>
<td>RP-221614</td>
<td style="text-align: center;">0285</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Corrections on further Multi-RAT Dual-Connectivity enhancements</td>
<td>17.2.0</td>
</tr>
<tr>
<td>2022-06</td>
<td>RAN#96</td>
<td>RP-221610</td>
<td style="text-align: center;">0286</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Corrections on eIAB</td>
<td>17.2.0</td>
</tr>
<tr>
<td>2022-06</td>
<td>RAN#96</td>
<td>RP-221600</td>
<td style="text-align: center;">0287</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on further enhancements on MIMO for NR</td>
<td>17.2.0</td>
</tr>
<tr>
<td>2022-06</td>
<td>RAN#96</td>
<td>RP-221604</td>
<td style="text-align: center;">0288</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on NR Positioning Enhancements</td>
<td>17.2.0</td>
</tr>
<tr>
<td>2022-06</td>
<td>RAN#96</td>
<td>RP-221615</td>
<td style="text-align: center;">0289</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Corrections on UL Tx Switching enhancements</td>
<td>17.2.0</td>
</tr>
<tr>
<td>2022-06</td>
<td>RAN#96</td>
<td>RP-221599</td>
<td style="text-align: center;">0291</td>
<td style="text-align: center;">-</td>
<td>A</td>
<td>Rel-16 editorial corrections for TS 38.214 (mirrored to Rel-17)</td>
<td>17.2.0</td>
</tr>
<tr>
<td>2022-09</td>
<td>RAN#97-e</td>
<td>RP-222404</td>
<td style="text-align: center;">0292</td>
<td style="text-align: center;">1</td>
<td>F</td>
<td>Correction on PRS reception procedure</td>
<td>17.3.0</td>
</tr>
<tr>
<td>2022-09</td>
<td>RAN#97-e</td>
<td>RP-222404</td>
<td style="text-align: center;">0293</td>
<td style="text-align: center;">1</td>
<td>F</td>
<td>Correction on UE sounding procedure for positioning purpose</td>
<td>17.3.0</td>
</tr>
<tr>
<td>2022-09</td>
<td>RAN#97-e</td>
<td>RP-222404</td>
<td style="text-align: center;">0294</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>CR on DL-AOD positioning measurement for 38.214</td>
<td>17.3.0</td>
</tr>
<tr>
<td>2022-09</td>
<td>RAN#97-e</td>
<td>RP-222404</td>
<td style="text-align: center;">0295</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>CR on PRS RSRPP reporting for 38.214</td>
<td>17.3.0</td>
</tr>
<tr>
<td>2022-09</td>
<td>RAN#97-e</td>
<td>RP-222398</td>
<td style="text-align: center;">0297</td>
<td style="text-align: center;">-</td>
<td>A</td>
<td>Correction for PUSCH TDRA Tables</td>
<td>17.3.0</td>
</tr>
<tr>
<td>2022-09</td>
<td>RAN#97-e</td>
<td>RP-222401</td>
<td style="text-align: center;">0298</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Corrections on timeline of CSI request for 480kHz and 960kHz SCS in
TS38.214</td>
<td>17.3.0</td>
</tr>
<tr>
<td>2022-09</td>
<td>RAN#97-e</td>
<td>RP-222401</td>
<td style="text-align: center;">0299</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on UE PDSCH processing procedure time for operation with
shared spectrum channel access in FR2-2 in TS 38.214</td>
<td>17.3.0</td>
</tr>
<tr>
<td>2022-09</td>
<td>RAN#97-e</td>
<td>RP-222401</td>
<td style="text-align: center;">0300</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction for aperiodic CSI triggering offset for FR2-2 in TS
38.214</td>
<td>17.3.0</td>
</tr>
<tr>
<td>2022-09</td>
<td>RAN#97-e</td>
<td>RP-222404</td>
<td style="text-align: center;">0301</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>CR on priority states within the PRS processing window</td>
<td>17.3.0</td>
</tr>
<tr>
<td>2022-09</td>
<td>RAN#97-e</td>
<td>RP-222404</td>
<td style="text-align: center;">0302</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>CR on PRS processing sample for 38.214</td>
<td>17.3.0</td>
</tr>
<tr>
<td>2022-09</td>
<td>RAN#97-e</td>
<td>RP-222404</td>
<td style="text-align: center;">0303</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Corrections on M-sample measurement</td>
<td>17.3.0</td>
</tr>
<tr>
<td>2022-09</td>
<td>RAN#97-e</td>
<td>RP-222404</td>
<td style="text-align: center;">0304</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>CR on the positioning frequency layer within a PPW and UE capability
for the PPW</td>
<td>17.3.0</td>
</tr>
<tr>
<td>2022-09</td>
<td>RAN#97-e</td>
<td>RP-222404</td>
<td style="text-align: center;">0305</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>CR on PRS reception and SRS transmission outside initial BWP</td>
<td>17.3.0</td>
</tr>
<tr>
<td>2022-09</td>
<td>RAN#97-e</td>
<td>RP-222403</td>
<td style="text-align: center;">0307</td>
<td style="text-align: center;">1</td>
<td>F</td>
<td>Corrections on HARQ for NR-NTN for 38.214</td>
<td>17.3.0</td>
</tr>
<tr>
<td>2022-09</td>
<td>RAN#97-e</td>
<td>RP-222410</td>
<td style="text-align: center;">0308</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on CQI derivation accounting for provided DL Tx power
adjustment for IAB-MT</td>
<td>17.3.0</td>
</tr>
<tr>
<td>2022-09</td>
<td>RAN#97-e</td>
<td>RP-222410</td>
<td style="text-align: center;">0309</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>CR on eIAB CSI</td>
<td>17.3.0</td>
</tr>
<tr>
<td>2022-09</td>
<td>RAN#97-e</td>
<td>RP-222400</td>
<td style="text-align: center;">0310</td>
<td style="text-align: center;">1</td>
<td>F</td>
<td>CR on inter-cell multi-TRP operation</td>
<td>17.3.0</td>
</tr>
<tr>
<td>2022-09</td>
<td>RAN#97-e</td>
<td>RP-222400</td>
<td style="text-align: center;">0311</td>
<td style="text-align: center;">1</td>
<td>F</td>
<td>CR on inter-cell mTRP with PUSCH repetition TypeB</td>
<td>17.3.0</td>
</tr>
<tr>
<td>2022-09</td>
<td>RAN#97-e</td>
<td>RP-222415</td>
<td style="text-align: center;">0312</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on uplink suspension for CA-based SRS carrier
switching</td>
<td>17.3.0</td>
</tr>
<tr>
<td>2022-09</td>
<td>RAN#97-e</td>
<td>RP-222400</td>
<td style="text-align: center;">0313</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>CR for CSI-RS power for inter-cell mTRP</td>
<td>17.3.0</td>
</tr>
<tr>
<td>2022-09</td>
<td>RAN#97-e</td>
<td>RP-222400</td>
<td style="text-align: center;">0314</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>CR on default QCL for unified TCI state for PDSCH and A-CSI-RS</td>
<td>17.3.0</td>
</tr>
<tr>
<td>2022-09</td>
<td>RAN#97-e</td>
<td>RP-222400</td>
<td style="text-align: center;">0315</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>CR on unified TCI in TS38.214</td>
<td>17.3.0</td>
</tr>
<tr>
<td>2022-09</td>
<td>RAN#97-e</td>
<td>RP-222400</td>
<td style="text-align: center;">0316</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>CR on BAT for CA case</td>
<td>17.3.0</td>
</tr>
<tr>
<td>2022-09</td>
<td>RAN#97-e</td>
<td>RP-222419</td>
<td style="text-align: center;">0317</td>
<td style="text-align: center;">-</td>
<td>A</td>
<td>Correction on parallel transmission of MsgA and other channels in TS
38.214</td>
<td>17.3.0</td>
</tr>
<tr>
<td>2022-09</td>
<td>RAN#97-e</td>
<td>RP-222400</td>
<td style="text-align: center;">0318</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on the number of CPUs for Multi-TRP CSI</td>
<td>17.3.0</td>
</tr>
<tr>
<td>2022-09</td>
<td>RAN#97-e</td>
<td>RP-222400</td>
<td style="text-align: center;">0319</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on CSI-RS port restriction for mTRP CSI</td>
<td>17.3.0</td>
</tr>
<tr>
<td>2022-09</td>
<td>RAN#97-e</td>
<td>RP-222400</td>
<td style="text-align: center;">0320</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on slot offsets of CSI-RS resource pairs for MTRP</td>
<td>17.3.0</td>
</tr>
<tr>
<td>2022-09</td>
<td>RAN#97-e</td>
<td>RP-222414</td>
<td style="text-align: center;">0321</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on aperiodic CSI-RS for tracking for fast SCell
activation</td>
<td>17.3.0</td>
</tr>
<tr>
<td>2022-09</td>
<td>RAN#97-e</td>
<td>RP-222402</td>
<td style="text-align: center;">0322</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>CR on UE procedure for overlapping CG PUSCH and DG PUSCH</td>
<td>17.3.0</td>
</tr>
<tr>
<td>2022-09</td>
<td>RAN#97-e</td>
<td>RP-222400</td>
<td style="text-align: center;">0323</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>CR on the application of the configuration of group-based beam
reporting</td>
<td>17.3.0</td>
</tr>
<tr>
<td>2022-09</td>
<td>RAN#97-e</td>
<td>RP-222404</td>
<td style="text-align: center;">0324</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>CR on completing the PPW processing timeline</td>
<td>17.3.0</td>
</tr>
<tr>
<td>2022-09</td>
<td>RAN#97-e</td>
<td>RP-222404</td>
<td style="text-align: center;">0326</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on PRS reception procedure</td>
<td>17.3.0</td>
</tr>
<tr>
<td>2022-09</td>
<td>RAN#97-e</td>
<td>RP-222415</td>
<td style="text-align: center;">0327</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>CR on SRS carrier switching</td>
<td>17.3.0</td>
</tr>
<tr>
<td>2022-09</td>
<td>RAN#97-e</td>
<td>RP-222400</td>
<td style="text-align: center;">0328</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on Rel-17 aperiodic SRS configuration for 1T4R</td>
<td>17.3.0</td>
</tr>
<tr>
<td>2022-09</td>
<td>RAN#97-e</td>
<td>RP-222398</td>
<td style="text-align: center;">0330</td>
<td style="text-align: center;">-</td>
<td>A</td>
<td>Corrections on presence of redundancy version field and HARQ process
number field of DCI format 0_2 for semi-persistent CSI activation or
deactivation PDCCH validation</td>
<td>17.3.0</td>
</tr>
<tr>
<td>2022-09</td>
<td>RAN#97-e</td>
<td>RP-222417</td>
<td style="text-align: center;">0332</td>
<td style="text-align: center;">-</td>
<td>A</td>
<td>Clarification of LI reporting for Enhanced Type II CSI feedback</td>
<td>17.3.0</td>
</tr>
<tr>
<td>2022-09</td>
<td>RAN#97-e</td>
<td>RP-222412</td>
<td style="text-align: center;">0337</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Corrections on NR Multicast and Broadcast Services</td>
<td>17.3.0</td>
</tr>
<tr>
<td>2022-09</td>
<td>RAN#97-e</td>
<td>RP-222411</td>
<td style="text-align: center;">0340</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Corrections on NR Sidelink enhancements</td>
<td>17.3.0</td>
</tr>
<tr>
<td>2022-09</td>
<td>RAN#97-e</td>
<td>RP-222422</td>
<td style="text-align: center;">0341</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Rel-17 editorial corrections for TS 38.214</td>
<td>17.3.0</td>
</tr>
<tr>
<td>2022-09</td>
<td>RAN#97-e</td>
<td>RP-222399</td>
<td style="text-align: center;">0343</td>
<td style="text-align: center;">-</td>
<td>A</td>
<td>Rel-16 editorial corrections for TS 38.214 (mirrored to Rel-17)</td>
<td>17.3.0</td>
</tr>
<tr>
<td>2022-09</td>
<td>RAN#97-e</td>
<td>RP-222407</td>
<td style="text-align: center;">0344</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>A-CSI multiplexing on TBoMS</td>
<td>17.3.0</td>
</tr>
<tr>
<td>2022-09</td>
<td>RAN#97-e</td>
<td>RP-222609</td>
<td style="text-align: center;">0345</td>
<td style="text-align: center;">1</td>
<td>F</td>
<td>CR on PUSCH frequency hopping with DMRS bundling</td>
<td>17.3.0</td>
</tr>
<tr>
<td>2022-12</td>
<td>RAN#98-e</td>
<td>RP-222852</td>
<td style="text-align: center;">0346</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on LI reporting for Further Enhanced Type II Port
Selection CSI feedback</td>
<td>17.4.0</td>
</tr>
<tr>
<td>2022-12</td>
<td>RAN#98-e</td>
<td>RP-222853</td>
<td style="text-align: center;">0347</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on spatial domain filter for sensing for SRS transmission
in FR2-2</td>
<td>17.4.0</td>
</tr>
<tr>
<td>2022-12</td>
<td>RAN#98-e</td>
<td>RP-222863</td>
<td style="text-align: center;">0348</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on the description for the minimum number of Y and Y'
candidate slots in sidelink partial sensing</td>
<td>17.4.0</td>
</tr>
<tr>
<td>2022-12</td>
<td>RAN#98-e</td>
<td>RP-222863</td>
<td style="text-align: center;">0349</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on the selection of Y and Y' candidate slots in sidelink
partial sensing</td>
<td>17.4.0</td>
</tr>
<tr>
<td>2022-12</td>
<td>RAN#98-e</td>
<td>RP-222856</td>
<td style="text-align: center;">0350</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on SRS for positioning switching time</td>
<td>17.4.0</td>
</tr>
<tr>
<td>2022-12</td>
<td>RAN#98-e</td>
<td>RP-222853</td>
<td style="text-align: center;">0351</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on frequency resource for CSI-RS for tracking in TS
38.214</td>
<td>17.4.0</td>
</tr>
<tr>
<td>2022-12</td>
<td>RAN#98-e</td>
<td>RP-222853</td>
<td style="text-align: center;">0352</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on UE PUSCH preparation procedure time for operation with
shared spectrum channel access in FR2-2 in TS 38.214</td>
<td>17.4.0</td>
</tr>
<tr>
<td>2022-12</td>
<td>RAN#98-e</td>
<td>RP-222856</td>
<td style="text-align: center;">0353</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on DL PRS subcarrier spacings for FR2-2</td>
<td>17.4.0</td>
</tr>
<tr>
<td>2022-12</td>
<td>RAN#98-e</td>
<td>RP-222853</td>
<td style="text-align: center;">0354</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on ZP CSI-RS rate-matching for multi-PDSCH
scheduling</td>
<td>17.4.0</td>
</tr>
<tr>
<td>2022-12</td>
<td>RAN#98-e</td>
<td>RP-222853</td>
<td style="text-align: center;">0355</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on TDRA for multiple PUSCH scheduling in TS 38.214</td>
<td>17.4.0</td>
</tr>
<tr>
<td>2022-12</td>
<td>RAN#98-e</td>
<td>RP-222857</td>
<td style="text-align: center;">0356</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on invalid symbol determination for PUSCH repetition type
B for HD-FDD</td>
<td>17.4.0</td>
</tr>
<tr>
<td>2022-12</td>
<td>RAN#98-e</td>
<td>RP-222857</td>
<td style="text-align: center;">0357</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Corrections on available slot determination for PUSCH repetition
type A and TBoMS for HD-UE</td>
<td>17.4.0</td>
</tr>
<tr>
<td>2022-12</td>
<td>RAN#98-e</td>
<td>RP-222856</td>
<td style="text-align: center;">0358</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction adding DL PRS-RSRPP to the applicable measurements</td>
<td>17.4.0</td>
</tr>
<tr>
<td>2022-12</td>
<td>RAN#98-e</td>
<td>RP-222856</td>
<td style="text-align: center;">0359</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction to the Rx beam reporting condition for DL-AoD</td>
<td>17.4.0</td>
</tr>
<tr>
<td>2022-12</td>
<td>RAN#98-e</td>
<td>RP-222864</td>
<td style="text-align: center;">0360</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>CR on the max data rate for FDMed MBS and unicast to TS 38.214</td>
<td>17.4.0</td>
</tr>
<tr>
<td>2022-12</td>
<td>RAN#98-e</td>
<td>RP-222867</td>
<td style="text-align: center;">0362</td>
<td style="text-align: center;">-</td>
<td>A</td>
<td>CR on aperiodic CSI report with dormant BWP</td>
<td>17.4.0</td>
</tr>
<tr>
<td>2022-12</td>
<td>RAN#98-e</td>
<td>RP-222853</td>
<td style="text-align: center;">0363</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on a minimum guard period between two SRS resources for
antenna switching</td>
<td>17.4.0</td>
</tr>
<tr>
<td>2022-12</td>
<td>RAN#98-e</td>
<td>RP-222863</td>
<td style="text-align: center;">0364</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Corrections on CPS operation in sidelink partial sensing</td>
<td>17.4.0</td>
</tr>
<tr>
<td>2022-12</td>
<td>RAN#98-e</td>
<td>RP-222852</td>
<td style="text-align: center;">0365</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on Type 1 configured grant PUSCH transmission associated
with two SRS resource sets</td>
<td>17.4.0</td>
</tr>
<tr>
<td>2022-12</td>
<td>RAN#98-e</td>
<td>RP-222856</td>
<td style="text-align: center;">0366</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>CR on collision in Type 1B and Type 2 PPW for FR2 inter-band
case</td>
<td>17.4.0</td>
</tr>
<tr>
<td>2022-12</td>
<td>RAN#98-e</td>
<td>RP-222853</td>
<td style="text-align: center;">0367</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on DL PDSCH validity for multi-PDSCH scheduling via
single DCI mTRP in FR2-2</td>
<td>17.4.0</td>
</tr>
<tr>
<td>2022-12</td>
<td>RAN#98-e</td>
<td>RP-222864</td>
<td style="text-align: center;">0368</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>CR on the MBS reception type combinations to TS 38.214</td>
<td>17.4.0</td>
</tr>
<tr>
<td>2022-12</td>
<td>RAN#98-e</td>
<td>RP-222851</td>
<td style="text-align: center;">0371</td>
<td style="text-align: center;">-</td>
<td>A</td>
<td>Rel-16 editorial corrections for TS 38.214 (mirrored to Rel-17)</td>
<td>17.4.0</td>
</tr>
<tr>
<td>2022-12</td>
<td>RAN#98-e</td>
<td>RP-222868</td>
<td style="text-align: center;">0372</td>
<td style="text-align: center;">1</td>
<td>F</td>
<td>Rel-17 editorial corrections for TS 38.214</td>
<td>17.4.0</td>
</tr>
<tr>
<td>2022-12</td>
<td>RAN#98-e</td>
<td>RP-222856</td>
<td style="text-align: center;">0373</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>CR on UE TEG margin value report</td>
<td>17.4.0</td>
</tr>
<tr>
<td>2022-12</td>
<td>RAN#98-e</td>
<td>RP-222856</td>
<td style="text-align: center;">0374</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on configuration of UE Tx TEG association information
reporting</td>
<td>17.4.0</td>
</tr>
<tr>
<td>2022-12</td>
<td>RAN#98-e</td>
<td>RP-222853</td>
<td style="text-align: center;">0375</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>CR on frequency hopping for PUSCH and SRS in FR2-2</td>
<td>17.4.0</td>
</tr>
<tr>
<td>2022-12</td>
<td>RAN#98-e</td>
<td>RP-222852</td>
<td style="text-align: center;">0376</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>CR on beam application time for unified TCI in TS 38.214</td>
<td>17.4.0</td>
</tr>
<tr>
<td>2022-12</td>
<td>RAN#98-e</td>
<td>RP-222852</td>
<td style="text-align: center;">0377</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on SRI for mTRP PUSCH repetition</td>
<td>17.4.0</td>
</tr>
<tr>
<td>2022-12</td>
<td>RAN#98-e</td>
<td>RP-222859</td>
<td style="text-align: center;">0378</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction of RV of CG PUSCH repetitions</td>
<td>17.4.0</td>
</tr>
<tr>
<td>2022-12</td>
<td>RAN#98-e</td>
<td>RP-222856</td>
<td style="text-align: center;">0379</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on DL PRS priority states in PPW</td>
<td>17.4.0</td>
</tr>
<tr>
<td>2022-12</td>
<td>RAN#98-e</td>
<td>RP-222870</td>
<td style="text-align: center;">0383</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>CR on UL Tx switching for PUCCH with HARQ-ACK</td>
<td>17.4.0</td>
</tr>
<tr>
<td>2022-12</td>
<td>RAN#98-e</td>
<td>RP-222850</td>
<td style="text-align: center;">0385</td>
<td style="text-align: center;">-</td>
<td>A</td>
<td>Correction on Priority rules for CSI reports in TS 38.214</td>
<td>17.4.0</td>
</tr>
<tr>
<td>2022-12</td>
<td>RAN#98-e</td>
<td>RP-222859</td>
<td style="text-align: center;">0386</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on events for restarting of DMRS bundling</td>
<td>17.4.0</td>
</tr>
<tr>
<td>2022-12</td>
<td>RAN#98-e</td>
<td>RP-222859</td>
<td style="text-align: center;">0387</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on DMRS bundling for reduced capability HD-UE</td>
<td>17.4.0</td>
</tr>
<tr>
<td>2022-12</td>
<td>RAN#98-e</td>
<td>RP-222859</td>
<td style="text-align: center;">0388</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on determination N∙K for DMRS bundling of CG-PUSCH</td>
<td>17.4.0</td>
</tr>
<tr>
<td>2022-12</td>
<td>RAN#98-e</td>
<td>RP-222864</td>
<td style="text-align: center;">0389</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>CR on rate-matching pattern for MBS broadcast reception</td>
<td>17.4.0</td>
</tr>
<tr>
<td>2022-12</td>
<td>RAN#98-e</td>
<td>RP-222863</td>
<td style="text-align: center;">0390</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on duplicated part on UE procedure for determining a
resource conflict between TS 38.213 and TS 38.214</td>
<td>17.4.0</td>
</tr>
<tr>
<td>2022-12</td>
<td>RAN#98-e</td>
<td>RP-222863</td>
<td style="text-align: center;">0391</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on the re-evaluation and pre-emption checking for
periodic and aperiodic transmissions</td>
<td>17.4.0</td>
</tr>
<tr>
<td>2022-12</td>
<td>RAN#98-e</td>
<td>RP-222870</td>
<td style="text-align: center;">0392</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>CR on CSI reporting</td>
<td>17.4.0</td>
</tr>
<tr>
<td>2023-03</td>
<td>RAN#99</td>
<td>RP-230443</td>
<td style="text-align: center;">0394</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on timeline requirements when configured with
uci-MuxWithDiffPrio</td>
<td>17.5.0</td>
</tr>
<tr>
<td>2023-03</td>
<td>RAN#99</td>
<td>RP-230441</td>
<td style="text-align: center;">0395</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>CR on power control parameters for multiple aperiodic SRS resource
sets</td>
<td>17.5.0</td>
</tr>
<tr>
<td>2023-03</td>
<td>RAN#99</td>
<td>RP-230442</td>
<td style="text-align: center;">0396</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Corrections to aperiodic CSI-RS timing for mixed numerologies
configuration in TS38.214</td>
<td>17.5.0</td>
</tr>
<tr>
<td>2023-03</td>
<td>RAN#99</td>
<td>RP-230441</td>
<td style="text-align: center;">0397</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>CR on slot offset parameters for multiple aperiodic SRS resource
sets</td>
<td>17.5.0</td>
</tr>
<tr>
<td>2023-03</td>
<td>RAN#99</td>
<td>RP-230451</td>
<td style="text-align: center;">0398</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>CR on SPS and dynamic scheduling PDSCH(s) collision for MBS</td>
<td>17.5.0</td>
</tr>
<tr>
<td>2023-03</td>
<td>RAN#99</td>
<td>RP-230442</td>
<td style="text-align: center;">0399</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>CR on K2 indication for multi-PUSCH scheduling DCI</td>
<td>17.5.0</td>
</tr>
<tr>
<td>2023-03</td>
<td>RAN#99</td>
<td>RP-230442</td>
<td style="text-align: center;">0400</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on channel measurement and interference measurement in
FR2-2 in TS 38.214</td>
<td>17.5.0</td>
</tr>
<tr>
<td>2023-03</td>
<td>RAN#99</td>
<td>RP-230450</td>
<td style="text-align: center;">0401</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Clarification of a field in SCI format 2-C indicating the time
offset of the first resource of each tuple with respect to the reference
slot</td>
<td>17.5.0</td>
</tr>
<tr>
<td>2023-03</td>
<td>RAN#99</td>
<td>RP-230450</td>
<td style="text-align: center;">0402</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on the resource selection mechanism indicated by higher
layer</td>
<td>17.5.0</td>
</tr>
<tr>
<td>2023-03</td>
<td>RAN#99</td>
<td>RP-230454</td>
<td style="text-align: center;">0404</td>
<td style="text-align: center;">-</td>
<td>A</td>
<td>Correction on PUSCH TDRA Tables in Rel-17</td>
<td>17.5.0</td>
</tr>
<tr>
<td>2023-03</td>
<td>RAN#99</td>
<td>RP-230450</td>
<td style="text-align: center;">0405</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on reservation periodicity for re-evaluation and
pre-emption checking</td>
<td>17.5.0</td>
</tr>
<tr>
<td>2023-03</td>
<td>RAN#99</td>
<td>RP-230450</td>
<td style="text-align: center;">0406</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on periodic-based partial sensing occasion index</td>
<td>17.5.0</td>
</tr>
<tr>
<td>2023-03</td>
<td>RAN#99</td>
<td>RP-230450</td>
<td style="text-align: center;">0407</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on resource selection based on decoded PSCCH and measured
RSRP</td>
<td>17.5.0</td>
</tr>
<tr>
<td>2023-03</td>
<td>RAN#99</td>
<td>RP-230450</td>
<td style="text-align: center;">0408</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on the parameter description for Y' candidate slots</td>
<td>17.5.0</td>
</tr>
<tr>
<td>2023-03</td>
<td>RAN#99</td>
<td>RP-230441</td>
<td style="text-align: center;">0409</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>CR on HARQ-ACK for beam indication in unified TCI</td>
<td>17.5.0</td>
</tr>
<tr>
<td>2023-03</td>
<td>RAN#99</td>
<td>RP-230451</td>
<td style="text-align: center;">0410</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>CR on FDMed unicast PDSCH and group-common PDSCH</td>
<td>17.5.0</td>
</tr>
<tr>
<td>2023-03</td>
<td>RAN#99</td>
<td>RP-230451</td>
<td style="text-align: center;">0411</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>CR on rate matching pattern number for MBS broadcast reception</td>
<td>17.5.0</td>
</tr>
<tr>
<td>2023-03</td>
<td>RAN#99</td>
<td>RP-230446</td>
<td style="text-align: center;">0412</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Corrections on invalid symbol determination for PUSCH repetition
Type B transmission for RedCap UE</td>
<td>17.5.0</td>
</tr>
<tr>
<td>2023-03</td>
<td>RAN#99</td>
<td>RP-230440</td>
<td style="text-align: center;">0414</td>
<td style="text-align: center;">-</td>
<td>A</td>
<td>Rel-16 editorial corrections for TS 38.214 (mirrored to Rel-17)</td>
<td>17.5.0</td>
</tr>
<tr>
<td>2023-03</td>
<td>RAN#99</td>
<td>RP-230453</td>
<td style="text-align: center;">0415</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Rel-17 editorial corrections for TS 38.214</td>
<td>17.5.0</td>
</tr>
<tr>
<td>2023-06</td>
<td>RAN#100</td>
<td>RP-231220</td>
<td style="text-align: center;">0416</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Corrections to timeline for CSI feedback in TS38.214</td>
<td>17.6.0</td>
</tr>
<tr>
<td>2023-06</td>
<td>RAN#100</td>
<td>RP-231219</td>
<td style="text-align: center;">0417</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>CR on the antenna switching capability indication for more than 4 Rx
antenna</td>
<td>17.6.0</td>
</tr>
<tr>
<td>2023-06</td>
<td>RAN#100</td>
<td>RP-231229</td>
<td style="text-align: center;">0419</td>
<td style="text-align: center;">-</td>
<td>A</td>
<td>Clarification to the switching gap location of the UL Tx
Switching</td>
<td>17.6.0</td>
</tr>
<tr>
<td>2023-06</td>
<td>RAN#100</td>
<td>RP-231220</td>
<td style="text-align: center;">0420</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Corrections to spatial domain filter determination for directional
LBT in TS38.214</td>
<td>17.6.0</td>
</tr>
<tr>
<td>2023-06</td>
<td>RAN#100</td>
<td>RP-231231</td>
<td style="text-align: center;">0422</td>
<td style="text-align: center;">-</td>
<td>A</td>
<td>CR on TBS determination of a PUSCH retransmission with initial PUSCH
scheduled by RAR UL grant</td>
<td>17.6.0</td>
</tr>
<tr>
<td>2023-06</td>
<td>RAN#100</td>
<td>RP-231223</td>
<td style="text-align: center;">0423</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Clarification for half-duplex consideration in partial sensing based
re-evaluation/pre-emption checking</td>
<td>17.6.0</td>
</tr>
<tr>
<td>2023-06</td>
<td>RAN#100</td>
<td>RP-231219</td>
<td style="text-align: center;">0424</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on default beam and configuration for HST-SFN</td>
<td>17.6.0</td>
</tr>
<tr>
<td>2023-06</td>
<td>RAN#100</td>
<td>RP-231219</td>
<td style="text-align: center;">0426</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on SFN configuration for HST-SFN</td>
<td>17.6.0</td>
</tr>
<tr>
<td>2023-06</td>
<td>RAN#100</td>
<td>RP-231226</td>
<td style="text-align: center;">0427</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Rel-17 editorial corrections for TS 38.214</td>
<td>17.6.0</td>
</tr>
<tr>
<td>2023-09</td>
<td>RAN#101</td>
<td>RP-232445</td>
<td style="text-align: center;">0428</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>CR on RI restriction description for NCJT in TS38.214</td>
<td>17.7.0</td>
</tr>
<tr>
<td>2023-09</td>
<td>RAN#101</td>
<td>RP-232447</td>
<td style="text-align: center;">0429</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on timeline requirements for simultaneous PUCCH and PUSCH
transmission of different priorities</td>
<td>17.7.0</td>
</tr>
<tr>
<td>2023-09</td>
<td>RAN#101</td>
<td>RP-232445</td>
<td style="text-align: center;">0430</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on SP CSI multiplexing on PUSCH after DCI activation</td>
<td>17.7.0</td>
</tr>
<tr>
<td>2023-09</td>
<td>RAN#101</td>
<td>RP-232445</td>
<td style="text-align: center;">0431</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on SFN configuration for CSI-RS reception using default
beam</td>
<td>17.7.0</td>
</tr>
<tr>
<td>2023-09</td>
<td>RAN#101</td>
<td>RP-232456</td>
<td style="text-align: center;">0432</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on PUSCH repetition type B with DMRS bundling</td>
<td>17.7.0</td>
</tr>
<tr>
<td>2023-09</td>
<td>RAN#101</td>
<td>RP-232456</td>
<td style="text-align: center;">0433</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on the calculation of the number of coded modulation
symbols for UCI multiplexing on TBoMS</td>
<td>17.7.0</td>
</tr>
<tr>
<td>2023-09</td>
<td>RAN#101</td>
<td>RP-232531</td>
<td style="text-align: center;">0436</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Rel-17 editorial corrections for TS 38.214</td>
<td>17.7.0</td>
</tr>
<tr>
<td>2023-12</td>
<td>RAN#102</td>
<td>RP-233726</td>
<td style="text-align: center;">0452</td>
<td style="text-align: center;">-</td>
<td>A</td>
<td>CR correcting capability parameter for CSI trigger state non-active
BWP</td>
<td>17.8.0</td>
</tr>
<tr>
<td>2023-12</td>
<td>RAN#102</td>
<td>RP-233700</td>
<td style="text-align: center;">0454</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Corrections on Partial Sensing Occasion</td>
<td>17.8.0</td>
</tr>
<tr>
<td>2023-12</td>
<td>RAN#102</td>
<td>RP-233697</td>
<td style="text-align: center;">0456</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>CR on one from more than one indicated TCI state applied for unified
TCI framework in TS38.214</td>
<td>17.8.0</td>
</tr>
<tr>
<td>2023-12</td>
<td>RAN#102</td>
<td>RP-233727</td>
<td style="text-align: center;">0458</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on the order of SRS transmissions on multiple uplinks
triggered by DCI 2_3 for SRS carrier switching</td>
<td>17.8.0</td>
</tr>
<tr>
<td>2023-12</td>
<td>RAN#102</td>
<td>RP-233698</td>
<td style="text-align: center;">0460</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>CR on resource allocation in time domain for multi-PXSCH
scheduling</td>
<td>17.8.0</td>
</tr>
<tr>
<td>2023-12</td>
<td>RAN#102</td>
<td>RP-233726</td>
<td style="text-align: center;">0463</td>
<td style="text-align: center;">-</td>
<td>A</td>
<td>CR on slot offset calculation for PUSCH carrying aperiodic CSI with
no transport block</td>
<td>17.8.0</td>
</tr>
<tr>
<td>2023-12</td>
<td>RAN#102</td>
<td>RP-233697</td>
<td style="text-align: center;">0465</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>CR on UL beam after 2-step RACH</td>
<td>17.8.0</td>
</tr>
<tr>
<td>2023-12</td>
<td>RAN#102</td>
<td>RP-233697</td>
<td style="text-align: center;">0467</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>CR on default beam based on unified TCI framework</td>
<td>17.8.0</td>
</tr>
<tr>
<td>2023-12</td>
<td>RAN#102</td>
<td>RP-233735</td>
<td style="text-align: center;">0469</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction to the SRS transmission collision</td>
<td>17.8.0</td>
</tr>
<tr>
<td>2023-12</td>
<td>RAN#102</td>
<td>RP-233732</td>
<td style="text-align: center;">0472</td>
<td style="text-align: center;">-</td>
<td>A</td>
<td>CR on Memory issue associated to slot offset determination for A-CSI
without data</td>
<td>17.8.0</td>
</tr>
<tr>
<td>2023-12</td>
<td>RAN#102</td>
<td>RP-233697</td>
<td style="text-align: center;">0474</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>CR on clarification of CSI-RS transmission occasion for NCJT
CSI</td>
<td>17.8.0</td>
</tr>
<tr>
<td>2023-12</td>
<td>RAN#102</td>
<td>RP-233727</td>
<td style="text-align: center;">0476</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction for SRS carrier switching for DCI formats 1_1 and
1_2</td>
<td>17.8.0</td>
</tr>
<tr>
<td>2023-12</td>
<td>RAN#102</td>
<td>RP-233736</td>
<td style="text-align: center;">0478</td>
<td style="text-align: center;">1</td>
<td>F</td>
<td>Correction of PUSCH repetition for RedCap UE with NCD-SSB in
TDD</td>
<td>17.8.0</td>
</tr>
<tr>
<td>2023-12</td>
<td>RAN#102</td>
<td>RP-233728</td>
<td style="text-align: center;">0480</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Rel-17 editorial corrections for TS 38.214</td>
<td>17.8.0</td>
</tr>
<tr>
<td>2024-03</td>
<td>RAN#103</td>
<td>RP-240538</td>
<td style="text-align: center;">0497</td>
<td style="text-align: center;">1</td>
<td>F</td>
<td>CR on Timing correction for aperiodic SRS transmission</td>
<td>17.9.0</td>
</tr>
<tr>
<td>2024-03</td>
<td>RAN#103</td>
<td>RP-240534</td>
<td style="text-align: center;">0499</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on SRS carrier switching prioritization rules</td>
<td>17.9.0</td>
</tr>
<tr>
<td>2024-03</td>
<td>RAN#103</td>
<td>RP-240515</td>
<td style="text-align: center;">0501</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Clarification on NCJT CSI-IM restriction</td>
<td>17.9.0</td>
</tr>
<tr>
<td>2024-03</td>
<td>RAN#103</td>
<td>RP-240516</td>
<td style="text-align: center;">0503</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction on the support of SCI format 1-A in IUC scheme 1</td>
<td>17.9.0</td>
</tr>
<tr>
<td>2024-03</td>
<td>RAN#103</td>
<td>RP-240515</td>
<td style="text-align: center;">0505</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>CR on sub-set of {DL TCI, UL TCI} indication for Rel-17 TCI
framework</td>
<td>17.9.0</td>
</tr>
<tr>
<td>2024-03</td>
<td>RAN#103</td>
<td>RP-240515</td>
<td style="text-align: center;">0507</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>CR on TCI state indication for Rel-15/16 TCI framework</td>
<td>17.9.0</td>
</tr>
<tr>
<td>2024-03</td>
<td>RAN#103</td>
<td>RP-240539</td>
<td style="text-align: center;">0509</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Correction for SRS transmission collision rule in RRC_INACTIVE</td>
<td>17.9.0</td>
</tr>
<tr>
<td>2024-03</td>
<td>RAN#103</td>
<td>RP-240515</td>
<td style="text-align: center;">0514</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>CR on clarifying condition for applying unified TCI</td>
<td>17.9.0</td>
</tr>
<tr>
<td>2024-03</td>
<td>RAN#103</td>
<td>RP-240517</td>
<td style="text-align: center;">0515</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>CR on PDSCH processing timeline</td>
<td>17.9.0</td>
</tr>
<tr>
<td>2024-03</td>
<td>RAN#103</td>
<td>RP-240533</td>
<td style="text-align: center;">0520</td>
<td style="text-align: center;">-</td>
<td>A</td>
<td>ssb-index-RSRP/SINR CSI report dropping due to absence of
CSI-RS</td>
<td>17.9.0</td>
</tr>
<tr>
<td>2024-03</td>
<td>RAN#103</td>
<td>RP-240534</td>
<td style="text-align: center;">0522</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>CR on overlapping SRS resources</td>
<td>17.9.0</td>
</tr>
<tr>
<td>2024-03</td>
<td>RAN#103</td>
<td>RP-240533</td>
<td style="text-align: center;">0525</td>
<td style="text-align: center;">-</td>
<td>A</td>
<td>Correction on mapping order of CSI report</td>
<td>17.9.0</td>
</tr>
<tr>
<td>2024-03</td>
<td>RAN#103</td>
<td>RP-240515</td>
<td style="text-align: center;">0529</td>
<td style="text-align: center;">-</td>
<td>F</td>
<td>Rel-17 editorial corrections for TS 38.214</td>
<td>17.9.0</td>
</tr>
</tbody>
</table>
</body>
</html>
